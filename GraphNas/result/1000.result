02200
Iter: 0008 train_loss= 0.50119 train_f1_mic= 0.52126 train_f1_mac= 0.27716 val_loss= 0.51973 val_f1_mic= 0.54787 val_f1_mac= 0.30071 time= 0.02175
Iter: 0013 train_loss= 0.52022 train_f1_mic= 0.42772 train_f1_mac= 0.18172 val_loss= 0.51973 val_f1_mic= 0.54787 val_f1_mac= 0.30071 time= 0.02156
Iter: 0018 train_loss= 0.50193 train_f1_mic= 0.49302 train_f1_mac= 0.25624 val_loss= 0.51973 val_f1_mic= 0.54787 val_f1_mac= 0.30071 time= 0.02143
Epoch: 0010
Iter: 0004 train_loss= 0.49317 train_f1_mic= 0.49928 train_f1_mac= 0.26455 val_loss= 0.51834 val_f1_mic= 0.46514 val_f1_mac= 0.23539 time= 0.02140
Iter: 0009 train_loss= 0.49266 train_f1_mic= 0.48691 train_f1_mac= 0.25179 val_loss= 0.51834 val_f1_mic= 0.46514 val_f1_mac= 0.23539 time= 0.02122
Iter: 0014 train_loss= 0.48727 train_f1_mic= 0.49656 train_f1_mac= 0.25404 val_loss= 0.51834 val_f1_mic= 0.46514 val_f1_mac= 0.23539 time= 0.02105
Optimization Finished!
Full validation stats: loss= 0.51327 f1_micro= 0.52985 f1_macro= 0.30214 time= 0.10372
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48091883022908244
Rewards :  0.05306251155994046 Accuracy :  0.5233688394770348
Total reward :  1.3483299113288427
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.05306251]
Trial 229: Controller loss : 106.251793
2018-08-31 00:43:24.365067: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:43:24.365371: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:43:24.365658: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:43:24.365870: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [1, 'linear', 4, 'linear']
] 0:   N
2018-08-31 00:43:24.366406: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69405 train_f1_mic= 0.37075 train_f1_mac= 0.34685 val_loss= 0.68440 val_f1_mic= 0.40998 val_f1_mac= 0.34472 time= 1.29860
Iter: 0005 train_loss= 0.59049 train_f1_mic= 0.36358 train_f1_mac= 0.08878 val_loss= 0.68440 val_f1_mic= 0.40998 val_f1_mac= 0.34472 time= 0.31733
Iter: 0010 train_loss= 0.55203 train_f1_mic= 0.36800 train_f1_mac= 0.08805 val_loss= 0.68440 val_f1_mic= 0.40998 val_f1_mac= 0.34472 time= 0.22785
Iter: 0015 train_loss= 0.54862 train_f1_mic= 0.38705 train_f1_mac= 0.09688 val_loss= 0.68440 val_f1_mic= 0.40998 val_f1_mac= 0.34472 time= 0.19455
Epoch: 0002
Iter: 0001 train_loss= 0.54031 train_f1_mic= 0.37991 train_f1_mac= 0.09175 val_loss= 0.56191 val_f1_mic= 0.37922 val_f1_mac= 0.09575 time= 0.17928
Iter: 0006 train_loss= 0.53878 train_f1_mic= 0.38650 train_f1_mac= 0.09281 val_loss= 0.56191 val_f1_mic= 0.37922 val_f1_mac= 0.09575 time= 0.16786
Iter: 0011 train_loss= 0.54593 train_f1_mic= 0.40282 train_f1_mac= 0.10385 val_loss= 0.56191 val_f1_mic= 0.37922 val_f1_mac= 0.09575 time= 0.16067
Iter: 0016 train_loss= 0.54921 train_f1_mic= 0.37652 train_f1_mac= 0.09307 val_loss= 0.56191 val_f1_mic= 0.37922 val_f1_mac= 0.09575 time= 0.15522
Epoch: 0003
Iter: 0002 train_loss= 0.54077 train_f1_mic= 0.36908 train_f1_mac= 0.08716 val_loss= 0.57175 val_f1_mic= 0.36072 val_f1_mac= 0.09127 time= 0.15191
Iter: 0007 train_loss= 0.53675 train_f1_mic= 0.37277 train_f1_mac= 0.08894 val_loss= 0.57175 val_f1_mic= 0.36072 val_f1_mac= 0.09127 time= 0.14842
Iter: 0012 train_loss= 0.54344 train_f1_mic= 0.39277 train_f1_mac= 0.10033 val_loss= 0.57175 val_f1_mic= 0.36072 val_f1_mac= 0.09127 time= 0.14570
Iter: 0017 train_loss= 0.53619 train_f1_mic= 0.39236 train_f1_mac= 0.09877 val_loss= 0.57175 val_f1_mic= 0.36072 val_f1_mac= 0.09127 time= 0.14342
Epoch: 0004
Iter: 0003 train_loss= 0.54341 train_f1_mic= 0.39217 train_f1_mac= 0.10928 val_loss= 0.55162 val_f1_mic= 0.39110 val_f1_mac= 0.10765 time= 0.14235
Iter: 0008 train_loss= 0.53382 train_f1_mic= 0.38990 train_f1_mac= 0.10168 val_loss= 0.55162 val_f1_mic= 0.39110 val_f1_mac= 0.10765 time= 0.14071
Iter: 0013 train_loss= 0.53576 train_f1_mic= 0.38627 train_f1_mac= 0.09841 val_loss= 0.55162 val_f1_mic= 0.39110 val_f1_mac= 0.10765 time= 0.13930
Iter: 0018 train_loss= 0.53519 train_f1_mic= 0.40259 train_f1_mac= 0.11606 val_loss= 0.55162 val_f1_mic= 0.39110 val_f1_mac= 0.10765 time= 0.13806
Epoch: 0005
Iter: 0004 train_loss= 0.54297 train_f1_mic= 0.41105 train_f1_mac= 0.12494 val_loss= 0.57103 val_f1_mic= 0.39914 val_f1_mac= 0.12303 time= 0.13762
Iter: 0009 train_loss= 0.52660 train_f1_mic= 0.41840 train_f1_mac= 0.12570 val_loss= 0.57103 val_f1_mic= 0.39914 val_f1_mac= 0.12303 time= 0.13703
Iter: 0014 train_loss= 0.52686 train_f1_mic= 0.40110 train_f1_mac= 0.11553 val_loss= 0.57103 val_f1_mic= 0.39914 val_f1_mac= 0.12303 time= 0.13618
Epoch: 0006
Iter: 0000 train_loss= 0.54092 train_f1_mic= 0.41131 train_f1_mac= 0.12575 val_loss= 0.56113 val_f1_mic= 0.40340 val_f1_mac= 0.12914 time= 0.13582
Iter: 0005 train_loss= 0.53888 train_f1_mic= 0.40352 train_f1_mac= 0.12389 val_loss= 0.56113 val_f1_mic= 0.40340 val_f1_mac= 0.12914 time= 0.13520
Iter: 0010 train_loss= 0.52386 train_f1_mic= 0.40985 train_f1_mac= 0.11856 val_loss= 0.56113 val_f1_mic= 0.40340 val_f1_mac= 0.12914 time= 0.13454
Iter: 0015 train_loss= 0.53790 train_f1_mic= 0.41896 train_f1_mac= 0.13585 val_loss= 0.56113 val_f1_mic= 0.40340 val_f1_mac= 0.12914 time= 0.13396
Epoch: 0007
Iter: 0001 train_loss= 0.53447 train_f1_mic= 0.40211 train_f1_mac= 0.11986 val_loss= 0.58881 val_f1_mic= 0.38190 val_f1_mac= 0.12257 time= 0.13385
Iter: 0006 train_loss= 0.52637 train_f1_mic= 0.41222 train_f1_mac= 0.12815 val_loss= 0.58881 val_f1_mic= 0.38190 val_f1_mac= 0.12257 time= 0.13333
Iter: 0011 train_loss= 0.53179 train_f1_mic= 0.41419 train_f1_mac= 0.13436 val_loss= 0.58881 val_f1_mic= 0.38190 val_f1_mac= 0.12257 time= 0.13298
Iter: 0016 train_loss= 0.52663 train_f1_mic= 0.42610 train_f1_mac= 0.13675 val_loss= 0.58881 val_f1_mic= 0.38190 val_f1_mac= 0.12257 time= 0.13264
Epoch: 0008
Iter: 0002 train_loss= 0.53050 train_f1_mic= 0.38921 train_f1_mac= 0.11931 val_loss= 0.54192 val_f1_mic= 0.40170 val_f1_mac= 0.13393 time= 0.13261
Iter: 0007 train_loss= 0.53761 train_f1_mic= 0.41484 train_f1_mac= 0.12886 val_loss= 0.54192 val_f1_mic= 0.40170 val_f1_mac= 0.13393 time= 0.13224
Iter: 0012 train_loss= 0.52528 train_f1_mic= 0.41062 train_f1_mac= 0.12964 val_loss= 0.54192 val_f1_mic= 0.40170 val_f1_mac= 0.13393 time= 0.13191
Iter: 0017 train_loss= 0.52926 train_f1_mic= 0.42695 train_f1_mac= 0.13343 val_loss= 0.54192 val_f1_mic= 0.40170 val_f1_mac= 0.13393 time= 0.13162
Epoch: 0009
Iter: 0003 train_loss= 0.54118 train_f1_mic= 0.40524 train_f1_mac= 0.12461 val_loss= 0.55381 val_f1_mic= 0.40356 val_f1_mac= 0.12562 time= 0.13158
Iter: 0008 train_loss= 0.52393 train_f1_mic= 0.40081 train_f1_mac= 0.12446 val_loss= 0.55381 val_f1_mic= 0.40356 val_f1_mac= 0.12562 time= 0.13132
Iter: 0013 train_loss= 0.54242 train_f1_mic= 0.39847 train_f1_mac= 0.11791 val_loss= 0.55381 val_f1_mic= 0.40356 val_f1_mac= 0.12562 time= 0.13104
Iter: 0018 train_loss= 0.52668 train_f1_mic= 0.41959 train_f1_mac= 0.12306 val_loss= 0.55381 val_f1_mic= 0.40356 val_f1_mac= 0.12562 time= 0.13076
Epoch: 0010
Iter: 0004 train_loss= 0.52938 train_f1_mic= 0.38761 train_f1_mac= 0.11609 val_loss= 0.56139 val_f1_mic= 0.38219 val_f1_mac= 0.12116 time= 0.13084
Iter: 0009 train_loss= 0.54142 train_f1_mic= 0.42389 train_f1_mac= 0.14610 val_loss= 0.56139 val_f1_mic= 0.38219 val_f1_mac= 0.12116 time= 0.13062
Iter: 0014 train_loss= 0.53727 train_f1_mic= 0.40861 train_f1_mac= 0.12687 val_loss= 0.56139 val_f1_mic= 0.38219 val_f1_mac= 0.12116 time= 0.13037
Optimization Finished!
Full validation stats: loss= 0.55349 f1_micro= 0.40397 f1_macro= 0.13210 time= 0.29122
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4666982985939352
Rewards :  -0.0711026581757363 Accuracy :  0.40981617205334614
Total reward :  1.2772272531531064
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'linear', 4, 'linear']
Training RNN (Reward ip) :  [-0.07110266]
Trial 230: Controller loss : 13819.999023

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [0, 'relu', 0, 'linear']
2018-08-31 00:43:56.024072: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:43:56.024577: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:43:56.025072: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:43:56.025429: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:43:56.025877: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69346 train_f1_mic= 0.35513 train_f1_mac= 0.31462 val_loss= 0.66816 val_f1_mic= 0.39043 val_f1_mac= 0.14131 time= 0.74835
Iter: 0005 train_loss= 0.57690 train_f1_mic= 0.36953 train_f1_mac= 0.08688 val_loss= 0.66816 val_f1_mic= 0.39043 val_f1_mac= 0.14131 time= 0.13404
Iter: 0010 train_loss= 0.55414 train_f1_mic= 0.38999 train_f1_mac= 0.09996 val_loss= 0.66816 val_f1_mic= 0.39043 val_f1_mac= 0.14131 time= 0.07865
Iter: 0015 train_loss= 0.54226 train_f1_mic= 0.38626 train_f1_mac= 0.09582 val_loss= 0.66816 val_f1_mic= 0.39043 val_f1_mac= 0.14131 time= 0.05781
Epoch: 0002
Iter: 0001 train_loss= 0.54039 train_f1_mic= 0.39418 train_f1_mac= 0.09847 val_loss= 0.56402 val_f1_mic= 0.38033 val_f1_mac= 0.10069 time= 0.04832
Iter: 0006 train_loss= 0.54338 train_f1_mic= 0.38514 train_f1_mac= 0.09903 val_loss= 0.56402 val_f1_mic= 0.38033 val_f1_mac= 0.10069 time= 0.04148
Iter: 0011 train_loss= 0.53658 train_f1_mic= 0.39054 train_f1_mac= 0.10674 val_loss= 0.56402 val_f1_mic= 0.38033 val_f1_mac= 0.10069 time= 0.03694
Iter: 0016 train_loss= 0.53305 train_f1_mic= 0.39998 train_f1_mac= 0.11214 val_loss= 0.56402 val_f1_mic= 0.38033 val_f1_mac= 0.10069 time= 0.03375
Epoch: 0003
Iter: 0002 train_loss= 0.54045 train_f1_mic= 0.41734 train_f1_mac= 0.12918 val_loss= 0.55900 val_f1_mic= 0.41164 val_f1_mac= 0.13283 time= 0.03194
Iter: 0007 train_loss= 0.52685 train_f1_mic= 0.41548 train_f1_mac= 0.12805 val_loss= 0.55900 val_f1_mic= 0.41164 val_f1_mac= 0.13283 time= 0.02990
Iter: 0012 train_loss= 0.53345 train_f1_mic= 0.40733 train_f1_mac= 0.13036 val_loss= 0.55900 val_f1_mic= 0.41164 val_f1_mac= 0.13283 time= 0.02812
Iter: 0017 train_loss= 0.53649 train_f1_mic= 0.41341 train_f1_mac= 0.13988 val_loss= 0.55900 val_f1_mic= 0.41164 val_f1_mac= 0.13283 time= 0.02670
Epoch: 0004
Iter: 0003 train_loss= 0.53218 train_f1_mic= 0.43075 train_f1_mac= 0.15594 val_loss= 0.55301 val_f1_mic= 0.42373 val_f1_mac= 0.15285 time= 0.02577
Iter: 0008 train_loss= 0.51133 train_f1_mic= 0.43272 train_f1_mac= 0.16308 val_loss= 0.55301 val_f1_mic= 0.42373 val_f1_mac= 0.15285 time= 0.02481
Iter: 0013 train_loss= 0.53078 train_f1_mic= 0.45370 train_f1_mac= 0.19394 val_loss= 0.55301 val_f1_mic= 0.42373 val_f1_mac= 0.15285 time= 0.02398
Iter: 0018 train_loss= 0.52904 train_f1_mic= 0.41784 train_f1_mac= 0.16537 val_loss= 0.55301 val_f1_mic= 0.42373 val_f1_mac= 0.15285 time= 0.02324
Epoch: 0005
Iter: 0004 train_loss= 0.51908 train_f1_mic= 0.45815 train_f1_mac= 0.19906 val_loss= 0.54646 val_f1_mic= 0.43712 val_f1_mac= 0.17501 time= 0.02278
Iter: 0009 train_loss= 0.51719 train_f1_mic= 0.47074 train_f1_mac= 0.22832 val_loss= 0.54646 val_f1_mic= 0.43712 val_f1_mac= 0.17501 time= 0.02218
Iter: 0014 train_loss= 0.50651 train_f1_mic= 0.46670 train_f1_mac= 0.21952 val_loss= 0.54646 val_f1_mic= 0.43712 val_f1_mac= 0.17501 time= 0.02165
Epoch: 0006
Iter: 0000 train_loss= 0.51344 train_f1_mic= 0.47326 train_f1_mac= 0.22450 val_loss= 0.52187 val_f1_mic= 0.47442 val_f1_mac= 0.23833 time= 0.02134
Iter: 0005 train_loss= 0.50977 train_f1_mic= 0.48123 train_f1_mac= 0.24212 val_loss= 0.52187 val_f1_mic= 0.47442 val_f1_mac= 0.23833 time= 0.02082
Iter: 0010 train_loss= 0.50568 train_f1_mic= 0.47858 train_f1_mac= 0.24339 val_loss= 0.52187 val_f1_mic= 0.47442 val_f1_mac= 0.23833 time= 0.02041
Iter: 0015 train_loss= 0.51356 train_f1_mic= 0.46115 train_f1_mac= 0.22505 val_loss= 0.52187 val_f1_mic= 0.47442 val_f1_mac= 0.23833 time= 0.02005
Epoch: 0007
Iter: 0001 train_loss= 0.50052 train_f1_mic= 0.48212 train_f1_mac= 0.23312 val_loss= 0.52778 val_f1_mic= 0.47518 val_f1_mac= 0.23195 time= 0.01989
Iter: 0006 train_loss= 0.50320 train_f1_mic= 0.49826 train_f1_mac= 0.28839 val_loss= 0.52778 val_f1_mic= 0.47518 val_f1_mac= 0.23195 time= 0.01957
Iter: 0011 train_loss= 0.50405 train_f1_mic= 0.50924 train_f1_mac= 0.28026 val_loss= 0.52778 val_f1_mic= 0.47518 val_f1_mac= 0.23195 time= 0.01922
Iter: 0016 train_loss= 0.51010 train_f1_mic= 0.48137 train_f1_mac= 0.25946 val_loss= 0.52778 val_f1_mic= 0.47518 val_f1_mac= 0.23195 time= 0.01896
Epoch: 0008
Iter: 0002 train_loss= 0.50263 train_f1_mic= 0.48350 train_f1_mac= 0.25923 val_loss= 0.53620 val_f1_mic= 0.49623 val_f1_mac= 0.29381 time= 0.01890
Iter: 0007 train_loss= 0.49620 train_f1_mic= 0.50774 train_f1_mac= 0.28665 val_loss= 0.53620 val_f1_mic= 0.49623 val_f1_mac= 0.29381 time= 0.01867
Iter: 0012 train_loss= 0.51238 train_f1_mic= 0.48631 train_f1_mac= 0.26723 val_loss= 0.53620 val_f1_mic= 0.49623 val_f1_mac= 0.29381 time= 0.01848
Iter: 0017 train_loss= 0.49435 train_f1_mic= 0.48007 train_f1_mac= 0.24094 val_loss= 0.53620 val_f1_mic= 0.49623 val_f1_mac= 0.29381 time= 0.01829
Epoch: 0009
Iter: 0003 train_loss= 0.48904 train_f1_mic= 0.50688 train_f1_mac= 0.28167 val_loss= 0.51269 val_f1_mic= 0.53071 val_f1_mac= 0.31949 time= 0.01820
Iter: 0008 train_loss= 0.50204 train_f1_mic= 0.49907 train_f1_mac= 0.29636 val_loss= 0.51269 val_f1_mic= 0.53071 val_f1_mac= 0.31949 time= 0.01802
Iter: 0013 train_loss= 0.49050 train_f1_mic= 0.53042 train_f1_mac= 0.30434 val_loss= 0.51269 val_f1_mic= 0.53071 val_f1_mac= 0.31949 time= 0.01786
Iter: 0018 train_loss= 0.51225 train_f1_mic= 0.46737 train_f1_mac= 0.24937 val_loss= 0.51269 val_f1_mic= 0.53071 val_f1_mac= 0.31949 time= 0.01767
Epoch: 0010
Iter: 0004 train_loss= 0.49921 train_f1_mic= 0.49332 train_f1_mac= 0.27137 val_loss= 0.52545 val_f1_mic= 0.51458 val_f1_mac= 0.32694 time= 0.01758
Iter: 0009 train_loss= 0.48938 train_f1_mic= 0.52678 train_f1_mac= 0.31687 val_loss= 0.52545 val_f1_mic= 0.51458 val_f1_mac= 0.32694 time= 0.01746
Iter: 0014 train_loss= 0.48494 train_f1_mic= 0.50671 train_f1_mac= 0.29555 val_loss= 0.52545 val_f1_mic= 0.51458 val_f1_mac= 0.32694 time= 0.01734
Optimization Finished!
Full validation stats: loss= 0.50894 f1_micro= 0.50955 f1_macro= 0.31243 time= 0.07281
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47203599448459754
Rewards :  0.026688479453311653 Accuracy :  0.49338677804724684
Total reward :  1.3039157326064181
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 0, 'linear']
Training RNN (Reward ip) :  [0.02668848]
Trial 231: Controller loss : 4377.029785

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'tanh', 2, 'relu']
2018-08-31 00:44:04.696596: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:44:04.697339: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:44:04.698060: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:44:04.698623: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:44:04.699291: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69251 train_f1_mic= 0.37543 train_f1_mac= 0.31912 val_loss= 0.66138 val_f1_mic= 0.38662 val_f1_mac= 0.12413 time= 0.74703
Iter: 0005 train_loss= 0.59242 train_f1_mic= 0.38773 train_f1_mac= 0.09888 val_loss= 0.66138 val_f1_mic= 0.38662 val_f1_mac= 0.12413 time= 0.13546
Iter: 0010 train_loss= 0.57015 train_f1_mic= 0.37850 train_f1_mac= 0.10189 val_loss= 0.66138 val_f1_mic= 0.38662 val_f1_mac= 0.12413 time= 0.08059
Iter: 0015 train_loss= 0.52909 train_f1_mic= 0.40560 train_f1_mac= 0.10928 val_loss= 0.66138 val_f1_mic= 0.38662 val_f1_mac= 0.12413 time= 0.06008
Epoch: 0002
Iter: 0001 train_loss= 0.53951 train_f1_mic= 0.38828 train_f1_mac= 0.10488 val_loss= 0.58437 val_f1_mic= 0.37419 val_f1_mac= 0.11084 time= 0.04986
Iter: 0006 train_loss= 0.53055 train_f1_mic= 0.38653 train_f1_mac= 0.10104 val_loss= 0.58437 val_f1_mic= 0.37419 val_f1_mac= 0.11084 time= 0.04322
Iter: 0011 train_loss= 0.52885 train_f1_mic= 0.40225 train_f1_mac= 0.10827 val_loss= 0.58437 val_f1_mic= 0.37419 val_f1_mac= 0.11084 time= 0.03872
Iter: 0016 train_loss= 0.52558 train_f1_mic= 0.40660 train_f1_mac= 0.11855 val_loss= 0.58437 val_f1_mic= 0.37419 val_f1_mac= 0.11084 time= 0.03534
Epoch: 0003
Iter: 0002 train_loss= 0.52626 train_f1_mic= 0.40486 train_f1_mac= 0.12719 val_loss= 0.56503 val_f1_mic= 0.40964 val_f1_mac= 0.13532 time= 0.03356
Iter: 0007 train_loss= 0.52381 train_f1_mic= 0.42020 train_f1_mac= 0.13828 val_loss= 0.56503 val_f1_mic= 0.40964 val_f1_mac= 0.13532 time= 0.03162
Iter: 0012 train_loss= 0.52784 train_f1_mic= 0.43247 train_f1_mac= 0.14598 val_loss= 0.56503 val_f1_mic= 0.40964 val_f1_mac= 0.13532 time= 0.03007
Iter: 0017 train_loss= 0.53089 train_f1_mic= 0.45717 train_f1_mac= 0.16061 val_loss= 0.56503 val_f1_mic= 0.40964 val_f1_mac= 0.13532 time= 0.02880
Epoch: 0004
Iter: 0003 train_loss= 0.51877 train_f1_mic= 0.41775 train_f1_mac= 0.14178 val_loss= 0.56177 val_f1_mic= 0.43286 val_f1_mac= 0.15979 time= 0.02795
Iter: 0008 train_loss= 0.52491 train_f1_mic= 0.44192 train_f1_mac= 0.15638 val_loss= 0.56177 val_f1_mic= 0.43286 val_f1_mac= 0.15979 time= 0.02701
Iter: 0013 train_loss= 0.52119 train_f1_mic= 0.41829 train_f1_mac= 0.14145 val_loss= 0.56177 val_f1_mic= 0.43286 val_f1_mac= 0.15979 time= 0.02612
Iter: 0018 train_loss= 0.52429 train_f1_mic= 0.43045 train_f1_mac= 0.15320 val_loss= 0.56177 val_f1_mic= 0.43286 val_f1_mac= 0.15979 time= 0.02541
Epoch: 0005
Iter: 0004 train_loss= 0.52112 train_f1_mic= 0.43238 train_f1_mac= 0.15184 val_loss= 0.56175 val_f1_mic= 0.42159 val_f1_mac= 0.15801 time= 0.02502
Iter: 0009 train_loss= 0.52661 train_f1_mic= 0.44321 train_f1_mac= 0.16864 val_loss= 0.56175 val_f1_mic= 0.42159 val_f1_mac= 0.15801 time= 0.02434
Iter: 0014 train_loss= 0.52327 train_f1_mic= 0.41492 train_f1_mac= 0.14871 val_loss= 0.56175 val_f1_mic= 0.42159 val_f1_mac= 0.15801 time= 0.02381
Epoch: 0006
Iter: 0000 train_loss= 0.52171 train_f1_mic= 0.45857 train_f1_mac= 0.18234 val_loss= 0.54791 val_f1_mic= 0.45249 val_f1_mac= 0.18592 time= 0.02374
Iter: 0005 train_loss= 0.52708 train_f1_mic= 0.42914 train_f1_mac= 0.15836 val_loss= 0.54791 val_f1_mic= 0.45249 val_f1_mac= 0.18592 time= 0.02340
Iter: 0010 train_loss= 0.51035 train_f1_mic= 0.46074 train_f1_mac= 0.18827 val_loss= 0.54791 val_f1_mic= 0.45249 val_f1_mac= 0.18592 time= 0.02304
Iter: 0015 train_loss= 0.52181 train_f1_mic= 0.43614 train_f1_mac= 0.17136 val_loss= 0.54791 val_f1_mic= 0.45249 val_f1_mac= 0.18592 time= 0.02263
Epoch: 0007
Iter: 0001 train_loss= 0.51752 train_f1_mic= 0.44478 train_f1_mac= 0.18246 val_loss= 0.53386 val_f1_mic= 0.45231 val_f1_mac= 0.19199 time= 0.02259
Iter: 0006 train_loss= 0.51123 train_f1_mic= 0.44121 train_f1_mac= 0.17664 val_loss= 0.53386 val_f1_mic= 0.45231 val_f1_mac= 0.19199 time= 0.02230
Iter: 0011 train_loss= 0.52057 train_f1_mic= 0.44326 train_f1_mac= 0.18306 val_loss= 0.53386 val_f1_mic= 0.45231 val_f1_mac= 0.19199 time= 0.02202
Iter: 0016 train_loss= 0.52266 train_f1_mic= 0.45304 train_f1_mac= 0.17767 val_loss= 0.53386 val_f1_mic= 0.45231 val_f1_mac= 0.19199 time= 0.02169
Epoch: 0008
Iter: 0002 train_loss= 0.50409 train_f1_mic= 0.46866 train_f1_mac= 0.20098 val_loss= 0.53479 val_f1_mic= 0.47148 val_f1_mac= 0.21168 time= 0.02156
Iter: 0007 train_loss= 0.51150 train_f1_mic= 0.45256 train_f1_mac= 0.18917 val_loss= 0.53479 val_f1_mic= 0.47148 val_f1_mac= 0.21168 time= 0.02133
Iter: 0012 train_loss= 0.51530 train_f1_mic= 0.46825 train_f1_mac= 0.19583 val_loss= 0.53479 val_f1_mic= 0.47148 val_f1_mac= 0.21168 time= 0.02115
Iter: 0017 train_loss= 0.53058 train_f1_mic= 0.41933 train_f1_mac= 0.16843 val_loss= 0.53479 val_f1_mic= 0.47148 val_f1_mac= 0.21168 time= 0.02093
Epoch: 0009
Iter: 0003 train_loss= 0.51298 train_f1_mic= 0.47166 train_f1_mac= 0.20062 val_loss= 0.53493 val_f1_mic= 0.49182 val_f1_mac= 0.22818 time= 0.02091
Iter: 0008 train_loss= 0.51230 train_f1_mic= 0.44065 train_f1_mac= 0.17729 val_loss= 0.53493 val_f1_mic= 0.49182 val_f1_mac= 0.22818 time= 0.02076
Iter: 0013 train_loss= 0.50774 train_f1_mic= 0.46833 train_f1_mac= 0.21064 val_loss= 0.53493 val_f1_mic= 0.49182 val_f1_mac= 0.22818 time= 0.02059
Iter: 0018 train_loss= 0.51295 train_f1_mic= 0.46462 train_f1_mac= 0.20350 val_loss= 0.53493 val_f1_mic= 0.49182 val_f1_mac= 0.22818 time= 0.02045
Epoch: 0010
Iter: 0004 train_loss= 0.50887 train_f1_mic= 0.45029 train_f1_mac= 0.18284 val_loss= 0.52390 val_f1_mic= 0.46333 val_f1_mac= 0.21107 time= 0.02036
Iter: 0009 train_loss= 0.50810 train_f1_mic= 0.45854 train_f1_mac= 0.19469 val_loss= 0.52390 val_f1_mic= 0.46333 val_f1_mac= 0.21107 time= 0.02019
Iter: 0014 train_loss= 0.50985 train_f1_mic= 0.46075 train_f1_mac= 0.19143 val_loss= 0.52390 val_f1_mic= 0.46333 val_f1_mac= 0.21107 time= 0.02005
Optimization Finished!
Full validation stats: loss= 0.52981 f1_micro= 0.48202 f1_macro= 0.22917 time= 0.10968
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4735573626962184
Rewards :  0.007606841058104441 Accuracy :  0.479642835542702
Total reward :  1.3115225736645226
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'tanh', 2, 'relu']
Training RNN (Reward ip) :  [0.00760684]
Trial 232: Controller loss : 6357.339355

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 0. 5.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:44:13.988329: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:44:13.988890: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:44:13.989437: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:44:13.989837: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:44:13.990327: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69151 train_f1_mic= 0.38058 train_f1_mac= 0.29137 val_loss= 0.66130 val_f1_mic= 0.42569 val_f1_mac= 0.13410 time= 0.75204
Iter: 0005 train_loss= 0.59076 train_f1_mic= 0.37238 train_f1_mac= 0.08656 val_loss= 0.66130 val_f1_mic= 0.42569 val_f1_mac= 0.13410 time= 0.13846
Iter: 0010 train_loss= 0.54559 train_f1_mic= 0.37257 train_f1_mac= 0.08755 val_loss= 0.66130 val_f1_mic= 0.42569 val_f1_mac= 0.13410 time= 0.08251
Iter: 0015 train_loss= 0.53913 train_f1_mic= 0.40814 train_f1_mac= 0.10378 val_loss= 0.66130 val_f1_mic= 0.42569 val_f1_mac= 0.13410 time= 0.06165
Epoch: 0002
Iter: 0001 train_loss= 0.54987 train_f1_mic= 0.38953 train_f1_mac= 0.10262 val_loss= 0.55377 val_f1_mic= 0.39274 val_f1_mac= 0.10494 time= 0.05191
Iter: 0006 train_loss= 0.53565 train_f1_mic= 0.38075 train_f1_mac= 0.09336 val_loss= 0.55377 val_f1_mic= 0.39274 val_f1_mac= 0.10494 time= 0.04511
Iter: 0011 train_loss= 0.53673 train_f1_mic= 0.37755 train_f1_mac= 0.09605 val_loss= 0.55377 val_f1_mic= 0.39274 val_f1_mac= 0.10494 time= 0.04070
Iter: 0016 train_loss= 0.53371 train_f1_mic= 0.40475 train_f1_mac= 0.10951 val_loss= 0.55377 val_f1_mic= 0.39274 val_f1_mac= 0.10494 time= 0.03729
Epoch: 0003
Iter: 0002 train_loss= 0.52638 train_f1_mic= 0.40126 train_f1_mac= 0.11175 val_loss= 0.55233 val_f1_mic= 0.40589 val_f1_mac= 0.11876 time= 0.03493
Iter: 0007 train_loss= 0.52290 train_f1_mic= 0.40808 train_f1_mac= 0.11592 val_loss= 0.55233 val_f1_mic= 0.40589 val_f1_mac= 0.11876 time= 0.03291
Iter: 0012 train_loss= 0.53314 train_f1_mic= 0.41738 train_f1_mac= 0.13062 val_loss= 0.55233 val_f1_mic= 0.40589 val_f1_mac= 0.11876 time= 0.03125
Iter: 0017 train_loss= 0.52120 train_f1_mic= 0.40063 train_f1_mac= 0.12125 val_loss= 0.55233 val_f1_mic= 0.40589 val_f1_mac= 0.11876 time= 0.02990
Epoch: 0004
Iter: 0003 train_loss= 0.53316 train_f1_mic= 0.43517 train_f1_mac= 0.14684 val_loss= 0.55303 val_f1_mic= 0.41918 val_f1_mac= 0.14385 time= 0.02923
Iter: 0008 train_loss= 0.52053 train_f1_mic= 0.40774 train_f1_mac= 0.13098 val_loss= 0.55303 val_f1_mic= 0.41918 val_f1_mac= 0.14385 time= 0.02829
Iter: 0013 train_loss= 0.51966 train_f1_mic= 0.43768 train_f1_mac= 0.14830 val_loss= 0.55303 val_f1_mic= 0.41918 val_f1_mac= 0.14385 time= 0.02742
Iter: 0018 train_loss= 0.52100 train_f1_mic= 0.40671 train_f1_mac= 0.13606 val_loss= 0.55303 val_f1_mic= 0.41918 val_f1_mac= 0.14385 time= 0.02666
Epoch: 0005
Iter: 0004 train_loss= 0.52365 train_f1_mic= 0.43344 train_f1_mac= 0.16035 val_loss= 0.54904 val_f1_mic= 0.41645 val_f1_mac= 0.14682 time= 0.02617
Iter: 0009 train_loss= 0.52057 train_f1_mic= 0.43924 train_f1_mac= 0.16238 val_loss= 0.54904 val_f1_mic= 0.41645 val_f1_mac= 0.14682 time= 0.02549
Iter: 0014 train_loss= 0.51237 train_f1_mic= 0.42650 train_f1_mac= 0.14825 val_loss= 0.54904 val_f1_mic= 0.41645 val_f1_mac= 0.14682 time= 0.02489
Epoch: 0006
Iter: 0000 train_loss= 0.52786 train_f1_mic= 0.45669 train_f1_mac= 0.19010 val_loss= 0.54221 val_f1_mic= 0.46947 val_f1_mac= 0.20193 time= 0.02474
Iter: 0005 train_loss= 0.51810 train_f1_mic= 0.43458 train_f1_mac= 0.16622 val_loss= 0.54221 val_f1_mic= 0.46947 val_f1_mac= 0.20193 time= 0.02423
Iter: 0010 train_loss= 0.51119 train_f1_mic= 0.46658 train_f1_mac= 0.19801 val_loss= 0.54221 val_f1_mic= 0.46947 val_f1_mac= 0.20193 time= 0.02386
Iter: 0015 train_loss= 0.52062 train_f1_mic= 0.46365 train_f1_mac= 0.19717 val_loss= 0.54221 val_f1_mic= 0.46947 val_f1_mac= 0.20193 time= 0.02348
Epoch: 0007
Iter: 0001 train_loss= 0.50294 train_f1_mic= 0.43913 train_f1_mac= 0.17403 val_loss= 0.50589 val_f1_mic= 0.43191 val_f1_mac= 0.17136 time= 0.02344
Iter: 0006 train_loss= 0.50393 train_f1_mic= 0.47044 train_f1_mac= 0.20220 val_loss= 0.50589 val_f1_mic= 0.43191 val_f1_mac= 0.17136 time= 0.02312
Iter: 0011 train_loss= 0.51664 train_f1_mic= 0.46226 train_f1_mac= 0.20969 val_loss= 0.50589 val_f1_mic= 0.43191 val_f1_mac= 0.17136 time= 0.02277
Iter: 0016 train_loss= 0.50627 train_f1_mic= 0.44812 train_f1_mac= 0.19091 val_loss= 0.50589 val_f1_mic= 0.43191 val_f1_mac= 0.17136 time= 0.02248
Epoch: 0008
Iter: 0002 train_loss= 0.51202 train_f1_mic= 0.47789 train_f1_mac= 0.22387 val_loss= 0.52386 val_f1_mic= 0.50528 val_f1_mac= 0.25654 time= 0.02263
Iter: 0007 train_loss= 0.50237 train_f1_mic= 0.48924 train_f1_mac= 0.24158 val_loss= 0.52386 val_f1_mic= 0.50528 val_f1_mac= 0.25654 time= 0.02241
Iter: 0012 train_loss= 0.49996 train_f1_mic= 0.45013 train_f1_mac= 0.20684 val_loss= 0.52386 val_f1_mic= 0.50528 val_f1_mac= 0.25654 time= 0.02214
Iter: 0017 train_loss= 0.51876 train_f1_mic= 0.47566 train_f1_mac= 0.22453 val_loss= 0.52386 val_f1_mic= 0.50528 val_f1_mac= 0.25654 time= 0.02189
Epoch: 0009
Iter: 0003 train_loss= 0.50094 train_f1_mic= 0.49739 train_f1_mac= 0.25012 val_loss= 0.51889 val_f1_mic= 0.49561 val_f1_mac= 0.26034 time= 0.02187
Iter: 0008 train_loss= 0.50049 train_f1_mic= 0.47582 train_f1_mac= 0.22816 val_loss= 0.51889 val_f1_mic= 0.49561 val_f1_mac= 0.26034 time= 0.02172
Iter: 0013 train_loss= 0.50855 train_f1_mic= 0.45824 train_f1_mac= 0.21050 val_loss= 0.51889 val_f1_mic= 0.49561 val_f1_mac= 0.26034 time= 0.02159
Iter: 0018 train_loss= 0.50726 train_f1_mic= 0.48897 train_f1_mac= 0.24368 val_loss= 0.51889 val_f1_mic= 0.49561 val_f1_mac= 0.26034 time= 0.02137
Epoch: 0010
Iter: 0004 train_loss= 0.49374 train_f1_mic= 0.51726 train_f1_mac= 0.27626 val_loss= 0.52360 val_f1_mic= 0.48597 val_f1_mac= 0.25588 time= 0.02126
Iter: 0009 train_loss= 0.50000 train_f1_mic= 0.50990 train_f1_mac= 0.27323 val_loss= 0.52360 val_f1_mic= 0.48597 val_f1_mac= 0.25588 time= 0.02110
Iter: 0014 train_loss= 0.48238 train_f1_mic= 0.49734 train_f1_mac= 0.26728 val_loss= 0.52360 val_f1_mic= 0.48597 val_f1_mac= 0.25588 time= 0.02091
Optimization Finished!
Full validation stats: loss= 0.51122 f1_micro= 0.52066 f1_macro= 0.29787 time= 0.10074
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4810595083577156
Rewards :  0.03751072830748625 Accuracy :  0.5110680910037046
Total reward :  1.3490333019720089
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03751073]
Trial 233: Controller loss : 107.638962

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:44:23.753427: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:44:23.753883: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:44:23.754330: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:44:23.754656: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:44:23.755061: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69192 train_f1_mic= 0.36904 train_f1_mac= 0.28913 val_loss= 0.66118 val_f1_mic= 0.36438 val_f1_mac= 0.10373 time= 0.77866
Iter: 0005 train_loss= 0.58545 train_f1_mic= 0.37784 train_f1_mac= 0.08981 val_loss= 0.66118 val_f1_mic= 0.36438 val_f1_mac= 0.10373 time= 0.14125
Iter: 0010 train_loss= 0.54949 train_f1_mic= 0.36611 train_f1_mac= 0.08641 val_loss= 0.66118 val_f1_mic= 0.36438 val_f1_mac= 0.10373 time= 0.08430
Iter: 0015 train_loss= 0.53841 train_f1_mic= 0.41151 train_f1_mac= 0.10841 val_loss= 0.66118 val_f1_mic= 0.36438 val_f1_mac= 0.10373 time= 0.06326
Epoch: 0002
Iter: 0001 train_loss= 0.53208 train_f1_mic= 0.40323 train_f1_mac= 0.10244 val_loss= 0.55433 val_f1_mic= 0.38502 val_f1_mac= 0.10246 time= 0.05337
Iter: 0006 train_loss= 0.54067 train_f1_mic= 0.37036 train_f1_mac= 0.09043 val_loss= 0.55433 val_f1_mic= 0.38502 val_f1_mac= 0.10246 time= 0.04591
Iter: 0011 train_loss= 0.53147 train_f1_mic= 0.38553 train_f1_mac= 0.09973 val_loss= 0.55433 val_f1_mic= 0.38502 val_f1_mac= 0.10246 time= 0.04114
Iter: 0016 train_loss= 0.53898 train_f1_mic= 0.38162 train_f1_mac= 0.09986 val_loss= 0.55433 val_f1_mic= 0.38502 val_f1_mac= 0.10246 time= 0.03745
Epoch: 0003
Iter: 0002 train_loss= 0.53908 train_f1_mic= 0.37624 train_f1_mac= 0.10331 val_loss= 0.55084 val_f1_mic= 0.37119 val_f1_mac= 0.10111 time= 0.03514
Iter: 0007 train_loss= 0.53100 train_f1_mic= 0.40409 train_f1_mac= 0.11545 val_loss= 0.55084 val_f1_mic= 0.37119 val_f1_mac= 0.10111 time= 0.03291
Iter: 0012 train_loss= 0.52615 train_f1_mic= 0.41552 train_f1_mac= 0.12595 val_loss= 0.55084 val_f1_mic= 0.37119 val_f1_mac= 0.10111 time= 0.03111
Iter: 0017 train_loss= 0.51573 train_f1_mic= 0.42338 train_f1_mac= 0.12766 val_loss= 0.55084 val_f1_mic= 0.37119 val_f1_mac= 0.10111 time= 0.02993
Epoch: 0004
Iter: 0003 train_loss= 0.50853 train_f1_mic= 0.40919 train_f1_mac= 0.12295 val_loss= 0.54242 val_f1_mic= 0.40273 val_f1_mac= 0.12512 time= 0.02918
Iter: 0008 train_loss= 0.51273 train_f1_mic= 0.41842 train_f1_mac= 0.12851 val_loss= 0.54242 val_f1_mic= 0.40273 val_f1_mac= 0.12512 time= 0.02810
Iter: 0013 train_loss= 0.52209 train_f1_mic= 0.43307 train_f1_mac= 0.14128 val_loss= 0.54242 val_f1_mic= 0.40273 val_f1_mac= 0.12512 time= 0.02710
Iter: 0018 train_loss= 0.51801 train_f1_mic= 0.44232 train_f1_mac= 0.15313 val_loss= 0.54242 val_f1_mic= 0.40273 val_f1_mac= 0.12512 time= 0.02637
Epoch: 0005
Iter: 0004 train_loss= 0.51381 train_f1_mic= 0.44274 train_f1_mac= 0.16160 val_loss= 0.55023 val_f1_mic= 0.43872 val_f1_mac= 0.16759 time= 0.02589
Iter: 0009 train_loss= 0.51657 train_f1_mic= 0.43210 train_f1_mac= 0.15437 val_loss= 0.55023 val_f1_mic= 0.43872 val_f1_mac= 0.16759 time= 0.02524
Iter: 0014 train_loss= 0.51971 train_f1_mic= 0.43620 train_f1_mac= 0.16276 val_loss= 0.55023 val_f1_mic= 0.43872 val_f1_mac= 0.16759 time= 0.02464
Epoch: 0006
Iter: 0000 train_loss= 0.51330 train_f1_mic= 0.42700 train_f1_mac= 0.15873 val_loss= 0.54872 val_f1_mic= 0.44058 val_f1_mac= 0.18846 time= 0.02438
Iter: 0005 train_loss= 0.49476 train_f1_mic= 0.43987 train_f1_mac= 0.17234 val_loss= 0.54872 val_f1_mic= 0.44058 val_f1_mac= 0.18846 time= 0.02396
Iter: 0010 train_loss= 0.51739 train_f1_mic= 0.47917 train_f1_mac= 0.21270 val_loss= 0.54872 val_f1_mic= 0.44058 val_f1_mac= 0.18846 time= 0.02358
Iter: 0015 train_loss= 0.50893 train_f1_mic= 0.46671 train_f1_mac= 0.19379 val_loss= 0.54872 val_f1_mic= 0.44058 val_f1_mac= 0.18846 time= 0.02324
Epoch: 0007
Iter: 0001 train_loss= 0.51199 train_f1_mic= 0.45630 train_f1_mac= 0.19284 val_loss= 0.52435 val_f1_mic= 0.47549 val_f1_mac= 0.21644 time= 0.02313
Iter: 0006 train_loss= 0.50301 train_f1_mic= 0.45820 train_f1_mac= 0.20115 val_loss= 0.52435 val_f1_mic= 0.47549 val_f1_mac= 0.21644 time= 0.02282
Iter: 0011 train_loss= 0.50996 train_f1_mic= 0.49102 train_f1_mac= 0.23052 val_loss= 0.52435 val_f1_mic= 0.47549 val_f1_mac= 0.21644 time= 0.02259
Iter: 0016 train_loss= 0.50918 train_f1_mic= 0.46068 train_f1_mac= 0.20740 val_loss= 0.52435 val_f1_mic= 0.47549 val_f1_mac= 0.21644 time= 0.02235
Epoch: 0008
Iter: 0002 train_loss= 0.51751 train_f1_mic= 0.46125 train_f1_mac= 0.21615 val_loss= 0.53703 val_f1_mic= 0.49052 val_f1_mac= 0.24230 time= 0.02219
Iter: 0007 train_loss= 0.50596 train_f1_mic= 0.48824 train_f1_mac= 0.23603 val_loss= 0.53703 val_f1_mic= 0.49052 val_f1_mac= 0.24230 time= 0.02198
Iter: 0012 train_loss= 0.51001 train_f1_mic= 0.47947 train_f1_mac= 0.22952 val_loss= 0.53703 val_f1_mic= 0.49052 val_f1_mac= 0.24230 time= 0.02176
Iter: 0017 train_loss= 0.50066 train_f1_mic= 0.46873 train_f1_mac= 0.23077 val_loss= 0.53703 val_f1_mic= 0.49052 val_f1_mac= 0.24230 time= 0.02152
Epoch: 0009
Iter: 0003 train_loss= 0.49535 train_f1_mic= 0.48813 train_f1_mac= 0.24120 val_loss= 0.51478 val_f1_mic= 0.49743 val_f1_mac= 0.27002 time= 0.02145
Iter: 0008 train_loss= 0.48271 train_f1_mic= 0.48501 train_f1_mac= 0.25878 val_loss= 0.51478 val_f1_mic= 0.49743 val_f1_mac= 0.27002 time= 0.02123
Iter: 0013 train_loss= 0.49257 train_f1_mic= 0.48875 train_f1_mac= 0.26247 val_loss= 0.51478 val_f1_mic= 0.49743 val_f1_mac= 0.27002 time= 0.02103
Iter: 0018 train_loss= 0.49809 train_f1_mic= 0.50352 train_f1_mac= 0.26624 val_loss= 0.51478 val_f1_mic= 0.49743 val_f1_mac= 0.27002 time= 0.02087
Epoch: 0010
Iter: 0004 train_loss= 0.49846 train_f1_mic= 0.50974 train_f1_mac= 0.26793 val_loss= 0.52843 val_f1_mic= 0.47876 val_f1_mac= 0.25084 time= 0.02078
Iter: 0009 train_loss= 0.49265 train_f1_mic= 0.51423 train_f1_mac= 0.29216 val_loss= 0.52843 val_f1_mic= 0.47876 val_f1_mac= 0.25084 time= 0.02066
Iter: 0014 train_loss= 0.49590 train_f1_mic= 0.50393 train_f1_mac= 0.28376 val_loss= 0.52843 val_f1_mic= 0.47876 val_f1_mac= 0.25084 time= 0.02053
Optimization Finished!
Full validation stats: loss= 0.50739 f1_micro= 0.51913 f1_macro= 0.29610 time= 0.09974
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48606538305814784
Rewards :  0.025029373502161056 Accuracy :  0.5060888818598767
Total reward :  1.3740626754741698
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02502937]
Trial 234: Controller loss : 107.753914

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 4, 'sigmoid']
2018-08-31 00:44:33.193329: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:44:33.193946: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:44:33.194887: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:44:33.195272: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:44:33.195787: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69205 train_f1_mic= 0.37646 train_f1_mac= 0.21960 val_loss= 0.65795 val_f1_mic= 0.33740 val_f1_mac= 0.08433 time= 0.76461
Iter: 0005 train_loss= 0.56755 train_f1_mic= 0.36784 train_f1_mac= 0.08711 val_loss= 0.65795 val_f1_mic= 0.33740 val_f1_mac= 0.08433 time= 0.13740
Iter: 0010 train_loss= 0.53529 train_f1_mic= 0.38181 train_f1_mac= 0.09062 val_loss= 0.65795 val_f1_mic= 0.33740 val_f1_mac= 0.08433 time= 0.08011
Iter: 0015 train_loss= 0.55413 train_f1_mic= 0.39505 train_f1_mac= 0.10006 val_loss= 0.65795 val_f1_mic= 0.33740 val_f1_mac= 0.08433 time= 0.05919
Epoch: 0002
Iter: 0001 train_loss= 0.53283 train_f1_mic= 0.40043 train_f1_mac= 0.09855 val_loss= 0.56531 val_f1_mic= 0.38075 val_f1_mac= 0.09978 time= 0.04951
Iter: 0006 train_loss= 0.54428 train_f1_mic= 0.37714 train_f1_mac= 0.09223 val_loss= 0.56531 val_f1_mic= 0.38075 val_f1_mac= 0.09978 time= 0.04213
Iter: 0011 train_loss= 0.54046 train_f1_mic= 0.37648 train_f1_mac= 0.09132 val_loss= 0.56531 val_f1_mic= 0.38075 val_f1_mac= 0.09978 time= 0.03736
Iter: 0016 train_loss= 0.54874 train_f1_mic= 0.37834 train_f1_mac= 0.09411 val_loss= 0.56531 val_f1_mic= 0.38075 val_f1_mac= 0.09978 time= 0.03373
Epoch: 0003
Iter: 0002 train_loss= 0.52147 train_f1_mic= 0.38518 train_f1_mac= 0.09075 val_loss= 0.56070 val_f1_mic= 0.37142 val_f1_mac= 0.09523 time= 0.03139
Iter: 0007 train_loss= 0.54361 train_f1_mic= 0.37635 train_f1_mac= 0.09697 val_loss= 0.56070 val_f1_mic= 0.37142 val_f1_mac= 0.09523 time= 0.02921
Iter: 0012 train_loss= 0.54537 train_f1_mic= 0.40896 train_f1_mac= 0.11614 val_loss= 0.56070 val_f1_mic= 0.37142 val_f1_mac= 0.09523 time= 0.02750
Iter: 0017 train_loss= 0.54142 train_f1_mic= 0.40982 train_f1_mac= 0.11938 val_loss= 0.56070 val_f1_mic= 0.37142 val_f1_mac= 0.09523 time= 0.02606
Epoch: 0004
Iter: 0003 train_loss= 0.53680 train_f1_mic= 0.37814 train_f1_mac= 0.10383 val_loss= 0.55075 val_f1_mic= 0.39227 val_f1_mac= 0.10914 time= 0.02506
Iter: 0008 train_loss= 0.54054 train_f1_mic= 0.41257 train_f1_mac= 0.12750 val_loss= 0.55075 val_f1_mic= 0.39227 val_f1_mac= 0.10914 time= 0.02404
Iter: 0013 train_loss= 0.53760 train_f1_mic= 0.42825 train_f1_mac= 0.13628 val_loss= 0.55075 val_f1_mic= 0.39227 val_f1_mac= 0.10914 time= 0.02327
Iter: 0018 train_loss= 0.52465 train_f1_mic= 0.40983 train_f1_mac= 0.12669 val_loss= 0.55075 val_f1_mic= 0.39227 val_f1_mac= 0.10914 time= 0.02248
Epoch: 0005
Iter: 0004 train_loss= 0.52052 train_f1_mic= 0.42054 train_f1_mac= 0.13727 val_loss= 0.54561 val_f1_mic= 0.41432 val_f1_mac= 0.13672 time= 0.02199
Iter: 0009 train_loss= 0.53193 train_f1_mic= 0.42249 train_f1_mac= 0.13654 val_loss= 0.54561 val_f1_mic= 0.41432 val_f1_mac= 0.13672 time= 0.02138
Iter: 0014 train_loss= 0.52716 train_f1_mic= 0.41488 train_f1_mac= 0.12957 val_loss= 0.54561 val_f1_mic= 0.41432 val_f1_mac= 0.13672 time= 0.02080
Epoch: 0006
Iter: 0000 train_loss= 0.51881 train_f1_mic= 0.43255 train_f1_mac= 0.14637 val_loss= 0.54945 val_f1_mic= 0.44226 val_f1_mac= 0.15838 time= 0.02055
Iter: 0005 train_loss= 0.52247 train_f1_mic= 0.42289 train_f1_mac= 0.14144 val_loss= 0.54945 val_f1_mic= 0.44226 val_f1_mac= 0.15838 time= 0.02013
Iter: 0010 train_loss= 0.51481 train_f1_mic= 0.43825 train_f1_mac= 0.15134 val_loss= 0.54945 val_f1_mic= 0.44226 val_f1_mac= 0.15838 time= 0.01974
Iter: 0015 train_loss= 0.53015 train_f1_mic= 0.41878 train_f1_mac= 0.14519 val_loss= 0.54945 val_f1_mic= 0.44226 val_f1_mac= 0.15838 time= 0.01938
Epoch: 0007
Iter: 0001 train_loss= 0.51579 train_f1_mic= 0.45789 train_f1_mac= 0.17604 val_loss= 0.54136 val_f1_mic= 0.46124 val_f1_mac= 0.19188 time= 0.01933
Iter: 0006 train_loss= 0.51468 train_f1_mic= 0.44339 train_f1_mac= 0.15828 val_loss= 0.54136 val_f1_mic= 0.46124 val_f1_mac= 0.19188 time= 0.01901
Iter: 0011 train_loss= 0.52295 train_f1_mic= 0.43815 train_f1_mac= 0.16243 val_loss= 0.54136 val_f1_mic= 0.46124 val_f1_mac= 0.19188 time= 0.01876
Iter: 0016 train_loss= 0.53085 train_f1_mic= 0.43951 train_f1_mac= 0.17550 val_loss= 0.54136 val_f1_mic= 0.46124 val_f1_mac= 0.19188 time= 0.01850
Epoch: 0008
Iter: 0002 train_loss= 0.50875 train_f1_mic= 0.44297 train_f1_mac= 0.17149 val_loss= 0.53522 val_f1_mic= 0.43568 val_f1_mac= 0.17969 time= 0.01836
Iter: 0007 train_loss= 0.51707 train_f1_mic= 0.45247 train_f1_mac= 0.17607 val_loss= 0.53522 val_f1_mic= 0.43568 val_f1_mac= 0.17969 time= 0.01818
Iter: 0012 train_loss= 0.52847 train_f1_mic= 0.43212 train_f1_mac= 0.16659 val_loss= 0.53522 val_f1_mic= 0.43568 val_f1_mac= 0.17969 time= 0.01803
Iter: 0017 train_loss= 0.51499 train_f1_mic= 0.47032 train_f1_mac= 0.19524 val_loss= 0.53522 val_f1_mic= 0.43568 val_f1_mac= 0.17969 time= 0.01786
Epoch: 0009
Iter: 0003 train_loss= 0.50132 train_f1_mic= 0.45822 train_f1_mac= 0.19496 val_loss= 0.52876 val_f1_mic= 0.44290 val_f1_mac= 0.18241 time= 0.01785
Iter: 0008 train_loss= 0.52006 train_f1_mic= 0.45154 train_f1_mac= 0.18506 val_loss= 0.52876 val_f1_mic= 0.44290 val_f1_mac= 0.18241 time= 0.01774
Iter: 0013 train_loss= 0.51695 train_f1_mic= 0.46578 train_f1_mac= 0.19631 val_loss= 0.52876 val_f1_mic= 0.44290 val_f1_mac= 0.18241 time= 0.01755
Iter: 0018 train_loss= 0.51439 train_f1_mic= 0.47073 train_f1_mac= 0.21010 val_loss= 0.52876 val_f1_mic= 0.44290 val_f1_mac= 0.18241 time= 0.01740
Epoch: 0010
Iter: 0004 train_loss= 0.51719 train_f1_mic= 0.43951 train_f1_mac= 0.17852 val_loss= 0.52431 val_f1_mic= 0.47282 val_f1_mac= 0.21824 time= 0.01733
Iter: 0009 train_loss= 0.52185 train_f1_mic= 0.46200 train_f1_mac= 0.19717 val_loss= 0.52431 val_f1_mic= 0.47282 val_f1_mac= 0.21824 time= 0.01720
Iter: 0014 train_loss= 0.50679 train_f1_mic= 0.46562 train_f1_mac= 0.20455 val_loss= 0.52431 val_f1_mic= 0.47282 val_f1_mac= 0.21824 time= 0.01706
Optimization Finished!
Full validation stats: loss= 0.53150 f1_micro= 0.46138 f1_macro= 0.21064 time= 0.10672
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48166016596884903
Rewards :  -0.022026085446494037 Accuracy :  0.4640392976116538
Total reward :  1.3520365900276758
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 4, 'sigmoid']
Training RNN (Reward ip) :  [-0.02202609]
Trial 235: Controller loss : 6182.748535
2018-08-31 00:44:41.467327: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:44:41.467665: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:44:41.467982: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:44:41.468216: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:44:41.468507: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [3, 'tanh', 1, 'relu']
Epoch: 0001
Iter: 0000 train_loss= 0.69218 train_f1_mic= 0.35850 train_f1_mac= 0.27087 val_loss= 0.66612 val_f1_mic= 0.37249 val_f1_mac= 0.11491 time= 1.07513
Iter: 0005 train_loss= 0.58573 train_f1_mic= 0.38387 train_f1_mac= 0.09559 val_loss= 0.66612 val_f1_mic= 0.37249 val_f1_mac= 0.11491 time= 0.24468
Iter: 0010 train_loss= 0.54277 train_f1_mic= 0.39709 train_f1_mac= 0.09838 val_loss= 0.66612 val_f1_mic= 0.37249 val_f1_mac= 0.11491 time= 0.17108
Iter: 0015 train_loss= 0.53956 train_f1_mic= 0.37965 train_f1_mac= 0.09166 val_loss= 0.66612 val_f1_mic= 0.37249 val_f1_mac= 0.11491 time= 0.14123
Epoch: 0002
Iter: 0001 train_loss= 0.52851 train_f1_mic= 0.39748 train_f1_mac= 0.09643 val_loss= 0.56820 val_f1_mic= 0.38755 val_f1_mac= 0.10212 time= 0.12627
Iter: 0006 train_loss= 0.55463 train_f1_mic= 0.36031 train_f1_mac= 0.08832 val_loss= 0.56820 val_f1_mic= 0.38755 val_f1_mac= 0.10212 time= 0.11668
Iter: 0011 train_loss= 0.54036 train_f1_mic= 0.38965 train_f1_mac= 0.09750 val_loss= 0.56820 val_f1_mic= 0.38755 val_f1_mac= 0.10212 time= 0.10979
Iter: 0016 train_loss= 0.52483 train_f1_mic= 0.41667 train_f1_mac= 0.10882 val_loss= 0.56820 val_f1_mic= 0.38755 val_f1_mac= 0.10212 time= 0.10557
Epoch: 0003
Iter: 0002 train_loss= 0.53964 train_f1_mic= 0.39707 train_f1_mac= 0.10618 val_loss= 0.54829 val_f1_mic= 0.39382 val_f1_mac= 0.10517 time= 0.10233
Iter: 0007 train_loss= 0.53881 train_f1_mic= 0.39963 train_f1_mac= 0.11640 val_loss= 0.54829 val_f1_mic= 0.39382 val_f1_mac= 0.10517 time= 0.09958
Iter: 0012 train_loss= 0.53929 train_f1_mic= 0.40155 train_f1_mac= 0.11472 val_loss= 0.54829 val_f1_mic= 0.39382 val_f1_mac= 0.10517 time= 0.09715
Iter: 0017 train_loss= 0.54113 train_f1_mic= 0.38611 train_f1_mac= 0.11071 val_loss= 0.54829 val_f1_mic= 0.39382 val_f1_mac= 0.10517 time= 0.09508
Epoch: 0004
Iter: 0003 train_loss= 0.54088 train_f1_mic= 0.40357 train_f1_mac= 0.12331 val_loss= 0.54786 val_f1_mic= 0.40070 val_f1_mac= 0.12263 time= 0.09433
Iter: 0008 train_loss= 0.54376 train_f1_mic= 0.41611 train_f1_mac= 0.13652 val_loss= 0.54786 val_f1_mic= 0.40070 val_f1_mac= 0.12263 time= 0.09273
Iter: 0013 train_loss= 0.52901 train_f1_mic= 0.40011 train_f1_mac= 0.12112 val_loss= 0.54786 val_f1_mic= 0.40070 val_f1_mac= 0.12263 time= 0.09171
Iter: 0018 train_loss= 0.53995 train_f1_mic= 0.40955 train_f1_mac= 0.13184 val_loss= 0.54786 val_f1_mic= 0.40070 val_f1_mac= 0.12263 time= 0.09065
Epoch: 0005
Iter: 0004 train_loss= 0.53239 train_f1_mic= 0.41497 train_f1_mac= 0.14666 val_loss= 0.54428 val_f1_mic= 0.43570 val_f1_mac= 0.15482 time= 0.08999
Iter: 0009 train_loss= 0.52773 train_f1_mic= 0.43516 train_f1_mac= 0.16246 val_loss= 0.54428 val_f1_mic= 0.43570 val_f1_mac= 0.15482 time= 0.08926
Iter: 0014 train_loss= 0.51229 train_f1_mic= 0.42789 train_f1_mac= 0.15435 val_loss= 0.54428 val_f1_mic= 0.43570 val_f1_mac= 0.15482 time= 0.08855
Epoch: 0006
Iter: 0000 train_loss= 0.51276 train_f1_mic= 0.44847 train_f1_mac= 0.16590 val_loss= 0.54191 val_f1_mic= 0.43021 val_f1_mac= 0.15956 time= 0.08807
Iter: 0005 train_loss= 0.52218 train_f1_mic= 0.42904 train_f1_mac= 0.16276 val_loss= 0.54191 val_f1_mic= 0.43021 val_f1_mac= 0.15956 time= 0.08752
Iter: 0010 train_loss= 0.52019 train_f1_mic= 0.45252 train_f1_mac= 0.18714 val_loss= 0.54191 val_f1_mic= 0.43021 val_f1_mac= 0.15956 time= 0.08703
Iter: 0015 train_loss= 0.53555 train_f1_mic= 0.44019 train_f1_mac= 0.17356 val_loss= 0.54191 val_f1_mic= 0.43021 val_f1_mac= 0.15956 time= 0.08684
Epoch: 0007
Iter: 0001 train_loss= 0.51652 train_f1_mic= 0.43484 train_f1_mac= 0.17621 val_loss= 0.53510 val_f1_mic= 0.41382 val_f1_mac= 0.16124 time= 0.08655
Iter: 0006 train_loss= 0.52950 train_f1_mic= 0.43010 train_f1_mac= 0.16364 val_loss= 0.53510 val_f1_mic= 0.41382 val_f1_mac= 0.16124 time= 0.08599
Iter: 0011 train_loss= 0.52009 train_f1_mic= 0.45688 train_f1_mac= 0.19769 val_loss= 0.53510 val_f1_mic= 0.41382 val_f1_mac= 0.16124 time= 0.08552
Iter: 0016 train_loss= 0.51646 train_f1_mic= 0.43639 train_f1_mac= 0.16819 val_loss= 0.53510 val_f1_mic= 0.41382 val_f1_mac= 0.16124 time= 0.08516
Epoch: 0008
Iter: 0002 train_loss= 0.50545 train_f1_mic= 0.43647 train_f1_mac= 0.17113 val_loss= 0.53542 val_f1_mic= 0.43872 val_f1_mac= 0.18742 time= 0.08510
Iter: 0007 train_loss= 0.51290 train_f1_mic= 0.44816 train_f1_mac= 0.18902 val_loss= 0.53542 val_f1_mic= 0.43872 val_f1_mac= 0.18742 time= 0.08470
Iter: 0012 train_loss= 0.52387 train_f1_mic= 0.44285 train_f1_mac= 0.18800 val_loss= 0.53542 val_f1_mic= 0.43872 val_f1_mac= 0.18742 time= 0.08439
Iter: 0017 train_loss= 0.51643 train_f1_mic= 0.47724 train_f1_mac= 0.22385 val_loss= 0.53542 val_f1_mic= 0.43872 val_f1_mac= 0.18742 time= 0.08410
Epoch: 0009
Iter: 0003 train_loss= 0.51243 train_f1_mic= 0.45904 train_f1_mac= 0.20436 val_loss= 0.52603 val_f1_mic= 0.45461 val_f1_mac= 0.20513 time= 0.08402
Iter: 0008 train_loss= 0.52424 train_f1_mic= 0.44200 train_f1_mac= 0.19587 val_loss= 0.52603 val_f1_mic= 0.45461 val_f1_mac= 0.20513 time= 0.08368
Iter: 0013 train_loss= 0.52179 train_f1_mic= 0.42584 train_f1_mac= 0.17517 val_loss= 0.52603 val_f1_mic= 0.45461 val_f1_mac= 0.20513 time= 0.08365
Iter: 0018 train_loss= 0.53282 train_f1_mic= 0.47738 train_f1_mac= 0.23166 val_loss= 0.52603 val_f1_mic= 0.45461 val_f1_mac= 0.20513 time= 0.08351
Epoch: 0010
Iter: 0004 train_loss= 0.52723 train_f1_mic= 0.42181 train_f1_mac= 0.16651 val_loss= 0.51515 val_f1_mic= 0.49689 val_f1_mac= 0.25575 time= 0.08342
Iter: 0009 train_loss= 0.51210 train_f1_mic= 0.50113 train_f1_mac= 0.25624 val_loss= 0.51515 val_f1_mic= 0.49689 val_f1_mac= 0.25575 time= 0.08330
Iter: 0014 train_loss= 0.51293 train_f1_mic= 0.43068 train_f1_mac= 0.18809 val_loss= 0.51515 val_f1_mic= 0.49689 val_f1_mac= 0.25575 time= 0.08312
Optimization Finished!
Full validation stats: loss= 0.52668 f1_micro= 0.49792 f1_macro= 0.26372 time= 0.15855
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4830254562483878
Rewards :  0.006826451397693556 Accuracy :  0.4884866173665426
Total reward :  1.3588630414253693
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'tanh', 1, 'relu']
Training RNN (Reward ip) :  [0.00682645]
Trial 236: Controller loss : 5104.560547

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 4. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:45:03.491129: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:45:03.491815: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:45:03.492912: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:45:03.493593: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:45:03.494612: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69496 train_f1_mic= 0.37448 train_f1_mac= 0.29848 val_loss= 0.66599 val_f1_mic= 0.36858 val_f1_mac= 0.10712 time= 0.75948
Iter: 0005 train_loss= 0.59118 train_f1_mic= 0.36781 train_f1_mac= 0.08663 val_loss= 0.66599 val_f1_mic= 0.36858 val_f1_mac= 0.10712 time= 0.13971
Iter: 0010 train_loss= 0.56039 train_f1_mic= 0.39167 train_f1_mac= 0.10032 val_loss= 0.66599 val_f1_mic= 0.36858 val_f1_mac= 0.10712 time= 0.08454
Iter: 0015 train_loss= 0.54190 train_f1_mic= 0.40695 train_f1_mac= 0.10807 val_loss= 0.66599 val_f1_mic= 0.36858 val_f1_mac= 0.10712 time= 0.06355
Epoch: 0002
Iter: 0001 train_loss= 0.54259 train_f1_mic= 0.38048 train_f1_mac= 0.09659 val_loss= 0.54710 val_f1_mic= 0.38859 val_f1_mac= 0.10069 time= 0.05426
Iter: 0006 train_loss= 0.53945 train_f1_mic= 0.36672 train_f1_mac= 0.08972 val_loss= 0.54710 val_f1_mic= 0.38859 val_f1_mac= 0.10069 time= 0.04693
Iter: 0011 train_loss= 0.53613 train_f1_mic= 0.39081 train_f1_mac= 0.10103 val_loss= 0.54710 val_f1_mic= 0.38859 val_f1_mac= 0.10069 time= 0.04210
Iter: 0016 train_loss= 0.53402 train_f1_mic= 0.39773 train_f1_mac= 0.10854 val_loss= 0.54710 val_f1_mic= 0.38859 val_f1_mac= 0.10069 time= 0.03844
Epoch: 0003
Iter: 0002 train_loss= 0.53289 train_f1_mic= 0.39856 train_f1_mac= 0.11111 val_loss= 0.56539 val_f1_mic= 0.38536 val_f1_mac= 0.11342 time= 0.03601
Iter: 0007 train_loss= 0.52969 train_f1_mic= 0.39352 train_f1_mac= 0.11225 val_loss= 0.56539 val_f1_mic= 0.38536 val_f1_mac= 0.11342 time= 0.03370
Iter: 0012 train_loss= 0.52176 train_f1_mic= 0.41936 train_f1_mac= 0.12748 val_loss= 0.56539 val_f1_mic= 0.38536 val_f1_mac= 0.11342 time= 0.03190
Iter: 0017 train_loss= 0.53682 train_f1_mic= 0.41841 train_f1_mac= 0.13201 val_loss= 0.56539 val_f1_mic= 0.38536 val_f1_mac= 0.11342 time= 0.03042
Epoch: 0004
Iter: 0003 train_loss= 0.51700 train_f1_mic= 0.42260 train_f1_mac= 0.13074 val_loss= 0.55555 val_f1_mic= 0.42647 val_f1_mac= 0.14186 time= 0.02966
Iter: 0008 train_loss= 0.53974 train_f1_mic= 0.41019 train_f1_mac= 0.13424 val_loss= 0.55555 val_f1_mic= 0.42647 val_f1_mac= 0.14186 time= 0.02850
Iter: 0013 train_loss= 0.53420 train_f1_mic= 0.41007 train_f1_mac= 0.13561 val_loss= 0.55555 val_f1_mic= 0.42647 val_f1_mac= 0.14186 time= 0.02758
Iter: 0018 train_loss= 0.52253 train_f1_mic= 0.42804 train_f1_mac= 0.14443 val_loss= 0.55555 val_f1_mic= 0.42647 val_f1_mac= 0.14186 time= 0.02681
Epoch: 0005
Iter: 0004 train_loss= 0.52110 train_f1_mic= 0.42317 train_f1_mac= 0.14611 val_loss= 0.54997 val_f1_mic= 0.44646 val_f1_mac= 0.17284 time= 0.02631
Iter: 0009 train_loss= 0.51406 train_f1_mic= 0.44588 train_f1_mac= 0.17073 val_loss= 0.54997 val_f1_mic= 0.44646 val_f1_mac= 0.17284 time= 0.02571
Iter: 0014 train_loss= 0.50726 train_f1_mic= 0.44809 train_f1_mac= 0.16966 val_loss= 0.54997 val_f1_mic= 0.44646 val_f1_mac= 0.17284 time= 0.02512
Epoch: 0006
Iter: 0000 train_loss= 0.51641 train_f1_mic= 0.44697 train_f1_mac= 0.17149 val_loss= 0.52500 val_f1_mic= 0.45664 val_f1_mac= 0.19467 time= 0.02473
Iter: 0005 train_loss= 0.51862 train_f1_mic= 0.44967 train_f1_mac= 0.18157 val_loss= 0.52500 val_f1_mic= 0.45664 val_f1_mac= 0.19467 time= 0.02419
Iter: 0010 train_loss= 0.52052 train_f1_mic= 0.43950 train_f1_mac= 0.17557 val_loss= 0.52500 val_f1_mic= 0.45664 val_f1_mac= 0.19467 time= 0.02372
Iter: 0015 train_loss= 0.52519 train_f1_mic= 0.45462 train_f1_mac= 0.19098 val_loss= 0.52500 val_f1_mic= 0.45664 val_f1_mac= 0.19467 time= 0.02329
Epoch: 0007
Iter: 0001 train_loss= 0.51965 train_f1_mic= 0.44984 train_f1_mac= 0.19068 val_loss= 0.51620 val_f1_mic= 0.44905 val_f1_mac= 0.19543 time= 0.02317
Iter: 0006 train_loss= 0.51764 train_f1_mic= 0.42210 train_f1_mac= 0.16251 val_loss= 0.51620 val_f1_mic= 0.44905 val_f1_mac= 0.19543 time= 0.02289
Iter: 0011 train_loss= 0.49822 train_f1_mic= 0.46271 train_f1_mac= 0.18945 val_loss= 0.51620 val_f1_mic= 0.44905 val_f1_mac= 0.19543 time= 0.02258
Iter: 0016 train_loss= 0.51842 train_f1_mic= 0.48245 train_f1_mac= 0.22521 val_loss= 0.51620 val_f1_mic= 0.44905 val_f1_mac= 0.19543 time= 0.02225
Epoch: 0008
Iter: 0002 train_loss= 0.51549 train_f1_mic= 0.45450 train_f1_mac= 0.20407 val_loss= 0.53344 val_f1_mic= 0.45227 val_f1_mac= 0.20657 time= 0.02221
Iter: 0007 train_loss= 0.49962 train_f1_mic= 0.44287 train_f1_mac= 0.17746 val_loss= 0.53344 val_f1_mic= 0.45227 val_f1_mac= 0.20657 time= 0.02200
Iter: 0012 train_loss= 0.50844 train_f1_mic= 0.50059 train_f1_mac= 0.24070 val_loss= 0.53344 val_f1_mic= 0.45227 val_f1_mac= 0.20657 time= 0.02174
Iter: 0017 train_loss= 0.51095 train_f1_mic= 0.47059 train_f1_mac= 0.23139 val_loss= 0.53344 val_f1_mic= 0.45227 val_f1_mac= 0.20657 time= 0.02153
Epoch: 0009
Iter: 0003 train_loss= 0.50865 train_f1_mic= 0.43607 train_f1_mac= 0.19123 val_loss= 0.50413 val_f1_mic= 0.51421 val_f1_mac= 0.27412 time= 0.02147
Iter: 0008 train_loss= 0.49965 train_f1_mic= 0.48471 train_f1_mac= 0.24257 val_loss= 0.50413 val_f1_mic= 0.51421 val_f1_mac= 0.27412 time= 0.02128
Iter: 0013 train_loss= 0.50587 train_f1_mic= 0.51264 train_f1_mac= 0.26987 val_loss= 0.50413 val_f1_mic= 0.51421 val_f1_mac= 0.27412 time= 0.02106
Iter: 0018 train_loss= 0.49799 train_f1_mic= 0.47986 train_f1_mac= 0.23119 val_loss= 0.50413 val_f1_mic= 0.51421 val_f1_mac= 0.27412 time= 0.02086
Epoch: 0010
Iter: 0004 train_loss= 0.49513 train_f1_mic= 0.48062 train_f1_mac= 0.23032 val_loss= 0.51542 val_f1_mic= 0.49631 val_f1_mac= 0.26413 time= 0.02075
Iter: 0009 train_loss= 0.50546 train_f1_mic= 0.50289 train_f1_mac= 0.25904 val_loss= 0.51542 val_f1_mic= 0.49631 val_f1_mac= 0.26413 time= 0.02057
Iter: 0014 train_loss= 0.49407 train_f1_mic= 0.50479 train_f1_mac= 0.26997 val_loss= 0.51542 val_f1_mic= 0.49631 val_f1_mac= 0.26413 time= 0.02040
Optimization Finished!
Full validation stats: loss= 0.51579 f1_micro= 0.48611 f1_macro= 0.26215 time= 0.11572
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.483989370952165
Rewards :  0.004819573518886233 Accuracy :  0.487845029767274
Total reward :  1.3636826149442556
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.00481957]
Trial 237: Controller loss : 108.061897

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:45:12.851202: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:45:12.851431: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:45:12.851651: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:45:12.851815: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:45:12.852016: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69417 train_f1_mic= 0.38097 train_f1_mac= 0.31014 val_loss= 0.66478 val_f1_mic= 0.42140 val_f1_mac= 0.13658 time= 0.74800
Iter: 0005 train_loss= 0.58620 train_f1_mic= 0.37054 train_f1_mac= 0.08862 val_loss= 0.66478 val_f1_mic= 0.42140 val_f1_mac= 0.13658 time= 0.13695
Iter: 0010 train_loss= 0.56835 train_f1_mic= 0.36584 train_f1_mac= 0.09290 val_loss= 0.66478 val_f1_mic= 0.42140 val_f1_mac= 0.13658 time= 0.08105
Iter: 0015 train_loss= 0.54302 train_f1_mic= 0.40575 train_f1_mac= 0.10614 val_loss= 0.66478 val_f1_mic= 0.42140 val_f1_mac= 0.13658 time= 0.06046
Epoch: 0002
Iter: 0001 train_loss= 0.52926 train_f1_mic= 0.38240 train_f1_mac= 0.09300 val_loss= 0.57620 val_f1_mic= 0.36920 val_f1_mac= 0.09853 time= 0.05020
Iter: 0006 train_loss= 0.53881 train_f1_mic= 0.37244 train_f1_mac= 0.08878 val_loss= 0.57620 val_f1_mic= 0.36920 val_f1_mac= 0.09853 time= 0.04369
Iter: 0011 train_loss= 0.53136 train_f1_mic= 0.37953 train_f1_mac= 0.09316 val_loss= 0.57620 val_f1_mic= 0.36920 val_f1_mac= 0.09853 time= 0.03896
Iter: 0016 train_loss= 0.53493 train_f1_mic= 0.38443 train_f1_mac= 0.10077 val_loss= 0.57620 val_f1_mic= 0.36920 val_f1_mac= 0.09853 time= 0.03584
Epoch: 0003
Iter: 0002 train_loss= 0.51335 train_f1_mic= 0.40428 train_f1_mac= 0.11054 val_loss= 0.52724 val_f1_mic= 0.40977 val_f1_mac= 0.11340 time= 0.03359
Iter: 0007 train_loss= 0.53590 train_f1_mic= 0.39186 train_f1_mac= 0.11846 val_loss= 0.52724 val_f1_mic= 0.40977 val_f1_mac= 0.11340 time= 0.03143
Iter: 0012 train_loss= 0.53077 train_f1_mic= 0.41474 train_f1_mac= 0.12845 val_loss= 0.52724 val_f1_mic= 0.40977 val_f1_mac= 0.11340 time= 0.02989
Iter: 0017 train_loss= 0.53221 train_f1_mic= 0.39801 train_f1_mac= 0.11961 val_loss= 0.52724 val_f1_mic= 0.40977 val_f1_mac= 0.11340 time= 0.02858
Epoch: 0004
Iter: 0003 train_loss= 0.52553 train_f1_mic= 0.44900 train_f1_mac= 0.14401 val_loss= 0.54634 val_f1_mic= 0.42886 val_f1_mac= 0.13886 time= 0.02811
Iter: 0008 train_loss= 0.53656 train_f1_mic= 0.39024 train_f1_mac= 0.12234 val_loss= 0.54634 val_f1_mic= 0.42886 val_f1_mac= 0.13886 time= 0.02712
Iter: 0013 train_loss= 0.51755 train_f1_mic= 0.42739 train_f1_mac= 0.13991 val_loss= 0.54634 val_f1_mic= 0.42886 val_f1_mac= 0.13886 time= 0.02626
Iter: 0018 train_loss= 0.51309 train_f1_mic= 0.42805 train_f1_mac= 0.14077 val_loss= 0.54634 val_f1_mic= 0.42886 val_f1_mac= 0.13886 time= 0.02555
Epoch: 0005
Iter: 0004 train_loss= 0.52812 train_f1_mic= 0.43856 train_f1_mac= 0.15715 val_loss= 0.54610 val_f1_mic= 0.43341 val_f1_mac= 0.15266 time= 0.02505
Iter: 0009 train_loss= 0.52043 train_f1_mic= 0.43338 train_f1_mac= 0.15514 val_loss= 0.54610 val_f1_mic= 0.43341 val_f1_mac= 0.15266 time= 0.02445
Iter: 0014 train_loss= 0.51165 train_f1_mic= 0.46197 train_f1_mac= 0.18167 val_loss= 0.54610 val_f1_mic= 0.43341 val_f1_mac= 0.15266 time= 0.02392
Epoch: 0006
Iter: 0000 train_loss= 0.51538 train_f1_mic= 0.43958 train_f1_mac= 0.17358 val_loss= 0.52531 val_f1_mic= 0.45857 val_f1_mac= 0.18703 time= 0.02382
Iter: 0005 train_loss= 0.52603 train_f1_mic= 0.44327 train_f1_mac= 0.17677 val_loss= 0.52531 val_f1_mic= 0.45857 val_f1_mac= 0.18703 time= 0.02341
Iter: 0010 train_loss= 0.51095 train_f1_mic= 0.45962 train_f1_mac= 0.18513 val_loss= 0.52531 val_f1_mic= 0.45857 val_f1_mac= 0.18703 time= 0.02308
Iter: 0015 train_loss= 0.50270 train_f1_mic= 0.45836 train_f1_mac= 0.18767 val_loss= 0.52531 val_f1_mic= 0.45857 val_f1_mac= 0.18703 time= 0.02274
Epoch: 0007
Iter: 0001 train_loss= 0.49911 train_f1_mic= 0.44993 train_f1_mac= 0.18005 val_loss= 0.54067 val_f1_mic= 0.44989 val_f1_mac= 0.19461 time= 0.02265
Iter: 0006 train_loss= 0.52094 train_f1_mic= 0.47859 train_f1_mac= 0.22033 val_loss= 0.54067 val_f1_mic= 0.44989 val_f1_mac= 0.19461 time= 0.02234
Iter: 0011 train_loss= 0.50628 train_f1_mic= 0.44707 train_f1_mac= 0.19186 val_loss= 0.54067 val_f1_mic= 0.44989 val_f1_mac= 0.19461 time= 0.02202
Iter: 0016 train_loss= 0.51620 train_f1_mic= 0.45583 train_f1_mac= 0.20201 val_loss= 0.54067 val_f1_mic= 0.44989 val_f1_mac= 0.19461 time= 0.02175
Epoch: 0008
Iter: 0002 train_loss= 0.51978 train_f1_mic= 0.48821 train_f1_mac= 0.23730 val_loss= 0.53546 val_f1_mic= 0.47754 val_f1_mac= 0.23395 time= 0.02161
Iter: 0007 train_loss= 0.51082 train_f1_mic= 0.46702 train_f1_mac= 0.21617 val_loss= 0.53546 val_f1_mic= 0.47754 val_f1_mac= 0.23395 time= 0.02134
Iter: 0012 train_loss= 0.49821 train_f1_mic= 0.47432 train_f1_mac= 0.22869 val_loss= 0.53546 val_f1_mic= 0.47754 val_f1_mac= 0.23395 time= 0.02110
Iter: 0017 train_loss= 0.50861 train_f1_mic= 0.49712 train_f1_mac= 0.25301 val_loss= 0.53546 val_f1_mic= 0.47754 val_f1_mac= 0.23395 time= 0.02089
Epoch: 0009
Iter: 0003 train_loss= 0.49308 train_f1_mic= 0.48869 train_f1_mac= 0.24722 val_loss= 0.53454 val_f1_mic= 0.45308 val_f1_mac= 0.21990 time= 0.02088
Iter: 0008 train_loss= 0.50248 train_f1_mic= 0.48117 train_f1_mac= 0.22924 val_loss= 0.53454 val_f1_mic= 0.45308 val_f1_mac= 0.21990 time= 0.02071
Iter: 0013 train_loss= 0.50230 train_f1_mic= 0.49799 train_f1_mac= 0.26006 val_loss= 0.53454 val_f1_mic= 0.45308 val_f1_mac= 0.21990 time= 0.02057
Iter: 0018 train_loss= 0.49766 train_f1_mic= 0.48492 train_f1_mac= 0.23940 val_loss= 0.53454 val_f1_mic= 0.45308 val_f1_mac= 0.21990 time= 0.02040
Epoch: 0010
Iter: 0004 train_loss= 0.49141 train_f1_mic= 0.47477 train_f1_mac= 0.23254 val_loss= 0.51834 val_f1_mic= 0.50770 val_f1_mac= 0.28513 time= 0.02032
Iter: 0009 train_loss= 0.50111 train_f1_mic= 0.51225 train_f1_mac= 0.27672 val_loss= 0.51834 val_f1_mic= 0.50770 val_f1_mac= 0.28513 time= 0.02016
Iter: 0014 train_loss= 0.50240 train_f1_mic= 0.50333 train_f1_mac= 0.26617 val_loss= 0.51834 val_f1_mic= 0.50770 val_f1_mac= 0.28513 time= 0.01999
Optimization Finished!
Full validation stats: loss= 0.51519 f1_micro= 0.49076 f1_macro= 0.26198 time= 0.13660
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4858323729261186
Rewards :  0.009215009869768032 Accuracy :  0.493204380821933
Total reward :  1.3728976248140237
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.00921501]
Trial 238: Controller loss : 108.110100

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [1, 'tanh', 4, 'linear']
2018-08-31 00:45:22.059274: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:45:22.059673: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:45:22.060059: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:45:22.060341: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:45:22.060701: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69415 train_f1_mic= 0.37751 train_f1_mac= 0.35493 val_loss= 0.67932 val_f1_mic= 0.39532 val_f1_mac= 0.30537 time= 1.27316
Iter: 0005 train_loss= 0.57512 train_f1_mic= 0.37729 train_f1_mac= 0.08876 val_loss= 0.67932 val_f1_mic= 0.39532 val_f1_mac= 0.30537 time= 0.31244
Iter: 0010 train_loss= 0.53957 train_f1_mic= 0.38408 train_f1_mac= 0.09216 val_loss= 0.67932 val_f1_mic= 0.39532 val_f1_mac= 0.30537 time= 0.22490
Iter: 0015 train_loss= 0.55275 train_f1_mic= 0.39361 train_f1_mac= 0.09961 val_loss= 0.67932 val_f1_mic= 0.39532 val_f1_mac= 0.30537 time= 0.19209
Epoch: 0002
Iter: 0001 train_loss= 0.53631 train_f1_mic= 0.40627 train_f1_mac= 0.10259 val_loss= 0.56392 val_f1_mic= 0.38174 val_f1_mac= 0.10293 time= 0.17722
Iter: 0006 train_loss= 0.53957 train_f1_mic= 0.36799 train_f1_mac= 0.08662 val_loss= 0.56392 val_f1_mic= 0.38174 val_f1_mac= 0.10293 time= 0.16619
Iter: 0011 train_loss= 0.54805 train_f1_mic= 0.38346 train_f1_mac= 0.09736 val_loss= 0.56392 val_f1_mic= 0.38174 val_f1_mac= 0.10293 time= 0.15879
Iter: 0016 train_loss= 0.55270 train_f1_mic= 0.37641 train_f1_mac= 0.09564 val_loss= 0.56392 val_f1_mic= 0.38174 val_f1_mac= 0.10293 time= 0.15341
Epoch: 0003
Iter: 0002 train_loss= 0.54765 train_f1_mic= 0.38922 train_f1_mac= 0.10075 val_loss= 0.54285 val_f1_mic= 0.38767 val_f1_mac= 0.09879 time= 0.15056
Iter: 0007 train_loss= 0.53236 train_f1_mic= 0.38366 train_f1_mac= 0.09417 val_loss= 0.54285 val_f1_mic= 0.38767 val_f1_mac= 0.09879 time= 0.14745
Iter: 0012 train_loss= 0.55070 train_f1_mic= 0.36781 train_f1_mac= 0.09686 val_loss= 0.54285 val_f1_mic= 0.38767 val_f1_mac= 0.09879 time= 0.14486
Iter: 0017 train_loss= 0.52408 train_f1_mic= 0.40563 train_f1_mac= 0.11177 val_loss= 0.54285 val_f1_mic= 0.38767 val_f1_mac= 0.09879 time= 0.14274
Epoch: 0004
Iter: 0003 train_loss= 0.53189 train_f1_mic= 0.39928 train_f1_mac= 0.11207 val_loss= 0.57540 val_f1_mic= 0.38829 val_f1_mac= 0.11261 time= 0.14168
Iter: 0008 train_loss= 0.54484 train_f1_mic= 0.39085 train_f1_mac= 0.11695 val_loss= 0.57540 val_f1_mic= 0.38829 val_f1_mac= 0.11261 time= 0.14009
Iter: 0013 train_loss= 0.53166 train_f1_mic= 0.41623 train_f1_mac= 0.12908 val_loss= 0.57540 val_f1_mic= 0.38829 val_f1_mac= 0.11261 time= 0.13871
Iter: 0018 train_loss= 0.53717 train_f1_mic= 0.40357 train_f1_mac= 0.12961 val_loss= 0.57540 val_f1_mic= 0.38829 val_f1_mac= 0.11261 time= 0.13751
Epoch: 0005
Iter: 0004 train_loss= 0.53986 train_f1_mic= 0.41158 train_f1_mac= 0.13147 val_loss= 0.56427 val_f1_mic= 0.39156 val_f1_mac= 0.12709 time= 0.13706
Iter: 0009 train_loss= 0.53332 train_f1_mic= 0.40337 train_f1_mac= 0.12479 val_loss= 0.56427 val_f1_mic= 0.39156 val_f1_mac= 0.12709 time= 0.13621
Iter: 0014 train_loss= 0.53967 train_f1_mic= 0.41017 train_f1_mac= 0.13256 val_loss= 0.56427 val_f1_mic= 0.39156 val_f1_mac= 0.12709 time= 0.13541
Epoch: 0006
Iter: 0000 train_loss= 0.52703 train_f1_mic= 0.40970 train_f1_mac= 0.12805 val_loss= 0.57012 val_f1_mic= 0.37536 val_f1_mac= 0.11952 time= 0.13508
Iter: 0005 train_loss= 0.53586 train_f1_mic= 0.45698 train_f1_mac= 0.15705 val_loss= 0.57012 val_f1_mic= 0.37536 val_f1_mac= 0.11952 time= 0.13435
Iter: 0010 train_loss= 0.53756 train_f1_mic= 0.38366 train_f1_mac= 0.11066 val_loss= 0.57012 val_f1_mic= 0.37536 val_f1_mac= 0.11952 time= 0.13369
Iter: 0015 train_loss= 0.53339 train_f1_mic= 0.43388 train_f1_mac= 0.14386 val_loss= 0.57012 val_f1_mic= 0.37536 val_f1_mac= 0.11952 time= 0.13312
Epoch: 0007
Iter: 0001 train_loss= 0.53727 train_f1_mic= 0.38122 train_f1_mac= 0.11119 val_loss= 0.54853 val_f1_mic= 0.38661 val_f1_mac= 0.12359 time= 0.13299
Iter: 0006 train_loss= 0.53160 train_f1_mic= 0.44313 train_f1_mac= 0.15141 val_loss= 0.54853 val_f1_mic= 0.38661 val_f1_mac= 0.12359 time= 0.13258
Iter: 0011 train_loss= 0.53058 train_f1_mic= 0.39608 train_f1_mac= 0.12258 val_loss= 0.54853 val_f1_mic= 0.38661 val_f1_mac= 0.12359 time= 0.13210
Iter: 0016 train_loss= 0.52875 train_f1_mic= 0.43395 train_f1_mac= 0.14792 val_loss= 0.54853 val_f1_mic= 0.38661 val_f1_mac= 0.12359 time= 0.13169
Epoch: 0008
Iter: 0002 train_loss= 0.53327 train_f1_mic= 0.41616 train_f1_mac= 0.14590 val_loss= 0.54869 val_f1_mic= 0.40133 val_f1_mac= 0.13656 time= 0.13175
Iter: 0007 train_loss= 0.54408 train_f1_mic= 0.43439 train_f1_mac= 0.15908 val_loss= 0.54869 val_f1_mic= 0.40133 val_f1_mac= 0.13656 time= 0.13140
Iter: 0012 train_loss= 0.52168 train_f1_mic= 0.40923 train_f1_mac= 0.13339 val_loss= 0.54869 val_f1_mic= 0.40133 val_f1_mac= 0.13656 time= 0.13104
Iter: 0017 train_loss= 0.53253 train_f1_mic= 0.42350 train_f1_mac= 0.14160 val_loss= 0.54869 val_f1_mic= 0.40133 val_f1_mac= 0.13656 time= 0.13075
Epoch: 0009
Iter: 0003 train_loss= 0.53349 train_f1_mic= 0.39801 train_f1_mac= 0.12287 val_loss= 0.56268 val_f1_mic= 0.39561 val_f1_mac= 0.13626 time= 0.13076
Iter: 0008 train_loss= 0.51915 train_f1_mic= 0.43491 train_f1_mac= 0.15847 val_loss= 0.56268 val_f1_mic= 0.39561 val_f1_mac= 0.13626 time= 0.13051
Iter: 0013 train_loss= 0.53163 train_f1_mic= 0.45938 train_f1_mac= 0.18540 val_loss= 0.56268 val_f1_mic= 0.39561 val_f1_mac= 0.13626 time= 0.13033
Iter: 0018 train_loss= 0.52418 train_f1_mic= 0.44417 train_f1_mac= 0.15737 val_loss= 0.56268 val_f1_mic= 0.39561 val_f1_mac= 0.13626 time= 0.13010
Epoch: 0010
Iter: 0004 train_loss= 0.53219 train_f1_mic= 0.40385 train_f1_mac= 0.13322 val_loss= 0.54416 val_f1_mic= 0.42907 val_f1_mac= 0.15650 time= 0.13014
Iter: 0009 train_loss= 0.52902 train_f1_mic= 0.41821 train_f1_mac= 0.14578 val_loss= 0.54416 val_f1_mic= 0.42907 val_f1_mac= 0.15650 time= 0.12994
Iter: 0014 train_loss= 0.51569 train_f1_mic= 0.43479 train_f1_mac= 0.16205 val_loss= 0.54416 val_f1_mic= 0.42907 val_f1_mac= 0.15650 time= 0.12976
Optimization Finished!
Full validation stats: loss= 0.54259 f1_micro= 0.45749 f1_macro= 0.20789 time= 0.27330
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47873087282323484
Rewards :  -0.035507500514418644 Accuracy :  0.45032487241169994
Total reward :  1.337390124299605
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'tanh', 4, 'linear']
Training RNN (Reward ip) :  [-0.0355075]
Trial 239: Controller loss : 11603.531250

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'sigmoid', 4, 'tanh']
2018-08-31 00:45:53.648571: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:45:53.648925: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:45:53.649287: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:45:53.649565: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:45:53.649902: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69370 train_f1_mic= 0.36848 train_f1_mac= 0.23069 val_loss= 0.66680 val_f1_mic= 0.39854 val_f1_mac= 0.12166 time= 0.84973
Iter: 0005 train_loss= 0.58933 train_f1_mic= 0.36208 train_f1_mac= 0.08758 val_loss= 0.66680 val_f1_mic= 0.39854 val_f1_mac= 0.12166 time= 0.19465
Iter: 0010 train_loss= 0.55317 train_f1_mic= 0.39569 train_f1_mac= 0.10237 val_loss= 0.66680 val_f1_mic= 0.39854 val_f1_mac= 0.12166 time= 0.13355
Iter: 0015 train_loss= 0.53732 train_f1_mic= 0.36991 train_f1_mac= 0.08641 val_loss= 0.66680 val_f1_mic= 0.39854 val_f1_mac= 0.12166 time= 0.11064
Epoch: 0002
Iter: 0001 train_loss= 0.54416 train_f1_mic= 0.37018 train_f1_mac= 0.08710 val_loss= 0.57598 val_f1_mic= 0.35931 val_f1_mac= 0.09048 time= 0.09978
Iter: 0006 train_loss= 0.54881 train_f1_mic= 0.39229 train_f1_mac= 0.09888 val_loss= 0.57598 val_f1_mic= 0.35931 val_f1_mac= 0.09048 time= 0.09218
Iter: 0011 train_loss= 0.54289 train_f1_mic= 0.37945 train_f1_mac= 0.09213 val_loss= 0.57598 val_f1_mic= 0.35931 val_f1_mac= 0.09048 time= 0.08696
Iter: 0016 train_loss= 0.54450 train_f1_mic= 0.38236 train_f1_mac= 0.09326 val_loss= 0.57598 val_f1_mic= 0.35931 val_f1_mac= 0.09048 time= 0.08330
Epoch: 0003
Iter: 0002 train_loss= 0.54332 train_f1_mic= 0.38539 train_f1_mac= 0.09636 val_loss= 0.56425 val_f1_mic= 0.38868 val_f1_mac= 0.10145 time= 0.08100
Iter: 0007 train_loss= 0.54264 train_f1_mic= 0.39170 train_f1_mac= 0.09783 val_loss= 0.56425 val_f1_mic= 0.38868 val_f1_mac= 0.10145 time= 0.07879
Iter: 0012 train_loss= 0.54166 train_f1_mic= 0.38910 train_f1_mac= 0.09723 val_loss= 0.56425 val_f1_mic= 0.38868 val_f1_mac= 0.10145 time= 0.07699
Iter: 0017 train_loss= 0.53699 train_f1_mic= 0.38368 train_f1_mac= 0.09205 val_loss= 0.56425 val_f1_mic= 0.38868 val_f1_mac= 0.10145 time= 0.07553
Epoch: 0004
Iter: 0003 train_loss= 0.54039 train_f1_mic= 0.36928 train_f1_mac= 0.08699 val_loss= 0.57082 val_f1_mic= 0.35838 val_f1_mac= 0.09024 time= 0.07460
Iter: 0008 train_loss= 0.55141 train_f1_mic= 0.40665 train_f1_mac= 0.10577 val_loss= 0.57082 val_f1_mic= 0.35838 val_f1_mac= 0.09024 time= 0.07350
Iter: 0013 train_loss= 0.54844 train_f1_mic= 0.38132 train_f1_mac= 0.09372 val_loss= 0.57082 val_f1_mic= 0.35838 val_f1_mac= 0.09024 time= 0.07259
Iter: 0018 train_loss= 0.54323 train_f1_mic= 0.36580 train_f1_mac= 0.08683 val_loss= 0.57082 val_f1_mic= 0.35838 val_f1_mac= 0.09024 time= 0.07175
Epoch: 0005
Iter: 0004 train_loss= 0.55885 train_f1_mic= 0.36042 train_f1_mac= 0.08844 val_loss= 0.58305 val_f1_mic= 0.34792 val_f1_mac= 0.09045 time= 0.07134
Iter: 0009 train_loss= 0.54656 train_f1_mic= 0.38634 train_f1_mac= 0.09732 val_loss= 0.58305 val_f1_mic= 0.34792 val_f1_mac= 0.09045 time= 0.07074
Iter: 0014 train_loss= 0.54332 train_f1_mic= 0.36883 train_f1_mac= 0.08726 val_loss= 0.58305 val_f1_mic= 0.34792 val_f1_mac= 0.09045 time= 0.07027
Epoch: 0006
Iter: 0000 train_loss= 0.54387 train_f1_mic= 0.37989 train_f1_mac= 0.09277 val_loss= 0.55714 val_f1_mic= 0.37685 val_f1_mac= 0.09460 time= 0.07004
Iter: 0005 train_loss= 0.53673 train_f1_mic= 0.39134 train_f1_mac= 0.09669 val_loss= 0.55714 val_f1_mic= 0.37685 val_f1_mac= 0.09460 time= 0.06958
Iter: 0010 train_loss= 0.53612 train_f1_mic= 0.37376 train_f1_mac= 0.08704 val_loss= 0.55714 val_f1_mic= 0.37685 val_f1_mac= 0.09460 time= 0.06917
Iter: 0015 train_loss= 0.55036 train_f1_mic= 0.36844 train_f1_mac= 0.09087 val_loss= 0.55714 val_f1_mic= 0.37685 val_f1_mac= 0.09460 time= 0.06878
Epoch: 0007
Iter: 0001 train_loss= 0.54425 train_f1_mic= 0.39059 train_f1_mac= 0.09786 val_loss= 0.57551 val_f1_mic= 0.38060 val_f1_mac= 0.10176 time= 0.06860
Iter: 0006 train_loss= 0.54523 train_f1_mic= 0.36807 train_f1_mac= 0.08819 val_loss= 0.57551 val_f1_mic= 0.38060 val_f1_mac= 0.10176 time= 0.06829
Iter: 0011 train_loss= 0.54157 train_f1_mic= 0.38285 train_f1_mac= 0.09317 val_loss= 0.57551 val_f1_mic= 0.38060 val_f1_mac= 0.10176 time= 0.06799
Iter: 0016 train_loss= 0.54676 train_f1_mic= 0.36380 train_f1_mac= 0.08716 val_loss= 0.57551 val_f1_mic= 0.38060 val_f1_mac= 0.10176 time= 0.06773
Epoch: 0008
Iter: 0002 train_loss= 0.53916 train_f1_mic= 0.39080 train_f1_mac= 0.09719 val_loss= 0.55447 val_f1_mic= 0.38814 val_f1_mac= 0.09988 time= 0.06768
Iter: 0007 train_loss= 0.53584 train_f1_mic= 0.37888 train_f1_mac= 0.09159 val_loss= 0.55447 val_f1_mic= 0.38814 val_f1_mac= 0.09988 time= 0.06746
Iter: 0012 train_loss= 0.54508 train_f1_mic= 0.39497 train_f1_mac= 0.10513 val_loss= 0.55447 val_f1_mic= 0.38814 val_f1_mac= 0.09988 time= 0.06725
Iter: 0017 train_loss= 0.53446 train_f1_mic= 0.40630 train_f1_mac= 0.10637 val_loss= 0.55447 val_f1_mic= 0.38814 val_f1_mac= 0.09988 time= 0.06705
Epoch: 0009
Iter: 0003 train_loss= 0.53356 train_f1_mic= 0.36799 train_f1_mac= 0.08811 val_loss= 0.55063 val_f1_mic= 0.37059 val_f1_mac= 0.09147 time= 0.06700
Iter: 0008 train_loss= 0.54124 train_f1_mic= 0.40505 train_f1_mac= 0.10419 val_loss= 0.55063 val_f1_mic= 0.37059 val_f1_mac= 0.09147 time= 0.06683
Iter: 0013 train_loss= 0.53391 train_f1_mic= 0.40102 train_f1_mac= 0.10229 val_loss= 0.55063 val_f1_mic= 0.37059 val_f1_mac= 0.09147 time= 0.06665
Iter: 0018 train_loss= 0.54675 train_f1_mic= 0.37537 train_f1_mac= 0.09723 val_loss= 0.55063 val_f1_mic= 0.37059 val_f1_mac= 0.09147 time= 0.06648
Epoch: 0010
Iter: 0004 train_loss= 0.54427 train_f1_mic= 0.39759 train_f1_mac= 0.10966 val_loss= 0.56523 val_f1_mic= 0.36482 val_f1_mac= 0.09846 time= 0.06645
Iter: 0009 train_loss= 0.54788 train_f1_mic= 0.39939 train_f1_mac= 0.11158 val_loss= 0.56523 val_f1_mic= 0.36482 val_f1_mac= 0.09846 time= 0.06629
Iter: 0014 train_loss= 0.52833 train_f1_mic= 0.41444 train_f1_mac= 0.11323 val_loss= 0.56523 val_f1_mic= 0.36482 val_f1_mac= 0.09846 time= 0.06615
Optimization Finished!
Full validation stats: loss= 0.55845 f1_micro= 0.37868 f1_macro= 0.10289 time= 0.11971
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4606886572065043
Rewards :  -0.09021107808365275 Accuracy :  0.3885197947395821
Total reward :  1.2471790462159522
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'sigmoid', 4, 'tanh']
Training RNN (Reward ip) :  [-0.09021108]
Trial 240: Controller loss : 11315.172852

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'linear', 2, 'tanh']
2018-08-31 00:46:11.378111: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:46:11.378910: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:46:11.379683: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:46:11.380254: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:46:11.380955: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69285 train_f1_mic= 0.37154 train_f1_mac= 0.32557 val_loss= 0.67186 val_f1_mic= 0.38827 val_f1_mac= 0.16486 time= 0.84870
Iter: 0005 train_loss= 0.58145 train_f1_mic= 0.39401 train_f1_mac= 0.09798 val_loss= 0.67186 val_f1_mic= 0.38827 val_f1_mac= 0.16486 time= 0.17702
Iter: 0010 train_loss= 0.55000 train_f1_mic= 0.36911 train_f1_mac= 0.08818 val_loss= 0.67186 val_f1_mic= 0.38827 val_f1_mac= 0.16486 time= 0.11687
Iter: 0015 train_loss= 0.54229 train_f1_mic= 0.39686 train_f1_mac= 0.09849 val_loss= 0.67186 val_f1_mic= 0.38827 val_f1_mac= 0.16486 time= 0.09444
Epoch: 0002
Iter: 0001 train_loss= 0.53968 train_f1_mic= 0.39633 train_f1_mac= 0.09741 val_loss= 0.56683 val_f1_mic= 0.38725 val_f1_mac= 0.10025 time= 0.08373
Iter: 0006 train_loss= 0.56529 train_f1_mic= 0.36462 train_f1_mac= 0.09243 val_loss= 0.56683 val_f1_mic= 0.38725 val_f1_mac= 0.10025 time= 0.07629
Iter: 0011 train_loss= 0.54158 train_f1_mic= 0.38407 train_f1_mac= 0.09281 val_loss= 0.56683 val_f1_mic= 0.38725 val_f1_mac= 0.10025 time= 0.07126
Iter: 0016 train_loss= 0.54450 train_f1_mic= 0.38081 train_f1_mac= 0.09264 val_loss= 0.56683 val_f1_mic= 0.38725 val_f1_mac= 0.10025 time= 0.06771
Epoch: 0003
Iter: 0002 train_loss= 0.55440 train_f1_mic= 0.38429 train_f1_mac= 0.09853 val_loss= 0.57661 val_f1_mic= 0.36835 val_f1_mac= 0.09632 time= 0.06594
Iter: 0007 train_loss= 0.53420 train_f1_mic= 0.39923 train_f1_mac= 0.09795 val_loss= 0.57661 val_f1_mic= 0.36835 val_f1_mac= 0.09632 time= 0.06378
Iter: 0012 train_loss= 0.54212 train_f1_mic= 0.36631 train_f1_mac= 0.08648 val_loss= 0.57661 val_f1_mic= 0.36835 val_f1_mac= 0.09632 time= 0.06189
Iter: 0017 train_loss= 0.54337 train_f1_mic= 0.39424 train_f1_mac= 0.09866 val_loss= 0.57661 val_f1_mic= 0.36835 val_f1_mac= 0.09632 time= 0.06044
Epoch: 0004
Iter: 0003 train_loss= 0.53775 train_f1_mic= 0.38673 train_f1_mac= 0.09627 val_loss= 0.56518 val_f1_mic= 0.37498 val_f1_mac= 0.09844 time= 0.05963
Iter: 0008 train_loss= 0.54335 train_f1_mic= 0.38622 train_f1_mac= 0.09709 val_loss= 0.56518 val_f1_mic= 0.37498 val_f1_mac= 0.09844 time= 0.05866
Iter: 0013 train_loss= 0.53820 train_f1_mic= 0.39192 train_f1_mac= 0.09698 val_loss= 0.56518 val_f1_mic= 0.37498 val_f1_mac= 0.09844 time= 0.05756
Iter: 0018 train_loss= 0.53534 train_f1_mic= 0.37150 train_f1_mac= 0.08837 val_loss= 0.56518 val_f1_mic= 0.37498 val_f1_mac= 0.09844 time= 0.05661
Epoch: 0005
Iter: 0004 train_loss= 0.54800 train_f1_mic= 0.38064 train_f1_mac= 0.09515 val_loss= 0.56480 val_f1_mic= 0.37268 val_f1_mac= 0.09543 time= 0.05607
Iter: 0009 train_loss= 0.55021 train_f1_mic= 0.38268 train_f1_mac= 0.09869 val_loss= 0.56480 val_f1_mic= 0.37268 val_f1_mac= 0.09543 time= 0.05541
Iter: 0014 train_loss= 0.53479 train_f1_mic= 0.38457 train_f1_mac= 0.09424 val_loss= 0.56480 val_f1_mic= 0.37268 val_f1_mac= 0.09543 time= 0.05485
Epoch: 0006
Iter: 0000 train_loss= 0.54296 train_f1_mic= 0.37574 train_f1_mac= 0.09203 val_loss= 0.54829 val_f1_mic= 0.37710 val_f1_mac= 0.09325 time= 0.05451
Iter: 0005 train_loss= 0.54208 train_f1_mic= 0.39066 train_f1_mac= 0.10340 val_loss= 0.54829 val_f1_mic= 0.37710 val_f1_mac= 0.09325 time= 0.05394
Iter: 0010 train_loss= 0.53720 train_f1_mic= 0.38245 train_f1_mac= 0.09505 val_loss= 0.54829 val_f1_mic= 0.37710 val_f1_mac= 0.09325 time= 0.05353
Iter: 0015 train_loss= 0.53783 train_f1_mic= 0.38282 train_f1_mac= 0.09541 val_loss= 0.54829 val_f1_mic= 0.37710 val_f1_mac= 0.09325 time= 0.05311
Epoch: 0007
Iter: 0001 train_loss= 0.54624 train_f1_mic= 0.39365 train_f1_mac= 0.10764 val_loss= 0.54873 val_f1_mic= 0.38760 val_f1_mac= 0.10707 time= 0.05313
Iter: 0006 train_loss= 0.54964 train_f1_mic= 0.41902 train_f1_mac= 0.12968 val_loss= 0.54873 val_f1_mic= 0.38760 val_f1_mac= 0.10707 time= 0.05286
Iter: 0011 train_loss= 0.52520 train_f1_mic= 0.37456 train_f1_mac= 0.09342 val_loss= 0.54873 val_f1_mic= 0.38760 val_f1_mac= 0.10707 time= 0.05262
Iter: 0016 train_loss= 0.53890 train_f1_mic= 0.38568 train_f1_mac= 0.09970 val_loss= 0.54873 val_f1_mic= 0.38760 val_f1_mac= 0.10707 time= 0.05231
Epoch: 0008
Iter: 0002 train_loss= 0.53280 train_f1_mic= 0.43127 train_f1_mac= 0.13103 val_loss= 0.57083 val_f1_mic= 0.41373 val_f1_mac= 0.13093 time= 0.05226
Iter: 0007 train_loss= 0.54334 train_f1_mic= 0.39819 train_f1_mac= 0.11732 val_loss= 0.57083 val_f1_mic= 0.41373 val_f1_mac= 0.13093 time= 0.05204
Iter: 0012 train_loss= 0.53752 train_f1_mic= 0.39149 train_f1_mac= 0.11412 val_loss= 0.57083 val_f1_mic= 0.41373 val_f1_mac= 0.13093 time= 0.05181
Iter: 0017 train_loss= 0.53433 train_f1_mic= 0.41701 train_f1_mac= 0.12904 val_loss= 0.57083 val_f1_mic= 0.41373 val_f1_mac= 0.13093 time= 0.05165
Epoch: 0009
Iter: 0003 train_loss= 0.52939 train_f1_mic= 0.40943 train_f1_mac= 0.12416 val_loss= 0.54837 val_f1_mic= 0.42293 val_f1_mac= 0.13306 time= 0.05160
Iter: 0008 train_loss= 0.54287 train_f1_mic= 0.40147 train_f1_mac= 0.12103 val_loss= 0.54837 val_f1_mic= 0.42293 val_f1_mac= 0.13306 time= 0.05143
Iter: 0013 train_loss= 0.53160 train_f1_mic= 0.39868 train_f1_mac= 0.11902 val_loss= 0.54837 val_f1_mic= 0.42293 val_f1_mac= 0.13306 time= 0.05117
Iter: 0018 train_loss= 0.53470 train_f1_mic= 0.40342 train_f1_mac= 0.12221 val_loss= 0.54837 val_f1_mic= 0.42293 val_f1_mac= 0.13306 time= 0.05098
Epoch: 0010
Iter: 0004 train_loss= 0.52860 train_f1_mic= 0.41406 train_f1_mac= 0.12529 val_loss= 0.54569 val_f1_mic= 0.41430 val_f1_mac= 0.13117 time= 0.05092
Iter: 0009 train_loss= 0.52584 train_f1_mic= 0.41191 train_f1_mac= 0.12298 val_loss= 0.54569 val_f1_mic= 0.41430 val_f1_mac= 0.13117 time= 0.05073
Iter: 0014 train_loss= 0.54014 train_f1_mic= 0.42049 train_f1_mac= 0.13301 val_loss= 0.54569 val_f1_mic= 0.41430 val_f1_mac= 0.13117 time= 0.05053
Optimization Finished!
Full validation stats: loss= 0.55260 f1_micro= 0.40681 f1_macro= 0.13117 time= 0.13567
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.45116885930225464
Rewards :  -0.04759898952124836 Accuracy :  0.41308966768525596
Total reward :  1.199580056694704
Saved buffers to file `buffers.txt` !
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'linear', 2, 'tanh']
Training RNN (Reward ip) :  [-0.04759899]
Trial 241: Controller loss : 11438.540039

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'linear', 4, 'sigmoid']
2018-08-31 00:46:27.487332: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:46:27.487927: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:46:27.488537: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:46:27.489068: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:46:27.489636: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69350 train_f1_mic= 0.35656 train_f1_mac= 0.22214 val_loss= 0.65994 val_f1_mic= 0.35997 val_f1_mac= 0.09419 time= 1.28514
Iter: 0005 train_loss= 0.57296 train_f1_mic= 0.37891 train_f1_mac= 0.09339 val_loss= 0.65994 val_f1_mic= 0.35997 val_f1_mac= 0.09419 time= 0.31425
Iter: 0010 train_loss= 0.54659 train_f1_mic= 0.42261 train_f1_mac= 0.11464 val_loss= 0.65994 val_f1_mic= 0.35997 val_f1_mac= 0.09419 time= 0.22563
Iter: 0015 train_loss= 0.54018 train_f1_mic= 0.39772 train_f1_mac= 0.10161 val_loss= 0.65994 val_f1_mic= 0.35997 val_f1_mac= 0.09419 time= 0.19246
Epoch: 0002
Iter: 0001 train_loss= 0.53099 train_f1_mic= 0.37449 train_f1_mac= 0.09167 val_loss= 0.56898 val_f1_mic= 0.36516 val_f1_mac= 0.09594 time= 0.17689
Iter: 0006 train_loss= 0.54031 train_f1_mic= 0.38104 train_f1_mac= 0.09880 val_loss= 0.56898 val_f1_mic= 0.36516 val_f1_mac= 0.09594 time= 0.16585
Iter: 0011 train_loss= 0.53613 train_f1_mic= 0.40304 train_f1_mac= 0.11443 val_loss= 0.56898 val_f1_mic= 0.36516 val_f1_mac= 0.09594 time= 0.15827
Iter: 0016 train_loss= 0.53812 train_f1_mic= 0.42238 train_f1_mac= 0.13082 val_loss= 0.56898 val_f1_mic= 0.36516 val_f1_mac= 0.09594 time= 0.15327
Epoch: 0003
Iter: 0002 train_loss= 0.52984 train_f1_mic= 0.40678 train_f1_mac= 0.12618 val_loss= 0.55940 val_f1_mic= 0.40701 val_f1_mac= 0.13158 time= 0.15066
Iter: 0007 train_loss= 0.52951 train_f1_mic= 0.40850 train_f1_mac= 0.12615 val_loss= 0.55940 val_f1_mic= 0.40701 val_f1_mac= 0.13158 time= 0.14733
Iter: 0012 train_loss= 0.53995 train_f1_mic= 0.41785 train_f1_mac= 0.13563 val_loss= 0.55940 val_f1_mic= 0.40701 val_f1_mac= 0.13158 time= 0.14460
Iter: 0017 train_loss= 0.53913 train_f1_mic= 0.41527 train_f1_mac= 0.13257 val_loss= 0.55940 val_f1_mic= 0.40701 val_f1_mac= 0.13158 time= 0.14264
Epoch: 0004
Iter: 0003 train_loss= 0.52310 train_f1_mic= 0.42092 train_f1_mac= 0.13172 val_loss= 0.55905 val_f1_mic= 0.41539 val_f1_mac= 0.13696 time= 0.14179
Iter: 0008 train_loss= 0.54098 train_f1_mic= 0.39434 train_f1_mac= 0.11949 val_loss= 0.55905 val_f1_mic= 0.41539 val_f1_mac= 0.13696 time= 0.14022
Iter: 0013 train_loss= 0.53042 train_f1_mic= 0.40542 train_f1_mac= 0.12440 val_loss= 0.55905 val_f1_mic= 0.41539 val_f1_mac= 0.13696 time= 0.13883
Iter: 0018 train_loss= 0.52396 train_f1_mic= 0.43824 train_f1_mac= 0.13596 val_loss= 0.55905 val_f1_mic= 0.41539 val_f1_mac= 0.13696 time= 0.13766
Epoch: 0005
Iter: 0004 train_loss= 0.52263 train_f1_mic= 0.40419 train_f1_mac= 0.12153 val_loss= 0.54797 val_f1_mic= 0.42949 val_f1_mac= 0.14003 time= 0.13719
Iter: 0009 train_loss= 0.53657 train_f1_mic= 0.43184 train_f1_mac= 0.14155 val_loss= 0.54797 val_f1_mic= 0.42949 val_f1_mac= 0.14003 time= 0.13627
Iter: 0014 train_loss= 0.52659 train_f1_mic= 0.40461 train_f1_mac= 0.13133 val_loss= 0.54797 val_f1_mic= 0.42949 val_f1_mac= 0.14003 time= 0.13564
Epoch: 0006
Iter: 0000 train_loss= 0.52977 train_f1_mic= 0.43195 train_f1_mac= 0.14529 val_loss= 0.55749 val_f1_mic= 0.42244 val_f1_mac= 0.14807 time= 0.13536
Iter: 0005 train_loss= 0.51495 train_f1_mic= 0.42249 train_f1_mac= 0.13745 val_loss= 0.55749 val_f1_mic= 0.42244 val_f1_mac= 0.14807 time= 0.13474
Iter: 0010 train_loss= 0.52226 train_f1_mic= 0.44085 train_f1_mac= 0.15118 val_loss= 0.55749 val_f1_mic= 0.42244 val_f1_mac= 0.14807 time= 0.13412
Iter: 0015 train_loss= 0.51775 train_f1_mic= 0.43709 train_f1_mac= 0.15151 val_loss= 0.55749 val_f1_mic= 0.42244 val_f1_mac= 0.14807 time= 0.13362
Epoch: 0007
Iter: 0001 train_loss= 0.50895 train_f1_mic= 0.44706 train_f1_mac= 0.16295 val_loss= 0.54036 val_f1_mic= 0.44891 val_f1_mac= 0.17438 time= 0.13346
Iter: 0006 train_loss= 0.52803 train_f1_mic= 0.42757 train_f1_mac= 0.15864 val_loss= 0.54036 val_f1_mic= 0.44891 val_f1_mac= 0.17438 time= 0.13300
Iter: 0011 train_loss= 0.50584 train_f1_mic= 0.44617 train_f1_mac= 0.16927 val_loss= 0.54036 val_f1_mic= 0.44891 val_f1_mac= 0.17438 time= 0.13256
Iter: 0016 train_loss= 0.51486 train_f1_mic= 0.47492 train_f1_mac= 0.20752 val_loss= 0.54036 val_f1_mic= 0.44891 val_f1_mac= 0.17438 time= 0.13217
Epoch: 0008
Iter: 0002 train_loss= 0.52015 train_f1_mic= 0.47697 train_f1_mac= 0.21356 val_loss= 0.53683 val_f1_mic= 0.49950 val_f1_mac= 0.24076 time= 0.13210
Iter: 0007 train_loss= 0.51867 train_f1_mic= 0.44418 train_f1_mac= 0.18500 val_loss= 0.53683 val_f1_mic= 0.49950 val_f1_mac= 0.24076 time= 0.13177
Iter: 0012 train_loss= 0.50079 train_f1_mic= 0.44300 train_f1_mac= 0.17018 val_loss= 0.53683 val_f1_mic= 0.49950 val_f1_mac= 0.24076 time= 0.13149
Iter: 0017 train_loss= 0.51893 train_f1_mic= 0.46369 train_f1_mac= 0.20069 val_loss= 0.53683 val_f1_mic= 0.49950 val_f1_mac= 0.24076 time= 0.13119
Epoch: 0009
Iter: 0003 train_loss= 0.51788 train_f1_mic= 0.42193 train_f1_mac= 0.16666 val_loss= 0.53299 val_f1_mic= 0.48116 val_f1_mac= 0.22262 time= 0.13131
Iter: 0008 train_loss= 0.50298 train_f1_mic= 0.48671 train_f1_mac= 0.22379 val_loss= 0.53299 val_f1_mic= 0.48116 val_f1_mac= 0.22262 time= 0.13105
Iter: 0013 train_loss= 0.50970 train_f1_mic= 0.45671 train_f1_mac= 0.20398 val_loss= 0.53299 val_f1_mic= 0.48116 val_f1_mac= 0.22262 time= 0.13082
Iter: 0018 train_loss= 0.51544 train_f1_mic= 0.46655 train_f1_mac= 0.19985 val_loss= 0.53299 val_f1_mic= 0.48116 val_f1_mac= 0.22262 time= 0.13059
Epoch: 0010
Iter: 0004 train_loss= 0.51482 train_f1_mic= 0.46042 train_f1_mac= 0.19962 val_loss= 0.52942 val_f1_mic= 0.47922 val_f1_mac= 0.22898 time= 0.13063
Iter: 0009 train_loss= 0.52279 train_f1_mic= 0.47747 train_f1_mac= 0.21681 val_loss= 0.52942 val_f1_mic= 0.47922 val_f1_mac= 0.22898 time= 0.13042
Iter: 0014 train_loss= 0.49694 train_f1_mic= 0.46762 train_f1_mac= 0.21449 val_loss= 0.52942 val_f1_mic= 0.47922 val_f1_mac= 0.22898 time= 0.13021
Optimization Finished!
Full validation stats: loss= 0.52522 f1_micro= 0.50607 f1_macro= 0.25818 time= 0.26426
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4596394847527967
Rewards :  0.04235312725271029 Accuracy :  0.49352198655496493
Total reward :  1.2419331839474141
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'linear', 4, 'sigmoid']
Training RNN (Reward ip) :  [0.04235313]
Trial 242: Controller loss : 12503.292969

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [2, 'relu', 2, 'relu']
2018-08-31 00:46:59.196598: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:46:59.196905: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:46:59.197214: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:46:59.197447: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:46:59.197741: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69331 train_f1_mic= 0.37027 train_f1_mac= 0.30033 val_loss= 0.66451 val_f1_mic= 0.37226 val_f1_mac= 0.10736 time= 0.89191
Iter: 0005 train_loss= 0.57946 train_f1_mic= 0.38289 train_f1_mac= 0.09002 val_loss= 0.66451 val_f1_mic= 0.37226 val_f1_mac= 0.10736 time= 0.18705
Iter: 0010 train_loss= 0.55056 train_f1_mic= 0.37801 train_f1_mac= 0.09228 val_loss= 0.66451 val_f1_mic= 0.37226 val_f1_mac= 0.10736 time= 0.12224
Iter: 0015 train_loss= 0.54612 train_f1_mic= 0.37307 train_f1_mac= 0.08848 val_loss= 0.66451 val_f1_mic= 0.37226 val_f1_mac= 0.10736 time= 0.09825
Epoch: 0002
Iter: 0001 train_loss= 0.55495 train_f1_mic= 0.38430 train_f1_mac= 0.09899 val_loss= 0.57782 val_f1_mic= 0.38206 val_f1_mac= 0.10175 time= 0.08677
Iter: 0006 train_loss= 0.53375 train_f1_mic= 0.37606 train_f1_mac= 0.08720 val_loss= 0.57782 val_f1_mic= 0.38206 val_f1_mac= 0.10175 time= 0.07883
Iter: 0011 train_loss= 0.54065 train_f1_mic= 0.37058 train_f1_mac= 0.08711 val_loss= 0.57782 val_f1_mic= 0.38206 val_f1_mac= 0.10175 time= 0.07355
Iter: 0016 train_loss= 0.54691 train_f1_mic= 0.38421 train_f1_mac= 0.09419 val_loss= 0.57782 val_f1_mic= 0.38206 val_f1_mac= 0.10175 time= 0.06943
Epoch: 0003
Iter: 0002 train_loss= 0.54933 train_f1_mic= 0.39159 train_f1_mac= 0.10213 val_loss= 0.55905 val_f1_mic= 0.38246 val_f1_mac= 0.09948 time= 0.06688
Iter: 0007 train_loss= 0.55081 train_f1_mic= 0.37875 train_f1_mac= 0.09430 val_loss= 0.55905 val_f1_mic= 0.38246 val_f1_mac= 0.09948 time= 0.06455
Iter: 0012 train_loss= 0.53918 train_f1_mic= 0.37287 train_f1_mac= 0.08795 val_loss= 0.55905 val_f1_mic= 0.38246 val_f1_mac= 0.09948 time= 0.06248
Iter: 0017 train_loss= 0.54416 train_f1_mic= 0.37022 train_f1_mac= 0.08783 val_loss= 0.55905 val_f1_mic= 0.38246 val_f1_mac= 0.09948 time= 0.06091
Epoch: 0004
Iter: 0003 train_loss= 0.54454 train_f1_mic= 0.37031 train_f1_mac= 0.08987 val_loss= 0.57923 val_f1_mic= 0.35289 val_f1_mac= 0.09190 time= 0.06012
Iter: 0008 train_loss= 0.54285 train_f1_mic= 0.36791 train_f1_mac= 0.08736 val_loss= 0.57923 val_f1_mic= 0.35289 val_f1_mac= 0.09190 time= 0.05904
Iter: 0013 train_loss= 0.54461 train_f1_mic= 0.37685 train_f1_mac= 0.09408 val_loss= 0.57923 val_f1_mic= 0.35289 val_f1_mac= 0.09190 time= 0.05817
Iter: 0018 train_loss= 0.53430 train_f1_mic= 0.38084 train_f1_mac= 0.09258 val_loss= 0.57923 val_f1_mic= 0.35289 val_f1_mac= 0.09190 time= 0.05721
Epoch: 0005
Iter: 0004 train_loss= 0.53079 train_f1_mic= 0.37553 train_f1_mac= 0.09011 val_loss= 0.56757 val_f1_mic= 0.36125 val_f1_mac= 0.09323 time= 0.05696
Iter: 0009 train_loss= 0.53262 train_f1_mic= 0.37891 train_f1_mac= 0.09382 val_loss= 0.56757 val_f1_mic= 0.36125 val_f1_mac= 0.09323 time= 0.05624
Iter: 0014 train_loss= 0.53165 train_f1_mic= 0.38458 train_f1_mac= 0.09843 val_loss= 0.56757 val_f1_mic= 0.36125 val_f1_mac= 0.09323 time= 0.05560
Epoch: 0006
Iter: 0000 train_loss= 0.53380 train_f1_mic= 0.39263 train_f1_mac= 0.11391 val_loss= 0.55974 val_f1_mic= 0.39008 val_f1_mac= 0.11797 time= 0.05531
Iter: 0005 train_loss= 0.52875 train_f1_mic= 0.42005 train_f1_mac= 0.12839 val_loss= 0.55974 val_f1_mic= 0.39008 val_f1_mac= 0.11797 time= 0.05476
Iter: 0010 train_loss= 0.53158 train_f1_mic= 0.40216 train_f1_mac= 0.12357 val_loss= 0.55974 val_f1_mic= 0.39008 val_f1_mac= 0.11797 time= 0.05424
Iter: 0015 train_loss= 0.54570 train_f1_mic= 0.40811 train_f1_mac= 0.13033 val_loss= 0.55974 val_f1_mic= 0.39008 val_f1_mac= 0.11797 time= 0.05390
Epoch: 0007
Iter: 0001 train_loss= 0.52219 train_f1_mic= 0.41607 train_f1_mac= 0.12888 val_loss= 0.55041 val_f1_mic= 0.41306 val_f1_mac= 0.13402 time= 0.05386
Iter: 0006 train_loss= 0.53218 train_f1_mic= 0.40523 train_f1_mac= 0.12942 val_loss= 0.55041 val_f1_mic= 0.41306 val_f1_mac= 0.13402 time= 0.05350
Iter: 0011 train_loss= 0.53557 train_f1_mic= 0.42521 train_f1_mac= 0.14400 val_loss= 0.55041 val_f1_mic= 0.41306 val_f1_mac= 0.13402 time= 0.05315
Iter: 0016 train_loss= 0.52568 train_f1_mic= 0.44772 train_f1_mac= 0.15698 val_loss= 0.55041 val_f1_mic= 0.41306 val_f1_mac= 0.13402 time= 0.05286
Epoch: 0008
Iter: 0002 train_loss= 0.52941 train_f1_mic= 0.41990 train_f1_mac= 0.14281 val_loss= 0.54566 val_f1_mic= 0.40694 val_f1_mac= 0.12886 time= 0.05283
Iter: 0007 train_loss= 0.53663 train_f1_mic= 0.41028 train_f1_mac= 0.13542 val_loss= 0.54566 val_f1_mic= 0.40694 val_f1_mac= 0.12886 time= 0.05250
Iter: 0012 train_loss= 0.53429 train_f1_mic= 0.40515 train_f1_mac= 0.13486 val_loss= 0.54566 val_f1_mic= 0.40694 val_f1_mac= 0.12886 time= 0.05229
Iter: 0017 train_loss= 0.52110 train_f1_mic= 0.44403 train_f1_mac= 0.15543 val_loss= 0.54566 val_f1_mic= 0.40694 val_f1_mac= 0.12886 time= 0.05201
Epoch: 0009
Iter: 0003 train_loss= 0.52355 train_f1_mic= 0.43649 train_f1_mac= 0.15194 val_loss= 0.55438 val_f1_mic= 0.43799 val_f1_mac= 0.16197 time= 0.05205
Iter: 0008 train_loss= 0.52195 train_f1_mic= 0.43542 train_f1_mac= 0.16642 val_loss= 0.55438 val_f1_mic= 0.43799 val_f1_mac= 0.16197 time= 0.05187
Iter: 0013 train_loss= 0.53001 train_f1_mic= 0.41731 train_f1_mac= 0.15629 val_loss= 0.55438 val_f1_mic= 0.43799 val_f1_mac= 0.16197 time= 0.05169
Iter: 0018 train_loss= 0.51137 train_f1_mic= 0.42356 train_f1_mac= 0.15401 val_loss= 0.55438 val_f1_mic= 0.43799 val_f1_mac= 0.16197 time= 0.05148
Epoch: 0010
Iter: 0004 train_loss= 0.52118 train_f1_mic= 0.45552 train_f1_mac= 0.18137 val_loss= 0.53980 val_f1_mic= 0.43777 val_f1_mac= 0.17357 time= 0.05153
Iter: 0009 train_loss= 0.51544 train_f1_mic= 0.44281 train_f1_mac= 0.18527 val_loss= 0.53980 val_f1_mic= 0.43777 val_f1_mac= 0.17357 time= 0.05134
Iter: 0014 train_loss= 0.50861 train_f1_mic= 0.46094 train_f1_mac= 0.19599 val_loss= 0.53980 val_f1_mic= 0.43777 val_f1_mac= 0.17357 time= 0.05115
Optimization Finished!
Full validation stats: loss= 0.53361 f1_micro= 0.47625 f1_macro= 0.21789 time= 0.14362
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4609521008276579
Rewards :  0.0065630803743059185 Accuracy :  0.4662025651271026
Total reward :  1.2484962643217201
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'relu', 2, 'relu']
Training RNN (Reward ip) :  [0.00656308]
Trial 243: Controller loss : 4160.704102

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [1, 'linear', 3, 'linear']
2018-08-31 00:47:15.183194: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:47:15.183632: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:47:15.184051: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:47:15.184357: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:47:15.184740: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69286 train_f1_mic= 0.36724 train_f1_mac= 0.30612 val_loss= 0.67063 val_f1_mic= 0.36008 val_f1_mac= 0.13737 time= 1.36069
Iter: 0005 train_loss= 0.58047 train_f1_mic= 0.37171 train_f1_mac= 0.08731 val_loss= 0.67063 val_f1_mic= 0.36008 val_f1_mac= 0.13737 time= 0.32966
Iter: 0010 train_loss= 0.54603 train_f1_mic= 0.40255 train_f1_mac= 0.10291 val_loss= 0.67063 val_f1_mic= 0.36008 val_f1_mac= 0.13737 time= 0.23548
Iter: 0015 train_loss= 0.54872 train_f1_mic= 0.38636 train_f1_mac= 0.09421 val_loss= 0.67063 val_f1_mic= 0.36008 val_f1_mac= 0.13737 time= 0.20022
Epoch: 0002
Iter: 0001 train_loss= 0.55249 train_f1_mic= 0.38018 train_f1_mac= 0.09457 val_loss= 0.56417 val_f1_mic= 0.37494 val_f1_mac= 0.09550 time= 0.18409
Iter: 0006 train_loss= 0.52925 train_f1_mic= 0.38732 train_f1_mac= 0.09150 val_loss= 0.56417 val_f1_mic= 0.37494 val_f1_mac= 0.09550 time= 0.17293
Iter: 0011 train_loss= 0.54595 train_f1_mic= 0.38593 train_f1_mac= 0.09778 val_loss= 0.56417 val_f1_mic= 0.37494 val_f1_mac= 0.09550 time= 0.16527
Iter: 0016 train_loss= 0.54694 train_f1_mic= 0.39081 train_f1_mac= 0.10718 val_loss= 0.56417 val_f1_mic= 0.37494 val_f1_mac= 0.09550 time= 0.16018
Epoch: 0003
Iter: 0002 train_loss= 0.52797 train_f1_mic= 0.37971 train_f1_mac= 0.09551 val_loss= 0.55988 val_f1_mic= 0.36823 val_f1_mac= 0.09798 time= 0.15712
Iter: 0007 train_loss= 0.54180 train_f1_mic= 0.39830 train_f1_mac= 0.12122 val_loss= 0.55988 val_f1_mic= 0.36823 val_f1_mac= 0.09798 time= 0.15365
Iter: 0012 train_loss= 0.52731 train_f1_mic= 0.40865 train_f1_mac= 0.12339 val_loss= 0.55988 val_f1_mic= 0.36823 val_f1_mac= 0.09798 time= 0.15091
Iter: 0017 train_loss= 0.52857 train_f1_mic= 0.41860 train_f1_mac= 0.12941 val_loss= 0.55988 val_f1_mic= 0.36823 val_f1_mac= 0.09798 time= 0.14855
Epoch: 0004
Iter: 0003 train_loss= 0.53410 train_f1_mic= 0.40673 train_f1_mac= 0.12965 val_loss= 0.54273 val_f1_mic= 0.40669 val_f1_mac= 0.13368 time= 0.14734
Iter: 0008 train_loss= 0.53909 train_f1_mic= 0.39226 train_f1_mac= 0.12564 val_loss= 0.54273 val_f1_mic= 0.40669 val_f1_mac= 0.13368 time= 0.14564
Iter: 0013 train_loss= 0.52672 train_f1_mic= 0.41088 train_f1_mac= 0.12199 val_loss= 0.54273 val_f1_mic= 0.40669 val_f1_mac= 0.13368 time= 0.14417
Iter: 0018 train_loss= 0.52166 train_f1_mic= 0.42448 train_f1_mac= 0.13719 val_loss= 0.54273 val_f1_mic= 0.40669 val_f1_mac= 0.13368 time= 0.14293
Epoch: 0005
Iter: 0004 train_loss= 0.52571 train_f1_mic= 0.45522 train_f1_mac= 0.17595 val_loss= 0.55094 val_f1_mic= 0.39624 val_f1_mac= 0.13075 time= 0.14250
Iter: 0009 train_loss= 0.52162 train_f1_mic= 0.43973 train_f1_mac= 0.17132 val_loss= 0.55094 val_f1_mic= 0.39624 val_f1_mac= 0.13075 time= 0.14162
Iter: 0014 train_loss= 0.52899 train_f1_mic= 0.43334 train_f1_mac= 0.16411 val_loss= 0.55094 val_f1_mic= 0.39624 val_f1_mac= 0.13075 time= 0.14074
Epoch: 0006
Iter: 0000 train_loss= 0.51457 train_f1_mic= 0.44174 train_f1_mac= 0.15744 val_loss= 0.53905 val_f1_mic= 0.41324 val_f1_mac= 0.15087 time= 0.14040
Iter: 0005 train_loss= 0.51585 train_f1_mic= 0.45804 train_f1_mac= 0.19545 val_loss= 0.53905 val_f1_mic= 0.41324 val_f1_mac= 0.15087 time= 0.13967
Iter: 0010 train_loss= 0.52795 train_f1_mic= 0.44404 train_f1_mac= 0.16973 val_loss= 0.53905 val_f1_mic= 0.41324 val_f1_mac= 0.15087 time= 0.13900
Iter: 0015 train_loss= 0.51576 train_f1_mic= 0.45258 train_f1_mac= 0.18981 val_loss= 0.53905 val_f1_mic= 0.41324 val_f1_mac= 0.15087 time= 0.13840
Epoch: 0007
Iter: 0001 train_loss= 0.52403 train_f1_mic= 0.45262 train_f1_mac= 0.17341 val_loss= 0.52810 val_f1_mic= 0.47243 val_f1_mac= 0.20668 time= 0.13821
Iter: 0006 train_loss= 0.51647 train_f1_mic= 0.45464 train_f1_mac= 0.19352 val_loss= 0.52810 val_f1_mic= 0.47243 val_f1_mac= 0.20668 time= 0.13773
Iter: 0011 train_loss= 0.51221 train_f1_mic= 0.46286 train_f1_mac= 0.18785 val_loss= 0.52810 val_f1_mic= 0.47243 val_f1_mac= 0.20668 time= 0.13730
Iter: 0016 train_loss= 0.51617 train_f1_mic= 0.44987 train_f1_mac= 0.19109 val_loss= 0.52810 val_f1_mic= 0.47243 val_f1_mac= 0.20668 time= 0.13690
Epoch: 0008
Iter: 0002 train_loss= 0.51099 train_f1_mic= 0.45407 train_f1_mac= 0.17831 val_loss= 0.53127 val_f1_mic= 0.46818 val_f1_mac= 0.19382 time= 0.13688
Iter: 0007 train_loss= 0.51408 train_f1_mic= 0.43745 train_f1_mac= 0.17263 val_loss= 0.53127 val_f1_mic= 0.46818 val_f1_mac= 0.19382 time= 0.13652
Iter: 0012 train_loss= 0.51908 train_f1_mic= 0.45884 train_f1_mac= 0.19843 val_loss= 0.53127 val_f1_mic= 0.46818 val_f1_mac= 0.19382 time= 0.13617
Iter: 0017 train_loss= 0.51235 train_f1_mic= 0.43223 train_f1_mac= 0.16193 val_loss= 0.53127 val_f1_mic= 0.46818 val_f1_mac= 0.19382 time= 0.13583
Epoch: 0009
Iter: 0003 train_loss= 0.50580 train_f1_mic= 0.42611 train_f1_mac= 0.16059 val_loss= 0.55261 val_f1_mic= 0.46916 val_f1_mac= 0.21937 time= 0.13577
Iter: 0008 train_loss= 0.52440 train_f1_mic= 0.46044 train_f1_mac= 0.20311 val_loss= 0.55261 val_f1_mic= 0.46916 val_f1_mac= 0.21937 time= 0.13552
Iter: 0013 train_loss= 0.50969 train_f1_mic= 0.44080 train_f1_mac= 0.18190 val_loss= 0.55261 val_f1_mic= 0.46916 val_f1_mac= 0.21937 time= 0.13526
Iter: 0018 train_loss= 0.52163 train_f1_mic= 0.43221 train_f1_mac= 0.17047 val_loss= 0.55261 val_f1_mic= 0.46916 val_f1_mac= 0.21937 time= 0.13496
Epoch: 0010
Iter: 0004 train_loss= 0.50650 train_f1_mic= 0.46746 train_f1_mac= 0.20201 val_loss= 0.53515 val_f1_mic= 0.45643 val_f1_mac= 0.20397 time= 0.13501
Iter: 0009 train_loss= 0.51730 train_f1_mic= 0.45461 train_f1_mac= 0.19951 val_loss= 0.53515 val_f1_mic= 0.45643 val_f1_mac= 0.20397 time= 0.13479
Iter: 0014 train_loss= 0.52284 train_f1_mic= 0.44370 train_f1_mac= 0.19539 val_loss= 0.53515 val_f1_mic= 0.45643 val_f1_mac= 0.20397 time= 0.13464
Optimization Finished!
Full validation stats: loss= 0.53334 f1_micro= 0.45763 f1_macro= 0.20595 time= 0.29524
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4604485894724598
Rewards :  -0.002517556775990415 Accuracy :  0.4584345440516675
Total reward :  1.2459787075457296
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'linear', 3, 'linear']
Training RNN (Reward ip) :  [-0.00251756]
Trial 244: Controller loss : 9973.214844

Prediction action from Controller
State input to Controller for Action :  [0. 2. 0. 0. 0.]
2018-08-31 00:47:47.899799: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:47:47.900186: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:47:47.900570: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:47:47.900853: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:47:47.901199: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
Epoch: 0001
Iter: 0000 train_loss= 0.69219 train_f1_mic= 0.39349 train_f1_mac= 0.31107 val_loss= 0.66606 val_f1_mic= 0.37854 val_f1_mac= 0.11169 time= 0.75334
Iter: 0005 train_loss= 0.58438 train_f1_mic= 0.37714 train_f1_mac= 0.08899 val_loss= 0.66606 val_f1_mic= 0.37854 val_f1_mac= 0.11169 time= 0.13884
Iter: 0010 train_loss= 0.55674 train_f1_mic= 0.36976 train_f1_mac= 0.09312 val_loss= 0.66606 val_f1_mic= 0.37854 val_f1_mac= 0.11169 time= 0.08317
Iter: 0015 train_loss= 0.54102 train_f1_mic= 0.41459 train_f1_mac= 0.10837 val_loss= 0.66606 val_f1_mic= 0.37854 val_f1_mac= 0.11169 time= 0.06192
Epoch: 0002
Iter: 0001 train_loss= 0.53394 train_f1_mic= 0.38582 train_f1_mac= 0.09532 val_loss= 0.55640 val_f1_mic= 0.36614 val_f1_mac= 0.09529 time= 0.05273
Iter: 0006 train_loss= 0.54733 train_f1_mic= 0.36761 train_f1_mac= 0.08879 val_loss= 0.55640 val_f1_mic= 0.36614 val_f1_mac= 0.09529 time= 0.04581
Iter: 0011 train_loss= 0.54187 train_f1_mic= 0.37763 train_f1_mac= 0.09542 val_loss= 0.55640 val_f1_mic= 0.36614 val_f1_mac= 0.09529 time= 0.04080
Iter: 0016 train_loss= 0.53551 train_f1_mic= 0.39546 train_f1_mac= 0.10444 val_loss= 0.55640 val_f1_mic= 0.36614 val_f1_mac= 0.09529 time= 0.03735
Epoch: 0003
Iter: 0002 train_loss= 0.52917 train_f1_mic= 0.38746 train_f1_mac= 0.10536 val_loss= 0.55047 val_f1_mic= 0.40268 val_f1_mac= 0.11434 time= 0.03545
Iter: 0007 train_loss= 0.53847 train_f1_mic= 0.37396 train_f1_mac= 0.10337 val_loss= 0.55047 val_f1_mic= 0.40268 val_f1_mac= 0.11434 time= 0.03324
Iter: 0012 train_loss= 0.54432 train_f1_mic= 0.39363 train_f1_mac= 0.11908 val_loss= 0.55047 val_f1_mic= 0.40268 val_f1_mac= 0.11434 time= 0.03163
Iter: 0017 train_loss= 0.51933 train_f1_mic= 0.42626 train_f1_mac= 0.13111 val_loss= 0.55047 val_f1_mic= 0.40268 val_f1_mac= 0.11434 time= 0.03012
Epoch: 0004
Iter: 0003 train_loss= 0.53028 train_f1_mic= 0.42299 train_f1_mac= 0.13576 val_loss= 0.55187 val_f1_mic= 0.41915 val_f1_mac= 0.13377 time= 0.02914
Iter: 0008 train_loss= 0.51112 train_f1_mic= 0.40407 train_f1_mac= 0.12323 val_loss= 0.55187 val_f1_mic= 0.41915 val_f1_mac= 0.13377 time= 0.02819
Iter: 0013 train_loss= 0.52577 train_f1_mic= 0.43081 train_f1_mac= 0.14404 val_loss= 0.55187 val_f1_mic= 0.41915 val_f1_mac= 0.13377 time= 0.02734
Iter: 0018 train_loss= 0.52448 train_f1_mic= 0.44065 train_f1_mac= 0.15108 val_loss= 0.55187 val_f1_mic= 0.41915 val_f1_mac= 0.13377 time= 0.02664
Epoch: 0005
Iter: 0004 train_loss= 0.53109 train_f1_mic= 0.42296 train_f1_mac= 0.14842 val_loss= 0.53957 val_f1_mic= 0.43384 val_f1_mac= 0.15016 time= 0.02631
Iter: 0009 train_loss= 0.52245 train_f1_mic= 0.42953 train_f1_mac= 0.15223 val_loss= 0.53957 val_f1_mic= 0.43384 val_f1_mac= 0.15016 time= 0.02576
Iter: 0014 train_loss= 0.51579 train_f1_mic= 0.44960 train_f1_mac= 0.16336 val_loss= 0.53957 val_f1_mic= 0.43384 val_f1_mac= 0.15016 time= 0.02522
Epoch: 0006
Iter: 0000 train_loss= 0.52890 train_f1_mic= 0.44574 train_f1_mac= 0.16992 val_loss= 0.55031 val_f1_mic= 0.45176 val_f1_mac= 0.18651 time= 0.02492
Iter: 0005 train_loss= 0.51594 train_f1_mic= 0.44821 train_f1_mac= 0.17926 val_loss= 0.55031 val_f1_mic= 0.45176 val_f1_mac= 0.18651 time= 0.02440
Iter: 0010 train_loss= 0.50918 train_f1_mic= 0.43641 train_f1_mac= 0.16761 val_loss= 0.55031 val_f1_mic= 0.45176 val_f1_mac= 0.18651 time= 0.02405
Iter: 0015 train_loss= 0.51016 train_f1_mic= 0.45071 train_f1_mac= 0.18140 val_loss= 0.55031 val_f1_mic= 0.45176 val_f1_mac= 0.18651 time= 0.02363
Epoch: 0007
Iter: 0001 train_loss= 0.50555 train_f1_mic= 0.45998 train_f1_mac= 0.19047 val_loss= 0.52738 val_f1_mic= 0.46565 val_f1_mac= 0.20437 time= 0.02352
Iter: 0006 train_loss= 0.50987 train_f1_mic= 0.47509 train_f1_mac= 0.20861 val_loss= 0.52738 val_f1_mic= 0.46565 val_f1_mac= 0.20437 time= 0.02323
Iter: 0011 train_loss= 0.49345 train_f1_mic= 0.46432 train_f1_mac= 0.20734 val_loss= 0.52738 val_f1_mic= 0.46565 val_f1_mac= 0.20437 time= 0.02291
Iter: 0016 train_loss= 0.52007 train_f1_mic= 0.45410 train_f1_mac= 0.19764 val_loss= 0.52738 val_f1_mic= 0.46565 val_f1_mac= 0.20437 time= 0.02268
Epoch: 0008
Iter: 0002 train_loss= 0.50365 train_f1_mic= 0.47275 train_f1_mac= 0.21854 val_loss= 0.53209 val_f1_mic= 0.46532 val_f1_mac= 0.23401 time= 0.02251
Iter: 0007 train_loss= 0.51020 train_f1_mic= 0.49811 train_f1_mac= 0.24357 val_loss= 0.53209 val_f1_mic= 0.46532 val_f1_mac= 0.23401 time= 0.02227
Iter: 0012 train_loss= 0.49405 train_f1_mic= 0.48163 train_f1_mac= 0.23919 val_loss= 0.53209 val_f1_mic= 0.46532 val_f1_mac= 0.23401 time= 0.02208
Iter: 0017 train_loss= 0.49852 train_f1_mic= 0.51539 train_f1_mac= 0.26432 val_loss= 0.53209 val_f1_mic= 0.46532 val_f1_mac= 0.23401 time= 0.02186
Epoch: 0009
Iter: 0003 train_loss= 0.49308 train_f1_mic= 0.48256 train_f1_mac= 0.23881 val_loss= 0.51640 val_f1_mic= 0.42052 val_f1_mac= 0.18275 time= 0.02186
Iter: 0008 train_loss= 0.50111 train_f1_mic= 0.45940 train_f1_mac= 0.20873 val_loss= 0.51640 val_f1_mic= 0.42052 val_f1_mac= 0.18275 time= 0.02171
Iter: 0013 train_loss= 0.50210 train_f1_mic= 0.50198 train_f1_mac= 0.25917 val_loss= 0.51640 val_f1_mic= 0.42052 val_f1_mac= 0.18275 time= 0.02156
Iter: 0018 train_loss= 0.50508 train_f1_mic= 0.50612 train_f1_mac= 0.26467 val_loss= 0.51640 val_f1_mic= 0.42052 val_f1_mac= 0.18275 time= 0.02139
Epoch: 0010
Iter: 0004 train_loss= 0.48681 train_f1_mic= 0.49778 train_f1_mac= 0.25131 val_loss= 0.50433 val_f1_mic= 0.51792 val_f1_mac= 0.28364 time= 0.02130
Iter: 0009 train_loss= 0.50256 train_f1_mic= 0.48424 train_f1_mac= 0.24570 val_loss= 0.50433 val_f1_mic= 0.51792 val_f1_mac= 0.28364 time= 0.02114
Iter: 0014 train_loss= 0.49564 train_f1_mic= 0.48040 train_f1_mac= 0.25581 val_loss= 0.50433 val_f1_mic= 0.51792 val_f1_mac= 0.28364 time= 0.02098
Optimization Finished!
Full validation stats: loss= 0.51394 f1_micro= 0.51503 f1_macro= 0.29273 time= 0.09774
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4705642769833732
Rewards :  0.050578437554567146 Accuracy :  0.511027027027027
Total reward :  1.2965571451002966
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.05057844]
Trial 245: Controller loss : 111.971191

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:47:57.552443: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:47:57.552739: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:47:57.553024: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:47:57.553245: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:47:57.553509: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69326 train_f1_mic= 0.38062 train_f1_mac= 0.29985 val_loss= 0.66433 val_f1_mic= 0.38554 val_f1_mac= 0.11954 time= 0.77338
Iter: 0005 train_loss= 0.59088 train_f1_mic= 0.36802 train_f1_mac= 0.08719 val_loss= 0.66433 val_f1_mic= 0.38554 val_f1_mac= 0.11954 time= 0.14237
Iter: 0010 train_loss= 0.53862 train_f1_mic= 0.38869 train_f1_mac= 0.09258 val_loss= 0.66433 val_f1_mic= 0.38554 val_f1_mac= 0.11954 time= 0.08464
Iter: 0015 train_loss= 0.52816 train_f1_mic= 0.42798 train_f1_mac= 0.10957 val_loss= 0.66433 val_f1_mic= 0.38554 val_f1_mac= 0.11954 time= 0.06323
Epoch: 0002
Iter: 0001 train_loss= 0.54293 train_f1_mic= 0.39852 train_f1_mac= 0.10494 val_loss= 0.57364 val_f1_mic= 0.38734 val_f1_mac= 0.10849 time= 0.05269
Iter: 0006 train_loss= 0.54338 train_f1_mic= 0.36795 train_f1_mac= 0.09371 val_loss= 0.57364 val_f1_mic= 0.38734 val_f1_mac= 0.10849 time= 0.04531
Iter: 0011 train_loss= 0.54062 train_f1_mic= 0.39438 train_f1_mac= 0.10211 val_loss= 0.57364 val_f1_mic= 0.38734 val_f1_mac= 0.10849 time= 0.04051
Iter: 0016 train_loss= 0.52766 train_f1_mic= 0.39593 train_f1_mac= 0.10507 val_loss= 0.57364 val_f1_mic= 0.38734 val_f1_mac= 0.10849 time= 0.03721
Epoch: 0003
Iter: 0002 train_loss= 0.53389 train_f1_mic= 0.39150 train_f1_mac= 0.11017 val_loss= 0.56604 val_f1_mic= 0.37487 val_f1_mac= 0.10910 time= 0.03547
Iter: 0007 train_loss= 0.53492 train_f1_mic= 0.40617 train_f1_mac= 0.12195 val_loss= 0.56604 val_f1_mic= 0.37487 val_f1_mac= 0.10910 time= 0.03335
Iter: 0012 train_loss= 0.52739 train_f1_mic= 0.41984 train_f1_mac= 0.13077 val_loss= 0.56604 val_f1_mic= 0.37487 val_f1_mac= 0.10910 time= 0.03149
Iter: 0017 train_loss= 0.52374 train_f1_mic= 0.41749 train_f1_mac= 0.12884 val_loss= 0.56604 val_f1_mic= 0.37487 val_f1_mac= 0.10910 time= 0.03003
Epoch: 0004
Iter: 0003 train_loss= 0.53682 train_f1_mic= 0.41827 train_f1_mac= 0.13488 val_loss= 0.54835 val_f1_mic= 0.41290 val_f1_mac= 0.13323 time= 0.02946
Iter: 0008 train_loss= 0.52008 train_f1_mic= 0.40745 train_f1_mac= 0.12701 val_loss= 0.54835 val_f1_mic= 0.41290 val_f1_mac= 0.13323 time= 0.02839
Iter: 0013 train_loss= 0.51752 train_f1_mic= 0.42988 train_f1_mac= 0.13928 val_loss= 0.54835 val_f1_mic= 0.41290 val_f1_mac= 0.13323 time= 0.02748
Iter: 0018 train_loss= 0.52568 train_f1_mic= 0.42950 train_f1_mac= 0.15184 val_loss= 0.54835 val_f1_mic= 0.41290 val_f1_mac= 0.13323 time= 0.02672
Epoch: 0005
Iter: 0004 train_loss= 0.52432 train_f1_mic= 0.43675 train_f1_mac= 0.16012 val_loss= 0.53011 val_f1_mic= 0.43790 val_f1_mac= 0.16723 time= 0.02620
Iter: 0009 train_loss= 0.52035 train_f1_mic= 0.44156 train_f1_mac= 0.16288 val_loss= 0.53011 val_f1_mic= 0.43790 val_f1_mac= 0.16723 time= 0.02556
Iter: 0014 train_loss= 0.51292 train_f1_mic= 0.44439 train_f1_mac= 0.17015 val_loss= 0.53011 val_f1_mic= 0.43790 val_f1_mac= 0.16723 time= 0.02494
Epoch: 0006
Iter: 0000 train_loss= 0.52494 train_f1_mic= 0.43932 train_f1_mac= 0.16904 val_loss= 0.52152 val_f1_mic= 0.46166 val_f1_mac= 0.19666 time= 0.02461
Iter: 0005 train_loss= 0.50290 train_f1_mic= 0.44250 train_f1_mac= 0.17191 val_loss= 0.52152 val_f1_mic= 0.46166 val_f1_mac= 0.19666 time= 0.02423
Iter: 0010 train_loss= 0.51157 train_f1_mic= 0.46970 train_f1_mac= 0.20739 val_loss= 0.52152 val_f1_mic= 0.46166 val_f1_mac= 0.19666 time= 0.02385
Iter: 0015 train_loss= 0.50262 train_f1_mic= 0.46784 train_f1_mac= 0.20282 val_loss= 0.52152 val_f1_mic= 0.46166 val_f1_mac= 0.19666 time= 0.02348
Epoch: 0007
Iter: 0001 train_loss= 0.51790 train_f1_mic= 0.46279 train_f1_mac= 0.20591 val_loss= 0.55571 val_f1_mic= 0.45655 val_f1_mac= 0.21144 time= 0.02329
Iter: 0006 train_loss= 0.50843 train_f1_mic= 0.44526 train_f1_mac= 0.18676 val_loss= 0.55571 val_f1_mic= 0.45655 val_f1_mac= 0.21144 time= 0.02294
Iter: 0011 train_loss= 0.50705 train_f1_mic= 0.49382 train_f1_mac= 0.23301 val_loss= 0.55571 val_f1_mic= 0.45655 val_f1_mac= 0.21144 time= 0.02263
Iter: 0016 train_loss= 0.50973 train_f1_mic= 0.47994 train_f1_mac= 0.22596 val_loss= 0.55571 val_f1_mic= 0.45655 val_f1_mac= 0.21144 time= 0.02238
Epoch: 0008
Iter: 0002 train_loss= 0.50084 train_f1_mic= 0.46382 train_f1_mac= 0.21498 val_loss= 0.51505 val_f1_mic= 0.46074 val_f1_mac= 0.22111 time= 0.02221
Iter: 0007 train_loss= 0.49947 train_f1_mic= 0.47994 train_f1_mac= 0.24270 val_loss= 0.51505 val_f1_mic= 0.46074 val_f1_mac= 0.22111 time= 0.02193
Iter: 0012 train_loss= 0.50461 train_f1_mic= 0.50146 train_f1_mac= 0.25443 val_loss= 0.51505 val_f1_mic= 0.46074 val_f1_mac= 0.22111 time= 0.02171
Iter: 0017 train_loss= 0.50989 train_f1_mic= 0.47006 train_f1_mac= 0.22021 val_loss= 0.51505 val_f1_mic= 0.46074 val_f1_mac= 0.22111 time= 0.02150
Epoch: 0009
Iter: 0003 train_loss= 0.50020 train_f1_mic= 0.46358 train_f1_mac= 0.21866 val_loss= 0.51742 val_f1_mic= 0.49743 val_f1_mac= 0.25234 time= 0.02150
Iter: 0008 train_loss= 0.50327 train_f1_mic= 0.50113 train_f1_mac= 0.25427 val_loss= 0.51742 val_f1_mic= 0.49743 val_f1_mac= 0.25234 time= 0.02126
Iter: 0013 train_loss= 0.51442 train_f1_mic= 0.49065 train_f1_mac= 0.25935 val_loss= 0.51742 val_f1_mic= 0.49743 val_f1_mac= 0.25234 time= 0.02110
Iter: 0018 train_loss= 0.50268 train_f1_mic= 0.45079 train_f1_mac= 0.20730 val_loss= 0.51742 val_f1_mic= 0.49743 val_f1_mac= 0.25234 time= 0.02091
Epoch: 0010
Iter: 0004 train_loss= 0.50923 train_f1_mic= 0.50340 train_f1_mac= 0.26507 val_loss= 0.52338 val_f1_mic= 0.50625 val_f1_mac= 0.28250 time= 0.02080
Iter: 0009 train_loss= 0.49862 train_f1_mic= 0.49885 train_f1_mac= 0.26208 val_loss= 0.52338 val_f1_mic= 0.50625 val_f1_mac= 0.28250 time= 0.02067
Iter: 0014 train_loss= 0.50443 train_f1_mic= 0.45995 train_f1_mac= 0.23590 val_loss= 0.52338 val_f1_mic= 0.50625 val_f1_mac= 0.28250 time= 0.02048
Optimization Finished!
Full validation stats: loss= 0.51210 f1_micro= 0.50566 f1_macro= 0.27905 time= 0.07878
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47731299913682157
Rewards :  0.03374361076724164 Accuracy :  0.5043078877506149
Total reward :  1.3303007558675382
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03374361]
Trial 246: Controller loss : 112.235939
2018-08-31 00:48:06.961847: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:48:06.962353: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:48:06.962829: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\c
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [0, 'linear', 3, 'linear']
ore\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:48:06.963489: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:48:06.963904: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69349 train_f1_mic= 0.37439 train_f1_mac= 0.31611 val_loss= 0.67226 val_f1_mic= 0.42098 val_f1_mac= 0.17295 time= 0.78385
Iter: 0005 train_loss= 0.59278 train_f1_mic= 0.38577 train_f1_mac= 0.09146 val_loss= 0.67226 val_f1_mic= 0.42098 val_f1_mac= 0.17295 time= 0.14162
Iter: 0010 train_loss= 0.55686 train_f1_mic= 0.37976 train_f1_mac= 0.09479 val_loss= 0.67226 val_f1_mic= 0.42098 val_f1_mac= 0.17295 time= 0.08396
Iter: 0015 train_loss= 0.53988 train_f1_mic= 0.37729 train_f1_mac= 0.09229 val_loss= 0.67226 val_f1_mic= 0.42098 val_f1_mac= 0.17295 time= 0.06208
Epoch: 0002
Iter: 0001 train_loss= 0.52491 train_f1_mic= 0.39771 train_f1_mac= 0.10412 val_loss= 0.58549 val_f1_mic= 0.37504 val_f1_mac= 0.10792 time= 0.05143
Iter: 0006 train_loss= 0.54430 train_f1_mic= 0.41245 train_f1_mac= 0.12066 val_loss= 0.58549 val_f1_mic= 0.37504 val_f1_mac= 0.10792 time= 0.04434
Iter: 0011 train_loss= 0.53466 train_f1_mic= 0.40432 train_f1_mac= 0.12190 val_loss= 0.58549 val_f1_mic= 0.37504 val_f1_mac= 0.10792 time= 0.03950
Iter: 0016 train_loss= 0.53296 train_f1_mic= 0.39111 train_f1_mac= 0.12007 val_loss= 0.58549 val_f1_mic= 0.37504 val_f1_mac= 0.10792 time= 0.03626
Epoch: 0003
Iter: 0002 train_loss= 0.53638 train_f1_mic= 0.38363 train_f1_mac= 0.10895 val_loss= 0.55846 val_f1_mic= 0.37824 val_f1_mac= 0.11139 time= 0.03437
Iter: 0007 train_loss= 0.53137 train_f1_mic= 0.41836 train_f1_mac= 0.12673 val_loss= 0.55846 val_f1_mic= 0.37824 val_f1_mac= 0.11139 time= 0.03213
Iter: 0012 train_loss= 0.53964 train_f1_mic= 0.42407 train_f1_mac= 0.14112 val_loss= 0.55846 val_f1_mic= 0.37824 val_f1_mac= 0.11139 time= 0.03041
Iter: 0017 train_loss= 0.52501 train_f1_mic= 0.40449 train_f1_mac= 0.12380 val_loss= 0.55846 val_f1_mic= 0.37824 val_f1_mac= 0.11139 time= 0.02893
Epoch: 0004
Iter: 0003 train_loss= 0.52477 train_f1_mic= 0.39081 train_f1_mac= 0.11098 val_loss= 0.57357 val_f1_mic= 0.37038 val_f1_mac= 0.11268 time= 0.02799
Iter: 0008 train_loss= 0.53935 train_f1_mic= 0.41525 train_f1_mac= 0.12645 val_loss= 0.57357 val_f1_mic= 0.37038 val_f1_mac= 0.11268 time= 0.02699
Iter: 0013 train_loss= 0.51906 train_f1_mic= 0.42684 train_f1_mac= 0.14617 val_loss= 0.57357 val_f1_mic= 0.37038 val_f1_mac= 0.11268 time= 0.02623
Iter: 0018 train_loss= 0.53545 train_f1_mic= 0.40536 train_f1_mac= 0.12533 val_loss= 0.57357 val_f1_mic= 0.37038 val_f1_mac= 0.11268 time= 0.02567
Epoch: 0005
Iter: 0004 train_loss= 0.53665 train_f1_mic= 0.40816 train_f1_mac= 0.13804 val_loss= 0.54221 val_f1_mic= 0.42515 val_f1_mac= 0.15695 time= 0.02551
Iter: 0009 train_loss= 0.52601 train_f1_mic= 0.42536 train_f1_mac= 0.14604 val_loss= 0.54221 val_f1_mic= 0.42515 val_f1_mac= 0.15695 time= 0.02483
Iter: 0014 train_loss= 0.53191 train_f1_mic= 0.42816 train_f1_mac= 0.14195 val_loss= 0.54221 val_f1_mic= 0.42515 val_f1_mac= 0.15695 time= 0.02420
Epoch: 0006
Iter: 0000 train_loss= 0.53239 train_f1_mic= 0.41838 train_f1_mac= 0.13790 val_loss= 0.54245 val_f1_mic= 0.42580 val_f1_mac= 0.15762 time= 0.02391
Iter: 0005 train_loss= 0.52009 train_f1_mic= 0.42059 train_f1_mac= 0.14395 val_loss= 0.54245 val_f1_mic= 0.42580 val_f1_mac= 0.15762 time= 0.02348
Iter: 0010 train_loss= 0.52167 train_f1_mic= 0.43504 train_f1_mac= 0.14864 val_loss= 0.54245 val_f1_mic= 0.42580 val_f1_mac= 0.15762 time= 0.02309
Iter: 0015 train_loss= 0.52942 train_f1_mic= 0.42883 train_f1_mac= 0.15849 val_loss= 0.54245 val_f1_mic= 0.42580 val_f1_mac= 0.15762 time= 0.02269
Epoch: 0007
Iter: 0001 train_loss= 0.52009 train_f1_mic= 0.44298 train_f1_mac= 0.16954 val_loss= 0.53300 val_f1_mic= 0.44432 val_f1_mac= 0.17545 time= 0.02247
Iter: 0006 train_loss= 0.53212 train_f1_mic= 0.43241 train_f1_mac= 0.16200 val_loss= 0.53300 val_f1_mic= 0.44432 val_f1_mac= 0.17545 time= 0.02218
Iter: 0011 train_loss= 0.52280 train_f1_mic= 0.41984 train_f1_mac= 0.14565 val_loss= 0.53300 val_f1_mic= 0.44432 val_f1_mac= 0.17545 time= 0.02187
Iter: 0016 train_loss= 0.52602 train_f1_mic= 0.44179 train_f1_mac= 0.17478 val_loss= 0.53300 val_f1_mic= 0.44432 val_f1_mac= 0.17545 time= 0.02157
Epoch: 0008
Iter: 0002 train_loss= 0.51825 train_f1_mic= 0.42325 train_f1_mac= 0.15458 val_loss= 0.53785 val_f1_mic= 0.40646 val_f1_mac= 0.14646 time= 0.02143
Iter: 0007 train_loss= 0.53164 train_f1_mic= 0.45153 train_f1_mac= 0.18891 val_loss= 0.53785 val_f1_mic= 0.40646 val_f1_mac= 0.14646 time= 0.02116
Iter: 0012 train_loss= 0.53171 train_f1_mic= 0.43091 train_f1_mac= 0.17445 val_loss= 0.53785 val_f1_mic= 0.40646 val_f1_mac= 0.14646 time= 0.02097
Iter: 0017 train_loss= 0.51577 train_f1_mic= 0.44035 train_f1_mac= 0.17091 val_loss= 0.53785 val_f1_mic= 0.40646 val_f1_mac= 0.14646 time= 0.02076
Epoch: 0009
Iter: 0003 train_loss= 0.52181 train_f1_mic= 0.45187 train_f1_mac= 0.19842 val_loss= 0.54251 val_f1_mic= 0.47792 val_f1_mac= 0.23318 time= 0.02079
Iter: 0008 train_loss= 0.51223 train_f1_mic= 0.47520 train_f1_mac= 0.22013 val_loss= 0.54251 val_f1_mic= 0.47792 val_f1_mac= 0.23318 time= 0.02056
Iter: 0013 train_loss= 0.51129 train_f1_mic= 0.47288 train_f1_mac= 0.21075 val_loss= 0.54251 val_f1_mic= 0.47792 val_f1_mac= 0.23318 time= 0.02041
Iter: 0018 train_loss= 0.50780 train_f1_mic= 0.46981 train_f1_mac= 0.21366 val_loss= 0.54251 val_f1_mic= 0.47792 val_f1_mac= 0.23318 time= 0.02024
Epoch: 0010
Iter: 0004 train_loss= 0.50585 train_f1_mic= 0.47105 train_f1_mac= 0.21999 val_loss= 0.53274 val_f1_mic= 0.46220 val_f1_mac= 0.21623 time= 0.02024
Iter: 0009 train_loss= 0.50694 train_f1_mic= 0.45540 train_f1_mac= 0.20178 val_loss= 0.53274 val_f1_mic= 0.46220 val_f1_mac= 0.21623 time= 0.02008
Iter: 0014 train_loss= 0.50248 train_f1_mic= 0.46390 train_f1_mac= 0.20962 val_loss= 0.53274 val_f1_mic= 0.46220 val_f1_mac= 0.21623 time= 0.01992
Optimization Finished!
Full validation stats: loss= 0.53134 f1_micro= 0.47785 f1_macro= 0.22069 time= 0.09375
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47770386168752044
Rewards :  0.0019543127534940585 Accuracy :  0.47926731189031563
Total reward :  1.3322550686210322
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'linear', 3, 'linear']
Training RNN (Reward ip) :  [0.00195431]
Trial 247: Controller loss : 8919.724609

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'tanh', 3, 'tanh']
2018-08-31 00:48:16.078509: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:48:16.078766: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:48:16.078989: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:48:16.079157: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:48:16.079379: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69534 train_f1_mic= 0.36786 train_f1_mac= 0.32365 val_loss= 0.67467 val_f1_mic= 0.41439 val_f1_mac= 0.19653 time= 1.30690
Iter: 0005 train_loss= 0.58829 train_f1_mic= 0.36434 train_f1_mac= 0.08805 val_loss= 0.67467 val_f1_mic= 0.41439 val_f1_mac= 0.19653 time= 0.32004
Iter: 0010 train_loss= 0.54304 train_f1_mic= 0.39469 train_f1_mac= 0.09797 val_loss= 0.67467 val_f1_mic= 0.41439 val_f1_mac= 0.19653 time= 0.23005
Iter: 0015 train_loss= 0.55026 train_f1_mic= 0.37818 train_f1_mac= 0.09336 val_loss= 0.67467 val_f1_mic= 0.41439 val_f1_mac= 0.19653 time= 0.19700
Epoch: 0002
Iter: 0001 train_loss= 0.54133 train_f1_mic= 0.39481 train_f1_mac= 0.09870 val_loss= 0.58749 val_f1_mic= 0.36671 val_f1_mac= 0.10031 time= 0.18154
Iter: 0006 train_loss= 0.54182 train_f1_mic= 0.37078 train_f1_mac= 0.08854 val_loss= 0.58749 val_f1_mic= 0.36671 val_f1_mac= 0.10031 time= 0.17029
Iter: 0011 train_loss= 0.54309 train_f1_mic= 0.38198 train_f1_mac= 0.09479 val_loss= 0.58749 val_f1_mic= 0.36671 val_f1_mac= 0.10031 time= 0.16258
Iter: 0016 train_loss= 0.53623 train_f1_mic= 0.39757 train_f1_mac= 0.10408 val_loss= 0.58749 val_f1_mic= 0.36671 val_f1_mac= 0.10031 time= 0.15701
Epoch: 0003
Iter: 0002 train_loss= 0.53676 train_f1_mic= 0.36761 train_f1_mac= 0.09030 val_loss= 0.57842 val_f1_mic= 0.35713 val_f1_mac= 0.09595 time= 0.15377
Iter: 0007 train_loss= 0.54765 train_f1_mic= 0.39055 train_f1_mac= 0.10733 val_loss= 0.57842 val_f1_mic= 0.35713 val_f1_mac= 0.09595 time= 0.15041
Iter: 0012 train_loss= 0.53605 train_f1_mic= 0.43672 train_f1_mac= 0.13383 val_loss= 0.57842 val_f1_mic= 0.35713 val_f1_mac= 0.09595 time= 0.14783
Iter: 0017 train_loss= 0.54058 train_f1_mic= 0.41871 train_f1_mac= 0.12741 val_loss= 0.57842 val_f1_mic= 0.35713 val_f1_mac= 0.09595 time= 0.14555
Epoch: 0004
Iter: 0003 train_loss= 0.53160 train_f1_mic= 0.39793 train_f1_mac= 0.11575 val_loss= 0.56036 val_f1_mic= 0.39481 val_f1_mac= 0.11690 time= 0.14428
Iter: 0008 train_loss= 0.53854 train_f1_mic= 0.41146 train_f1_mac= 0.12556 val_loss= 0.56036 val_f1_mic= 0.39481 val_f1_mac= 0.11690 time= 0.14262
Iter: 0013 train_loss= 0.54383 train_f1_mic= 0.41607 train_f1_mac= 0.13063 val_loss= 0.56036 val_f1_mic= 0.39481 val_f1_mac= 0.11690 time= 0.14122
Iter: 0018 train_loss= 0.53560 train_f1_mic= 0.39932 train_f1_mac= 0.11942 val_loss= 0.56036 val_f1_mic= 0.39481 val_f1_mac= 0.11690 time= 0.13993
Epoch: 0005
Iter: 0004 train_loss= 0.53267 train_f1_mic= 0.39219 train_f1_mac= 0.11356 val_loss= 0.56007 val_f1_mic= 0.38291 val_f1_mac= 0.11846 time= 0.13946
Iter: 0009 train_loss= 0.53900 train_f1_mic= 0.38355 train_f1_mac= 0.11365 val_loss= 0.56007 val_f1_mic= 0.38291 val_f1_mac= 0.11846 time= 0.13848
Iter: 0014 train_loss= 0.53024 train_f1_mic= 0.42815 train_f1_mac= 0.13120 val_loss= 0.56007 val_f1_mic= 0.38291 val_f1_mac= 0.11846 time= 0.13762
Epoch: 0006
Iter: 0000 train_loss= 0.53198 train_f1_mic= 0.42515 train_f1_mac= 0.13336 val_loss= 0.53610 val_f1_mic= 0.43355 val_f1_mac= 0.13582 time= 0.13725
Iter: 0005 train_loss= 0.54052 train_f1_mic= 0.39913 train_f1_mac= 0.12288 val_loss= 0.53610 val_f1_mic= 0.43355 val_f1_mac= 0.13582 time= 0.13663
Iter: 0010 train_loss= 0.52500 train_f1_mic= 0.40569 train_f1_mac= 0.12594 val_loss= 0.53610 val_f1_mic= 0.43355 val_f1_mac= 0.13582 time= 0.13594
Iter: 0015 train_loss= 0.54345 train_f1_mic= 0.41990 train_f1_mac= 0.13660 val_loss= 0.53610 val_f1_mic= 0.43355 val_f1_mac= 0.13582 time= 0.13533
Epoch: 0007
Iter: 0001 train_loss= 0.52950 train_f1_mic= 0.41315 train_f1_mac= 0.12866 val_loss= 0.54833 val_f1_mic= 0.41742 val_f1_mac= 0.13361 time= 0.13523
Iter: 0006 train_loss= 0.53808 train_f1_mic= 0.40673 train_f1_mac= 0.13052 val_loss= 0.54833 val_f1_mic= 0.41742 val_f1_mac= 0.13361 time= 0.13477
Iter: 0011 train_loss= 0.52768 train_f1_mic= 0.40659 train_f1_mac= 0.12997 val_loss= 0.54833 val_f1_mic= 0.41742 val_f1_mac= 0.13361 time= 0.13432
Iter: 0016 train_loss= 0.52945 train_f1_mic= 0.40652 train_f1_mac= 0.12109 val_loss= 0.54833 val_f1_mic= 0.41742 val_f1_mac= 0.13361 time= 0.13394
Epoch: 0008
Iter: 0002 train_loss= 0.53537 train_f1_mic= 0.41844 train_f1_mac= 0.13358 val_loss= 0.56690 val_f1_mic= 0.41727 val_f1_mac= 0.13743 time= 0.13388
Iter: 0007 train_loss= 0.53364 train_f1_mic= 0.42418 train_f1_mac= 0.14212 val_loss= 0.56690 val_f1_mic= 0.41727 val_f1_mac= 0.13743 time= 0.13354
Iter: 0012 train_loss= 0.53476 train_f1_mic= 0.41100 train_f1_mac= 0.14362 val_loss= 0.56690 val_f1_mic= 0.41727 val_f1_mac= 0.13743 time= 0.13321
Iter: 0017 train_loss= 0.52191 train_f1_mic= 0.41477 train_f1_mac= 0.13582 val_loss= 0.56690 val_f1_mic= 0.41727 val_f1_mac= 0.13743 time= 0.13291
Epoch: 0009
Iter: 0003 train_loss= 0.53064 train_f1_mic= 0.42857 train_f1_mac= 0.15074 val_loss= 0.53537 val_f1_mic= 0.41568 val_f1_mac= 0.14044 time= 0.13290
Iter: 0008 train_loss= 0.52597 train_f1_mic= 0.44399 train_f1_mac= 0.16714 val_loss= 0.53537 val_f1_mic= 0.41568 val_f1_mac= 0.14044 time= 0.13266
Iter: 0013 train_loss= 0.52324 train_f1_mic= 0.41933 train_f1_mac= 0.15059 val_loss= 0.53537 val_f1_mic= 0.41568 val_f1_mac= 0.14044 time= 0.13240
Iter: 0018 train_loss= 0.52523 train_f1_mic= 0.41983 train_f1_mac= 0.14926 val_loss= 0.53537 val_f1_mic= 0.41568 val_f1_mac= 0.14044 time= 0.13214
Epoch: 0010
Iter: 0004 train_loss= 0.52571 train_f1_mic= 0.43694 train_f1_mac= 0.16801 val_loss= 0.53910 val_f1_mic= 0.44458 val_f1_mac= 0.16969 time= 0.13217
Iter: 0009 train_loss= 0.53479 train_f1_mic= 0.42947 train_f1_mac= 0.16527 val_loss= 0.53910 val_f1_mic= 0.44458 val_f1_mac= 0.16969 time= 0.13192
Iter: 0014 train_loss= 0.52536 train_f1_mic= 0.43900 train_f1_mac= 0.17239 val_loss= 0.53910 val_f1_mic= 0.44458 val_f1_mac= 0.16969 time= 0.13174
Optimization Finished!
Full validation stats: loss= 0.54415 f1_micro= 0.44134 f1_macro= 0.17884 time= 0.25926
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47035850626325876
Rewards :  -0.036726777121308285 Accuracy :  0.44097708456621215
Total reward :  1.295528291499724
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'tanh', 3, 'tanh']
Training RNN (Reward ip) :  [-0.03672678]
Trial 248: Controller loss : 5441.559570

Prediction action from Controller
State input to Controller for Action :  [0. 2. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:48:48.168210: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:48:48.168625: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:48:48.169031: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:48:48.169328: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:48:48.169692: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69164 train_f1_mic= 0.38580 train_f1_mac= 0.30315 val_loss= 0.65984 val_f1_mic= 0.36864 val_f1_mac= 0.09576 time= 0.76203
Iter: 0005 train_loss= 0.59237 train_f1_mic= 0.38631 train_f1_mac= 0.09778 val_loss= 0.65984 val_f1_mic= 0.36864 val_f1_mac= 0.09576 time= 0.13947
Iter: 0010 train_loss= 0.53948 train_f1_mic= 0.37146 train_f1_mac= 0.08581 val_loss= 0.65984 val_f1_mic= 0.36864 val_f1_mac= 0.09576 time= 0.08296
Iter: 0015 train_loss= 0.54617 train_f1_mic= 0.40276 train_f1_mac= 0.10558 val_loss= 0.65984 val_f1_mic= 0.36864 val_f1_mac= 0.09576 time= 0.06214
Epoch: 0002
Iter: 0001 train_loss= 0.54767 train_f1_mic= 0.38722 train_f1_mac= 0.09854 val_loss= 0.56096 val_f1_mic= 0.38390 val_f1_mac= 0.10050 time= 0.05200
Iter: 0006 train_loss= 0.53606 train_f1_mic= 0.37167 train_f1_mac= 0.08916 val_loss= 0.56096 val_f1_mic= 0.38390 val_f1_mac= 0.10050 time= 0.04484
Iter: 0011 train_loss= 0.53761 train_f1_mic= 0.38214 train_f1_mac= 0.09684 val_loss= 0.56096 val_f1_mic= 0.38390 val_f1_mac= 0.10050 time= 0.03986
Iter: 0016 train_loss= 0.53214 train_f1_mic= 0.39908 train_f1_mac= 0.10928 val_loss= 0.56096 val_f1_mic= 0.38390 val_f1_mac= 0.10050 time= 0.03640
Epoch: 0003
Iter: 0002 train_loss= 0.53348 train_f1_mic= 0.40362 train_f1_mac= 0.12089 val_loss= 0.55949 val_f1_mic= 0.39858 val_f1_mac= 0.12140 time= 0.03429
Iter: 0007 train_loss= 0.53044 train_f1_mic= 0.40232 train_f1_mac= 0.12005 val_loss= 0.55949 val_f1_mic= 0.39858 val_f1_mac= 0.12140 time= 0.03232
Iter: 0012 train_loss= 0.53184 train_f1_mic= 0.40752 train_f1_mac= 0.12510 val_loss= 0.55949 val_f1_mic= 0.39858 val_f1_mac= 0.12140 time= 0.03068
Iter: 0017 train_loss= 0.53038 train_f1_mic= 0.41232 train_f1_mac= 0.12893 val_loss= 0.55949 val_f1_mic= 0.39858 val_f1_mac= 0.12140 time= 0.02938
Epoch: 0004
Iter: 0003 train_loss= 0.52849 train_f1_mic= 0.41851 train_f1_mac= 0.13739 val_loss= 0.53333 val_f1_mic= 0.44885 val_f1_mac= 0.15182 time= 0.02854
Iter: 0008 train_loss= 0.51870 train_f1_mic= 0.42506 train_f1_mac= 0.14359 val_loss= 0.53333 val_f1_mic= 0.44885 val_f1_mac= 0.15182 time= 0.02748
Iter: 0013 train_loss= 0.50958 train_f1_mic= 0.44276 train_f1_mac= 0.15729 val_loss= 0.53333 val_f1_mic= 0.44885 val_f1_mac= 0.15182 time= 0.02671
Iter: 0018 train_loss= 0.53469 train_f1_mic= 0.42151 train_f1_mac= 0.14930 val_loss= 0.53333 val_f1_mic= 0.44885 val_f1_mac= 0.15182 time= 0.02604
Epoch: 0005
Iter: 0004 train_loss= 0.51653 train_f1_mic= 0.42334 train_f1_mac= 0.14680 val_loss= 0.53905 val_f1_mic= 0.46876 val_f1_mac= 0.19179 time= 0.02572
Iter: 0009 train_loss= 0.52003 train_f1_mic= 0.44465 train_f1_mac= 0.16796 val_loss= 0.53905 val_f1_mic= 0.46876 val_f1_mac= 0.19179 time= 0.02507
Iter: 0014 train_loss= 0.52328 train_f1_mic= 0.41096 train_f1_mac= 0.14074 val_loss= 0.53905 val_f1_mic= 0.46876 val_f1_mac= 0.19179 time= 0.02457
Epoch: 0006
Iter: 0000 train_loss= 0.51315 train_f1_mic= 0.44344 train_f1_mac= 0.16102 val_loss= 0.52955 val_f1_mic= 0.44654 val_f1_mac= 0.17262 time= 0.02418
Iter: 0005 train_loss= 0.51871 train_f1_mic= 0.46266 train_f1_mac= 0.19159 val_loss= 0.52955 val_f1_mic= 0.44654 val_f1_mac= 0.17262 time= 0.02365
Iter: 0010 train_loss= 0.52745 train_f1_mic= 0.43828 train_f1_mac= 0.17446 val_loss= 0.52955 val_f1_mic= 0.44654 val_f1_mac= 0.17262 time= 0.02320
Iter: 0015 train_loss= 0.52416 train_f1_mic= 0.43231 train_f1_mac= 0.16990 val_loss= 0.52955 val_f1_mic= 0.44654 val_f1_mac= 0.17262 time= 0.02286
Epoch: 0007
Iter: 0001 train_loss= 0.50955 train_f1_mic= 0.47027 train_f1_mac= 0.19734 val_loss= 0.51955 val_f1_mic= 0.48040 val_f1_mac= 0.21886 time= 0.02268
Iter: 0006 train_loss= 0.49829 train_f1_mic= 0.45038 train_f1_mac= 0.17993 val_loss= 0.51955 val_f1_mic= 0.48040 val_f1_mac= 0.21886 time= 0.02236
Iter: 0011 train_loss= 0.51600 train_f1_mic= 0.46699 train_f1_mac= 0.21163 val_loss= 0.51955 val_f1_mic= 0.48040 val_f1_mac= 0.21886 time= 0.02209
Iter: 0016 train_loss= 0.51018 train_f1_mic= 0.46068 train_f1_mac= 0.20423 val_loss= 0.51955 val_f1_mic= 0.48040 val_f1_mac= 0.21886 time= 0.02185
Epoch: 0008
Iter: 0002 train_loss= 0.49789 train_f1_mic= 0.44873 train_f1_mac= 0.18646 val_loss= 0.54506 val_f1_mic= 0.47704 val_f1_mac= 0.23409 time= 0.02181
Iter: 0007 train_loss= 0.50136 train_f1_mic= 0.48805 train_f1_mac= 0.24210 val_loss= 0.54506 val_f1_mic= 0.47704 val_f1_mac= 0.23409 time= 0.02154
Iter: 0012 train_loss= 0.50140 train_f1_mic= 0.48174 train_f1_mac= 0.22986 val_loss= 0.54506 val_f1_mic= 0.47704 val_f1_mac= 0.23409 time= 0.02133
Iter: 0017 train_loss= 0.50576 train_f1_mic= 0.45635 train_f1_mac= 0.20906 val_loss= 0.54506 val_f1_mic= 0.47704 val_f1_mac= 0.23409 time= 0.02113
Epoch: 0009
Iter: 0003 train_loss= 0.50974 train_f1_mic= 0.48470 train_f1_mac= 0.23375 val_loss= 0.52015 val_f1_mic= 0.49462 val_f1_mac= 0.24428 time= 0.02108
Iter: 0008 train_loss= 0.49416 train_f1_mic= 0.49095 train_f1_mac= 0.24706 val_loss= 0.52015 val_f1_mic= 0.49462 val_f1_mac= 0.24428 time= 0.02091
Iter: 0013 train_loss= 0.49935 train_f1_mic= 0.47447 train_f1_mac= 0.23460 val_loss= 0.52015 val_f1_mic= 0.49462 val_f1_mac= 0.24428 time= 0.02074
Iter: 0018 train_loss= 0.49512 train_f1_mic= 0.51279 train_f1_mac= 0.28126 val_loss= 0.52015 val_f1_mic= 0.49462 val_f1_mac= 0.24428 time= 0.02059
Epoch: 0010
Iter: 0004 train_loss= 0.50116 train_f1_mic= 0.49054 train_f1_mac= 0.25870 val_loss= 0.52032 val_f1_mic= 0.47704 val_f1_mac= 0.24921 time= 0.02049
Iter: 0009 train_loss= 0.49808 train_f1_mic= 0.48379 train_f1_mac= 0.24905 val_loss= 0.52032 val_f1_mic= 0.47704 val_f1_mac= 0.24921 time= 0.02033
Iter: 0014 train_loss= 0.49362 train_f1_mic= 0.49947 train_f1_mac= 0.26415 val_loss= 0.52032 val_f1_mic= 0.47704 val_f1_mac= 0.24921 time= 0.02021
Optimization Finished!
Full validation stats: loss= 0.51540 f1_micro= 0.51346 f1_macro= 0.28296 time= 0.11566
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47750924848683907
Rewards :  0.03575371111790154 Accuracy :  0.5061122173811603
Total reward :  1.3312820026176255
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03575371]
Trial 249: Controller loss : 113.069305

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [0, 'sigmoid', 0, 'relu']
2018-08-31 00:48:57.501033: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:48:57.501279: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:48:57.501503: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:48:57.501673: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:48:57.501885: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69642 train_f1_mic= 0.39433 train_f1_mac= 0.28765 val_loss= 0.66623 val_f1_mic= 0.36879 val_f1_mac= 0.10742 time= 0.75099
Iter: 0005 train_loss= 0.59518 train_f1_mic= 0.37191 train_f1_mac= 0.08858 val_loss= 0.66623 val_f1_mic= 0.36879 val_f1_mac= 0.10742 time= 0.13514
Iter: 0010 train_loss= 0.55574 train_f1_mic= 0.38894 train_f1_mac= 0.09443 val_loss= 0.66623 val_f1_mic= 0.36879 val_f1_mac= 0.10742 time= 0.07951
Iter: 0015 train_loss= 0.53665 train_f1_mic= 0.39530 train_f1_mac= 0.09712 val_loss= 0.66623 val_f1_mic= 0.36879 val_f1_mac= 0.10742 time= 0.05871
Epoch: 0002
Iter: 0001 train_loss= 0.53151 train_f1_mic= 0.39425 train_f1_mac= 0.09359 val_loss= 0.56752 val_f1_mic= 0.37301 val_f1_mac= 0.09461 time= 0.04867
Iter: 0006 train_loss= 0.55174 train_f1_mic= 0.36822 train_f1_mac= 0.08838 val_loss= 0.56752 val_f1_mic= 0.37301 val_f1_mac= 0.09461 time= 0.04207
Iter: 0011 train_loss= 0.54942 train_f1_mic= 0.36835 train_f1_mac= 0.08849 val_loss= 0.56752 val_f1_mic= 0.37301 val_f1_mac= 0.09461 time= 0.03715
Iter: 0016 train_loss= 0.54197 train_f1_mic= 0.37954 train_f1_mac= 0.09228 val_loss= 0.56752 val_f1_mic= 0.37301 val_f1_mac= 0.09461 time= 0.03351
Epoch: 0003
Iter: 0002 train_loss= 0.54665 train_f1_mic= 0.37295 train_f1_mac= 0.08897 val_loss= 0.55779 val_f1_mic= 0.35777 val_f1_mac= 0.08751 time= 0.03115
Iter: 0007 train_loss= 0.53737 train_f1_mic= 0.39109 train_f1_mac= 0.09909 val_loss= 0.55779 val_f1_mic= 0.35777 val_f1_mac= 0.08751 time= 0.02913
Iter: 0012 train_loss= 0.54311 train_f1_mic= 0.37501 train_f1_mac= 0.09126 val_loss= 0.55779 val_f1_mic= 0.35777 val_f1_mac= 0.08751 time= 0.02735
Iter: 0017 train_loss= 0.53505 train_f1_mic= 0.37387 train_f1_mac= 0.08727 val_loss= 0.55779 val_f1_mic= 0.35777 val_f1_mac= 0.08751 time= 0.02592
Epoch: 0004
Iter: 0003 train_loss= 0.54455 train_f1_mic= 0.37360 train_f1_mac= 0.09181 val_loss= 0.56395 val_f1_mic= 0.36721 val_f1_mac= 0.09314 time= 0.02510
Iter: 0008 train_loss= 0.53826 train_f1_mic= 0.39123 train_f1_mac= 0.09770 val_loss= 0.56395 val_f1_mic= 0.36721 val_f1_mac= 0.09314 time= 0.02421
Iter: 0013 train_loss= 0.53388 train_f1_mic= 0.38460 train_f1_mac= 0.09576 val_loss= 0.56395 val_f1_mic= 0.36721 val_f1_mac= 0.09314 time= 0.02339
Iter: 0018 train_loss= 0.53950 train_f1_mic= 0.37727 train_f1_mac= 0.09372 val_loss= 0.56395 val_f1_mic= 0.36721 val_f1_mac= 0.09314 time= 0.02265
Epoch: 0005
Iter: 0004 train_loss= 0.53957 train_f1_mic= 0.39901 train_f1_mac= 0.11204 val_loss= 0.56854 val_f1_mic= 0.37164 val_f1_mac= 0.09996 time= 0.02232
Iter: 0009 train_loss= 0.53680 train_f1_mic= 0.40472 train_f1_mac= 0.11997 val_loss= 0.56854 val_f1_mic= 0.37164 val_f1_mac= 0.09996 time= 0.02172
Iter: 0014 train_loss= 0.54719 train_f1_mic= 0.38532 train_f1_mac= 0.11347 val_loss= 0.56854 val_f1_mic= 0.37164 val_f1_mac= 0.09996 time= 0.02134
Epoch: 0006
Iter: 0000 train_loss= 0.52659 train_f1_mic= 0.41080 train_f1_mac= 0.12225 val_loss= 0.56851 val_f1_mic= 0.40419 val_f1_mac= 0.12828 time= 0.02095
Iter: 0005 train_loss= 0.52910 train_f1_mic= 0.40627 train_f1_mac= 0.12217 val_loss= 0.56851 val_f1_mic= 0.40419 val_f1_mac= 0.12828 time= 0.02046
Iter: 0010 train_loss= 0.52994 train_f1_mic= 0.42259 train_f1_mac= 0.12771 val_loss= 0.56851 val_f1_mic= 0.40419 val_f1_mac= 0.12828 time= 0.02017
Iter: 0015 train_loss= 0.53672 train_f1_mic= 0.41341 train_f1_mac= 0.12726 val_loss= 0.56851 val_f1_mic= 0.40419 val_f1_mac= 0.12828 time= 0.01978
Epoch: 0007
Iter: 0001 train_loss= 0.53507 train_f1_mic= 0.39797 train_f1_mac= 0.12162 val_loss= 0.55729 val_f1_mic= 0.40513 val_f1_mac= 0.13473 time= 0.01972
Iter: 0006 train_loss= 0.53428 train_f1_mic= 0.39213 train_f1_mac= 0.11586 val_loss= 0.55729 val_f1_mic= 0.40513 val_f1_mac= 0.13473 time= 0.01936
Iter: 0011 train_loss= 0.54769 train_f1_mic= 0.42114 train_f1_mac= 0.13778 val_loss= 0.55729 val_f1_mic= 0.40513 val_f1_mac= 0.13473 time= 0.01903
Iter: 0016 train_loss= 0.53681 train_f1_mic= 0.39351 train_f1_mac= 0.11641 val_loss= 0.55729 val_f1_mic= 0.40513 val_f1_mac= 0.13473 time= 0.01877
Epoch: 0008
Iter: 0002 train_loss= 0.53453 train_f1_mic= 0.41537 train_f1_mac= 0.13646 val_loss= 0.55032 val_f1_mic= 0.41257 val_f1_mac= 0.13645 time= 0.01876
Iter: 0007 train_loss= 0.52703 train_f1_mic= 0.40159 train_f1_mac= 0.12090 val_loss= 0.55032 val_f1_mic= 0.41257 val_f1_mac= 0.13645 time= 0.01854
Iter: 0012 train_loss= 0.53766 train_f1_mic= 0.40147 train_f1_mac= 0.12983 val_loss= 0.55032 val_f1_mic= 0.41257 val_f1_mac= 0.13645 time= 0.01833
Iter: 0017 train_loss= 0.53307 train_f1_mic= 0.41699 train_f1_mac= 0.14132 val_loss= 0.55032 val_f1_mic= 0.41257 val_f1_mac= 0.13645 time= 0.01814
Epoch: 0009
Iter: 0003 train_loss= 0.52814 train_f1_mic= 0.44423 train_f1_mac= 0.16530 val_loss= 0.54565 val_f1_mic= 0.42267 val_f1_mac= 0.16724 time= 0.01802
Iter: 0008 train_loss= 0.51954 train_f1_mic= 0.43201 train_f1_mac= 0.14750 val_loss= 0.54565 val_f1_mic= 0.42267 val_f1_mac= 0.16724 time= 0.01784
Iter: 0013 train_loss= 0.52136 train_f1_mic= 0.42266 train_f1_mac= 0.13616 val_loss= 0.54565 val_f1_mic= 0.42267 val_f1_mac= 0.16724 time= 0.01765
Iter: 0018 train_loss= 0.52582 train_f1_mic= 0.43280 train_f1_mac= 0.15368 val_loss= 0.54565 val_f1_mic= 0.42267 val_f1_mac= 0.16724 time= 0.01747
Epoch: 0010
Iter: 0004 train_loss= 0.51944 train_f1_mic= 0.43079 train_f1_mac= 0.15620 val_loss= 0.55385 val_f1_mic= 0.43546 val_f1_mac= 0.16880 time= 0.01745
Iter: 0009 train_loss= 0.53108 train_f1_mic= 0.43475 train_f1_mac= 0.16390 val_loss= 0.55385 val_f1_mic= 0.43546 val_f1_mac= 0.16880 time= 0.01730
Iter: 0014 train_loss= 0.52706 train_f1_mic= 0.43423 train_f1_mac= 0.15921 val_loss= 0.55385 val_f1_mic= 0.43546 val_f1_mac= 0.16880 time= 0.01722
Optimization Finished!
Full validation stats: loss= 0.54181 f1_micro= 0.44217 f1_macro= 0.17661 time= 0.10973
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.469588206605314
Rewards :  -0.03960520940762552 Accuracy :  0.43790403907921355
Total reward :  1.29167679321
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'sigmoid', 0, 'relu']
Training RNN (Reward ip) :  [-0.03960521]
Trial 250: Controller loss : 2238.109375

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [0, 'tanh', 0, 'linear']
2018-08-31 00:49:06.035017: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:49:06.035486: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:49:06.035926: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:49:06.036253: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:49:06.036656: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69375 train_f1_mic= 0.37479 train_f1_mac= 0.34978 val_loss= 0.68475 val_f1_mic= 0.41310 val_f1_mac= 0.35604 time= 0.73703
Iter: 0005 train_loss= 0.61759 train_f1_mic= 0.39303 train_f1_mac= 0.23802 val_loss= 0.68475 val_f1_mic= 0.41310 val_f1_mac= 0.35604 time= 0.13182
Iter: 0010 train_loss= 0.55741 train_f1_mic= 0.39981 train_f1_mac= 0.15198 val_loss= 0.68475 val_f1_mic= 0.41310 val_f1_mac= 0.35604 time= 0.07689
Iter: 0015 train_loss= 0.54122 train_f1_mic= 0.40202 train_f1_mac= 0.11342 val_loss= 0.68475 val_f1_mic= 0.41310 val_f1_mac= 0.35604 time= 0.05641
Epoch: 0002
Iter: 0001 train_loss= 0.53946 train_f1_mic= 0.38405 train_f1_mac= 0.10903 val_loss= 0.56100 val_f1_mic= 0.38361 val_f1_mac= 0.11129 time= 0.04630
Iter: 0006 train_loss= 0.53429 train_f1_mic= 0.39503 train_f1_mac= 0.12869 val_loss= 0.56100 val_f1_mic= 0.38361 val_f1_mac= 0.11129 time= 0.03951
Iter: 0011 train_loss= 0.53247 train_f1_mic= 0.41233 train_f1_mac= 0.13905 val_loss= 0.56100 val_f1_mic= 0.38361 val_f1_mac= 0.11129 time= 0.03507
Iter: 0016 train_loss= 0.53563 train_f1_mic= 0.42406 train_f1_mac= 0.15129 val_loss= 0.56100 val_f1_mic= 0.38361 val_f1_mac= 0.11129 time= 0.03194
Epoch: 0003
Iter: 0002 train_loss= 0.52917 train_f1_mic= 0.42307 train_f1_mac= 0.15448 val_loss= 0.56202 val_f1_mic= 0.40493 val_f1_mac= 0.13983 time= 0.03026
Iter: 0007 train_loss= 0.52794 train_f1_mic= 0.44295 train_f1_mac= 0.17194 val_loss= 0.56202 val_f1_mic= 0.40493 val_f1_mac= 0.13983 time= 0.02827
Iter: 0012 train_loss= 0.52333 train_f1_mic= 0.42591 train_f1_mac= 0.15533 val_loss= 0.56202 val_f1_mic= 0.40493 val_f1_mac= 0.13983 time= 0.02677
Iter: 0017 train_loss= 0.53311 train_f1_mic= 0.43019 train_f1_mac= 0.17208 val_loss= 0.56202 val_f1_mic= 0.40493 val_f1_mac= 0.13983 time= 0.02540
Epoch: 0004
Iter: 0003 train_loss= 0.52464 train_f1_mic= 0.44663 train_f1_mac= 0.17434 val_loss= 0.54507 val_f1_mic= 0.45396 val_f1_mac= 0.19992 time= 0.02444
Iter: 0008 train_loss= 0.53060 train_f1_mic= 0.44074 train_f1_mac= 0.18183 val_loss= 0.54507 val_f1_mic= 0.45396 val_f1_mac= 0.19992 time= 0.02344
Iter: 0013 train_loss= 0.51864 train_f1_mic= 0.44436 train_f1_mac= 0.17897 val_loss= 0.54507 val_f1_mic= 0.45396 val_f1_mac= 0.19992 time= 0.02256
Iter: 0018 train_loss= 0.52575 train_f1_mic= 0.43909 train_f1_mac= 0.17568 val_loss= 0.54507 val_f1_mic= 0.45396 val_f1_mac= 0.19992 time= 0.02180
Epoch: 0005
Iter: 0004 train_loss= 0.50958 train_f1_mic= 0.45199 train_f1_mac= 0.18777 val_loss= 0.55312 val_f1_mic= 0.45341 val_f1_mac= 0.21826 time= 0.02132
Iter: 0009 train_loss= 0.53087 train_f1_mic= 0.45534 train_f1_mac= 0.21390 val_loss= 0.55312 val_f1_mic= 0.45341 val_f1_mac= 0.21826 time= 0.02072
Iter: 0014 train_loss= 0.51808 train_f1_mic= 0.44599 train_f1_mac= 0.19110 val_loss= 0.55312 val_f1_mic= 0.45341 val_f1_mac= 0.21826 time= 0.02020
Epoch: 0006
Iter: 0000 train_loss= 0.51139 train_f1_mic= 0.47397 train_f1_mac= 0.21070 val_loss= 0.51498 val_f1_mic= 0.49626 val_f1_mac= 0.25551 time= 0.01988
Iter: 0005 train_loss= 0.51107 train_f1_mic= 0.45678 train_f1_mac= 0.20735 val_loss= 0.51498 val_f1_mic= 0.49626 val_f1_mac= 0.25551 time= 0.01943
Iter: 0010 train_loss= 0.50865 train_f1_mic= 0.46716 train_f1_mac= 0.23574 val_loss= 0.51498 val_f1_mic= 0.49626 val_f1_mac= 0.25551 time= 0.01904
Iter: 0015 train_loss= 0.51103 train_f1_mic= 0.44985 train_f1_mac= 0.21819 val_loss= 0.51498 val_f1_mic= 0.49626 val_f1_mac= 0.25551 time= 0.01875
Epoch: 0007
Iter: 0001 train_loss= 0.50747 train_f1_mic= 0.49001 train_f1_mac= 0.25026 val_loss= 0.50642 val_f1_mic= 0.49657 val_f1_mac= 0.28168 time= 0.01876
Iter: 0006 train_loss= 0.50665 train_f1_mic= 0.45343 train_f1_mac= 0.22124 val_loss= 0.50642 val_f1_mic= 0.49657 val_f1_mac= 0.28168 time= 0.01850
Iter: 0011 train_loss= 0.51053 train_f1_mic= 0.48778 train_f1_mac= 0.26477 val_loss= 0.50642 val_f1_mic= 0.49657 val_f1_mac= 0.28168 time= 0.01827
Iter: 0016 train_loss= 0.50917 train_f1_mic= 0.47309 train_f1_mac= 0.23042 val_loss= 0.50642 val_f1_mic= 0.49657 val_f1_mac= 0.28168 time= 0.01803
Epoch: 0008
Iter: 0002 train_loss= 0.50926 train_f1_mic= 0.48536 train_f1_mac= 0.25739 val_loss= 0.52562 val_f1_mic= 0.50465 val_f1_mac= 0.29670 time= 0.01801
Iter: 0007 train_loss= 0.51025 train_f1_mic= 0.47705 train_f1_mac= 0.26035 val_loss= 0.52562 val_f1_mic= 0.50465 val_f1_mac= 0.29670 time= 0.01777
Iter: 0012 train_loss= 0.50573 train_f1_mic= 0.47654 train_f1_mac= 0.25688 val_loss= 0.52562 val_f1_mic= 0.50465 val_f1_mac= 0.29670 time= 0.01753
Iter: 0017 train_loss= 0.51258 train_f1_mic= 0.49866 train_f1_mac= 0.27372 val_loss= 0.52562 val_f1_mic= 0.50465 val_f1_mac= 0.29670 time= 0.01733
Epoch: 0009
Iter: 0003 train_loss= 0.50955 train_f1_mic= 0.48391 train_f1_mac= 0.24995 val_loss= 0.52866 val_f1_mic= 0.48244 val_f1_mac= 0.26239 time= 0.01724
Iter: 0008 train_loss= 0.51241 train_f1_mic= 0.47426 train_f1_mac= 0.24969 val_loss= 0.52866 val_f1_mic= 0.48244 val_f1_mac= 0.26239 time= 0.01709
Iter: 0013 train_loss= 0.49859 train_f1_mic= 0.50795 train_f1_mac= 0.30370 val_loss= 0.52866 val_f1_mic= 0.48244 val_f1_mac= 0.26239 time= 0.01692
Iter: 0018 train_loss= 0.48897 train_f1_mic= 0.46899 train_f1_mac= 0.23332 val_loss= 0.52866 val_f1_mic= 0.48244 val_f1_mac= 0.26239 time= 0.01679
Epoch: 0010
Iter: 0004 train_loss= 0.48335 train_f1_mic= 0.51158 train_f1_mac= 0.30772 val_loss= 0.50158 val_f1_mic= 0.47817 val_f1_mac= 0.26825 time= 0.01675
Iter: 0009 train_loss= 0.50630 train_f1_mic= 0.48583 train_f1_mac= 0.26452 val_loss= 0.50158 val_f1_mic= 0.47817 val_f1_mac= 0.26825 time= 0.01659
Iter: 0014 train_loss= 0.49861 train_f1_mic= 0.51621 train_f1_mac= 0.30777 val_loss= 0.50158 val_f1_mic= 0.47817 val_f1_mac= 0.26825 time= 0.01645
Optimization Finished!
Full validation stats: loss= 0.50999 f1_micro= 0.50949 f1_macro= 0.30677 time= 0.07879
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4766999521798887
Rewards :  0.03555872787287351 Accuracy :  0.5051469344781875
Total reward :  1.3272355210828735
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'tanh', 0, 'linear']
Training RNN (Reward ip) :  [0.03555873]
Trial 251: Controller loss : 6503.172363
2018-08-31 00:49:14.160747: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:49:14.161253: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:49:14.161657: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.c
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 2, 'sigmoid']
c:958]      0
2018-08-31 00:49:14.162277: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:49:14.162620: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69301 train_f1_mic= 0.38335 train_f1_mac= 0.24290 val_loss= 0.65409 val_f1_mic= 0.38308 val_f1_mac= 0.10023 time= 0.77607
Iter: 0005 train_loss= 0.56342 train_f1_mic= 0.37251 train_f1_mac= 0.08611 val_loss= 0.65409 val_f1_mic= 0.38308 val_f1_mac= 0.10023 time= 0.14130
Iter: 0010 train_loss= 0.55387 train_f1_mic= 0.39338 train_f1_mac= 0.09966 val_loss= 0.65409 val_f1_mic= 0.38308 val_f1_mac= 0.10023 time= 0.08315
Iter: 0015 train_loss= 0.54961 train_f1_mic= 0.39145 train_f1_mac= 0.09814 val_loss= 0.65409 val_f1_mic= 0.38308 val_f1_mac= 0.10023 time= 0.06178
Epoch: 0002
Iter: 0001 train_loss= 0.54753 train_f1_mic= 0.36995 train_f1_mac= 0.08808 val_loss= 0.54236 val_f1_mic= 0.36470 val_f1_mac= 0.08656 time= 0.05196
Iter: 0006 train_loss= 0.54241 train_f1_mic= 0.37017 train_f1_mac= 0.08914 val_loss= 0.54236 val_f1_mic= 0.36470 val_f1_mac= 0.08656 time= 0.04485
Iter: 0011 train_loss= 0.54740 train_f1_mic= 0.39990 train_f1_mac= 0.10363 val_loss= 0.54236 val_f1_mic= 0.36470 val_f1_mac= 0.08656 time= 0.03986
Iter: 0016 train_loss= 0.53505 train_f1_mic= 0.40011 train_f1_mac= 0.10198 val_loss= 0.54236 val_f1_mic= 0.36470 val_f1_mac= 0.08656 time= 0.03646
Epoch: 0003
Iter: 0002 train_loss= 0.54152 train_f1_mic= 0.38468 train_f1_mac= 0.10370 val_loss= 0.56459 val_f1_mic= 0.36986 val_f1_mac= 0.10083 time= 0.03459
Iter: 0007 train_loss= 0.53166 train_f1_mic= 0.39773 train_f1_mac= 0.11089 val_loss= 0.56459 val_f1_mic= 0.36986 val_f1_mac= 0.10083 time= 0.03226
Iter: 0012 train_loss= 0.54121 train_f1_mic= 0.39251 train_f1_mac= 0.11260 val_loss= 0.56459 val_f1_mic= 0.36986 val_f1_mac= 0.10083 time= 0.03046
Iter: 0017 train_loss= 0.53037 train_f1_mic= 0.42602 train_f1_mac= 0.12941 val_loss= 0.56459 val_f1_mic= 0.36986 val_f1_mac= 0.10083 time= 0.02890
Epoch: 0004
Iter: 0003 train_loss= 0.53078 train_f1_mic= 0.42275 train_f1_mac= 0.13048 val_loss= 0.55747 val_f1_mic= 0.43180 val_f1_mac= 0.13973 time= 0.02792
Iter: 0008 train_loss= 0.52584 train_f1_mic= 0.41212 train_f1_mac= 0.12599 val_loss= 0.55747 val_f1_mic= 0.43180 val_f1_mac= 0.13973 time= 0.02679
Iter: 0013 train_loss= 0.52802 train_f1_mic= 0.43029 train_f1_mac= 0.13912 val_loss= 0.55747 val_f1_mic= 0.43180 val_f1_mac= 0.13973 time= 0.02588
Iter: 0018 train_loss= 0.52789 train_f1_mic= 0.42057 train_f1_mac= 0.14085 val_loss= 0.55747 val_f1_mic= 0.43180 val_f1_mac= 0.13973 time= 0.02507
Epoch: 0005
Iter: 0004 train_loss= 0.52524 train_f1_mic= 0.41795 train_f1_mac= 0.14400 val_loss= 0.55182 val_f1_mic= 0.41275 val_f1_mac= 0.14619 time= 0.02482
Iter: 0009 train_loss= 0.52112 train_f1_mic= 0.45101 train_f1_mac= 0.16615 val_loss= 0.55182 val_f1_mic= 0.41275 val_f1_mac= 0.14619 time= 0.02419
Iter: 0014 train_loss= 0.53598 train_f1_mic= 0.41099 train_f1_mac= 0.14621 val_loss= 0.55182 val_f1_mic= 0.41275 val_f1_mac= 0.14619 time= 0.02362
Epoch: 0006
Iter: 0000 train_loss= 0.52782 train_f1_mic= 0.45401 train_f1_mac= 0.17724 val_loss= 0.55805 val_f1_mic= 0.43715 val_f1_mac= 0.17963 time= 0.02343
Iter: 0005 train_loss= 0.51169 train_f1_mic= 0.44425 train_f1_mac= 0.17417 val_loss= 0.55805 val_f1_mic= 0.43715 val_f1_mac= 0.17963 time= 0.02293
Iter: 0010 train_loss= 0.51591 train_f1_mic= 0.47053 train_f1_mac= 0.20199 val_loss= 0.55805 val_f1_mic= 0.43715 val_f1_mac= 0.17963 time= 0.02248
Iter: 0015 train_loss= 0.51672 train_f1_mic= 0.44717 train_f1_mac= 0.17906 val_loss= 0.55805 val_f1_mic= 0.43715 val_f1_mac= 0.17963 time= 0.02212
Epoch: 0007
Iter: 0001 train_loss= 0.50875 train_f1_mic= 0.44723 train_f1_mac= 0.18010 val_loss= 0.52323 val_f1_mic= 0.44358 val_f1_mac= 0.18112 time= 0.02205
Iter: 0006 train_loss= 0.51973 train_f1_mic= 0.46138 train_f1_mac= 0.20258 val_loss= 0.52323 val_f1_mic= 0.44358 val_f1_mac= 0.18112 time= 0.02176
Iter: 0011 train_loss= 0.50280 train_f1_mic= 0.46323 train_f1_mac= 0.19356 val_loss= 0.52323 val_f1_mic= 0.44358 val_f1_mac= 0.18112 time= 0.02149
Iter: 0016 train_loss= 0.51257 train_f1_mic= 0.45705 train_f1_mac= 0.19723 val_loss= 0.52323 val_f1_mic= 0.44358 val_f1_mac= 0.18112 time= 0.02128
Epoch: 0008
Iter: 0002 train_loss= 0.51181 train_f1_mic= 0.45419 train_f1_mac= 0.19935 val_loss= 0.54429 val_f1_mic= 0.49250 val_f1_mac= 0.23513 time= 0.02123
Iter: 0007 train_loss= 0.50041 train_f1_mic= 0.48131 train_f1_mac= 0.22057 val_loss= 0.54429 val_f1_mic= 0.49250 val_f1_mac= 0.23513 time= 0.02098
Iter: 0012 train_loss= 0.52365 train_f1_mic= 0.48172 train_f1_mac= 0.22997 val_loss= 0.54429 val_f1_mic= 0.49250 val_f1_mac= 0.23513 time= 0.02082
Iter: 0017 train_loss= 0.49885 train_f1_mic= 0.46338 train_f1_mac= 0.20044 val_loss= 0.54429 val_f1_mic= 0.49250 val_f1_mac= 0.23513 time= 0.02056
Epoch: 0009
Iter: 0003 train_loss= 0.50682 train_f1_mic= 0.48289 train_f1_mac= 0.23463 val_loss= 0.51944 val_f1_mic= 0.50172 val_f1_mac= 0.25517 time= 0.02054
Iter: 0008 train_loss= 0.50487 train_f1_mic= 0.48390 train_f1_mac= 0.24206 val_loss= 0.51944 val_f1_mic= 0.50172 val_f1_mac= 0.25517 time= 0.02033
Iter: 0013 train_loss= 0.48397 train_f1_mic= 0.48026 train_f1_mac= 0.22773 val_loss= 0.51944 val_f1_mic= 0.50172 val_f1_mac= 0.25517 time= 0.02013
Iter: 0018 train_loss= 0.50445 train_f1_mic= 0.47796 train_f1_mac= 0.23675 val_loss= 0.51944 val_f1_mic= 0.50172 val_f1_mac= 0.25517 time= 0.01997
Epoch: 0010
Iter: 0004 train_loss= 0.49949 train_f1_mic= 0.49815 train_f1_mac= 0.25597 val_loss= 0.51293 val_f1_mic= 0.49278 val_f1_mac= 0.24812 time= 0.01991
Iter: 0009 train_loss= 0.49488 train_f1_mic= 0.49570 train_f1_mac= 0.24916 val_loss= 0.51293 val_f1_mic= 0.49278 val_f1_mac= 0.24812 time= 0.01978
Iter: 0014 train_loss= 0.51294 train_f1_mic= 0.47800 train_f1_mac= 0.24165 val_loss= 0.51293 val_f1_mic= 0.49278 val_f1_mac= 0.24812 time= 0.01960
Optimization Finished!
Full validation stats: loss= 0.51554 f1_micro= 0.49895 f1_macro= 0.27106 time= 0.12068
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4800097947758512
Rewards :  0.01654921297981271 Accuracy :  0.4932491651597014
Total reward :  1.343784734062686
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 2, 'sigmoid']
Training RNN (Reward ip) :  [0.01654921]
Trial 252: Controller loss : 3370.423340
2018-08-31 00:49:23.317009: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:49:23.317324: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:49:23.317620: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:49:23.317841: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:49:23.318115: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [1, 'relu', 1, 'linear']
Epoch: 0001
Iter: 0000 train_loss= 0.69532 train_f1_mic= 0.37415 train_f1_mac= 0.33012 val_loss= 0.67100 val_f1_mic= 0.42172 val_f1_mac= 0.17341 time= 1.58450
Iter: 0005 train_loss= 0.58211 train_f1_mic= 0.39462 train_f1_mac= 0.10115 val_loss= 0.67100 val_f1_mic= 0.42172 val_f1_mac= 0.17341 time= 0.37795
Iter: 0010 train_loss= 0.54359 train_f1_mic= 0.36214 train_f1_mac= 0.08512 val_loss= 0.67100 val_f1_mic= 0.42172 val_f1_mac= 0.17341 time= 0.26780
Iter: 0015 train_loss= 0.54122 train_f1_mic= 0.38523 train_f1_mac= 0.09315 val_loss= 0.67100 val_f1_mic= 0.42172 val_f1_mac= 0.17341 time= 0.22619
Epoch: 0002
Iter: 0001 train_loss= 0.54625 train_f1_mic= 0.38930 train_f1_mac= 0.09862 val_loss= 0.57709 val_f1_mic= 0.37703 val_f1_mac= 0.10129 time= 0.20644
Iter: 0006 train_loss= 0.54084 train_f1_mic= 0.38130 train_f1_mac= 0.09627 val_loss= 0.57709 val_f1_mic= 0.37703 val_f1_mac= 0.10129 time= 0.19263
Iter: 0011 train_loss= 0.54757 train_f1_mic= 0.38747 train_f1_mac= 0.10339 val_loss= 0.57709 val_f1_mic= 0.37703 val_f1_mac= 0.10129 time= 0.18315
Iter: 0016 train_loss= 0.53614 train_f1_mic= 0.39986 train_f1_mac= 0.10691 val_loss= 0.57709 val_f1_mic= 0.37703 val_f1_mac= 0.10129 time= 0.17608
Epoch: 0003
Iter: 0002 train_loss= 0.53331 train_f1_mic= 0.40174 train_f1_mac= 0.11030 val_loss= 0.55783 val_f1_mic= 0.38671 val_f1_mac= 0.10988 time= 0.17180
Iter: 0007 train_loss= 0.52926 train_f1_mic= 0.40519 train_f1_mac= 0.11572 val_loss= 0.55783 val_f1_mic= 0.38671 val_f1_mac= 0.10988 time= 0.16767
Iter: 0012 train_loss= 0.53318 train_f1_mic= 0.41898 train_f1_mac= 0.12600 val_loss= 0.55783 val_f1_mic= 0.38671 val_f1_mac= 0.10988 time= 0.16432
Iter: 0017 train_loss= 0.53173 train_f1_mic= 0.42553 train_f1_mac= 0.13027 val_loss= 0.55783 val_f1_mic= 0.38671 val_f1_mac= 0.10988 time= 0.16154
Epoch: 0004
Iter: 0003 train_loss= 0.52923 train_f1_mic= 0.40863 train_f1_mac= 0.11950 val_loss= 0.54311 val_f1_mic= 0.40954 val_f1_mac= 0.12346 time= 0.16001
Iter: 0008 train_loss= 0.54274 train_f1_mic= 0.39442 train_f1_mac= 0.11721 val_loss= 0.54311 val_f1_mic= 0.40954 val_f1_mac= 0.12346 time= 0.15796
Iter: 0013 train_loss= 0.52968 train_f1_mic= 0.42210 train_f1_mac= 0.13180 val_loss= 0.54311 val_f1_mic= 0.40954 val_f1_mac= 0.12346 time= 0.15638
Iter: 0018 train_loss= 0.52589 train_f1_mic= 0.43008 train_f1_mac= 0.13847 val_loss= 0.54311 val_f1_mic= 0.40954 val_f1_mac= 0.12346 time= 0.15490
Epoch: 0005
Iter: 0004 train_loss= 0.52839 train_f1_mic= 0.42978 train_f1_mac= 0.14461 val_loss= 0.54025 val_f1_mic= 0.45516 val_f1_mac= 0.16581 time= 0.15441
Iter: 0009 train_loss= 0.51811 train_f1_mic= 0.40992 train_f1_mac= 0.13241 val_loss= 0.54025 val_f1_mic= 0.45516 val_f1_mac= 0.16581 time= 0.15310
Iter: 0014 train_loss= 0.51846 train_f1_mic= 0.44704 train_f1_mac= 0.16195 val_loss= 0.54025 val_f1_mic= 0.45516 val_f1_mac= 0.16581 time= 0.15200
Epoch: 0006
Iter: 0000 train_loss= 0.51046 train_f1_mic= 0.46201 train_f1_mac= 0.18152 val_loss= 0.53364 val_f1_mic= 0.43069 val_f1_mac= 0.17191 time= 0.15156
Iter: 0005 train_loss= 0.50836 train_f1_mic= 0.45497 train_f1_mac= 0.18251 val_loss= 0.53364 val_f1_mic= 0.43069 val_f1_mac= 0.17191 time= 0.15067
Iter: 0010 train_loss= 0.50940 train_f1_mic= 0.44239 train_f1_mac= 0.17815 val_loss= 0.53364 val_f1_mic= 0.43069 val_f1_mac= 0.17191 time= 0.14984
Iter: 0015 train_loss= 0.52474 train_f1_mic= 0.50106 train_f1_mac= 0.24441 val_loss= 0.53364 val_f1_mic= 0.43069 val_f1_mac= 0.17191 time= 0.14914
Epoch: 0007
Iter: 0001 train_loss= 0.52645 train_f1_mic= 0.46849 train_f1_mac= 0.20563 val_loss= 0.52712 val_f1_mic= 0.47263 val_f1_mac= 0.21433 time= 0.14894
Iter: 0006 train_loss= 0.52341 train_f1_mic= 0.42203 train_f1_mac= 0.16867 val_loss= 0.52712 val_f1_mic= 0.47263 val_f1_mac= 0.21433 time= 0.14831
Iter: 0011 train_loss= 0.50081 train_f1_mic= 0.48571 train_f1_mac= 0.23778 val_loss= 0.52712 val_f1_mic= 0.47263 val_f1_mac= 0.21433 time= 0.14785
Iter: 0016 train_loss= 0.50772 train_f1_mic= 0.50283 train_f1_mac= 0.26132 val_loss= 0.52712 val_f1_mic= 0.47263 val_f1_mac= 0.21433 time= 0.14732
Epoch: 0008
Iter: 0002 train_loss= 0.50484 train_f1_mic= 0.45609 train_f1_mac= 0.18799 val_loss= 0.53618 val_f1_mic= 0.45277 val_f1_mac= 0.19470 time= 0.14724
Iter: 0007 train_loss= 0.50276 train_f1_mic= 0.48632 train_f1_mac= 0.23405 val_loss= 0.53618 val_f1_mic= 0.45277 val_f1_mac= 0.19470 time= 0.14670
Iter: 0012 train_loss= 0.50559 train_f1_mic= 0.45775 train_f1_mac= 0.20305 val_loss= 0.53618 val_f1_mic= 0.45277 val_f1_mac= 0.19470 time= 0.14628
Iter: 0017 train_loss= 0.51768 train_f1_mic= 0.48438 train_f1_mac= 0.24743 val_loss= 0.53618 val_f1_mic= 0.45277 val_f1_mac= 0.19470 time= 0.14600
Epoch: 0009
Iter: 0003 train_loss= 0.50899 train_f1_mic= 0.47649 train_f1_mac= 0.23052 val_loss= 0.52137 val_f1_mic= 0.49730 val_f1_mac= 0.26241 time= 0.14611
Iter: 0008 train_loss= 0.50992 train_f1_mic= 0.45888 train_f1_mac= 0.22277 val_loss= 0.52137 val_f1_mic= 0.49730 val_f1_mac= 0.26241 time= 0.14571
Iter: 0013 train_loss= 0.50983 train_f1_mic= 0.45984 train_f1_mac= 0.22342 val_loss= 0.52137 val_f1_mic= 0.49730 val_f1_mac= 0.26241 time= 0.14550
Iter: 0018 train_loss= 0.50848 train_f1_mic= 0.48113 train_f1_mac= 0.24151 val_loss= 0.52137 val_f1_mic= 0.49730 val_f1_mac= 0.26241 time= 0.14536
Epoch: 0010
Iter: 0004 train_loss= 0.49169 train_f1_mic= 0.47690 train_f1_mac= 0.24189 val_loss= 0.49317 val_f1_mic= 0.52108 val_f1_mac= 0.28676 time= 0.14536
Iter: 0009 train_loss= 0.50198 train_f1_mic= 0.46031 train_f1_mac= 0.21833 val_loss= 0.49317 val_f1_mic= 0.52108 val_f1_mac= 0.28676 time= 0.14517
Iter: 0014 train_loss= 0.49952 train_f1_mic= 0.48804 train_f1_mac= 0.24457 val_loss= 0.49317 val_f1_mic= 0.52108 val_f1_mac= 0.28676 time= 0.14487
Optimization Finished!
Full validation stats: loss= 0.51313 f1_micro= 0.50756 f1_macro= 0.29367 time= 0.28636
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4839919562861156
Rewards :  0.019910807551321963 Accuracy :  0.49992060232717317
Total reward :  1.363695541614008
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'relu', 1, 'linear']
Training RNN (Reward ip) :  [0.01991081]
Trial 253: Controller loss : 6802.919922

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [4, 'tanh', 3, 'sigmoid']
2018-08-31 00:49:58.916937: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:49:58.917519: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:49:58.918067: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:49:58.918474: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:49:58.918969: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69275 train_f1_mic= 0.38008 train_f1_mac= 0.22360 val_loss= 0.65407 val_f1_mic= 0.37666 val_f1_mac= 0.09690 time= 0.77792
Iter: 0005 train_loss= 0.56447 train_f1_mic= 0.37924 train_f1_mac= 0.09115 val_loss= 0.65407 val_f1_mic= 0.37666 val_f1_mac= 0.09690 time= 0.14243
Iter: 0010 train_loss= 0.54855 train_f1_mic= 0.40079 train_f1_mac= 0.10493 val_loss= 0.65407 val_f1_mic= 0.37666 val_f1_mac= 0.09690 time= 0.08437
Iter: 0015 train_loss= 0.54888 train_f1_mic= 0.38502 train_f1_mac= 0.10357 val_loss= 0.65407 val_f1_mic= 0.37666 val_f1_mac= 0.09690 time= 0.06331
Epoch: 0002
Iter: 0001 train_loss= 0.54670 train_f1_mic= 0.38454 train_f1_mac= 0.09897 val_loss= 0.55755 val_f1_mic= 0.38530 val_f1_mac= 0.10184 time= 0.05341
Iter: 0006 train_loss= 0.53881 train_f1_mic= 0.39346 train_f1_mac= 0.10355 val_loss= 0.55755 val_f1_mic= 0.38530 val_f1_mac= 0.10184 time= 0.04609
Iter: 0011 train_loss= 0.53723 train_f1_mic= 0.40095 train_f1_mac= 0.11127 val_loss= 0.55755 val_f1_mic= 0.38530 val_f1_mac= 0.10184 time= 0.04101
Iter: 0016 train_loss= 0.54164 train_f1_mic= 0.40430 train_f1_mac= 0.12018 val_loss= 0.55755 val_f1_mic= 0.38530 val_f1_mac= 0.10184 time= 0.03753
Epoch: 0003
Iter: 0002 train_loss= 0.54046 train_f1_mic= 0.39925 train_f1_mac= 0.11956 val_loss= 0.55571 val_f1_mic= 0.39494 val_f1_mac= 0.12216 time= 0.03514
Iter: 0007 train_loss= 0.53474 train_f1_mic= 0.41418 train_f1_mac= 0.12714 val_loss= 0.55571 val_f1_mic= 0.39494 val_f1_mac= 0.12216 time= 0.03299
Iter: 0012 train_loss= 0.54489 train_f1_mic= 0.39911 train_f1_mac= 0.12659 val_loss= 0.55571 val_f1_mic= 0.39494 val_f1_mac= 0.12216 time= 0.03126
Iter: 0017 train_loss= 0.52775 train_f1_mic= 0.41946 train_f1_mac= 0.13482 val_loss= 0.55571 val_f1_mic= 0.39494 val_f1_mac= 0.12216 time= 0.02981
Epoch: 0004
Iter: 0003 train_loss= 0.52846 train_f1_mic= 0.42378 train_f1_mac= 0.13933 val_loss= 0.53711 val_f1_mic= 0.42418 val_f1_mac= 0.13909 time= 0.02883
Iter: 0008 train_loss= 0.53969 train_f1_mic= 0.41613 train_f1_mac= 0.13773 val_loss= 0.53711 val_f1_mic= 0.42418 val_f1_mac= 0.13909 time= 0.02793
Iter: 0013 train_loss= 0.52646 train_f1_mic= 0.41940 train_f1_mac= 0.13888 val_loss= 0.53711 val_f1_mic= 0.42418 val_f1_mac= 0.13909 time= 0.02713
Iter: 0018 train_loss= 0.52809 train_f1_mic= 0.41496 train_f1_mac= 0.13192 val_loss= 0.53711 val_f1_mic= 0.42418 val_f1_mac= 0.13909 time= 0.02632
Epoch: 0005
Iter: 0004 train_loss= 0.51881 train_f1_mic= 0.42862 train_f1_mac= 0.13813 val_loss= 0.54511 val_f1_mic= 0.41161 val_f1_mac= 0.13770 time= 0.02608
Iter: 0009 train_loss= 0.52394 train_f1_mic= 0.43240 train_f1_mac= 0.14287 val_loss= 0.54511 val_f1_mic= 0.41161 val_f1_mac= 0.13770 time= 0.02563
Iter: 0014 train_loss= 0.52670 train_f1_mic= 0.42032 train_f1_mac= 0.13777 val_loss= 0.54511 val_f1_mic= 0.41161 val_f1_mac= 0.13770 time= 0.02512
Epoch: 0006
Iter: 0000 train_loss= 0.53149 train_f1_mic= 0.41103 train_f1_mac= 0.13209 val_loss= 0.53617 val_f1_mic= 0.41631 val_f1_mac= 0.14204 time= 0.02495
Iter: 0005 train_loss= 0.52653 train_f1_mic= 0.43177 train_f1_mac= 0.14839 val_loss= 0.53617 val_f1_mic= 0.41631 val_f1_mac= 0.14204 time= 0.02457
Iter: 0010 train_loss= 0.51098 train_f1_mic= 0.43036 train_f1_mac= 0.14248 val_loss= 0.53617 val_f1_mic= 0.41631 val_f1_mac= 0.14204 time= 0.02419
Iter: 0015 train_loss= 0.53058 train_f1_mic= 0.42180 train_f1_mac= 0.14622 val_loss= 0.53617 val_f1_mic= 0.41631 val_f1_mac= 0.14204 time= 0.02384
Epoch: 0007
Iter: 0001 train_loss= 0.52008 train_f1_mic= 0.42356 train_f1_mac= 0.13858 val_loss= 0.53237 val_f1_mic= 0.41735 val_f1_mac= 0.14567 time= 0.02378
Iter: 0006 train_loss= 0.53645 train_f1_mic= 0.42300 train_f1_mac= 0.14437 val_loss= 0.53237 val_f1_mic= 0.41735 val_f1_mac= 0.14567 time= 0.02347
Iter: 0011 train_loss= 0.52702 train_f1_mic= 0.43395 train_f1_mac= 0.15572 val_loss= 0.53237 val_f1_mic= 0.41735 val_f1_mac= 0.14567 time= 0.02313
Iter: 0016 train_loss= 0.51092 train_f1_mic= 0.41223 train_f1_mac= 0.13661 val_loss= 0.53237 val_f1_mic= 0.41735 val_f1_mac= 0.14567 time= 0.02284
Epoch: 0008
Iter: 0002 train_loss= 0.52094 train_f1_mic= 0.44092 train_f1_mac= 0.15696 val_loss= 0.55178 val_f1_mic= 0.42704 val_f1_mac= 0.15563 time= 0.02282
Iter: 0007 train_loss= 0.52537 train_f1_mic= 0.43353 train_f1_mac= 0.15528 val_loss= 0.55178 val_f1_mic= 0.42704 val_f1_mac= 0.15563 time= 0.02265
Iter: 0012 train_loss= 0.51466 train_f1_mic= 0.43850 train_f1_mac= 0.15712 val_loss= 0.55178 val_f1_mic= 0.42704 val_f1_mac= 0.15563 time= 0.02246
Iter: 0017 train_loss= 0.51212 train_f1_mic= 0.43920 train_f1_mac= 0.15678 val_loss= 0.55178 val_f1_mic= 0.42704 val_f1_mac= 0.15563 time= 0.02227
Epoch: 0009
Iter: 0003 train_loss= 0.52360 train_f1_mic= 0.43922 train_f1_mac= 0.17055 val_loss= 0.54426 val_f1_mic= 0.43318 val_f1_mac= 0.16892 time= 0.02225
Iter: 0008 train_loss= 0.51261 train_f1_mic= 0.43642 train_f1_mac= 0.16089 val_loss= 0.54426 val_f1_mic= 0.43318 val_f1_mac= 0.16892 time= 0.02208
Iter: 0013 train_loss= 0.52578 train_f1_mic= 0.44391 train_f1_mac= 0.17509 val_loss= 0.54426 val_f1_mic= 0.43318 val_f1_mac= 0.16892 time= 0.02193
Iter: 0018 train_loss= 0.52698 train_f1_mic= 0.42054 train_f1_mac= 0.14999 val_loss= 0.54426 val_f1_mic= 0.43318 val_f1_mac= 0.16892 time= 0.02176
Epoch: 0010
Iter: 0004 train_loss= 0.51209 train_f1_mic= 0.45113 train_f1_mac= 0.17367 val_loss= 0.54411 val_f1_mic= 0.44144 val_f1_mac= 0.19008 time= 0.02169
Iter: 0009 train_loss= 0.51404 train_f1_mic= 0.44322 train_f1_mac= 0.17410 val_loss= 0.54411 val_f1_mic= 0.44144 val_f1_mac= 0.19008 time= 0.02151
Iter: 0014 train_loss= 0.52769 train_f1_mic= 0.43691 train_f1_mac= 0.16833 val_loss= 0.54411 val_f1_mic= 0.44144 val_f1_mac= 0.19008 time= 0.02135
Optimization Finished!
Full validation stats: loss= 0.54227 f1_micro= 0.44185 f1_macro= 0.18201 time= 0.13165
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4763972151821365
Rewards :  -0.037973705519895096 Accuracy :  0.4460182507662205
Total reward :  1.3257218360941128
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'tanh', 3, 'sigmoid']
Training RNN (Reward ip) :  [-0.03797371]
Trial 254: Controller loss : 5766.181641

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 0. 5.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:50:08.739195: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:50:08.739496: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:50:08.739793: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:50:08.740010: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:50:08.740276: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69449 train_f1_mic= 0.36903 train_f1_mac= 0.29231 val_loss= 0.66372 val_f1_mic= 0.38628 val_f1_mac= 0.11124 time= 0.75800
Iter: 0005 train_loss= 0.59032 train_f1_mic= 0.38692 train_f1_mac= 0.09620 val_loss= 0.66372 val_f1_mic= 0.38628 val_f1_mac= 0.11124 time= 0.13997
Iter: 0010 train_loss= 0.54174 train_f1_mic= 0.37660 train_f1_mac= 0.08711 val_loss= 0.66372 val_f1_mic= 0.38628 val_f1_mac= 0.11124 time= 0.08378
Iter: 0015 train_loss= 0.55604 train_f1_mic= 0.42007 train_f1_mac= 0.11578 val_loss= 0.66372 val_f1_mic= 0.38628 val_f1_mac= 0.11124 time= 0.06214
Epoch: 0002
Iter: 0001 train_loss= 0.54060 train_f1_mic= 0.40002 train_f1_mac= 0.10462 val_loss= 0.54522 val_f1_mic= 0.40314 val_f1_mac= 0.10498 time= 0.05243
Iter: 0006 train_loss= 0.55983 train_f1_mic= 0.37246 train_f1_mac= 0.09616 val_loss= 0.54522 val_f1_mic= 0.40314 val_f1_mac= 0.10498 time= 0.04538
Iter: 0011 train_loss= 0.53446 train_f1_mic= 0.38975 train_f1_mac= 0.09963 val_loss= 0.54522 val_f1_mic= 0.40314 val_f1_mac= 0.10498 time= 0.04054
Iter: 0016 train_loss= 0.52990 train_f1_mic= 0.37851 train_f1_mac= 0.09426 val_loss= 0.54522 val_f1_mic= 0.40314 val_f1_mac= 0.10498 time= 0.03712
Epoch: 0003
Iter: 0002 train_loss= 0.53179 train_f1_mic= 0.39124 train_f1_mac= 0.10929 val_loss= 0.54582 val_f1_mic= 0.37921 val_f1_mac= 0.10751 time= 0.03488
Iter: 0007 train_loss= 0.53978 train_f1_mic= 0.40569 train_f1_mac= 0.12386 val_loss= 0.54582 val_f1_mic= 0.37921 val_f1_mac= 0.10751 time= 0.03285
Iter: 0012 train_loss= 0.54460 train_f1_mic= 0.42245 train_f1_mac= 0.13565 val_loss= 0.54582 val_f1_mic= 0.37921 val_f1_mac= 0.10751 time= 0.03119
Iter: 0017 train_loss= 0.52960 train_f1_mic= 0.42062 train_f1_mac= 0.13083 val_loss= 0.54582 val_f1_mic= 0.37921 val_f1_mac= 0.10751 time= 0.02972
Epoch: 0004
Iter: 0003 train_loss= 0.50721 train_f1_mic= 0.42423 train_f1_mac= 0.12918 val_loss= 0.55022 val_f1_mic= 0.40484 val_f1_mac= 0.13040 time= 0.02910
Iter: 0008 train_loss= 0.53331 train_f1_mic= 0.40893 train_f1_mac= 0.13306 val_loss= 0.55022 val_f1_mic= 0.40484 val_f1_mac= 0.13040 time= 0.02798
Iter: 0013 train_loss= 0.51944 train_f1_mic= 0.43345 train_f1_mac= 0.15171 val_loss= 0.55022 val_f1_mic= 0.40484 val_f1_mac= 0.13040 time= 0.02708
Iter: 0018 train_loss= 0.52281 train_f1_mic= 0.42668 train_f1_mac= 0.14929 val_loss= 0.55022 val_f1_mic= 0.40484 val_f1_mac= 0.13040 time= 0.02631
Epoch: 0005
Iter: 0004 train_loss= 0.52288 train_f1_mic= 0.44153 train_f1_mac= 0.16309 val_loss= 0.53765 val_f1_mic= 0.45502 val_f1_mac= 0.18127 time= 0.02597
Iter: 0009 train_loss= 0.50835 train_f1_mic= 0.46328 train_f1_mac= 0.17460 val_loss= 0.53765 val_f1_mic= 0.45502 val_f1_mac= 0.18127 time= 0.02526
Iter: 0014 train_loss= 0.51391 train_f1_mic= 0.41534 train_f1_mac= 0.14492 val_loss= 0.53765 val_f1_mic= 0.45502 val_f1_mac= 0.18127 time= 0.02478
Epoch: 0006
Iter: 0000 train_loss= 0.52181 train_f1_mic= 0.44635 train_f1_mac= 0.16945 val_loss= 0.52547 val_f1_mic= 0.43641 val_f1_mac= 0.16735 time= 0.02461
Iter: 0005 train_loss= 0.52002 train_f1_mic= 0.46483 train_f1_mac= 0.19604 val_loss= 0.52547 val_f1_mic= 0.43641 val_f1_mac= 0.16735 time= 0.02416
Iter: 0010 train_loss= 0.51851 train_f1_mic= 0.44276 train_f1_mac= 0.17110 val_loss= 0.52547 val_f1_mic= 0.43641 val_f1_mac= 0.16735 time= 0.02389
Iter: 0015 train_loss= 0.49919 train_f1_mic= 0.43592 train_f1_mac= 0.16238 val_loss= 0.52547 val_f1_mic= 0.43641 val_f1_mac= 0.16735 time= 0.02354
Epoch: 0007
Iter: 0001 train_loss= 0.51180 train_f1_mic= 0.47725 train_f1_mac= 0.21069 val_loss= 0.54612 val_f1_mic= 0.49438 val_f1_mac= 0.22951 time= 0.02358
Iter: 0006 train_loss= 0.51247 train_f1_mic= 0.43849 train_f1_mac= 0.17605 val_loss= 0.54612 val_f1_mic= 0.49438 val_f1_mac= 0.22951 time= 0.02327
Iter: 0011 train_loss= 0.52030 train_f1_mic= 0.44542 train_f1_mac= 0.18675 val_loss= 0.54612 val_f1_mic= 0.49438 val_f1_mac= 0.22951 time= 0.02306
Iter: 0016 train_loss= 0.50716 train_f1_mic= 0.46928 train_f1_mac= 0.21596 val_loss= 0.54612 val_f1_mic= 0.49438 val_f1_mac= 0.22951 time= 0.02277
Epoch: 0008
Iter: 0002 train_loss= 0.51717 train_f1_mic= 0.44998 train_f1_mac= 0.20274 val_loss= 0.52263 val_f1_mic= 0.46404 val_f1_mac= 0.22024 time= 0.02267
Iter: 0007 train_loss= 0.50341 train_f1_mic= 0.46385 train_f1_mac= 0.20144 val_loss= 0.52263 val_f1_mic= 0.46404 val_f1_mac= 0.22024 time= 0.02242
Iter: 0012 train_loss= 0.51354 train_f1_mic= 0.47252 train_f1_mac= 0.21070 val_loss= 0.52263 val_f1_mic= 0.46404 val_f1_mac= 0.22024 time= 0.02221
Iter: 0017 train_loss= 0.49918 train_f1_mic= 0.47678 train_f1_mac= 0.22164 val_loss= 0.52263 val_f1_mic= 0.46404 val_f1_mac= 0.22024 time= 0.02198
Epoch: 0009
Iter: 0003 train_loss= 0.49832 train_f1_mic= 0.46439 train_f1_mac= 0.21664 val_loss= 0.53647 val_f1_mic= 0.48829 val_f1_mac= 0.24840 time= 0.02193
Iter: 0008 train_loss= 0.51118 train_f1_mic= 0.48461 train_f1_mac= 0.23824 val_loss= 0.53647 val_f1_mic= 0.48829 val_f1_mac= 0.24840 time= 0.02170
Iter: 0013 train_loss= 0.49878 train_f1_mic= 0.48404 train_f1_mac= 0.22293 val_loss= 0.53647 val_f1_mic= 0.48829 val_f1_mac= 0.24840 time= 0.02151
Iter: 0018 train_loss= 0.50377 train_f1_mic= 0.48562 train_f1_mac= 0.23714 val_loss= 0.53647 val_f1_mic= 0.48829 val_f1_mac= 0.24840 time= 0.02136
Epoch: 0010
Iter: 0004 train_loss= 0.50173 train_f1_mic= 0.46434 train_f1_mac= 0.21513 val_loss= 0.51014 val_f1_mic= 0.50905 val_f1_mac= 0.27310 time= 0.02125
Iter: 0009 train_loss= 0.50814 train_f1_mic= 0.48316 train_f1_mac= 0.24849 val_loss= 0.51014 val_f1_mic= 0.50905 val_f1_mac= 0.27310 time= 0.02115
Iter: 0014 train_loss= 0.48932 train_f1_mic= 0.49799 train_f1_mac= 0.25516 val_loss= 0.51014 val_f1_mic= 0.50905 val_f1_mac= 0.27310 time= 0.02101
Optimization Finished!
Full validation stats: loss= 0.51672 f1_micro= 0.48940 f1_macro= 0.26511 time= 0.16652
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4783877794144205
Rewards :  0.009952821161419989 Accuracy :  0.4863500363435565
Total reward :  1.3356746572555327
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.00995282]
Trial 255: Controller loss : 113.306068
2018-08-31 00:50:18.675936: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:50:18.676544: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:50:18.677111: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:50:18.677941: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'sigmoid', 1, 'linear']
2018-08-31 00:50:18.678724: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69512 train_f1_mic= 0.37796 train_f1_mac= 0.25590 val_loss= 0.66261 val_f1_mic= 0.38196 val_f1_mac= 0.10720 time= 1.06216
Iter: 0005 train_loss= 0.57715 train_f1_mic= 0.37887 train_f1_mac= 0.09194 val_loss= 0.66261 val_f1_mic= 0.38196 val_f1_mac= 0.10720 time= 0.22339
Iter: 0010 train_loss= 0.55881 train_f1_mic= 0.36374 train_f1_mac= 0.08828 val_loss= 0.66261 val_f1_mic= 0.38196 val_f1_mac= 0.10720 time= 0.14660
Iter: 0015 train_loss= 0.54791 train_f1_mic= 0.40101 train_f1_mac= 0.10296 val_loss= 0.66261 val_f1_mic= 0.38196 val_f1_mac= 0.10720 time= 0.11781
Epoch: 0002
Iter: 0001 train_loss= 0.54955 train_f1_mic= 0.36063 train_f1_mac= 0.08627 val_loss= 0.59659 val_f1_mic= 0.34854 val_f1_mac= 0.09030 time= 0.10462
Iter: 0006 train_loss= 0.54439 train_f1_mic= 0.36113 train_f1_mac= 0.08597 val_loss= 0.59659 val_f1_mic= 0.34854 val_f1_mac= 0.09030 time= 0.09486
Iter: 0011 train_loss= 0.54638 train_f1_mic= 0.39634 train_f1_mac= 0.10126 val_loss= 0.59659 val_f1_mic= 0.34854 val_f1_mac= 0.09030 time= 0.08812
Iter: 0016 train_loss= 0.53269 train_f1_mic= 0.40255 train_f1_mac= 0.09839 val_loss= 0.59659 val_f1_mic= 0.34854 val_f1_mac= 0.09030 time= 0.08358
Epoch: 0003
Iter: 0002 train_loss= 0.54643 train_f1_mic= 0.37849 train_f1_mac= 0.09576 val_loss= 0.55550 val_f1_mic= 0.37966 val_f1_mac= 0.09477 time= 0.08146
Iter: 0007 train_loss= 0.54656 train_f1_mic= 0.38054 train_f1_mac= 0.09384 val_loss= 0.55550 val_f1_mic= 0.37966 val_f1_mac= 0.09477 time= 0.07844
Iter: 0012 train_loss= 0.52743 train_f1_mic= 0.37756 train_f1_mac= 0.09007 val_loss= 0.55550 val_f1_mic= 0.37966 val_f1_mac= 0.09477 time= 0.07609
Iter: 0017 train_loss= 0.55374 train_f1_mic= 0.36339 train_f1_mac= 0.09319 val_loss= 0.55550 val_f1_mic= 0.37966 val_f1_mac= 0.09477 time= 0.07425
Epoch: 0004
Iter: 0003 train_loss= 0.53566 train_f1_mic= 0.40505 train_f1_mac= 0.11788 val_loss= 0.55947 val_f1_mic= 0.39112 val_f1_mac= 0.11190 time= 0.07312
Iter: 0008 train_loss= 0.53087 train_f1_mic= 0.40194 train_f1_mac= 0.11276 val_loss= 0.55947 val_f1_mic= 0.39112 val_f1_mac= 0.11190 time= 0.07158
Iter: 0013 train_loss= 0.53341 train_f1_mic= 0.41143 train_f1_mac= 0.12455 val_loss= 0.55947 val_f1_mic= 0.39112 val_f1_mac= 0.11190 time= 0.07036
Iter: 0018 train_loss= 0.54120 train_f1_mic= 0.42428 train_f1_mac= 0.13589 val_loss= 0.55947 val_f1_mic= 0.39112 val_f1_mac= 0.11190 time= 0.06926
Epoch: 0005
Iter: 0004 train_loss= 0.54020 train_f1_mic= 0.39131 train_f1_mac= 0.12003 val_loss= 0.54139 val_f1_mic= 0.41741 val_f1_mac= 0.13312 time= 0.06874
Iter: 0009 train_loss= 0.53201 train_f1_mic= 0.42595 train_f1_mac= 0.14014 val_loss= 0.54139 val_f1_mic= 0.41741 val_f1_mac= 0.13312 time= 0.06796
Iter: 0014 train_loss= 0.53853 train_f1_mic= 0.40118 train_f1_mac= 0.12389 val_loss= 0.54139 val_f1_mic= 0.41741 val_f1_mac= 0.13312 time= 0.06719
Epoch: 0006
Iter: 0000 train_loss= 0.53644 train_f1_mic= 0.41524 train_f1_mac= 0.13032 val_loss= 0.55893 val_f1_mic= 0.40817 val_f1_mac= 0.12935 time= 0.06674
Iter: 0005 train_loss= 0.53678 train_f1_mic= 0.41669 train_f1_mac= 0.14048 val_loss= 0.55893 val_f1_mic= 0.40817 val_f1_mac= 0.12935 time= 0.06626
Iter: 0010 train_loss= 0.53095 train_f1_mic= 0.39593 train_f1_mac= 0.12044 val_loss= 0.55893 val_f1_mic= 0.40817 val_f1_mac= 0.12935 time= 0.06565
Iter: 0015 train_loss= 0.53303 train_f1_mic= 0.41710 train_f1_mac= 0.13986 val_loss= 0.55893 val_f1_mic= 0.40817 val_f1_mac= 0.12935 time= 0.06507
Epoch: 0007
Iter: 0001 train_loss= 0.52093 train_f1_mic= 0.41132 train_f1_mac= 0.13209 val_loss= 0.54306 val_f1_mic= 0.40987 val_f1_mac= 0.13611 time= 0.06490
Iter: 0006 train_loss= 0.52737 train_f1_mic= 0.43434 train_f1_mac= 0.14640 val_loss= 0.54306 val_f1_mic= 0.40987 val_f1_mac= 0.13611 time= 0.06449
Iter: 0011 train_loss= 0.52710 train_f1_mic= 0.43092 train_f1_mac= 0.15366 val_loss= 0.54306 val_f1_mic= 0.40987 val_f1_mac= 0.13611 time= 0.06402
Iter: 0016 train_loss= 0.52025 train_f1_mic= 0.40709 train_f1_mac= 0.13649 val_loss= 0.54306 val_f1_mic= 0.40987 val_f1_mac= 0.13611 time= 0.06362
Epoch: 0008
Iter: 0002 train_loss= 0.52156 train_f1_mic= 0.44210 train_f1_mac= 0.16460 val_loss= 0.55326 val_f1_mic= 0.43393 val_f1_mac= 0.16095 time= 0.06346
Iter: 0007 train_loss= 0.53642 train_f1_mic= 0.42586 train_f1_mac= 0.14426 val_loss= 0.55326 val_f1_mic= 0.43393 val_f1_mac= 0.16095 time= 0.06321
Iter: 0012 train_loss= 0.53195 train_f1_mic= 0.42666 train_f1_mac= 0.15137 val_loss= 0.55326 val_f1_mic= 0.43393 val_f1_mac= 0.16095 time= 0.06291
Iter: 0017 train_loss= 0.53039 train_f1_mic= 0.40953 train_f1_mac= 0.14012 val_loss= 0.55326 val_f1_mic= 0.43393 val_f1_mac= 0.16095 time= 0.06259
Epoch: 0009
Iter: 0003 train_loss= 0.52350 train_f1_mic= 0.44461 train_f1_mac= 0.17108 val_loss= 0.54490 val_f1_mic= 0.42620 val_f1_mac= 0.15850 time= 0.06249
Iter: 0008 train_loss= 0.52316 train_f1_mic= 0.43632 train_f1_mac= 0.15446 val_loss= 0.54490 val_f1_mic= 0.42620 val_f1_mac= 0.15850 time= 0.06218
Iter: 0013 train_loss= 0.52147 train_f1_mic= 0.42862 train_f1_mac= 0.14825 val_loss= 0.54490 val_f1_mic= 0.42620 val_f1_mac= 0.15850 time= 0.06199
Iter: 0018 train_loss= 0.52360 train_f1_mic= 0.43110 train_f1_mac= 0.16580 val_loss= 0.54490 val_f1_mic= 0.42620 val_f1_mac= 0.15850 time= 0.06182
Epoch: 0010
Iter: 0004 train_loss= 0.53084 train_f1_mic= 0.46396 train_f1_mac= 0.20680 val_loss= 0.54864 val_f1_mic= 0.45106 val_f1_mac= 0.20554 time= 0.06173
Iter: 0009 train_loss= 0.52290 train_f1_mic= 0.43574 train_f1_mac= 0.16184 val_loss= 0.54864 val_f1_mic= 0.45106 val_f1_mac= 0.20554 time= 0.06158
Iter: 0014 train_loss= 0.52205 train_f1_mic= 0.45849 train_f1_mac= 0.19575 val_loss= 0.54864 val_f1_mic= 0.45106 val_f1_mac= 0.20554 time= 0.06145
Optimization Finished!
Full validation stats: loss= 0.54796 f1_micro= 0.41792 f1_macro= 0.15743 time= 0.16157
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4673081068435588
Rewards :  -0.05539836285430866 Accuracy :  0.42298941656011185
Total reward :  1.280276294401224
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'sigmoid', 1, 'linear']
Training RNN (Reward ip) :  [-0.05539836]
Trial 256: Controller loss : 8820.148438
2018-08-31 00:50:36.794093: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devi
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [0, 'tanh', 4, 'tanh']
ces: 0
2018-08-31 00:50:36.794698: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:50:36.795077: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:50:36.795384: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:50:36.795779: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69359 train_f1_mic= 0.37062 train_f1_mac= 0.34338 val_loss= 0.68285 val_f1_mic= 0.43515 val_f1_mac= 0.36094 time= 0.73897
Iter: 0005 train_loss= 0.59375 train_f1_mic= 0.39392 train_f1_mac= 0.16278 val_loss= 0.68285 val_f1_mic= 0.43515 val_f1_mac= 0.36094 time= 0.13283
Iter: 0010 train_loss= 0.55895 train_f1_mic= 0.37428 train_f1_mac= 0.12088 val_loss= 0.68285 val_f1_mic= 0.43515 val_f1_mac= 0.36094 time= 0.07825
Iter: 0015 train_loss= 0.55156 train_f1_mic= 0.38453 train_f1_mac= 0.11931 val_loss= 0.68285 val_f1_mic= 0.43515 val_f1_mac= 0.36094 time= 0.05760
Epoch: 0002
Iter: 0001 train_loss= 0.53465 train_f1_mic= 0.39611 train_f1_mac= 0.10320 val_loss= 0.57477 val_f1_mic= 0.38538 val_f1_mac= 0.11061 time= 0.04859
Iter: 0006 train_loss= 0.53649 train_f1_mic= 0.42037 train_f1_mac= 0.13042 val_loss= 0.57477 val_f1_mic= 0.38538 val_f1_mac= 0.11061 time= 0.04158
Iter: 0011 train_loss= 0.53312 train_f1_mic= 0.39855 train_f1_mac= 0.11493 val_loss= 0.57477 val_f1_mic= 0.38538 val_f1_mac= 0.11061 time= 0.03706
Iter: 0016 train_loss= 0.53562 train_f1_mic= 0.41058 train_f1_mac= 0.13649 val_loss= 0.57477 val_f1_mic= 0.38538 val_f1_mac= 0.11061 time= 0.03369
Epoch: 0003
Iter: 0002 train_loss= 0.52768 train_f1_mic= 0.43606 train_f1_mac= 0.14676 val_loss= 0.54362 val_f1_mic= 0.44585 val_f1_mac= 0.15948 time= 0.03184
Iter: 0007 train_loss= 0.52848 train_f1_mic= 0.42157 train_f1_mac= 0.14405 val_loss= 0.54362 val_f1_mic= 0.44585 val_f1_mac= 0.15948 time= 0.02977
Iter: 0012 train_loss= 0.53189 train_f1_mic= 0.42657 train_f1_mac= 0.15176 val_loss= 0.54362 val_f1_mic= 0.44585 val_f1_mac= 0.15948 time= 0.02802
Iter: 0017 train_loss= 0.52598 train_f1_mic= 0.44188 train_f1_mac= 0.15836 val_loss= 0.54362 val_f1_mic= 0.44585 val_f1_mac= 0.15948 time= 0.02652
Epoch: 0004
Iter: 0003 train_loss= 0.52214 train_f1_mic= 0.43412 train_f1_mac= 0.14683 val_loss= 0.53493 val_f1_mic= 0.44606 val_f1_mac= 0.15821 time= 0.02568
Iter: 0008 train_loss= 0.52484 train_f1_mic= 0.42578 train_f1_mac= 0.14280 val_loss= 0.53493 val_f1_mic= 0.44606 val_f1_mac= 0.15821 time= 0.02460
Iter: 0013 train_loss= 0.51441 train_f1_mic= 0.44282 train_f1_mac= 0.15548 val_loss= 0.53493 val_f1_mic= 0.44606 val_f1_mac= 0.15821 time= 0.02371
Iter: 0018 train_loss= 0.52682 train_f1_mic= 0.42348 train_f1_mac= 0.14547 val_loss= 0.53493 val_f1_mic= 0.44606 val_f1_mac= 0.15821 time= 0.02303
Epoch: 0005
Iter: 0004 train_loss= 0.51785 train_f1_mic= 0.43333 train_f1_mac= 0.15215 val_loss= 0.52416 val_f1_mic= 0.41589 val_f1_mac= 0.14618 time= 0.02276
Iter: 0009 train_loss= 0.52673 train_f1_mic= 0.43809 train_f1_mac= 0.15644 val_loss= 0.52416 val_f1_mic= 0.41589 val_f1_mac= 0.14618 time= 0.02219
Iter: 0014 train_loss= 0.52480 train_f1_mic= 0.44378 train_f1_mac= 0.17288 val_loss= 0.52416 val_f1_mic= 0.41589 val_f1_mac= 0.14618 time= 0.02168
Epoch: 0006
Iter: 0000 train_loss= 0.51831 train_f1_mic= 0.42654 train_f1_mac= 0.15377 val_loss= 0.52816 val_f1_mic= 0.42497 val_f1_mac= 0.16018 time= 0.02140
Iter: 0005 train_loss= 0.52591 train_f1_mic= 0.43416 train_f1_mac= 0.16436 val_loss= 0.52816 val_f1_mic= 0.42497 val_f1_mac= 0.16018 time= 0.02093
Iter: 0010 train_loss= 0.51954 train_f1_mic= 0.47379 train_f1_mac= 0.19808 val_loss= 0.52816 val_f1_mic= 0.42497 val_f1_mac= 0.16018 time= 0.02049
Iter: 0015 train_loss= 0.52079 train_f1_mic= 0.44564 train_f1_mac= 0.17311 val_loss= 0.52816 val_f1_mic= 0.42497 val_f1_mac= 0.16018 time= 0.02016
Epoch: 0007
Iter: 0001 train_loss= 0.52341 train_f1_mic= 0.45381 train_f1_mac= 0.19354 val_loss= 0.51671 val_f1_mic= 0.48004 val_f1_mac= 0.20953 time= 0.02012
Iter: 0006 train_loss= 0.51506 train_f1_mic= 0.45883 train_f1_mac= 0.20150 val_loss= 0.51671 val_f1_mic= 0.48004 val_f1_mac= 0.20953 time= 0.01982
Iter: 0011 train_loss= 0.50597 train_f1_mic= 0.44038 train_f1_mac= 0.17207 val_loss= 0.51671 val_f1_mic= 0.48004 val_f1_mac= 0.20953 time= 0.01951
Iter: 0016 train_loss= 0.51914 train_f1_mic= 0.45535 train_f1_mac= 0.19092 val_loss= 0.51671 val_f1_mic= 0.48004 val_f1_mac= 0.20953 time= 0.01921
Epoch: 0008
Iter: 0002 train_loss= 0.51485 train_f1_mic= 0.43950 train_f1_mac= 0.17027 val_loss= 0.52811 val_f1_mic= 0.45534 val_f1_mac= 0.19169 time= 0.01930
Iter: 0007 train_loss= 0.50943 train_f1_mic= 0.46256 train_f1_mac= 0.20846 val_loss= 0.52811 val_f1_mic= 0.45534 val_f1_mac= 0.19169 time= 0.01909
Iter: 0012 train_loss= 0.51243 train_f1_mic= 0.45492 train_f1_mac= 0.19173 val_loss= 0.52811 val_f1_mic= 0.45534 val_f1_mac= 0.19169 time= 0.01889
Iter: 0017 train_loss= 0.49808 train_f1_mic= 0.47055 train_f1_mac= 0.20964 val_loss= 0.52811 val_f1_mic= 0.45534 val_f1_mac= 0.19169 time= 0.01870
Epoch: 0009
Iter: 0003 train_loss= 0.50546 train_f1_mic= 0.45970 train_f1_mac= 0.20735 val_loss= 0.53990 val_f1_mic= 0.47236 val_f1_mac= 0.23780 time= 0.01859
Iter: 0008 train_loss= 0.51294 train_f1_mic= 0.48731 train_f1_mac= 0.23090 val_loss= 0.53990 val_f1_mic= 0.47236 val_f1_mac= 0.23780 time= 0.01838
Iter: 0013 train_loss= 0.50574 train_f1_mic= 0.44281 train_f1_mac= 0.17282 val_loss= 0.53990 val_f1_mic= 0.47236 val_f1_mac= 0.23780 time= 0.01823
Iter: 0018 train_loss= 0.51459 train_f1_mic= 0.46938 train_f1_mac= 0.21628 val_loss= 0.53990 val_f1_mic= 0.47236 val_f1_mac= 0.23780 time= 0.01810
Epoch: 0010
Iter: 0004 train_loss= 0.49723 train_f1_mic= 0.48918 train_f1_mac= 0.21187 val_loss= 0.52445 val_f1_mic= 0.50806 val_f1_mac= 0.25936 time= 0.01804
Iter: 0009 train_loss= 0.51230 train_f1_mic= 0.43659 train_f1_mac= 0.19010 val_loss= 0.52445 val_f1_mic= 0.50806 val_f1_mac= 0.25936 time= 0.01790
Iter: 0014 train_loss= 0.50859 train_f1_mic= 0.48714 train_f1_mac= 0.23761 val_loss= 0.52445 val_f1_mic= 0.50806 val_f1_mac= 0.25936 time= 0.01775
Optimization Finished!
Full validation stats: loss= 0.52706 f1_micro= 0.47011 f1_macro= 0.21894 time= 0.07182
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46512974218380115
Rewards :  -0.010891823298788295 Accuracy :  0.4564162835447705
Total reward :  1.2693844711024358
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'tanh', 4, 'tanh']
Training RNN (Reward ip) :  [-0.01089182]
Trial 257: Controller loss : 9764.112305
2018-08-31 00:50:45.457469: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:50:45.457817: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:50:45.458152: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:50:45.458395: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:50:45.458699: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'relu', 3, 'tanh']
Epoch: 0001
Iter: 0000 train_loss= 0.69439 train_f1_mic= 0.38477 train_f1_mac= 0.31638 val_loss= 0.67162 val_f1_mic= 0.39529 val_f1_mac= 0.14947 time= 1.31823
Iter: 0005 train_loss= 0.57848 train_f1_mic= 0.37691 train_f1_mac= 0.08788 val_loss= 0.67162 val_f1_mic= 0.39529 val_f1_mac= 0.14947 time= 0.32226
Iter: 0010 train_loss= 0.55133 train_f1_mic= 0.39435 train_f1_mac= 0.10212 val_loss= 0.67162 val_f1_mic= 0.39529 val_f1_mac= 0.14947 time= 0.23199
Iter: 0015 train_loss= 0.56428 train_f1_mic= 0.35841 train_f1_mac= 0.08799 val_loss= 0.67162 val_f1_mic= 0.39529 val_f1_mac= 0.14947 time= 0.19770
Epoch: 0002
Iter: 0001 train_loss= 0.54531 train_f1_mic= 0.41014 train_f1_mac= 0.10504 val_loss= 0.58214 val_f1_mic= 0.39539 val_f1_mac= 0.10795 time= 0.18169
Iter: 0006 train_loss= 0.55212 train_f1_mic= 0.38943 train_f1_mac= 0.09890 val_loss= 0.58214 val_f1_mic= 0.39539 val_f1_mac= 0.10795 time= 0.17042
Iter: 0011 train_loss= 0.54011 train_f1_mic= 0.37175 train_f1_mac= 0.08743 val_loss= 0.58214 val_f1_mic= 0.39539 val_f1_mac= 0.10795 time= 0.16281
Iter: 0016 train_loss= 0.54677 train_f1_mic= 0.37885 train_f1_mac= 0.10254 val_loss= 0.58214 val_f1_mic= 0.39539 val_f1_mac= 0.10795 time= 0.15737
Epoch: 0003
Iter: 0002 train_loss= 0.53662 train_f1_mic= 0.39863 train_f1_mac= 0.10312 val_loss= 0.56099 val_f1_mic= 0.39716 val_f1_mac= 0.11415 time= 0.15428
Iter: 0007 train_loss= 0.54402 train_f1_mic= 0.36791 train_f1_mac= 0.08851 val_loss= 0.56099 val_f1_mic= 0.39716 val_f1_mac= 0.11415 time= 0.15082
Iter: 0012 train_loss= 0.54596 train_f1_mic= 0.38708 train_f1_mac= 0.10458 val_loss= 0.56099 val_f1_mic= 0.39716 val_f1_mac= 0.11415 time= 0.14804
Iter: 0017 train_loss= 0.53986 train_f1_mic= 0.43536 train_f1_mac= 0.13558 val_loss= 0.56099 val_f1_mic= 0.39716 val_f1_mac= 0.11415 time= 0.14572
Epoch: 0004
Iter: 0003 train_loss= 0.53341 train_f1_mic= 0.41493 train_f1_mac= 0.12239 val_loss= 0.56985 val_f1_mic= 0.39900 val_f1_mac= 0.12403 time= 0.14461
Iter: 0008 train_loss= 0.53954 train_f1_mic= 0.40659 train_f1_mac= 0.12389 val_loss= 0.56985 val_f1_mic= 0.39900 val_f1_mac= 0.12403 time= 0.14290
Iter: 0013 train_loss= 0.52729 train_f1_mic= 0.41965 train_f1_mac= 0.12808 val_loss= 0.56985 val_f1_mic= 0.39900 val_f1_mac= 0.12403 time= 0.14148
Iter: 0018 train_loss= 0.54063 train_f1_mic= 0.40697 train_f1_mac= 0.12686 val_loss= 0.56985 val_f1_mic= 0.39900 val_f1_mac= 0.12403 time= 0.14026
Epoch: 0005
Iter: 0004 train_loss= 0.53300 train_f1_mic= 0.42183 train_f1_mac= 0.12568 val_loss= 0.55783 val_f1_mic= 0.40050 val_f1_mac= 0.12931 time= 0.13966
Iter: 0009 train_loss= 0.52441 train_f1_mic= 0.40615 train_f1_mac= 0.12306 val_loss= 0.55783 val_f1_mic= 0.40050 val_f1_mac= 0.12931 time= 0.13867
Iter: 0014 train_loss= 0.52108 train_f1_mic= 0.43892 train_f1_mac= 0.13793 val_loss= 0.55783 val_f1_mic= 0.40050 val_f1_mac= 0.12931 time= 0.13780
Epoch: 0006
Iter: 0000 train_loss= 0.53519 train_f1_mic= 0.39692 train_f1_mac= 0.12286 val_loss= 0.55079 val_f1_mic= 0.39971 val_f1_mac= 0.12893 time= 0.13745
Iter: 0005 train_loss= 0.51918 train_f1_mic= 0.42978 train_f1_mac= 0.13345 val_loss= 0.55079 val_f1_mic= 0.39971 val_f1_mac= 0.12893 time= 0.13679
Iter: 0010 train_loss= 0.53967 train_f1_mic= 0.43384 train_f1_mac= 0.13942 val_loss= 0.55079 val_f1_mic= 0.39971 val_f1_mac= 0.12893 time= 0.13628
Iter: 0015 train_loss= 0.53431 train_f1_mic= 0.41236 train_f1_mac= 0.13389 val_loss= 0.55079 val_f1_mic= 0.39971 val_f1_mac= 0.12893 time= 0.13566
Epoch: 0007
Iter: 0001 train_loss= 0.52191 train_f1_mic= 0.42191 train_f1_mac= 0.13423 val_loss= 0.57280 val_f1_mic= 0.41862 val_f1_mac= 0.14425 time= 0.13547
Iter: 0006 train_loss= 0.51922 train_f1_mic= 0.42491 train_f1_mac= 0.13325 val_loss= 0.57280 val_f1_mic= 0.41862 val_f1_mac= 0.14425 time= 0.13496
Iter: 0011 train_loss= 0.51352 train_f1_mic= 0.45079 train_f1_mac= 0.15480 val_loss= 0.57280 val_f1_mic= 0.41862 val_f1_mac= 0.14425 time= 0.13453
Iter: 0016 train_loss= 0.52743 train_f1_mic= 0.42720 train_f1_mac= 0.14601 val_loss= 0.57280 val_f1_mic= 0.41862 val_f1_mac= 0.14425 time= 0.13413
Epoch: 0008
Iter: 0002 train_loss= 0.51692 train_f1_mic= 0.44059 train_f1_mac= 0.14746 val_loss= 0.53199 val_f1_mic= 0.45710 val_f1_mac= 0.16087 time= 0.13404
Iter: 0007 train_loss= 0.50849 train_f1_mic= 0.42674 train_f1_mac= 0.14182 val_loss= 0.53199 val_f1_mic= 0.45710 val_f1_mac= 0.16087 time= 0.13365
Iter: 0012 train_loss= 0.51285 train_f1_mic= 0.45604 train_f1_mac= 0.16515 val_loss= 0.53199 val_f1_mic= 0.45710 val_f1_mac= 0.16087 time= 0.13326
Iter: 0017 train_loss= 0.52151 train_f1_mic= 0.43905 train_f1_mac= 0.16870 val_loss= 0.53199 val_f1_mic= 0.45710 val_f1_mac= 0.16087 time= 0.13312
Epoch: 0009
Iter: 0003 train_loss= 0.52071 train_f1_mic= 0.46239 train_f1_mac= 0.19598 val_loss= 0.54829 val_f1_mic= 0.45915 val_f1_mac= 0.20030 time= 0.13313
Iter: 0008 train_loss= 0.49974 train_f1_mic= 0.44703 train_f1_mac= 0.17796 val_loss= 0.54829 val_f1_mic= 0.45915 val_f1_mac= 0.20030 time= 0.13282
Iter: 0013 train_loss= 0.52204 train_f1_mic= 0.45672 train_f1_mac= 0.18070 val_loss= 0.54829 val_f1_mic= 0.45915 val_f1_mac= 0.20030 time= 0.13267
Iter: 0018 train_loss= 0.52675 train_f1_mic= 0.44363 train_f1_mac= 0.17675 val_loss= 0.54829 val_f1_mic= 0.45915 val_f1_mac= 0.20030 time= 0.13248
Epoch: 0010
Iter: 0004 train_loss= 0.51588 train_f1_mic= 0.45538 train_f1_mac= 0.19330 val_loss= 0.54125 val_f1_mic= 0.47747 val_f1_mac= 0.20226 time= 0.13248
Iter: 0009 train_loss= 0.50604 train_f1_mic= 0.47586 train_f1_mac= 0.21463 val_loss= 0.54125 val_f1_mic= 0.47747 val_f1_mac= 0.20226 time= 0.13226
Iter: 0014 train_loss= 0.51316 train_f1_mic= 0.46860 train_f1_mac= 0.20842 val_loss= 0.54125 val_f1_mic= 0.47747 val_f1_mac= 0.20226 time= 0.13202
Optimization Finished!
Full validation stats: loss= 0.52896 f1_micro= 0.45997 f1_macro= 0.19791 time= 0.30020
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46288031833872506
Rewards :  -0.011247119225380464 Accuracy :  0.4538826229584207
Total reward :  1.2581373518770553
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'relu', 3, 'tanh']
Training RNN (Reward ip) :  [-0.01124712]
Trial 258: Controller loss : 3856.459229

Prediction action from Controller
State input to Controller for Action :  [0. 2. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:51:17.672908: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:51:17.673132: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:51:17.673353: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:51:17.673520: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:51:17.673723: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69296 train_f1_mic= 0.39770 train_f1_mac= 0.31762 val_loss= 0.66397 val_f1_mic= 0.38112 val_f1_mac= 0.12153 time= 0.76720
Iter: 0005 train_loss= 0.59609 train_f1_mic= 0.36356 train_f1_mac= 0.08751 val_loss= 0.66397 val_f1_mic= 0.38112 val_f1_mac= 0.12153 time= 0.14033
Iter: 0010 train_loss= 0.55435 train_f1_mic= 0.37214 train_f1_mac= 0.09049 val_loss= 0.66397 val_f1_mic= 0.38112 val_f1_mac= 0.12153 time= 0.08325
Iter: 0015 train_loss= 0.53851 train_f1_mic= 0.41917 train_f1_mac= 0.11264 val_loss= 0.66397 val_f1_mic= 0.38112 val_f1_mac= 0.12153 time= 0.06178
Epoch: 0002
Iter: 0001 train_loss= 0.53516 train_f1_mic= 0.38553 train_f1_mac= 0.09577 val_loss= 0.56135 val_f1_mic= 0.37419 val_f1_mac= 0.09933 time= 0.05134
Iter: 0006 train_loss= 0.53312 train_f1_mic= 0.37715 train_f1_mac= 0.09124 val_loss= 0.56135 val_f1_mic= 0.37419 val_f1_mac= 0.09933 time= 0.04454
Iter: 0011 train_loss= 0.52786 train_f1_mic= 0.38987 train_f1_mac= 0.10185 val_loss= 0.56135 val_f1_mic= 0.37419 val_f1_mac= 0.09933 time= 0.03963
Iter: 0016 train_loss= 0.53529 train_f1_mic= 0.40392 train_f1_mac= 0.10923 val_loss= 0.56135 val_f1_mic= 0.37419 val_f1_mac= 0.09933 time= 0.03623
Epoch: 0003
Iter: 0002 train_loss= 0.53971 train_f1_mic= 0.39589 train_f1_mac= 0.11116 val_loss= 0.56271 val_f1_mic= 0.38747 val_f1_mac= 0.11402 time= 0.03466
Iter: 0007 train_loss= 0.52388 train_f1_mic= 0.41135 train_f1_mac= 0.11567 val_loss= 0.56271 val_f1_mic= 0.38747 val_f1_mac= 0.11402 time= 0.03243
Iter: 0012 train_loss= 0.53735 train_f1_mic= 0.40640 train_f1_mac= 0.12401 val_loss= 0.56271 val_f1_mic= 0.38747 val_f1_mac= 0.11402 time= 0.03060
Iter: 0017 train_loss= 0.52598 train_f1_mic= 0.38618 train_f1_mac= 0.11455 val_loss= 0.56271 val_f1_mic= 0.38747 val_f1_mac= 0.11402 time= 0.02913
Epoch: 0004
Iter: 0003 train_loss= 0.52673 train_f1_mic= 0.42322 train_f1_mac= 0.13282 val_loss= 0.54307 val_f1_mic= 0.41129 val_f1_mac= 0.13133 time= 0.02833
Iter: 0008 train_loss= 0.53015 train_f1_mic= 0.39612 train_f1_mac= 0.12427 val_loss= 0.54307 val_f1_mic= 0.41129 val_f1_mac= 0.13133 time= 0.02736
Iter: 0013 train_loss= 0.52641 train_f1_mic= 0.42942 train_f1_mac= 0.14228 val_loss= 0.54307 val_f1_mic= 0.41129 val_f1_mac= 0.13133 time= 0.02646
Iter: 0018 train_loss= 0.53144 train_f1_mic= 0.43135 train_f1_mac= 0.15656 val_loss= 0.54307 val_f1_mic= 0.41129 val_f1_mac= 0.13133 time= 0.02577
Epoch: 0005
Iter: 0004 train_loss= 0.51750 train_f1_mic= 0.43042 train_f1_mac= 0.15161 val_loss= 0.54293 val_f1_mic= 0.46148 val_f1_mac= 0.17946 time= 0.02531
Iter: 0009 train_loss= 0.51915 train_f1_mic= 0.45535 train_f1_mac= 0.17165 val_loss= 0.54293 val_f1_mic= 0.46148 val_f1_mac= 0.17946 time= 0.02469
Iter: 0014 train_loss= 0.51695 train_f1_mic= 0.41563 train_f1_mac= 0.14053 val_loss= 0.54293 val_f1_mic= 0.46148 val_f1_mac= 0.17946 time= 0.02411
Epoch: 0006
Iter: 0000 train_loss= 0.52339 train_f1_mic= 0.42786 train_f1_mac= 0.15987 val_loss= 0.55273 val_f1_mic= 0.43381 val_f1_mac= 0.18082 time= 0.02398
Iter: 0005 train_loss= 0.51454 train_f1_mic= 0.44853 train_f1_mac= 0.18129 val_loss= 0.55273 val_f1_mic= 0.43381 val_f1_mac= 0.18082 time= 0.02360
Iter: 0010 train_loss= 0.51406 train_f1_mic= 0.45194 train_f1_mac= 0.18737 val_loss= 0.55273 val_f1_mic= 0.43381 val_f1_mac= 0.18082 time= 0.02324
Iter: 0015 train_loss= 0.51968 train_f1_mic= 0.45986 train_f1_mac= 0.20107 val_loss= 0.55273 val_f1_mic= 0.43381 val_f1_mac= 0.18082 time= 0.02288
Epoch: 0007
Iter: 0001 train_loss= 0.51810 train_f1_mic= 0.46560 train_f1_mac= 0.20567 val_loss= 0.52973 val_f1_mic= 0.46732 val_f1_mac= 0.20094 time= 0.02265
Iter: 0006 train_loss= 0.50821 train_f1_mic= 0.44217 train_f1_mac= 0.18006 val_loss= 0.52973 val_f1_mic= 0.46732 val_f1_mac= 0.20094 time= 0.02236
Iter: 0011 train_loss= 0.50175 train_f1_mic= 0.48257 train_f1_mac= 0.22268 val_loss= 0.52973 val_f1_mic= 0.46732 val_f1_mac= 0.20094 time= 0.02208
Iter: 0016 train_loss= 0.50660 train_f1_mic= 0.50423 train_f1_mac= 0.23956 val_loss= 0.52973 val_f1_mic= 0.46732 val_f1_mac= 0.20094 time= 0.02185
Epoch: 0008
Iter: 0002 train_loss= 0.50744 train_f1_mic= 0.46533 train_f1_mac= 0.20769 val_loss= 0.52928 val_f1_mic= 0.45521 val_f1_mac= 0.20997 time= 0.02166
Iter: 0007 train_loss= 0.49985 train_f1_mic= 0.45914 train_f1_mac= 0.21110 val_loss= 0.52928 val_f1_mic= 0.45521 val_f1_mac= 0.20997 time= 0.02138
Iter: 0012 train_loss= 0.50613 train_f1_mic= 0.47163 train_f1_mac= 0.23566 val_loss= 0.52928 val_f1_mic= 0.45521 val_f1_mac= 0.20997 time= 0.02120
Iter: 0017 train_loss= 0.51088 train_f1_mic= 0.47843 train_f1_mac= 0.23703 val_loss= 0.52928 val_f1_mic= 0.45521 val_f1_mac= 0.20997 time= 0.02098
Epoch: 0009
Iter: 0003 train_loss= 0.50254 train_f1_mic= 0.48495 train_f1_mac= 0.24352 val_loss= 0.51994 val_f1_mic= 0.48576 val_f1_mac= 0.24280 time= 0.02089
Iter: 0008 train_loss= 0.50174 train_f1_mic= 0.48278 train_f1_mac= 0.24472 val_loss= 0.51994 val_f1_mic= 0.48576 val_f1_mac= 0.24280 time= 0.02070
Iter: 0013 train_loss= 0.51881 train_f1_mic= 0.46293 train_f1_mac= 0.22060 val_loss= 0.51994 val_f1_mic= 0.48576 val_f1_mac= 0.24280 time= 0.02052
Iter: 0018 train_loss= 0.50066 train_f1_mic= 0.48177 train_f1_mac= 0.24991 val_loss= 0.51994 val_f1_mic= 0.48576 val_f1_mac= 0.24280 time= 0.02032
Epoch: 0010
Iter: 0004 train_loss= 0.49733 train_f1_mic= 0.50017 train_f1_mac= 0.27662 val_loss= 0.53290 val_f1_mic= 0.50759 val_f1_mac= 0.28730 time= 0.02029
Iter: 0009 train_loss= 0.49573 train_f1_mic= 0.53704 train_f1_mac= 0.30190 val_loss= 0.53290 val_f1_mic= 0.50759 val_f1_mac= 0.28730 time= 0.02012
Iter: 0014 train_loss= 0.48961 train_f1_mic= 0.50597 train_f1_mac= 0.27252 val_loss= 0.53290 val_f1_mic= 0.50759 val_f1_mac= 0.28730 time= 0.01997
Optimization Finished!
Full validation stats: loss= 0.51565 f1_micro= 0.48953 f1_macro= 0.26721 time= 0.10971
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46851035918684136
Rewards :  0.02815020424058151 Accuracy :  0.49103052257930657
Total reward :  1.2862875561176368
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.0281502]
Trial 259: Controller loss : 115.516945

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 2, 'relu']
2018-08-31 00:51:26.924576: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:51:26.925026: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:51:26.925461: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:51:26.925782: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:51:26.926184: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69370 train_f1_mic= 0.36645 train_f1_mac= 0.29124 val_loss= 0.66304 val_f1_mic= 0.36969 val_f1_mac= 0.10053 time= 0.84664
Iter: 0005 train_loss= 0.58147 train_f1_mic= 0.40382 train_f1_mac= 0.10014 val_loss= 0.66304 val_f1_mic= 0.36969 val_f1_mac= 0.10053 time= 0.19263
Iter: 0010 train_loss= 0.54599 train_f1_mic= 0.39029 train_f1_mac= 0.09700 val_loss= 0.66304 val_f1_mic= 0.36969 val_f1_mac= 0.10053 time= 0.13327
Iter: 0015 train_loss= 0.53725 train_f1_mic= 0.38047 train_f1_mac= 0.09234 val_loss= 0.66304 val_f1_mic= 0.36969 val_f1_mac= 0.10053 time= 0.11088
Epoch: 0002
Iter: 0001 train_loss= 0.54137 train_f1_mic= 0.38974 train_f1_mac= 0.09747 val_loss= 0.57498 val_f1_mic= 0.37357 val_f1_mac= 0.09985 time= 0.10040
Iter: 0006 train_loss= 0.53894 train_f1_mic= 0.38236 train_f1_mac= 0.09278 val_loss= 0.57498 val_f1_mic= 0.37357 val_f1_mac= 0.09985 time= 0.09306
Iter: 0011 train_loss= 0.54945 train_f1_mic= 0.37354 train_f1_mac= 0.09419 val_loss= 0.57498 val_f1_mic= 0.37357 val_f1_mac= 0.09985 time= 0.08821
Iter: 0016 train_loss= 0.52933 train_f1_mic= 0.37477 train_f1_mac= 0.09004 val_loss= 0.57498 val_f1_mic= 0.37357 val_f1_mac= 0.09985 time= 0.08455
Epoch: 0003
Iter: 0002 train_loss= 0.53213 train_f1_mic= 0.40006 train_f1_mac= 0.10632 val_loss= 0.55251 val_f1_mic= 0.40478 val_f1_mac= 0.11353 time= 0.08253
Iter: 0007 train_loss= 0.53107 train_f1_mic= 0.42428 train_f1_mac= 0.12269 val_loss= 0.55251 val_f1_mic= 0.40478 val_f1_mac= 0.11353 time= 0.08039
Iter: 0012 train_loss= 0.53022 train_f1_mic= 0.40019 train_f1_mac= 0.11269 val_loss= 0.55251 val_f1_mic= 0.40478 val_f1_mac= 0.11353 time= 0.07859
Iter: 0017 train_loss= 0.54683 train_f1_mic= 0.38741 train_f1_mac= 0.11086 val_loss= 0.55251 val_f1_mic= 0.40478 val_f1_mac= 0.11353 time= 0.07713
Epoch: 0004
Iter: 0003 train_loss= 0.53181 train_f1_mic= 0.39501 train_f1_mac= 0.10923 val_loss= 0.56230 val_f1_mic= 0.42181 val_f1_mac= 0.13762 time= 0.07625
Iter: 0008 train_loss= 0.54242 train_f1_mic= 0.42439 train_f1_mac= 0.13290 val_loss= 0.56230 val_f1_mic= 0.42181 val_f1_mac= 0.13762 time= 0.07519
Iter: 0013 train_loss= 0.54569 train_f1_mic= 0.38153 train_f1_mac= 0.10753 val_loss= 0.56230 val_f1_mic= 0.42181 val_f1_mac= 0.13762 time= 0.07424
Iter: 0018 train_loss= 0.52563 train_f1_mic= 0.37976 train_f1_mac= 0.09900 val_loss= 0.56230 val_f1_mic= 0.42181 val_f1_mac= 0.13762 time= 0.07347
Epoch: 0005
Iter: 0004 train_loss= 0.54034 train_f1_mic= 0.39714 train_f1_mac= 0.11524 val_loss= 0.56496 val_f1_mic= 0.40667 val_f1_mac= 0.12999 time= 0.07303
Iter: 0009 train_loss= 0.51367 train_f1_mic= 0.41374 train_f1_mac= 0.12335 val_loss= 0.56496 val_f1_mic= 0.40667 val_f1_mac= 0.12999 time= 0.07238
Iter: 0014 train_loss= 0.53889 train_f1_mic= 0.35531 train_f1_mac= 0.09658 val_loss= 0.56496 val_f1_mic= 0.40667 val_f1_mac= 0.12999 time= 0.07179
Epoch: 0006
Iter: 0000 train_loss= 0.52220 train_f1_mic= 0.43986 train_f1_mac= 0.14172 val_loss= 0.54346 val_f1_mic= 0.41076 val_f1_mac= 0.13321 time= 0.07149
Iter: 0005 train_loss= 0.52610 train_f1_mic= 0.42439 train_f1_mac= 0.13695 val_loss= 0.54346 val_f1_mic= 0.41076 val_f1_mac= 0.13321 time= 0.07100
Iter: 0010 train_loss= 0.52745 train_f1_mic= 0.46444 train_f1_mac= 0.16750 val_loss= 0.54346 val_f1_mic= 0.41076 val_f1_mac= 0.13321 time= 0.07059
Iter: 0015 train_loss= 0.51695 train_f1_mic= 0.45147 train_f1_mac= 0.15643 val_loss= 0.54346 val_f1_mic= 0.41076 val_f1_mac= 0.13321 time= 0.07020
Epoch: 0007
Iter: 0001 train_loss= 0.51838 train_f1_mic= 0.44764 train_f1_mac= 0.15109 val_loss= 0.54346 val_f1_mic= 0.44044 val_f1_mac= 0.16140 time= 0.07005
Iter: 0006 train_loss= 0.52045 train_f1_mic= 0.43786 train_f1_mac= 0.14869 val_loss= 0.54346 val_f1_mic= 0.44044 val_f1_mac= 0.16140 time= 0.06985
Iter: 0011 train_loss= 0.52881 train_f1_mic= 0.41533 train_f1_mac= 0.13357 val_loss= 0.54346 val_f1_mic= 0.44044 val_f1_mac= 0.16140 time= 0.06961
Iter: 0016 train_loss= 0.51458 train_f1_mic= 0.40683 train_f1_mac= 0.13479 val_loss= 0.54346 val_f1_mic= 0.44044 val_f1_mac= 0.16140 time= 0.06933
Epoch: 0008
Iter: 0002 train_loss= 0.51293 train_f1_mic= 0.45326 train_f1_mac= 0.17949 val_loss= 0.53912 val_f1_mic= 0.46167 val_f1_mac= 0.20000 time= 0.06922
Iter: 0007 train_loss= 0.52402 train_f1_mic= 0.39902 train_f1_mac= 0.12984 val_loss= 0.53912 val_f1_mic= 0.46167 val_f1_mac= 0.20000 time= 0.06898
Iter: 0012 train_loss= 0.51911 train_f1_mic= 0.39441 train_f1_mac= 0.12173 val_loss= 0.53912 val_f1_mic= 0.46167 val_f1_mac= 0.20000 time= 0.06877
Iter: 0017 train_loss= 0.52901 train_f1_mic= 0.45428 train_f1_mac= 0.17563 val_loss= 0.53912 val_f1_mic= 0.46167 val_f1_mac= 0.20000 time= 0.06858
Epoch: 0009
Iter: 0003 train_loss= 0.51595 train_f1_mic= 0.45831 train_f1_mac= 0.18850 val_loss= 0.54733 val_f1_mic= 0.45782 val_f1_mac= 0.19207 time= 0.06865
Iter: 0008 train_loss= 0.50826 train_f1_mic= 0.47819 train_f1_mac= 0.21578 val_loss= 0.54733 val_f1_mic= 0.45782 val_f1_mac= 0.19207 time= 0.06846
Iter: 0013 train_loss= 0.51685 train_f1_mic= 0.45195 train_f1_mac= 0.19197 val_loss= 0.54733 val_f1_mic= 0.45782 val_f1_mac= 0.19207 time= 0.06830
Iter: 0018 train_loss= 0.51517 train_f1_mic= 0.45622 train_f1_mac= 0.18636 val_loss= 0.54733 val_f1_mic= 0.45782 val_f1_mac= 0.19207 time= 0.06814
Epoch: 0010
Iter: 0004 train_loss= 0.51713 train_f1_mic= 0.48285 train_f1_mac= 0.21769 val_loss= 0.53223 val_f1_mic= 0.50234 val_f1_mac= 0.23845 time= 0.06815
Iter: 0009 train_loss= 0.52307 train_f1_mic= 0.48016 train_f1_mac= 0.22431 val_loss= 0.53223 val_f1_mic= 0.50234 val_f1_mac= 0.23845 time= 0.06801
Iter: 0014 train_loss= 0.50636 train_f1_mic= 0.46554 train_f1_mac= 0.20708 val_loss= 0.53223 val_f1_mic= 0.50234 val_f1_mac= 0.23845 time= 0.06789
Optimization Finished!
Full validation stats: loss= 0.52764 f1_micro= 0.47671 f1_macro= 0.23908 time= 0.11968
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4688795138017915
Rewards :  0.0018457730747507006 Accuracy :  0.47035613226159206
Total reward :  1.2881333291923875
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 2, 'relu']
Training RNN (Reward ip) :  [0.00184577]
Trial 260: Controller loss : 9696.681641

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'relu', 1, 'tanh']
2018-08-31 00:51:45.321899: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:51:45.322139: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:51:45.322369: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:51:45.322534: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:51:45.322747: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69243 train_f1_mic= 0.39671 train_f1_mac= 0.32408 val_loss= 0.66790 val_f1_mic= 0.41734 val_f1_mac= 0.15034 time= 1.05918
Iter: 0005 train_loss= 0.58104 train_f1_mic= 0.36667 train_f1_mac= 0.08861 val_loss= 0.66790 val_f1_mic= 0.41734 val_f1_mac= 0.15034 time= 0.23884
Iter: 0010 train_loss= 0.54335 train_f1_mic= 0.37328 train_f1_mac= 0.08767 val_loss= 0.66790 val_f1_mic= 0.41734 val_f1_mac= 0.15034 time= 0.16328
Iter: 0015 train_loss= 0.55203 train_f1_mic= 0.37703 train_f1_mac= 0.09261 val_loss= 0.66790 val_f1_mic= 0.41734 val_f1_mac= 0.15034 time= 0.13595
Epoch: 0002
Iter: 0001 train_loss= 0.55446 train_f1_mic= 0.37824 train_f1_mac= 0.09359 val_loss= 0.56365 val_f1_mic= 0.36714 val_f1_mac= 0.09291 time= 0.12443
Iter: 0006 train_loss= 0.54672 train_f1_mic= 0.36628 train_f1_mac= 0.08712 val_loss= 0.56365 val_f1_mic= 0.36714 val_f1_mac= 0.09291 time= 0.11496
Iter: 0011 train_loss= 0.54484 train_f1_mic= 0.38583 train_f1_mac= 0.09646 val_loss= 0.56365 val_f1_mic= 0.36714 val_f1_mac= 0.09291 time= 0.10890
Iter: 0016 train_loss= 0.52920 train_f1_mic= 0.40509 train_f1_mac= 0.10052 val_loss= 0.56365 val_f1_mic= 0.36714 val_f1_mac= 0.09291 time= 0.10430
Epoch: 0003
Iter: 0002 train_loss= 0.54137 train_f1_mic= 0.37357 train_f1_mac= 0.08823 val_loss= 0.56607 val_f1_mic= 0.36043 val_f1_mac= 0.08991 time= 0.10156
Iter: 0007 train_loss= 0.54710 train_f1_mic= 0.36506 train_f1_mac= 0.08751 val_loss= 0.56607 val_f1_mic= 0.36043 val_f1_mac= 0.08991 time= 0.09915
Iter: 0012 train_loss= 0.54410 train_f1_mic= 0.37340 train_f1_mac= 0.09137 val_loss= 0.56607 val_f1_mic= 0.36043 val_f1_mac= 0.08991 time= 0.09656
Iter: 0017 train_loss= 0.54641 train_f1_mic= 0.37905 train_f1_mac= 0.09660 val_loss= 0.56607 val_f1_mic= 0.36043 val_f1_mac= 0.08991 time= 0.09478
Epoch: 0004
Iter: 0003 train_loss= 0.53350 train_f1_mic= 0.39819 train_f1_mac= 0.10145 val_loss= 0.57647 val_f1_mic= 0.37365 val_f1_mac= 0.10297 time= 0.09355
Iter: 0008 train_loss= 0.53887 train_f1_mic= 0.38622 train_f1_mac= 0.09747 val_loss= 0.57647 val_f1_mic= 0.37365 val_f1_mac= 0.10297 time= 0.09198
Iter: 0013 train_loss= 0.54056 train_f1_mic= 0.38348 train_f1_mac= 0.09743 val_loss= 0.57647 val_f1_mic= 0.37365 val_f1_mac= 0.10297 time= 0.09063
Iter: 0018 train_loss= 0.53293 train_f1_mic= 0.38525 train_f1_mac= 0.09811 val_loss= 0.57647 val_f1_mic= 0.37365 val_f1_mac= 0.10297 time= 0.08961
Epoch: 0005
Iter: 0004 train_loss= 0.54387 train_f1_mic= 0.38652 train_f1_mac= 0.10154 val_loss= 0.57923 val_f1_mic= 0.38357 val_f1_mac= 0.10877 time= 0.08919
Iter: 0009 train_loss= 0.53544 train_f1_mic= 0.38377 train_f1_mac= 0.10150 val_loss= 0.57923 val_f1_mic= 0.38357 val_f1_mac= 0.10877 time= 0.08861
Iter: 0014 train_loss= 0.54061 train_f1_mic= 0.39333 train_f1_mac= 0.10609 val_loss= 0.57923 val_f1_mic= 0.38357 val_f1_mac= 0.10877 time= 0.08776
Epoch: 0006
Iter: 0000 train_loss= 0.52661 train_f1_mic= 0.41214 train_f1_mac= 0.11897 val_loss= 0.57132 val_f1_mic= 0.38745 val_f1_mac= 0.11941 time= 0.08733
Iter: 0005 train_loss= 0.52803 train_f1_mic= 0.41593 train_f1_mac= 0.11513 val_loss= 0.57132 val_f1_mic= 0.38745 val_f1_mac= 0.11941 time= 0.08666
Iter: 0010 train_loss= 0.53637 train_f1_mic= 0.38547 train_f1_mac= 0.10353 val_loss= 0.57132 val_f1_mic= 0.38745 val_f1_mac= 0.11941 time= 0.08603
Iter: 0015 train_loss= 0.52899 train_f1_mic= 0.43035 train_f1_mac= 0.13478 val_loss= 0.57132 val_f1_mic= 0.38745 val_f1_mac= 0.11941 time= 0.08557
Epoch: 0007
Iter: 0001 train_loss= 0.53338 train_f1_mic= 0.41046 train_f1_mac= 0.12583 val_loss= 0.55012 val_f1_mic= 0.41280 val_f1_mac= 0.13184 time= 0.08543
Iter: 0006 train_loss= 0.53089 train_f1_mic= 0.40388 train_f1_mac= 0.12341 val_loss= 0.55012 val_f1_mic= 0.41280 val_f1_mac= 0.13184 time= 0.08529
Iter: 0011 train_loss= 0.53022 train_f1_mic= 0.44282 train_f1_mac= 0.14206 val_loss= 0.55012 val_f1_mic= 0.41280 val_f1_mac= 0.13184 time= 0.08483
Iter: 0016 train_loss= 0.52068 train_f1_mic= 0.41213 train_f1_mac= 0.12389 val_loss= 0.55012 val_f1_mic= 0.41280 val_f1_mac= 0.13184 time= 0.08447
Epoch: 0008
Iter: 0002 train_loss= 0.52743 train_f1_mic= 0.42571 train_f1_mac= 0.13143 val_loss= 0.54617 val_f1_mic= 0.44957 val_f1_mac= 0.14427 time= 0.08437
Iter: 0007 train_loss= 0.52830 train_f1_mic= 0.41625 train_f1_mac= 0.13273 val_loss= 0.54617 val_f1_mic= 0.44957 val_f1_mac= 0.14427 time= 0.08402
Iter: 0012 train_loss= 0.54256 train_f1_mic= 0.43077 train_f1_mac= 0.14418 val_loss= 0.54617 val_f1_mic= 0.44957 val_f1_mac= 0.14427 time= 0.08375
Iter: 0017 train_loss= 0.52473 train_f1_mic= 0.42877 train_f1_mac= 0.13265 val_loss= 0.54617 val_f1_mic= 0.44957 val_f1_mac= 0.14427 time= 0.08343
Epoch: 0009
Iter: 0003 train_loss= 0.51419 train_f1_mic= 0.41132 train_f1_mac= 0.12700 val_loss= 0.52637 val_f1_mic= 0.43879 val_f1_mac= 0.13959 time= 0.08338
Iter: 0008 train_loss= 0.53130 train_f1_mic= 0.42971 train_f1_mac= 0.14211 val_loss= 0.52637 val_f1_mic= 0.43879 val_f1_mac= 0.13959 time= 0.08310
Iter: 0013 train_loss= 0.53673 train_f1_mic= 0.42717 train_f1_mac= 0.14037 val_loss= 0.52637 val_f1_mic= 0.43879 val_f1_mac= 0.13959 time= 0.08281
Iter: 0018 train_loss= 0.52141 train_f1_mic= 0.41044 train_f1_mac= 0.13224 val_loss= 0.52637 val_f1_mic= 0.43879 val_f1_mac= 0.13959 time= 0.08259
Epoch: 0010
Iter: 0004 train_loss= 0.53367 train_f1_mic= 0.42797 train_f1_mac= 0.14268 val_loss= 0.53824 val_f1_mic= 0.42307 val_f1_mac= 0.14137 time= 0.08252
Iter: 0009 train_loss= 0.52211 train_f1_mic= 0.43346 train_f1_mac= 0.15886 val_loss= 0.53824 val_f1_mic= 0.42307 val_f1_mac= 0.14137 time= 0.08229
Iter: 0014 train_loss= 0.52237 train_f1_mic= 0.44887 train_f1_mac= 0.16170 val_loss= 0.53824 val_f1_mic= 0.42307 val_f1_mac= 0.14137 time= 0.08212
Optimization Finished!
Full validation stats: loss= 0.54669 f1_micro= 0.40337 f1_macro= 0.13427 time= 0.16160
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.45681934900012433
Rewards :  -0.06030082400833586 Accuracy :  0.40857868979345563
Total reward :  1.2278325051840517
Saved buffers to file `buffers.txt` !
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'relu', 1, 'tanh']
Training RNN (Reward ip) :  [-0.06030082]
Trial 261: Controller loss : 6730.674316
2018-08-31 00:52:07.128471: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:52:07.128917: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:52:07.129804: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:52:07.130308: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [3, 'tanh', 4, 'relu']
2018-08-31 00:52:07.130928: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69454 train_f1_mic= 0.38567 train_f1_mac= 0.27448 val_loss= 0.66862 val_f1_mic= 0.40132 val_f1_mac= 0.13705 time= 0.81438
Iter: 0005 train_loss= 0.58781 train_f1_mic= 0.36603 train_f1_mac= 0.08768 val_loss= 0.66862 val_f1_mic= 0.40132 val_f1_mac= 0.13705 time= 0.18626
Iter: 0010 train_loss= 0.54674 train_f1_mic= 0.37852 train_f1_mac= 0.09150 val_loss= 0.66862 val_f1_mic= 0.40132 val_f1_mac= 0.13705 time= 0.12989
Iter: 0015 train_loss= 0.53764 train_f1_mic= 0.38194 train_f1_mac= 0.09158 val_loss= 0.66862 val_f1_mic= 0.40132 val_f1_mac= 0.13705 time= 0.10806
Epoch: 0002
Iter: 0001 train_loss= 0.55289 train_f1_mic= 0.38263 train_f1_mac= 0.09533 val_loss= 0.55771 val_f1_mic= 0.38116 val_f1_mac= 0.09572 time= 0.09819
Iter: 0006 train_loss= 0.53757 train_f1_mic= 0.37434 train_f1_mac= 0.09030 val_loss= 0.55771 val_f1_mic= 0.38116 val_f1_mac= 0.09572 time= 0.09097
Iter: 0011 train_loss= 0.53881 train_f1_mic= 0.38379 train_f1_mac= 0.09309 val_loss= 0.55771 val_f1_mic= 0.38116 val_f1_mac= 0.09572 time= 0.08601
Iter: 0016 train_loss= 0.54557 train_f1_mic= 0.38926 train_f1_mac= 0.09867 val_loss= 0.55771 val_f1_mic= 0.38116 val_f1_mac= 0.09572 time= 0.08248
Epoch: 0003
Iter: 0002 train_loss= 0.54189 train_f1_mic= 0.39055 train_f1_mac= 0.09942 val_loss= 0.55478 val_f1_mic= 0.39319 val_f1_mac= 0.10152 time= 0.08028
Iter: 0007 train_loss= 0.52714 train_f1_mic= 0.38768 train_f1_mac= 0.09894 val_loss= 0.55478 val_f1_mic= 0.39319 val_f1_mac= 0.10152 time= 0.07812
Iter: 0012 train_loss= 0.53651 train_f1_mic= 0.39102 train_f1_mac= 0.10579 val_loss= 0.55478 val_f1_mic= 0.39319 val_f1_mac= 0.10152 time= 0.07643
Iter: 0017 train_loss= 0.54813 train_f1_mic= 0.39979 train_f1_mac= 0.11957 val_loss= 0.55478 val_f1_mic= 0.39319 val_f1_mac= 0.10152 time= 0.07507
Epoch: 0004
Iter: 0003 train_loss= 0.54288 train_f1_mic= 0.41592 train_f1_mac= 0.12796 val_loss= 0.55548 val_f1_mic= 0.41210 val_f1_mac= 0.13013 time= 0.07425
Iter: 0008 train_loss= 0.52457 train_f1_mic= 0.41731 train_f1_mac= 0.12515 val_loss= 0.55548 val_f1_mic= 0.41210 val_f1_mac= 0.13013 time= 0.07327
Iter: 0013 train_loss= 0.54134 train_f1_mic= 0.40336 train_f1_mac= 0.12488 val_loss= 0.55548 val_f1_mic= 0.41210 val_f1_mac= 0.13013 time= 0.07244
Iter: 0018 train_loss= 0.53961 train_f1_mic= 0.39340 train_f1_mac= 0.11306 val_loss= 0.55548 val_f1_mic= 0.41210 val_f1_mac= 0.13013 time= 0.07169
Epoch: 0005
Iter: 0004 train_loss= 0.53204 train_f1_mic= 0.42394 train_f1_mac= 0.12947 val_loss= 0.57015 val_f1_mic= 0.39276 val_f1_mac= 0.12328 time= 0.07130
Iter: 0009 train_loss= 0.53555 train_f1_mic= 0.40695 train_f1_mac= 0.13086 val_loss= 0.57015 val_f1_mic= 0.39276 val_f1_mac= 0.12328 time= 0.07078
Iter: 0014 train_loss= 0.52565 train_f1_mic= 0.42375 train_f1_mac= 0.13541 val_loss= 0.57015 val_f1_mic= 0.39276 val_f1_mac= 0.12328 time= 0.07029
Epoch: 0006
Iter: 0000 train_loss= 0.54566 train_f1_mic= 0.40604 train_f1_mac= 0.12962 val_loss= 0.54553 val_f1_mic= 0.42209 val_f1_mac= 0.13842 time= 0.07000
Iter: 0005 train_loss= 0.52994 train_f1_mic= 0.41658 train_f1_mac= 0.12951 val_loss= 0.54553 val_f1_mic= 0.42209 val_f1_mac= 0.13842 time= 0.06959
Iter: 0010 train_loss= 0.52232 train_f1_mic= 0.42674 train_f1_mac= 0.13311 val_loss= 0.54553 val_f1_mic= 0.42209 val_f1_mac= 0.13842 time= 0.06922
Iter: 0015 train_loss= 0.51333 train_f1_mic= 0.41760 train_f1_mac= 0.13342 val_loss= 0.54553 val_f1_mic= 0.42209 val_f1_mac= 0.13842 time= 0.06883
Epoch: 0007
Iter: 0001 train_loss= 0.52461 train_f1_mic= 0.43288 train_f1_mac= 0.14468 val_loss= 0.53417 val_f1_mic= 0.43792 val_f1_mac= 0.15317 time= 0.06868
Iter: 0006 train_loss= 0.51399 train_f1_mic= 0.43678 train_f1_mac= 0.13971 val_loss= 0.53417 val_f1_mic= 0.43792 val_f1_mac= 0.15317 time= 0.06837
Iter: 0011 train_loss= 0.53033 train_f1_mic= 0.41644 train_f1_mac= 0.13466 val_loss= 0.53417 val_f1_mic= 0.43792 val_f1_mac= 0.15317 time= 0.06806
Iter: 0016 train_loss= 0.52268 train_f1_mic= 0.42536 train_f1_mac= 0.14059 val_loss= 0.53417 val_f1_mic= 0.43792 val_f1_mac= 0.15317 time= 0.06780
Epoch: 0008
Iter: 0002 train_loss= 0.52434 train_f1_mic= 0.43641 train_f1_mac= 0.14552 val_loss= 0.56211 val_f1_mic= 0.42252 val_f1_mac= 0.15067 time= 0.06772
Iter: 0007 train_loss= 0.53222 train_f1_mic= 0.41178 train_f1_mac= 0.13536 val_loss= 0.56211 val_f1_mic= 0.42252 val_f1_mac= 0.15067 time= 0.06749
Iter: 0012 train_loss= 0.52779 train_f1_mic= 0.41770 train_f1_mac= 0.14010 val_loss= 0.56211 val_f1_mic= 0.42252 val_f1_mac= 0.15067 time= 0.06728
Iter: 0017 train_loss= 0.53083 train_f1_mic= 0.43901 train_f1_mac= 0.15459 val_loss= 0.56211 val_f1_mic= 0.42252 val_f1_mac= 0.15067 time= 0.06707
Epoch: 0009
Iter: 0003 train_loss= 0.52926 train_f1_mic= 0.41856 train_f1_mac= 0.14346 val_loss= 0.54151 val_f1_mic= 0.40997 val_f1_mac= 0.14423 time= 0.06703
Iter: 0008 train_loss= 0.51026 train_f1_mic= 0.42878 train_f1_mac= 0.15048 val_loss= 0.54151 val_f1_mic= 0.40997 val_f1_mac= 0.14423 time= 0.06685
Iter: 0013 train_loss= 0.52187 train_f1_mic= 0.44823 train_f1_mac= 0.16230 val_loss= 0.54151 val_f1_mic= 0.40997 val_f1_mac= 0.14423 time= 0.06671
Iter: 0018 train_loss= 0.53198 train_f1_mic= 0.40961 train_f1_mac= 0.14463 val_loss= 0.54151 val_f1_mic= 0.40997 val_f1_mac= 0.14423 time= 0.06652
Epoch: 0010
Iter: 0004 train_loss= 0.52792 train_f1_mic= 0.41497 train_f1_mac= 0.14965 val_loss= 0.52276 val_f1_mic= 0.45084 val_f1_mac= 0.18033 time= 0.06647
Iter: 0009 train_loss= 0.52732 train_f1_mic= 0.44440 train_f1_mac= 0.18015 val_loss= 0.52276 val_f1_mic= 0.45084 val_f1_mac= 0.18033 time= 0.06635
Iter: 0014 train_loss= 0.52023 train_f1_mic= 0.46222 train_f1_mac= 0.17433 val_loss= 0.52276 val_f1_mic= 0.45084 val_f1_mac= 0.18033 time= 0.06620
Optimization Finished!
Full validation stats: loss= 0.53807 f1_micro= 0.43873 f1_macro= 0.18102 time= 0.11367
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.45377893236341194
Rewards :  -0.01520208318356192 Accuracy :  0.4416172658165624
Total reward :  1.2126304220004898
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'tanh', 4, 'relu']
Training RNN (Reward ip) :  [-0.01520208]
Trial 262: Controller loss : 9658.028320

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 4. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:52:24.839167: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:52:24.839656: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:52:24.840141: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:52:24.840502: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:52:24.841403: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69316 train_f1_mic= 0.36769 train_f1_mac= 0.29127 val_loss= 0.66555 val_f1_mic= 0.39033 val_f1_mac= 0.12434 time= 0.77689
Iter: 0005 train_loss= 0.58928 train_f1_mic= 0.38487 train_f1_mac= 0.09156 val_loss= 0.66555 val_f1_mic= 0.39033 val_f1_mac= 0.12434 time= 0.14246
Iter: 0010 train_loss= 0.55145 train_f1_mic= 0.37125 train_f1_mac= 0.08871 val_loss= 0.66555 val_f1_mic= 0.39033 val_f1_mac= 0.12434 time= 0.08468
Iter: 0015 train_loss= 0.54949 train_f1_mic= 0.40275 train_f1_mac= 0.10535 val_loss= 0.66555 val_f1_mic= 0.39033 val_f1_mac= 0.12434 time= 0.06290
Epoch: 0002
Iter: 0001 train_loss= 0.53436 train_f1_mic= 0.39093 train_f1_mac= 0.09870 val_loss= 0.56979 val_f1_mic= 0.37329 val_f1_mac= 0.10286 time= 0.05291
Iter: 0006 train_loss= 0.54552 train_f1_mic= 0.36588 train_f1_mac= 0.09017 val_loss= 0.56979 val_f1_mic= 0.37329 val_f1_mac= 0.10286 time= 0.04588
Iter: 0011 train_loss= 0.53508 train_f1_mic= 0.37989 train_f1_mac= 0.09216 val_loss= 0.56979 val_f1_mic= 0.37329 val_f1_mac= 0.10286 time= 0.04095
Iter: 0016 train_loss= 0.53425 train_f1_mic= 0.40180 train_f1_mac= 0.10415 val_loss= 0.56979 val_f1_mic= 0.37329 val_f1_mac= 0.10286 time= 0.03745
Epoch: 0003
Iter: 0002 train_loss= 0.53370 train_f1_mic= 0.39640 train_f1_mac= 0.10407 val_loss= 0.56819 val_f1_mic= 0.38976 val_f1_mac= 0.11172 time= 0.03546
Iter: 0007 train_loss= 0.54221 train_f1_mic= 0.37752 train_f1_mac= 0.10385 val_loss= 0.56819 val_f1_mic= 0.38976 val_f1_mac= 0.11172 time= 0.03330
Iter: 0012 train_loss= 0.52808 train_f1_mic= 0.39661 train_f1_mac= 0.11843 val_loss= 0.56819 val_f1_mic= 0.38976 val_f1_mac= 0.11172 time= 0.03168
Iter: 0017 train_loss= 0.53791 train_f1_mic= 0.40815 train_f1_mac= 0.12556 val_loss= 0.56819 val_f1_mic= 0.38976 val_f1_mac= 0.11172 time= 0.03026
Epoch: 0004
Iter: 0003 train_loss= 0.51710 train_f1_mic= 0.41104 train_f1_mac= 0.12231 val_loss= 0.55012 val_f1_mic= 0.41562 val_f1_mac= 0.13480 time= 0.02936
Iter: 0008 train_loss= 0.53190 train_f1_mic= 0.42016 train_f1_mac= 0.13173 val_loss= 0.55012 val_f1_mic= 0.41562 val_f1_mac= 0.13480 time= 0.02823
Iter: 0013 train_loss= 0.51746 train_f1_mic= 0.42241 train_f1_mac= 0.13325 val_loss= 0.55012 val_f1_mic= 0.41562 val_f1_mac= 0.13480 time= 0.02722
Iter: 0018 train_loss= 0.53362 train_f1_mic= 0.44397 train_f1_mac= 0.15038 val_loss= 0.55012 val_f1_mic= 0.41562 val_f1_mac= 0.13480 time= 0.02651
Epoch: 0005
Iter: 0004 train_loss= 0.52140 train_f1_mic= 0.41682 train_f1_mac= 0.13761 val_loss= 0.54597 val_f1_mic= 0.44732 val_f1_mac= 0.16357 time= 0.02605
Iter: 0009 train_loss= 0.52629 train_f1_mic= 0.43086 train_f1_mac= 0.14886 val_loss= 0.54597 val_f1_mic= 0.44732 val_f1_mac= 0.16357 time= 0.02541
Iter: 0014 train_loss= 0.51311 train_f1_mic= 0.44617 train_f1_mac= 0.15896 val_loss= 0.54597 val_f1_mic= 0.44732 val_f1_mac= 0.16357 time= 0.02486
Epoch: 0006
Iter: 0000 train_loss= 0.51251 train_f1_mic= 0.42928 train_f1_mac= 0.15632 val_loss= 0.51884 val_f1_mic= 0.43133 val_f1_mac= 0.15992 time= 0.02445
Iter: 0005 train_loss= 0.51734 train_f1_mic= 0.47214 train_f1_mac= 0.19764 val_loss= 0.51884 val_f1_mic= 0.43133 val_f1_mac= 0.15992 time= 0.02393
Iter: 0010 train_loss= 0.51478 train_f1_mic= 0.41793 train_f1_mac= 0.15071 val_loss= 0.51884 val_f1_mic= 0.43133 val_f1_mac= 0.15992 time= 0.02355
Iter: 0015 train_loss= 0.51737 train_f1_mic= 0.44564 train_f1_mac= 0.17192 val_loss= 0.51884 val_f1_mic= 0.43133 val_f1_mac= 0.15992 time= 0.02329
Epoch: 0007
Iter: 0001 train_loss= 0.50370 train_f1_mic= 0.47273 train_f1_mac= 0.20174 val_loss= 0.52947 val_f1_mic= 0.47402 val_f1_mac= 0.20078 time= 0.02320
Iter: 0006 train_loss= 0.51645 train_f1_mic= 0.42410 train_f1_mac= 0.16608 val_loss= 0.52947 val_f1_mic= 0.47402 val_f1_mac= 0.20078 time= 0.02291
Iter: 0011 train_loss= 0.51300 train_f1_mic= 0.47101 train_f1_mac= 0.20234 val_loss= 0.52947 val_f1_mic= 0.47402 val_f1_mac= 0.20078 time= 0.02259
Iter: 0016 train_loss= 0.50383 train_f1_mic= 0.46219 train_f1_mac= 0.20426 val_loss= 0.52947 val_f1_mic= 0.47402 val_f1_mac= 0.20078 time= 0.02233
Epoch: 0008
Iter: 0002 train_loss= 0.52182 train_f1_mic= 0.46264 train_f1_mac= 0.20967 val_loss= 0.52846 val_f1_mic= 0.47245 val_f1_mac= 0.21986 time= 0.02222
Iter: 0007 train_loss= 0.51163 train_f1_mic= 0.44754 train_f1_mac= 0.20636 val_loss= 0.52846 val_f1_mic= 0.47245 val_f1_mac= 0.21986 time= 0.02198
Iter: 0012 train_loss= 0.49994 train_f1_mic= 0.50674 train_f1_mac= 0.24858 val_loss= 0.52846 val_f1_mic= 0.47245 val_f1_mac= 0.21986 time= 0.02173
Iter: 0017 train_loss= 0.50322 train_f1_mic= 0.48483 train_f1_mac= 0.24155 val_loss= 0.52846 val_f1_mic= 0.47245 val_f1_mac= 0.21986 time= 0.02148
Epoch: 0009
Iter: 0003 train_loss= 0.50559 train_f1_mic= 0.48328 train_f1_mac= 0.23716 val_loss= 0.53247 val_f1_mic= 0.51958 val_f1_mac= 0.26810 time= 0.02136
Iter: 0008 train_loss= 0.49933 train_f1_mic= 0.50578 train_f1_mac= 0.26952 val_loss= 0.53247 val_f1_mic= 0.51958 val_f1_mac= 0.26810 time= 0.02115
Iter: 0013 train_loss= 0.50234 train_f1_mic= 0.47284 train_f1_mac= 0.23105 val_loss= 0.53247 val_f1_mic= 0.51958 val_f1_mac= 0.26810 time= 0.02095
Iter: 0018 train_loss= 0.49394 train_f1_mic= 0.48443 train_f1_mac= 0.23803 val_loss= 0.53247 val_f1_mic= 0.51958 val_f1_mac= 0.26810 time= 0.02077
Epoch: 0010
Iter: 0004 train_loss= 0.49136 train_f1_mic= 0.49727 train_f1_mac= 0.25988 val_loss= 0.53852 val_f1_mic= 0.48621 val_f1_mac= 0.26100 time= 0.02067
Iter: 0009 train_loss= 0.50198 train_f1_mic= 0.48717 train_f1_mac= 0.25054 val_loss= 0.53852 val_f1_mic= 0.48621 val_f1_mac= 0.26100 time= 0.02049
Iter: 0014 train_loss= 0.49383 train_f1_mic= 0.49221 train_f1_mac= 0.26360 val_loss= 0.53852 val_f1_mic= 0.48621 val_f1_mac= 0.26100 time= 0.02039
Optimization Finished!
Full validation stats: loss= 0.51455 f1_micro= 0.49491 f1_macro= 0.27006 time= 0.09375
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4626256756460987
Rewards :  0.04423371641343382 Accuracy :  0.49801264877684576
Total reward :  1.2568641384139236
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.04423372]
Trial 263: Controller loss : 117.280190
2018-08-31 00:52:34.147243: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:52:34.147877: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:52:34.148753: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:52:34.149162: I C:\users\nwani\_bazel_n
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'linear', 4, 'sigmoid']
wani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:52:34.149949: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69076 train_f1_mic= 0.37326 train_f1_mac= 0.22558 val_loss= 0.65589 val_f1_mic= 0.38187 val_f1_mac= 0.10449 time= 0.86154
Iter: 0005 train_loss= 0.57900 train_f1_mic= 0.35982 train_f1_mac= 0.08783 val_loss= 0.65589 val_f1_mic= 0.38187 val_f1_mac= 0.10449 time= 0.17998
Iter: 0010 train_loss= 0.53478 train_f1_mic= 0.38804 train_f1_mac= 0.09485 val_loss= 0.65589 val_f1_mic= 0.38187 val_f1_mac= 0.10449 time= 0.11865
Iter: 0015 train_loss= 0.54965 train_f1_mic= 0.36161 train_f1_mac= 0.08698 val_loss= 0.65589 val_f1_mic= 0.38187 val_f1_mac= 0.10449 time= 0.09485
Epoch: 0002
Iter: 0001 train_loss= 0.53626 train_f1_mic= 0.39171 train_f1_mac= 0.10057 val_loss= 0.56790 val_f1_mic= 0.38354 val_f1_mac= 0.10665 time= 0.08324
Iter: 0006 train_loss= 0.53569 train_f1_mic= 0.39211 train_f1_mac= 0.10500 val_loss= 0.56790 val_f1_mic= 0.38354 val_f1_mac= 0.10665 time= 0.07536
Iter: 0011 train_loss= 0.53611 train_f1_mic= 0.40952 train_f1_mac= 0.12114 val_loss= 0.56790 val_f1_mic= 0.38354 val_f1_mac= 0.10665 time= 0.06999
Iter: 0016 train_loss= 0.53669 train_f1_mic= 0.41547 train_f1_mac= 0.13058 val_loss= 0.56790 val_f1_mic= 0.38354 val_f1_mac= 0.10665 time= 0.06645
Epoch: 0003
Iter: 0002 train_loss= 0.53711 train_f1_mic= 0.41187 train_f1_mac= 0.12869 val_loss= 0.54434 val_f1_mic= 0.40261 val_f1_mac= 0.12716 time= 0.06413
Iter: 0007 train_loss= 0.53633 train_f1_mic= 0.44145 train_f1_mac= 0.14763 val_loss= 0.54434 val_f1_mic= 0.40261 val_f1_mac= 0.12716 time= 0.06169
Iter: 0012 train_loss= 0.52119 train_f1_mic= 0.42501 train_f1_mac= 0.13781 val_loss= 0.54434 val_f1_mic= 0.40261 val_f1_mac= 0.12716 time= 0.05963
Iter: 0017 train_loss= 0.53873 train_f1_mic= 0.40933 train_f1_mac= 0.12704 val_loss= 0.54434 val_f1_mic= 0.40261 val_f1_mac= 0.12716 time= 0.05816
Epoch: 0004
Iter: 0003 train_loss= 0.52296 train_f1_mic= 0.42591 train_f1_mac= 0.13327 val_loss= 0.54619 val_f1_mic= 0.42232 val_f1_mac= 0.13614 time= 0.05718
Iter: 0008 train_loss= 0.53066 train_f1_mic= 0.40055 train_f1_mac= 0.12561 val_loss= 0.54619 val_f1_mic= 0.42232 val_f1_mac= 0.13614 time= 0.05619
Iter: 0013 train_loss= 0.52161 train_f1_mic= 0.43069 train_f1_mac= 0.13170 val_loss= 0.54619 val_f1_mic= 0.42232 val_f1_mac= 0.13614 time= 0.05512
Iter: 0018 train_loss= 0.52449 train_f1_mic= 0.44224 train_f1_mac= 0.14884 val_loss= 0.54619 val_f1_mic= 0.42232 val_f1_mac= 0.13614 time= 0.05427
Epoch: 0005
Iter: 0004 train_loss= 0.53529 train_f1_mic= 0.40805 train_f1_mac= 0.13408 val_loss= 0.56103 val_f1_mic= 0.43311 val_f1_mac= 0.15340 time= 0.05379
Iter: 0009 train_loss= 0.52449 train_f1_mic= 0.43566 train_f1_mac= 0.14789 val_loss= 0.56103 val_f1_mic= 0.43311 val_f1_mac= 0.15340 time= 0.05327
Iter: 0014 train_loss= 0.53356 train_f1_mic= 0.43230 train_f1_mac= 0.15309 val_loss= 0.56103 val_f1_mic= 0.43311 val_f1_mac= 0.15340 time= 0.05278
Epoch: 0006
Iter: 0000 train_loss= 0.52817 train_f1_mic= 0.43466 train_f1_mac= 0.15481 val_loss= 0.53808 val_f1_mic= 0.45012 val_f1_mac= 0.16693 time= 0.05264
Iter: 0005 train_loss= 0.52061 train_f1_mic= 0.42688 train_f1_mac= 0.14493 val_loss= 0.53808 val_f1_mic= 0.45012 val_f1_mac= 0.16693 time= 0.05205
Iter: 0010 train_loss= 0.52305 train_f1_mic= 0.44173 train_f1_mac= 0.16160 val_loss= 0.53808 val_f1_mic= 0.45012 val_f1_mac= 0.16693 time= 0.05159
Iter: 0015 train_loss= 0.51476 train_f1_mic= 0.46136 train_f1_mac= 0.16703 val_loss= 0.53808 val_f1_mic= 0.45012 val_f1_mac= 0.16693 time= 0.05113
Epoch: 0007
Iter: 0001 train_loss= 0.51160 train_f1_mic= 0.44534 train_f1_mac= 0.16212 val_loss= 0.52143 val_f1_mic= 0.46111 val_f1_mac= 0.17947 time= 0.05098
Iter: 0006 train_loss= 0.51601 train_f1_mic= 0.46942 train_f1_mac= 0.20128 val_loss= 0.52143 val_f1_mic= 0.46111 val_f1_mac= 0.17947 time= 0.05071
Iter: 0011 train_loss= 0.51906 train_f1_mic= 0.47601 train_f1_mac= 0.20784 val_loss= 0.52143 val_f1_mic= 0.46111 val_f1_mac= 0.17947 time= 0.05036
Iter: 0016 train_loss= 0.51605 train_f1_mic= 0.44190 train_f1_mac= 0.17075 val_loss= 0.52143 val_f1_mic= 0.46111 val_f1_mac= 0.17947 time= 0.05013
Epoch: 0008
Iter: 0002 train_loss= 0.52372 train_f1_mic= 0.47034 train_f1_mac= 0.20788 val_loss= 0.53523 val_f1_mic= 0.48062 val_f1_mac= 0.21712 time= 0.05007
Iter: 0007 train_loss= 0.50456 train_f1_mic= 0.44653 train_f1_mac= 0.17349 val_loss= 0.53523 val_f1_mic= 0.48062 val_f1_mac= 0.21712 time= 0.04990
Iter: 0012 train_loss= 0.50236 train_f1_mic= 0.47828 train_f1_mac= 0.20916 val_loss= 0.53523 val_f1_mic= 0.48062 val_f1_mac= 0.21712 time= 0.04970
Iter: 0017 train_loss= 0.50791 train_f1_mic= 0.47319 train_f1_mac= 0.20876 val_loss= 0.53523 val_f1_mic= 0.48062 val_f1_mac= 0.21712 time= 0.04942
Epoch: 0009
Iter: 0003 train_loss= 0.50964 train_f1_mic= 0.47093 train_f1_mac= 0.20716 val_loss= 0.53369 val_f1_mic= 0.48240 val_f1_mac= 0.22812 time= 0.04930
Iter: 0008 train_loss= 0.51163 train_f1_mic= 0.46468 train_f1_mac= 0.20265 val_loss= 0.53369 val_f1_mic= 0.48240 val_f1_mac= 0.22812 time= 0.04911
Iter: 0013 train_loss= 0.51107 train_f1_mic= 0.44688 train_f1_mac= 0.18355 val_loss= 0.53369 val_f1_mic= 0.48240 val_f1_mac= 0.22812 time= 0.04886
Iter: 0018 train_loss= 0.50160 train_f1_mic= 0.44890 train_f1_mac= 0.18347 val_loss= 0.53369 val_f1_mic= 0.48240 val_f1_mac= 0.22812 time= 0.04865
Epoch: 0010
Iter: 0004 train_loss= 0.52479 train_f1_mic= 0.47062 train_f1_mac= 0.21034 val_loss= 0.54396 val_f1_mic= 0.47776 val_f1_mac= 0.22309 time= 0.04856
Iter: 0009 train_loss= 0.50973 train_f1_mic= 0.48661 train_f1_mac= 0.22620 val_loss= 0.54396 val_f1_mic= 0.47776 val_f1_mac= 0.22309 time= 0.04843
Iter: 0014 train_loss= 0.50987 train_f1_mic= 0.47731 train_f1_mac= 0.22205 val_loss= 0.54396 val_f1_mic= 0.47776 val_f1_mac= 0.22309 time= 0.04825
Optimization Finished!
Full validation stats: loss= 0.52882 f1_micro= 0.50946 f1_macro= 0.26130 time= 0.11769
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46985302494777864
Rewards :  0.036136746508399764 Accuracy :  0.49876242215449845
Total reward :  1.2930008849223233
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'linear', 4, 'sigmoid']
Training RNN (Reward ip) :  [0.03613675]
Trial 264: Controller loss : 13421.540039

Prediction action from Controller
State input to Controller for Action :  [0. 0. 3. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:52:49.330113: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:52:49.330414: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:52:49.330711: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:52:49.330928: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:52:49.331195: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69369 train_f1_mic= 0.37698 train_f1_mac= 0.30729 val_loss= 0.66392 val_f1_mic= 0.38945 val_f1_mac= 0.11305 time= 0.76896
Iter: 0005 train_loss= 0.59160 train_f1_mic= 0.37398 train_f1_mac= 0.09116 val_loss= 0.66392 val_f1_mic= 0.38945 val_f1_mac= 0.11305 time= 0.14080
Iter: 0010 train_loss= 0.55605 train_f1_mic= 0.36487 train_f1_mac= 0.09015 val_loss= 0.66392 val_f1_mic= 0.38945 val_f1_mac= 0.11305 time= 0.08341
Iter: 0015 train_loss= 0.53836 train_f1_mic= 0.39577 train_f1_mac= 0.09865 val_loss= 0.66392 val_f1_mic= 0.38945 val_f1_mac= 0.11305 time= 0.06227
Epoch: 0002
Iter: 0001 train_loss= 0.53691 train_f1_mic= 0.39877 train_f1_mac= 0.10136 val_loss= 0.56408 val_f1_mic= 0.39085 val_f1_mac= 0.10470 time= 0.05167
Iter: 0006 train_loss= 0.54067 train_f1_mic= 0.38193 train_f1_mac= 0.09579 val_loss= 0.56408 val_f1_mic= 0.39085 val_f1_mac= 0.10470 time= 0.04476
Iter: 0011 train_loss= 0.53684 train_f1_mic= 0.37552 train_f1_mac= 0.09275 val_loss= 0.56408 val_f1_mic= 0.39085 val_f1_mac= 0.10470 time= 0.04002
Iter: 0016 train_loss= 0.53347 train_f1_mic= 0.38807 train_f1_mac= 0.09928 val_loss= 0.56408 val_f1_mic= 0.39085 val_f1_mac= 0.10470 time= 0.03637
Epoch: 0003
Iter: 0002 train_loss= 0.52812 train_f1_mic= 0.39983 train_f1_mac= 0.10881 val_loss= 0.55081 val_f1_mic= 0.39023 val_f1_mac= 0.10844 time= 0.03425
Iter: 0007 train_loss= 0.52711 train_f1_mic= 0.40850 train_f1_mac= 0.11809 val_loss= 0.55081 val_f1_mic= 0.39023 val_f1_mac= 0.10844 time= 0.03209
Iter: 0012 train_loss= 0.53640 train_f1_mic= 0.38633 train_f1_mac= 0.11425 val_loss= 0.55081 val_f1_mic= 0.39023 val_f1_mac= 0.10844 time= 0.03044
Iter: 0017 train_loss= 0.52264 train_f1_mic= 0.42693 train_f1_mac= 0.13230 val_loss= 0.55081 val_f1_mic= 0.39023 val_f1_mac= 0.10844 time= 0.02904
Epoch: 0004
Iter: 0003 train_loss= 0.52449 train_f1_mic= 0.40503 train_f1_mac= 0.12475 val_loss= 0.57005 val_f1_mic= 0.40469 val_f1_mac= 0.13833 time= 0.02817
Iter: 0008 train_loss= 0.52493 train_f1_mic= 0.41696 train_f1_mac= 0.13218 val_loss= 0.57005 val_f1_mic= 0.40469 val_f1_mac= 0.13833 time= 0.02712
Iter: 0013 train_loss= 0.52901 train_f1_mic= 0.42193 train_f1_mac= 0.13913 val_loss= 0.57005 val_f1_mic= 0.40469 val_f1_mac= 0.13833 time= 0.02619
Iter: 0018 train_loss= 0.52984 train_f1_mic= 0.41628 train_f1_mac= 0.14095 val_loss= 0.57005 val_f1_mic= 0.40469 val_f1_mac= 0.13833 time= 0.02545
Epoch: 0005
Iter: 0004 train_loss= 0.52044 train_f1_mic= 0.44753 train_f1_mac= 0.16255 val_loss= 0.52741 val_f1_mic= 0.42955 val_f1_mac= 0.15806 time= 0.02519
Iter: 0009 train_loss= 0.52673 train_f1_mic= 0.42959 train_f1_mac= 0.15770 val_loss= 0.52741 val_f1_mic= 0.42955 val_f1_mac= 0.15806 time= 0.02469
Iter: 0014 train_loss= 0.51094 train_f1_mic= 0.42614 train_f1_mac= 0.15580 val_loss= 0.52741 val_f1_mic= 0.42955 val_f1_mac= 0.15806 time= 0.02408
Epoch: 0006
Iter: 0000 train_loss= 0.51485 train_f1_mic= 0.47888 train_f1_mac= 0.20411 val_loss= 0.53171 val_f1_mic= 0.46281 val_f1_mac= 0.19473 time= 0.02381
Iter: 0005 train_loss= 0.52860 train_f1_mic= 0.43149 train_f1_mac= 0.16654 val_loss= 0.53171 val_f1_mic= 0.46281 val_f1_mac= 0.19473 time= 0.02337
Iter: 0010 train_loss= 0.52204 train_f1_mic= 0.44486 train_f1_mac= 0.17706 val_loss= 0.53171 val_f1_mic= 0.46281 val_f1_mac= 0.19473 time= 0.02294
Iter: 0015 train_loss= 0.50060 train_f1_mic= 0.45673 train_f1_mac= 0.18428 val_loss= 0.53171 val_f1_mic= 0.46281 val_f1_mac= 0.19473 time= 0.02258
Epoch: 0007
Iter: 0001 train_loss= 0.51681 train_f1_mic= 0.45761 train_f1_mac= 0.19539 val_loss= 0.52349 val_f1_mic= 0.49290 val_f1_mac= 0.23246 time= 0.02255
Iter: 0006 train_loss= 0.50741 train_f1_mic= 0.45736 train_f1_mac= 0.19344 val_loss= 0.52349 val_f1_mic= 0.49290 val_f1_mac= 0.23246 time= 0.02231
Iter: 0011 train_loss= 0.50009 train_f1_mic= 0.46349 train_f1_mac= 0.19768 val_loss= 0.52349 val_f1_mic= 0.49290 val_f1_mac= 0.23246 time= 0.02208
Iter: 0016 train_loss= 0.51152 train_f1_mic= 0.50442 train_f1_mac= 0.24482 val_loss= 0.52349 val_f1_mic= 0.49290 val_f1_mac= 0.23246 time= 0.02181
Epoch: 0008
Iter: 0002 train_loss= 0.51037 train_f1_mic= 0.45727 train_f1_mac= 0.21215 val_loss= 0.52352 val_f1_mic= 0.43282 val_f1_mac= 0.19308 time= 0.02171
Iter: 0007 train_loss= 0.50817 train_f1_mic= 0.44101 train_f1_mac= 0.19021 val_loss= 0.52352 val_f1_mic= 0.43282 val_f1_mac= 0.19308 time= 0.02143
Iter: 0012 train_loss= 0.49991 train_f1_mic= 0.49317 train_f1_mac= 0.24782 val_loss= 0.52352 val_f1_mic= 0.43282 val_f1_mac= 0.19308 time= 0.02117
Iter: 0017 train_loss= 0.49913 train_f1_mic= 0.49868 train_f1_mac= 0.25275 val_loss= 0.52352 val_f1_mic= 0.43282 val_f1_mac= 0.19308 time= 0.02093
Epoch: 0009
Iter: 0003 train_loss= 0.48748 train_f1_mic= 0.46836 train_f1_mac= 0.22443 val_loss= 0.51920 val_f1_mic= 0.47152 val_f1_mac= 0.22513 time= 0.02084
Iter: 0008 train_loss= 0.50742 train_f1_mic= 0.48788 train_f1_mac= 0.25723 val_loss= 0.51920 val_f1_mic= 0.47152 val_f1_mac= 0.22513 time= 0.02064
Iter: 0013 train_loss= 0.49372 train_f1_mic= 0.49391 train_f1_mac= 0.25519 val_loss= 0.51920 val_f1_mic= 0.47152 val_f1_mac= 0.22513 time= 0.02046
Iter: 0018 train_loss= 0.50449 train_f1_mic= 0.48163 train_f1_mac= 0.22966 val_loss= 0.51920 val_f1_mic= 0.47152 val_f1_mac= 0.22513 time= 0.02034
Epoch: 0010
Iter: 0004 train_loss= 0.49897 train_f1_mic= 0.47230 train_f1_mac= 0.24173 val_loss= 0.52485 val_f1_mic= 0.51742 val_f1_mac= 0.28833 time= 0.02025
Iter: 0009 train_loss= 0.49331 train_f1_mic= 0.47750 train_f1_mac= 0.23378 val_loss= 0.52485 val_f1_mic= 0.51742 val_f1_mac= 0.28833 time= 0.02015
Iter: 0014 train_loss= 0.50224 train_f1_mic= 0.53379 train_f1_mac= 0.30391 val_loss= 0.52485 val_f1_mic= 0.51742 val_f1_mac= 0.28833 time= 0.02000
Optimization Finished!
Full validation stats: loss= 0.51326 f1_micro= 0.49485 f1_macro= 0.26569 time= 0.13065
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47436212146738366
Rewards :  0.022545482598025246 Accuracy :  0.4923985075458039
Total reward :  1.3155463675203487
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02254548]
Trial 265: Controller loss : 116.014252
2018-08-31 00:52:58.633269: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:52:58.633746: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:52:58.634210: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:52:58.634548: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:52:58.634975: I C:\users\nwani\_bazel_nwan
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [0, 'linear', 1, 'linear']
i\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69415 train_f1_mic= 0.37923 train_f1_mac= 0.35632 val_loss= 0.68636 val_f1_mic= 0.40688 val_f1_mac= 0.36368 time= 1.00032
Iter: 0005 train_loss= 0.60842 train_f1_mic= 0.38284 train_f1_mac= 0.12172 val_loss= 0.68636 val_f1_mic= 0.40688 val_f1_mac= 0.36368 time= 0.18934
Iter: 0010 train_loss= 0.55265 train_f1_mic= 0.39258 train_f1_mac= 0.10022 val_loss= 0.68636 val_f1_mic= 0.40688 val_f1_mac= 0.36368 time= 0.11443
Iter: 0015 train_loss= 0.54527 train_f1_mic= 0.36761 train_f1_mac= 0.09091 val_loss= 0.68636 val_f1_mic= 0.40688 val_f1_mac= 0.36368 time= 0.08615
Epoch: 0002
Iter: 0001 train_loss= 0.55706 train_f1_mic= 0.39180 train_f1_mac= 0.10934 val_loss= 0.56745 val_f1_mic= 0.38637 val_f1_mac= 0.11782 time= 0.07476
Iter: 0006 train_loss= 0.53724 train_f1_mic= 0.41425 train_f1_mac= 0.13149 val_loss= 0.56745 val_f1_mic= 0.38637 val_f1_mac= 0.11782 time= 0.06544
Iter: 0011 train_loss= 0.54080 train_f1_mic= 0.40560 train_f1_mac= 0.14043 val_loss= 0.56745 val_f1_mic= 0.38637 val_f1_mac= 0.11782 time= 0.05907
Iter: 0016 train_loss= 0.52956 train_f1_mic= 0.42629 train_f1_mac= 0.15828 val_loss= 0.56745 val_f1_mic= 0.38637 val_f1_mac= 0.11782 time= 0.05441
Epoch: 0003
Iter: 0002 train_loss= 0.52678 train_f1_mic= 0.41100 train_f1_mac= 0.13397 val_loss= 0.54735 val_f1_mic= 0.40039 val_f1_mac= 0.13632 time= 0.05242
Iter: 0007 train_loss= 0.53004 train_f1_mic= 0.42207 train_f1_mac= 0.15194 val_loss= 0.54735 val_f1_mic= 0.40039 val_f1_mac= 0.13632 time= 0.04932
Iter: 0012 train_loss= 0.53190 train_f1_mic= 0.42450 train_f1_mac= 0.15623 val_loss= 0.54735 val_f1_mic= 0.40039 val_f1_mac= 0.13632 time= 0.04682
Iter: 0017 train_loss= 0.52893 train_f1_mic= 0.41851 train_f1_mac= 0.14546 val_loss= 0.54735 val_f1_mic= 0.40039 val_f1_mac= 0.13632 time= 0.04477
Epoch: 0004
Iter: 0003 train_loss= 0.52134 train_f1_mic= 0.43043 train_f1_mac= 0.16108 val_loss= 0.54534 val_f1_mic= 0.41095 val_f1_mac= 0.14520 time= 0.04344
Iter: 0008 train_loss= 0.52187 train_f1_mic= 0.42170 train_f1_mac= 0.14893 val_loss= 0.54534 val_f1_mic= 0.41095 val_f1_mac= 0.14520 time= 0.04204
Iter: 0013 train_loss= 0.52441 train_f1_mic= 0.42086 train_f1_mac= 0.16021 val_loss= 0.54534 val_f1_mic= 0.41095 val_f1_mac= 0.14520 time= 0.04078
Iter: 0018 train_loss= 0.53411 train_f1_mic= 0.42165 train_f1_mac= 0.15427 val_loss= 0.54534 val_f1_mic= 0.41095 val_f1_mac= 0.14520 time= 0.04009
Epoch: 0005
Iter: 0004 train_loss= 0.52316 train_f1_mic= 0.42454 train_f1_mac= 0.15467 val_loss= 0.53936 val_f1_mic= 0.42622 val_f1_mac= 0.16147 time= 0.03941
Iter: 0009 train_loss= 0.53168 train_f1_mic= 0.42938 train_f1_mac= 0.16098 val_loss= 0.53936 val_f1_mic= 0.42622 val_f1_mac= 0.16147 time= 0.03856
Iter: 0014 train_loss= 0.53590 train_f1_mic= 0.41484 train_f1_mac= 0.14939 val_loss= 0.53936 val_f1_mic= 0.42622 val_f1_mac= 0.16147 time= 0.03778
Epoch: 0006
Iter: 0000 train_loss= 0.52570 train_f1_mic= 0.43112 train_f1_mac= 0.16457 val_loss= 0.53708 val_f1_mic= 0.43804 val_f1_mac= 0.17629 time= 0.03744
Iter: 0005 train_loss= 0.52478 train_f1_mic= 0.43826 train_f1_mac= 0.18433 val_loss= 0.53708 val_f1_mic= 0.43804 val_f1_mac= 0.17629 time= 0.03684
Iter: 0010 train_loss= 0.52431 train_f1_mic= 0.41947 train_f1_mac= 0.16001 val_loss= 0.53708 val_f1_mic= 0.43804 val_f1_mac= 0.17629 time= 0.03653
Iter: 0015 train_loss= 0.51803 train_f1_mic= 0.44928 train_f1_mac= 0.17308 val_loss= 0.53708 val_f1_mic= 0.43804 val_f1_mac= 0.17629 time= 0.03596
Epoch: 0007
Iter: 0001 train_loss= 0.51926 train_f1_mic= 0.41586 train_f1_mac= 0.14797 val_loss= 0.54272 val_f1_mic= 0.41627 val_f1_mac= 0.15313 time= 0.03564
Iter: 0006 train_loss= 0.52014 train_f1_mic= 0.45008 train_f1_mac= 0.19240 val_loss= 0.54272 val_f1_mic= 0.41627 val_f1_mac= 0.15313 time= 0.03527
Iter: 0011 train_loss= 0.51220 train_f1_mic= 0.43690 train_f1_mac= 0.16418 val_loss= 0.54272 val_f1_mic= 0.41627 val_f1_mac= 0.15313 time= 0.03487
Iter: 0016 train_loss= 0.52295 train_f1_mic= 0.44921 train_f1_mac= 0.17581 val_loss= 0.54272 val_f1_mic= 0.41627 val_f1_mac= 0.15313 time= 0.03445
Epoch: 0008
Iter: 0002 train_loss= 0.52663 train_f1_mic= 0.41356 train_f1_mac= 0.15892 val_loss= 0.53750 val_f1_mic= 0.43299 val_f1_mac= 0.17800 time= 0.03436
Iter: 0007 train_loss= 0.51796 train_f1_mic= 0.44904 train_f1_mac= 0.19944 val_loss= 0.53750 val_f1_mic= 0.43299 val_f1_mac= 0.17800 time= 0.03400
Iter: 0012 train_loss= 0.52004 train_f1_mic= 0.45989 train_f1_mac= 0.19071 val_loss= 0.53750 val_f1_mic= 0.43299 val_f1_mac= 0.17800 time= 0.03366
Iter: 0017 train_loss= 0.52302 train_f1_mic= 0.42687 train_f1_mac= 0.15307 val_loss= 0.53750 val_f1_mic= 0.43299 val_f1_mac= 0.17800 time= 0.03352
Epoch: 0009
Iter: 0003 train_loss= 0.51372 train_f1_mic= 0.45157 train_f1_mac= 0.19353 val_loss= 0.53303 val_f1_mic= 0.45449 val_f1_mac= 0.20060 time= 0.03349
Iter: 0008 train_loss= 0.51802 train_f1_mic= 0.45837 train_f1_mac= 0.21773 val_loss= 0.53303 val_f1_mic= 0.45449 val_f1_mac= 0.20060 time= 0.03319
Iter: 0013 train_loss= 0.51341 train_f1_mic= 0.44203 train_f1_mac= 0.17986 val_loss= 0.53303 val_f1_mic= 0.45449 val_f1_mac= 0.20060 time= 0.03302
Iter: 0018 train_loss= 0.51353 train_f1_mic= 0.45859 train_f1_mac= 0.19673 val_loss= 0.53303 val_f1_mic= 0.45449 val_f1_mac= 0.20060 time= 0.03287
Epoch: 0010
Iter: 0004 train_loss= 0.51695 train_f1_mic= 0.46883 train_f1_mac= 0.20703 val_loss= 0.53615 val_f1_mic= 0.44637 val_f1_mac= 0.19415 time= 0.03282
Iter: 0009 train_loss= 0.50813 train_f1_mic= 0.43123 train_f1_mac= 0.16886 val_loss= 0.53615 val_f1_mic= 0.44637 val_f1_mac= 0.19415 time= 0.03262
Iter: 0014 train_loss= 0.52378 train_f1_mic= 0.43876 train_f1_mac= 0.18203 val_loss= 0.53615 val_f1_mic= 0.44637 val_f1_mac= 0.19415 time= 0.03249
Optimization Finished!
Full validation stats: loss= 0.53413 f1_micro= 0.46431 f1_macro= 0.22166 time= 0.14561
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4709654575761182
Rewards :  -0.016983319456327417 Accuracy :  0.45737880201105624
Total reward :  1.2985630480640213
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'linear', 1, 'linear']
Training RNN (Reward ip) :  [-0.01698332]
Trial 266: Controller loss : 10689.834961

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'relu', 0, 'tanh']
2018-08-31 00:53:10.854127: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:53:10.854376: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:53:10.854603: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:53:10.854767: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:53:10.854977: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69240 train_f1_mic= 0.37924 train_f1_mac= 0.27667 val_loss= 0.66565 val_f1_mic= 0.42231 val_f1_mac= 0.13621 time= 0.86730
Iter: 0005 train_loss= 0.58566 train_f1_mic= 0.37235 train_f1_mac= 0.09191 val_loss= 0.66565 val_f1_mic= 0.42231 val_f1_mac= 0.13621 time= 0.19442
Iter: 0010 train_loss= 0.54384 train_f1_mic= 0.39742 train_f1_mac= 0.10141 val_loss= 0.66565 val_f1_mic= 0.42231 val_f1_mac= 0.13621 time= 0.13326
Iter: 0015 train_loss= 0.53805 train_f1_mic= 0.38186 train_f1_mac= 0.09152 val_loss= 0.66565 val_f1_mic= 0.42231 val_f1_mac= 0.13621 time= 0.11044
Epoch: 0002
Iter: 0001 train_loss= 0.53758 train_f1_mic= 0.38749 train_f1_mac= 0.09253 val_loss= 0.56877 val_f1_mic= 0.37410 val_f1_mac= 0.09486 time= 0.09939
Iter: 0006 train_loss= 0.54310 train_f1_mic= 0.38155 train_f1_mac= 0.09266 val_loss= 0.56877 val_f1_mic= 0.37410 val_f1_mac= 0.09486 time= 0.09194
Iter: 0011 train_loss= 0.53804 train_f1_mic= 0.39225 train_f1_mac= 0.09694 val_loss= 0.56877 val_f1_mic= 0.37410 val_f1_mac= 0.09486 time= 0.08689
Iter: 0016 train_loss= 0.54403 train_f1_mic= 0.39178 train_f1_mac= 0.09828 val_loss= 0.56877 val_f1_mic= 0.37410 val_f1_mac= 0.09486 time= 0.08313
Epoch: 0003
Iter: 0002 train_loss= 0.54469 train_f1_mic= 0.39066 train_f1_mac= 0.09899 val_loss= 0.57670 val_f1_mic= 0.36957 val_f1_mac= 0.10011 time= 0.08085
Iter: 0007 train_loss= 0.54586 train_f1_mic= 0.38593 train_f1_mac= 0.09511 val_loss= 0.57670 val_f1_mic= 0.36957 val_f1_mac= 0.10011 time= 0.07870
Iter: 0012 train_loss= 0.53900 train_f1_mic= 0.40113 train_f1_mac= 0.10676 val_loss= 0.57670 val_f1_mic= 0.36957 val_f1_mac= 0.10011 time= 0.07689
Iter: 0017 train_loss= 0.53338 train_f1_mic= 0.38276 train_f1_mac= 0.09578 val_loss= 0.57670 val_f1_mic= 0.36957 val_f1_mac= 0.10011 time= 0.07535
Epoch: 0004
Iter: 0003 train_loss= 0.53142 train_f1_mic= 0.39948 train_f1_mac= 0.10227 val_loss= 0.57862 val_f1_mic= 0.37270 val_f1_mac= 0.10399 time= 0.07457
Iter: 0008 train_loss= 0.53440 train_f1_mic= 0.41537 train_f1_mac= 0.11214 val_loss= 0.57862 val_f1_mic= 0.37270 val_f1_mac= 0.10399 time= 0.07353
Iter: 0013 train_loss= 0.53906 train_f1_mic= 0.37312 train_f1_mac= 0.09558 val_loss= 0.57862 val_f1_mic= 0.37270 val_f1_mac= 0.10399 time= 0.07260
Iter: 0018 train_loss= 0.54078 train_f1_mic= 0.38929 train_f1_mac= 0.10412 val_loss= 0.57862 val_f1_mic= 0.37270 val_f1_mac= 0.10399 time= 0.07179
Epoch: 0005
Iter: 0004 train_loss= 0.53488 train_f1_mic= 0.39719 train_f1_mac= 0.10872 val_loss= 0.55716 val_f1_mic= 0.38850 val_f1_mac= 0.10841 time= 0.07140
Iter: 0009 train_loss= 0.53906 train_f1_mic= 0.40476 train_f1_mac= 0.11460 val_loss= 0.55716 val_f1_mic= 0.38850 val_f1_mac= 0.10841 time= 0.07076
Iter: 0014 train_loss= 0.53195 train_f1_mic= 0.39097 train_f1_mac= 0.10954 val_loss= 0.55716 val_f1_mic= 0.38850 val_f1_mac= 0.10841 time= 0.07018
Epoch: 0006
Iter: 0000 train_loss= 0.52880 train_f1_mic= 0.43046 train_f1_mac= 0.12955 val_loss= 0.52658 val_f1_mic= 0.40772 val_f1_mac= 0.12181 time= 0.06989
Iter: 0005 train_loss= 0.53303 train_f1_mic= 0.42857 train_f1_mac= 0.13225 val_loss= 0.52658 val_f1_mic= 0.40772 val_f1_mac= 0.12181 time= 0.06940
Iter: 0010 train_loss= 0.52458 train_f1_mic= 0.42131 train_f1_mac= 0.13091 val_loss= 0.52658 val_f1_mic= 0.40772 val_f1_mac= 0.12181 time= 0.06898
Iter: 0015 train_loss= 0.53332 train_f1_mic= 0.40506 train_f1_mac= 0.12594 val_loss= 0.52658 val_f1_mic= 0.40772 val_f1_mac= 0.12181 time= 0.06859
Epoch: 0007
Iter: 0001 train_loss= 0.51751 train_f1_mic= 0.42499 train_f1_mac= 0.13594 val_loss= 0.55200 val_f1_mic= 0.44540 val_f1_mac= 0.14779 time= 0.06838
Iter: 0006 train_loss= 0.52575 train_f1_mic= 0.44014 train_f1_mac= 0.13925 val_loss= 0.55200 val_f1_mic= 0.44540 val_f1_mac= 0.14779 time= 0.06804
Iter: 0011 train_loss= 0.53380 train_f1_mic= 0.41916 train_f1_mac= 0.13443 val_loss= 0.55200 val_f1_mic= 0.44540 val_f1_mac= 0.14779 time= 0.06774
Iter: 0016 train_loss= 0.51920 train_f1_mic= 0.42465 train_f1_mac= 0.13123 val_loss= 0.55200 val_f1_mic= 0.44540 val_f1_mac= 0.14779 time= 0.06745
Epoch: 0008
Iter: 0002 train_loss= 0.52459 train_f1_mic= 0.43512 train_f1_mac= 0.13994 val_loss= 0.53967 val_f1_mic= 0.42384 val_f1_mac= 0.13993 time= 0.06736
Iter: 0007 train_loss= 0.52743 train_f1_mic= 0.40813 train_f1_mac= 0.12793 val_loss= 0.53967 val_f1_mic= 0.42384 val_f1_mac= 0.13993 time= 0.06710
Iter: 0012 train_loss= 0.52937 train_f1_mic= 0.43522 train_f1_mac= 0.14294 val_loss= 0.53967 val_f1_mic= 0.42384 val_f1_mac= 0.13993 time= 0.06687
Iter: 0017 train_loss= 0.52251 train_f1_mic= 0.41947 train_f1_mac= 0.13169 val_loss= 0.53967 val_f1_mic= 0.42384 val_f1_mac= 0.13993 time= 0.06665
Epoch: 0009
Iter: 0003 train_loss= 0.52106 train_f1_mic= 0.42157 train_f1_mac= 0.13272 val_loss= 0.55556 val_f1_mic= 0.44101 val_f1_mac= 0.15252 time= 0.06663
Iter: 0008 train_loss= 0.52628 train_f1_mic= 0.41760 train_f1_mac= 0.13528 val_loss= 0.55556 val_f1_mic= 0.44101 val_f1_mac= 0.15252 time= 0.06644
Iter: 0013 train_loss= 0.51363 train_f1_mic= 0.42851 train_f1_mac= 0.14358 val_loss= 0.55556 val_f1_mic= 0.44101 val_f1_mac= 0.15252 time= 0.06627
Iter: 0018 train_loss= 0.51443 train_f1_mic= 0.46076 train_f1_mac= 0.16908 val_loss= 0.55556 val_f1_mic= 0.44101 val_f1_mac= 0.15252 time= 0.06608
Epoch: 0010
Iter: 0004 train_loss= 0.51833 train_f1_mic= 0.44708 train_f1_mac= 0.16430 val_loss= 0.54320 val_f1_mic= 0.43565 val_f1_mac= 0.16536 time= 0.06602
Iter: 0009 train_loss= 0.52102 train_f1_mic= 0.40981 train_f1_mac= 0.13153 val_loss= 0.54320 val_f1_mic= 0.43565 val_f1_mac= 0.16536 time= 0.06587
Iter: 0014 train_loss= 0.50871 train_f1_mic= 0.44063 train_f1_mac= 0.15252 val_loss= 0.54320 val_f1_mic= 0.43565 val_f1_mac= 0.16536 time= 0.06571
Optimization Finished!
Full validation stats: loss= 0.53796 f1_micro= 0.47268 f1_macro= 0.19528 time= 0.13161
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4705068481550893
Rewards :  -0.0022930471051445522 Accuracy :  0.46867241047097363
Total reward :  1.2962700009588768
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'relu', 0, 'tanh']
Training RNN (Reward ip) :  [-0.00229305]
Trial 267: Controller loss : 5960.472168

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [1, 'relu', 2, 'linear']
2018-08-31 00:53:28.562519: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:53:28.562902: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:53:28.563273: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:53:28.563548: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:53:28.563888: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69255 train_f1_mic= 0.36787 train_f1_mac= 0.31374 val_loss= 0.66679 val_f1_mic= 0.37887 val_f1_mac= 0.12009 time= 1.32147
Iter: 0005 train_loss= 0.57707 train_f1_mic= 0.37851 train_f1_mac= 0.09270 val_loss= 0.66679 val_f1_mic= 0.37887 val_f1_mac= 0.12009 time= 0.32513
Iter: 0010 train_loss= 0.54741 train_f1_mic= 0.36922 train_f1_mac= 0.08744 val_loss= 0.66679 val_f1_mic= 0.37887 val_f1_mac= 0.12009 time= 0.23310
Iter: 0015 train_loss= 0.53128 train_f1_mic= 0.40348 train_f1_mac= 0.10083 val_loss= 0.66679 val_f1_mic= 0.37887 val_f1_mac= 0.12009 time= 0.19921
Epoch: 0002
Iter: 0001 train_loss= 0.54459 train_f1_mic= 0.37757 train_f1_mac= 0.09192 val_loss= 0.57049 val_f1_mic= 0.36938 val_f1_mac= 0.09518 time= 0.18294
Iter: 0006 train_loss= 0.53875 train_f1_mic= 0.37293 train_f1_mac= 0.08763 val_loss= 0.57049 val_f1_mic= 0.36938 val_f1_mac= 0.09518 time= 0.17158
Iter: 0011 train_loss= 0.54114 train_f1_mic= 0.40640 train_f1_mac= 0.10387 val_loss= 0.57049 val_f1_mic= 0.36938 val_f1_mac= 0.09518 time= 0.16362
Iter: 0016 train_loss= 0.53543 train_f1_mic= 0.38725 train_f1_mac= 0.09639 val_loss= 0.57049 val_f1_mic= 0.36938 val_f1_mac= 0.09518 time= 0.15785
Epoch: 0003
Iter: 0002 train_loss= 0.53695 train_f1_mic= 0.36579 train_f1_mac= 0.08599 val_loss= 0.55137 val_f1_mic= 0.36421 val_f1_mac= 0.08795 time= 0.15458
Iter: 0007 train_loss= 0.54476 train_f1_mic= 0.36249 train_f1_mac= 0.08674 val_loss= 0.55137 val_f1_mic= 0.36421 val_f1_mac= 0.08795 time= 0.15105
Iter: 0012 train_loss= 0.53465 train_f1_mic= 0.39605 train_f1_mac= 0.10064 val_loss= 0.55137 val_f1_mic= 0.36421 val_f1_mac= 0.08795 time= 0.14819
Iter: 0017 train_loss= 0.53256 train_f1_mic= 0.40395 train_f1_mac= 0.10566 val_loss= 0.55137 val_f1_mic= 0.36421 val_f1_mac= 0.08795 time= 0.14577
Epoch: 0004
Iter: 0003 train_loss= 0.52773 train_f1_mic= 0.38824 train_f1_mac= 0.10904 val_loss= 0.56932 val_f1_mic= 0.40444 val_f1_mac= 0.12594 time= 0.14464
Iter: 0008 train_loss= 0.53172 train_f1_mic= 0.40538 train_f1_mac= 0.12421 val_loss= 0.56932 val_f1_mic= 0.40444 val_f1_mac= 0.12594 time= 0.14306
Iter: 0013 train_loss= 0.53337 train_f1_mic= 0.41925 train_f1_mac= 0.13667 val_loss= 0.56932 val_f1_mic= 0.40444 val_f1_mac= 0.12594 time= 0.14171
Iter: 0018 train_loss= 0.52998 train_f1_mic= 0.44202 train_f1_mac= 0.15307 val_loss= 0.56932 val_f1_mic= 0.40444 val_f1_mac= 0.12594 time= 0.14048
Epoch: 0005
Iter: 0004 train_loss= 0.52704 train_f1_mic= 0.43495 train_f1_mac= 0.14766 val_loss= 0.55288 val_f1_mic= 0.41975 val_f1_mac= 0.14997 time= 0.14014
Iter: 0009 train_loss= 0.52172 train_f1_mic= 0.39866 train_f1_mac= 0.12537 val_loss= 0.55288 val_f1_mic= 0.41975 val_f1_mac= 0.14997 time= 0.13912
Iter: 0014 train_loss= 0.52681 train_f1_mic= 0.45052 train_f1_mac= 0.17433 val_loss= 0.55288 val_f1_mic= 0.41975 val_f1_mac= 0.14997 time= 0.13830
Epoch: 0006
Iter: 0000 train_loss= 0.53166 train_f1_mic= 0.44100 train_f1_mac= 0.16279 val_loss= 0.55111 val_f1_mic= 0.44948 val_f1_mac= 0.18664 time= 0.13796
Iter: 0005 train_loss= 0.52673 train_f1_mic= 0.40906 train_f1_mac= 0.14334 val_loss= 0.55111 val_f1_mic= 0.44948 val_f1_mac= 0.18664 time= 0.13728
Iter: 0010 train_loss= 0.53024 train_f1_mic= 0.40204 train_f1_mac= 0.14219 val_loss= 0.55111 val_f1_mic= 0.44948 val_f1_mac= 0.18664 time= 0.13669
Iter: 0015 train_loss= 0.52476 train_f1_mic= 0.43836 train_f1_mac= 0.18139 val_loss= 0.55111 val_f1_mic= 0.44948 val_f1_mac= 0.18664 time= 0.13623
Epoch: 0007
Iter: 0001 train_loss= 0.51616 train_f1_mic= 0.45606 train_f1_mac= 0.19473 val_loss= 0.53559 val_f1_mic= 0.45216 val_f1_mac= 0.20285 time= 0.13611
Iter: 0006 train_loss= 0.51072 train_f1_mic= 0.47798 train_f1_mac= 0.24062 val_loss= 0.53559 val_f1_mic= 0.45216 val_f1_mac= 0.20285 time= 0.13569
Iter: 0011 train_loss= 0.51913 train_f1_mic= 0.49622 train_f1_mac= 0.26540 val_loss= 0.53559 val_f1_mic= 0.45216 val_f1_mac= 0.20285 time= 0.13522
Iter: 0016 train_loss= 0.51869 train_f1_mic= 0.49042 train_f1_mac= 0.23132 val_loss= 0.53559 val_f1_mic= 0.45216 val_f1_mac= 0.20285 time= 0.13482
Epoch: 0008
Iter: 0002 train_loss= 0.51459 train_f1_mic= 0.44565 train_f1_mac= 0.18881 val_loss= 0.55281 val_f1_mic= 0.44176 val_f1_mac= 0.20212 time= 0.13474
Iter: 0007 train_loss= 0.51123 train_f1_mic= 0.45802 train_f1_mac= 0.21929 val_loss= 0.55281 val_f1_mic= 0.44176 val_f1_mac= 0.20212 time= 0.13436
Iter: 0012 train_loss= 0.51884 train_f1_mic= 0.49612 train_f1_mac= 0.25882 val_loss= 0.55281 val_f1_mic= 0.44176 val_f1_mac= 0.20212 time= 0.13430
Iter: 0017 train_loss= 0.52101 train_f1_mic= 0.49046 train_f1_mac= 0.24924 val_loss= 0.55281 val_f1_mic= 0.44176 val_f1_mac= 0.20212 time= 0.13404
Epoch: 0009
Iter: 0003 train_loss= 0.51729 train_f1_mic= 0.43266 train_f1_mac= 0.19458 val_loss= 0.54676 val_f1_mic= 0.46666 val_f1_mac= 0.23486 time= 0.13398
Iter: 0008 train_loss= 0.51768 train_f1_mic= 0.47635 train_f1_mac= 0.24060 val_loss= 0.54676 val_f1_mic= 0.46666 val_f1_mac= 0.23486 time= 0.13365
Iter: 0013 train_loss= 0.51396 train_f1_mic= 0.46745 train_f1_mac= 0.23196 val_loss= 0.54676 val_f1_mic= 0.46666 val_f1_mac= 0.23486 time= 0.13335
Iter: 0018 train_loss= 0.51834 train_f1_mic= 0.44083 train_f1_mac= 0.19141 val_loss= 0.54676 val_f1_mic= 0.46666 val_f1_mac= 0.23486 time= 0.13309
Epoch: 0010
Iter: 0004 train_loss= 0.50181 train_f1_mic= 0.47980 train_f1_mac= 0.25285 val_loss= 0.51483 val_f1_mic= 0.53372 val_f1_mac= 0.30614 time= 0.13306
Iter: 0009 train_loss= 0.50948 train_f1_mic= 0.48454 train_f1_mac= 0.25057 val_loss= 0.51483 val_f1_mic= 0.53372 val_f1_mac= 0.30614 time= 0.13281
Iter: 0014 train_loss= 0.50664 train_f1_mic= 0.50593 train_f1_mac= 0.28339 val_loss= 0.51483 val_f1_mic= 0.53372 val_f1_mac= 0.30614 time= 0.13278
Optimization Finished!
Full validation stats: loss= 0.51774 f1_micro= 0.52582 f1_macro= 0.31468 time= 0.25330
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47793411526863744
Rewards :  0.0371363355677406 Accuracy :  0.5076431837228299
Total reward :  1.3334063365266173
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'relu', 2, 'linear']
Training RNN (Reward ip) :  [0.03713633]
Trial 268: Controller loss : 7585.386719

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [0, 'tanh', 4, 'relu']
2018-08-31 00:54:00.846745: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:54:00.846986: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:54:00.847209: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:54:00.847372: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:54:00.847577: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69375 train_f1_mic= 0.36578 train_f1_mac= 0.31788 val_loss= 0.66869 val_f1_mic= 0.39240 val_f1_mac= 0.17658 time= 0.72902
Iter: 0005 train_loss= 0.58510 train_f1_mic= 0.39095 train_f1_mac= 0.09888 val_loss= 0.66869 val_f1_mic= 0.39240 val_f1_mac= 0.17658 time= 0.13216
Iter: 0010 train_loss= 0.55132 train_f1_mic= 0.40477 train_f1_mac= 0.10761 val_loss= 0.66869 val_f1_mic= 0.39240 val_f1_mac= 0.17658 time= 0.07752
Iter: 0015 train_loss= 0.53825 train_f1_mic= 0.39850 train_f1_mac= 0.11025 val_loss= 0.66869 val_f1_mic= 0.39240 val_f1_mac= 0.17658 time= 0.05686
Epoch: 0002
Iter: 0001 train_loss= 0.54225 train_f1_mic= 0.39195 train_f1_mac= 0.11015 val_loss= 0.55836 val_f1_mic= 0.39413 val_f1_mac= 0.11782 time= 0.04736
Iter: 0006 train_loss= 0.54064 train_f1_mic= 0.39789 train_f1_mac= 0.10734 val_loss= 0.55836 val_f1_mic= 0.39413 val_f1_mac= 0.11782 time= 0.04059
Iter: 0011 train_loss= 0.52654 train_f1_mic= 0.40416 train_f1_mac= 0.11284 val_loss= 0.55836 val_f1_mic= 0.39413 val_f1_mac= 0.11782 time= 0.03603
Iter: 0016 train_loss= 0.54454 train_f1_mic= 0.40378 train_f1_mac= 0.13066 val_loss= 0.55836 val_f1_mic= 0.39413 val_f1_mac= 0.11782 time= 0.03280
Epoch: 0003
Iter: 0002 train_loss= 0.52481 train_f1_mic= 0.43528 train_f1_mac= 0.14758 val_loss= 0.55390 val_f1_mic= 0.43361 val_f1_mac= 0.14820 time= 0.03065
Iter: 0007 train_loss= 0.52868 train_f1_mic= 0.43665 train_f1_mac= 0.15634 val_loss= 0.55390 val_f1_mic= 0.43361 val_f1_mac= 0.14820 time= 0.02862
Iter: 0012 train_loss= 0.52609 train_f1_mic= 0.43329 train_f1_mac= 0.15418 val_loss= 0.55390 val_f1_mic= 0.43361 val_f1_mac= 0.14820 time= 0.02695
Iter: 0017 train_loss= 0.52286 train_f1_mic= 0.44060 train_f1_mac= 0.15554 val_loss= 0.55390 val_f1_mic= 0.43361 val_f1_mac= 0.14820 time= 0.02552
Epoch: 0004
Iter: 0003 train_loss= 0.51773 train_f1_mic= 0.44312 train_f1_mac= 0.15568 val_loss= 0.55925 val_f1_mic= 0.42553 val_f1_mac= 0.15722 time= 0.02461
Iter: 0008 train_loss= 0.51793 train_f1_mic= 0.44139 train_f1_mac= 0.15799 val_loss= 0.55925 val_f1_mic= 0.42553 val_f1_mac= 0.15722 time= 0.02359
Iter: 0013 train_loss= 0.52809 train_f1_mic= 0.42478 train_f1_mac= 0.15476 val_loss= 0.55925 val_f1_mic= 0.42553 val_f1_mac= 0.15722 time= 0.02270
Iter: 0018 train_loss= 0.53195 train_f1_mic= 0.44203 train_f1_mac= 0.17387 val_loss= 0.55925 val_f1_mic= 0.42553 val_f1_mac= 0.15722 time= 0.02193
Epoch: 0005
Iter: 0004 train_loss= 0.50227 train_f1_mic= 0.45710 train_f1_mac= 0.18431 val_loss= 0.54207 val_f1_mic= 0.44606 val_f1_mac= 0.18197 time= 0.02145
Iter: 0009 train_loss= 0.51432 train_f1_mic= 0.45590 train_f1_mac= 0.18721 val_loss= 0.54207 val_f1_mic= 0.44606 val_f1_mac= 0.18197 time= 0.02093
Iter: 0014 train_loss= 0.52818 train_f1_mic= 0.43395 train_f1_mac= 0.16573 val_loss= 0.54207 val_f1_mic= 0.44606 val_f1_mac= 0.18197 time= 0.02044
Epoch: 0006
Iter: 0000 train_loss= 0.51718 train_f1_mic= 0.45718 train_f1_mac= 0.18742 val_loss= 0.53817 val_f1_mic= 0.47657 val_f1_mac= 0.21890 time= 0.02029
Iter: 0005 train_loss= 0.50166 train_f1_mic= 0.44424 train_f1_mac= 0.18197 val_loss= 0.53817 val_f1_mic= 0.47657 val_f1_mac= 0.21890 time= 0.01988
Iter: 0010 train_loss= 0.51299 train_f1_mic= 0.46369 train_f1_mac= 0.20439 val_loss= 0.53817 val_f1_mic= 0.47657 val_f1_mac= 0.21890 time= 0.01951
Iter: 0015 train_loss= 0.51344 train_f1_mic= 0.45318 train_f1_mac= 0.19507 val_loss= 0.53817 val_f1_mic= 0.47657 val_f1_mac= 0.21890 time= 0.01914
Epoch: 0007
Iter: 0001 train_loss= 0.50926 train_f1_mic= 0.46927 train_f1_mac= 0.20567 val_loss= 0.52581 val_f1_mic= 0.46100 val_f1_mac= 0.20187 time= 0.01897
Iter: 0006 train_loss= 0.51053 train_f1_mic= 0.46599 train_f1_mac= 0.20571 val_loss= 0.52581 val_f1_mic= 0.46100 val_f1_mac= 0.20187 time= 0.01867
Iter: 0011 train_loss= 0.49801 train_f1_mic= 0.44297 train_f1_mac= 0.18777 val_loss= 0.52581 val_f1_mic= 0.46100 val_f1_mac= 0.20187 time= 0.01840
Iter: 0016 train_loss= 0.50680 train_f1_mic= 0.47737 train_f1_mac= 0.22511 val_loss= 0.52581 val_f1_mic= 0.46100 val_f1_mac= 0.20187 time= 0.01813
Epoch: 0008
Iter: 0002 train_loss= 0.50847 train_f1_mic= 0.47283 train_f1_mac= 0.20333 val_loss= 0.51712 val_f1_mic= 0.45096 val_f1_mac= 0.20066 time= 0.01800
Iter: 0007 train_loss= 0.50395 train_f1_mic= 0.47690 train_f1_mac= 0.21532 val_loss= 0.51712 val_f1_mic= 0.45096 val_f1_mac= 0.20066 time= 0.01781
Iter: 0012 train_loss= 0.50912 train_f1_mic= 0.45843 train_f1_mac= 0.21584 val_loss= 0.51712 val_f1_mic= 0.45096 val_f1_mac= 0.20066 time= 0.01760
Iter: 0017 train_loss= 0.49014 train_f1_mic= 0.47294 train_f1_mac= 0.22808 val_loss= 0.51712 val_f1_mic= 0.45096 val_f1_mac= 0.20066 time= 0.01741
Epoch: 0009
Iter: 0003 train_loss= 0.49886 train_f1_mic= 0.48357 train_f1_mac= 0.23429 val_loss= 0.52299 val_f1_mic= 0.48483 val_f1_mac= 0.24410 time= 0.01730
Iter: 0008 train_loss= 0.50482 train_f1_mic= 0.46372 train_f1_mac= 0.21630 val_loss= 0.52299 val_f1_mic= 0.48483 val_f1_mac= 0.24410 time= 0.01715
Iter: 0013 train_loss= 0.50800 train_f1_mic= 0.49140 train_f1_mac= 0.24690 val_loss= 0.52299 val_f1_mic= 0.48483 val_f1_mac= 0.24410 time= 0.01702
Iter: 0018 train_loss= 0.49681 train_f1_mic= 0.46106 train_f1_mac= 0.22353 val_loss= 0.52299 val_f1_mic= 0.48483 val_f1_mac= 0.24410 time= 0.01686
Epoch: 0010
Iter: 0004 train_loss= 0.49354 train_f1_mic= 0.50587 train_f1_mac= 0.26456 val_loss= 0.51580 val_f1_mic= 0.48525 val_f1_mac= 0.25783 time= 0.01682
Iter: 0009 train_loss= 0.49142 train_f1_mic= 0.48803 train_f1_mac= 0.24581 val_loss= 0.51580 val_f1_mic= 0.48525 val_f1_mac= 0.25783 time= 0.01679
Iter: 0014 train_loss= 0.50398 train_f1_mic= 0.48250 train_f1_mac= 0.24550 val_loss= 0.51580 val_f1_mic= 0.48525 val_f1_mac= 0.25783 time= 0.01664
Optimization Finished!
Full validation stats: loss= 0.51698 f1_micro= 0.50108 f1_macro= 0.27805 time= 0.07979
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47994694282885514
Rewards :  0.010064137801088502 Accuracy :  0.48799825306972594
Total reward :  1.343470474327706
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'tanh', 4, 'relu']
Training RNN (Reward ip) :  [0.01006414]
Trial 269: Controller loss : 7262.557129

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
2018-08-31 00:54:08.948808: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:54:08.949271: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:54:08.950002: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:54:08.950297: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:54:08.950694: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (devicActions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
e: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69436 train_f1_mic= 0.35154 train_f1_mac= 0.27081 val_loss= 0.66278 val_f1_mic= 0.40974 val_f1_mac= 0.12427 time= 0.75296
Iter: 0005 train_loss= 0.59418 train_f1_mic= 0.37896 train_f1_mac= 0.09350 val_loss= 0.66278 val_f1_mic= 0.40974 val_f1_mac= 0.12427 time= 0.13713
Iter: 0010 train_loss= 0.55138 train_f1_mic= 0.36929 train_f1_mac= 0.08777 val_loss= 0.66278 val_f1_mic= 0.40974 val_f1_mac= 0.12427 time= 0.08232
Iter: 0015 train_loss= 0.53115 train_f1_mic= 0.42543 train_f1_mac= 0.11244 val_loss= 0.66278 val_f1_mic= 0.40974 val_f1_mac= 0.12427 time= 0.06164
Epoch: 0002
Iter: 0001 train_loss= 0.54195 train_f1_mic= 0.38964 train_f1_mac= 0.09726 val_loss= 0.58941 val_f1_mic= 0.36198 val_f1_mac= 0.10033 time= 0.05162
Iter: 0006 train_loss= 0.54298 train_f1_mic= 0.35966 train_f1_mac= 0.08627 val_loss= 0.58941 val_f1_mic= 0.36198 val_f1_mac= 0.10033 time= 0.04445
Iter: 0011 train_loss= 0.53692 train_f1_mic= 0.37849 train_f1_mac= 0.09344 val_loss= 0.58941 val_f1_mic= 0.36198 val_f1_mac= 0.10033 time= 0.03989
Iter: 0016 train_loss= 0.53484 train_f1_mic= 0.40194 train_f1_mac= 0.10653 val_loss= 0.58941 val_f1_mic= 0.36198 val_f1_mac= 0.10033 time= 0.03628
Epoch: 0003
Iter: 0002 train_loss= 0.52725 train_f1_mic= 0.41100 train_f1_mac= 0.11530 val_loss= 0.56623 val_f1_mic= 0.39683 val_f1_mac= 0.12000 time= 0.03410
Iter: 0007 train_loss= 0.53616 train_f1_mic= 0.39804 train_f1_mac= 0.11770 val_loss= 0.56623 val_f1_mic= 0.39683 val_f1_mac= 0.12000 time= 0.03197
Iter: 0012 train_loss= 0.53760 train_f1_mic= 0.40337 train_f1_mac= 0.12400 val_loss= 0.56623 val_f1_mic= 0.39683 val_f1_mac= 0.12000 time= 0.03036
Iter: 0017 train_loss= 0.54609 train_f1_mic= 0.40454 train_f1_mac= 0.12887 val_loss= 0.56623 val_f1_mic= 0.39683 val_f1_mac= 0.12000 time= 0.02913
Epoch: 0004
Iter: 0003 train_loss= 0.52613 train_f1_mic= 0.40666 train_f1_mac= 0.12675 val_loss= 0.55676 val_f1_mic= 0.40546 val_f1_mac= 0.13101 time= 0.02856
Iter: 0008 train_loss= 0.52919 train_f1_mic= 0.43301 train_f1_mac= 0.14633 val_loss= 0.55676 val_f1_mic= 0.40546 val_f1_mac= 0.13101 time= 0.02762
Iter: 0013 train_loss= 0.52425 train_f1_mic= 0.42230 train_f1_mac= 0.14012 val_loss= 0.55676 val_f1_mic= 0.40546 val_f1_mac= 0.13101 time= 0.02665
Iter: 0018 train_loss= 0.53105 train_f1_mic= 0.44594 train_f1_mac= 0.16858 val_loss= 0.55676 val_f1_mic= 0.40546 val_f1_mac= 0.13101 time= 0.02586
Epoch: 0005
Iter: 0004 train_loss= 0.52737 train_f1_mic= 0.40843 train_f1_mac= 0.13539 val_loss= 0.53813 val_f1_mic= 0.42698 val_f1_mac= 0.15569 time= 0.02547
Iter: 0009 train_loss= 0.52338 train_f1_mic= 0.43689 train_f1_mac= 0.15724 val_loss= 0.53813 val_f1_mic= 0.42698 val_f1_mac= 0.15569 time= 0.02486
Iter: 0014 train_loss= 0.51821 train_f1_mic= 0.44708 train_f1_mac= 0.17485 val_loss= 0.53813 val_f1_mic= 0.42698 val_f1_mac= 0.15569 time= 0.02426
Epoch: 0006
Iter: 0000 train_loss= 0.51607 train_f1_mic= 0.42894 train_f1_mac= 0.16079 val_loss= 0.52558 val_f1_mic= 0.43268 val_f1_mac= 0.17307 time= 0.02388
Iter: 0005 train_loss= 0.51546 train_f1_mic= 0.43533 train_f1_mac= 0.16351 val_loss= 0.52558 val_f1_mic= 0.43268 val_f1_mac= 0.17307 time= 0.02339
Iter: 0010 train_loss= 0.51351 train_f1_mic= 0.43119 train_f1_mac= 0.16512 val_loss= 0.52558 val_f1_mic= 0.43268 val_f1_mac= 0.17307 time= 0.02298
Iter: 0015 train_loss= 0.51116 train_f1_mic= 0.49419 train_f1_mac= 0.22983 val_loss= 0.52558 val_f1_mic= 0.43268 val_f1_mac= 0.17307 time= 0.02258
Epoch: 0007
Iter: 0001 train_loss= 0.51360 train_f1_mic= 0.47704 train_f1_mac= 0.22056 val_loss= 0.53979 val_f1_mic= 0.47664 val_f1_mac= 0.22113 time= 0.02245
Iter: 0006 train_loss= 0.51979 train_f1_mic= 0.45083 train_f1_mac= 0.19750 val_loss= 0.53979 val_f1_mic= 0.47664 val_f1_mac= 0.22113 time= 0.02218
Iter: 0011 train_loss= 0.50227 train_f1_mic= 0.44698 train_f1_mac= 0.19055 val_loss= 0.53979 val_f1_mic= 0.47664 val_f1_mac= 0.22113 time= 0.02189
Iter: 0016 train_loss= 0.51896 train_f1_mic= 0.49603 train_f1_mac= 0.23454 val_loss= 0.53979 val_f1_mic= 0.47664 val_f1_mac= 0.22113 time= 0.02168
Epoch: 0008
Iter: 0002 train_loss= 0.50508 train_f1_mic= 0.45390 train_f1_mac= 0.19992 val_loss= 0.50358 val_f1_mic= 0.45242 val_f1_mac= 0.20187 time= 0.02157
Iter: 0007 train_loss= 0.49774 train_f1_mic= 0.47119 train_f1_mac= 0.22418 val_loss= 0.50358 val_f1_mic= 0.45242 val_f1_mac= 0.20187 time= 0.02130
Iter: 0012 train_loss= 0.50038 train_f1_mic= 0.48975 train_f1_mac= 0.23621 val_loss= 0.50358 val_f1_mic= 0.45242 val_f1_mac= 0.20187 time= 0.02105
Iter: 0017 train_loss= 0.50616 train_f1_mic= 0.47254 train_f1_mac= 0.21928 val_loss= 0.50358 val_f1_mic= 0.45242 val_f1_mac= 0.20187 time= 0.02081
Epoch: 0009
Iter: 0003 train_loss= 0.49644 train_f1_mic= 0.47265 train_f1_mac= 0.22413 val_loss= 0.51317 val_f1_mic= 0.50360 val_f1_mac= 0.25038 time= 0.02078
Iter: 0008 train_loss= 0.50273 train_f1_mic= 0.47931 train_f1_mac= 0.24732 val_loss= 0.51317 val_f1_mic= 0.50360 val_f1_mac= 0.25038 time= 0.02058
Iter: 0013 train_loss= 0.50495 train_f1_mic= 0.48991 train_f1_mac= 0.24602 val_loss= 0.51317 val_f1_mic= 0.50360 val_f1_mac= 0.25038 time= 0.02046
Iter: 0018 train_loss= 0.50258 train_f1_mic= 0.48266 train_f1_mac= 0.23891 val_loss= 0.51317 val_f1_mic= 0.50360 val_f1_mac= 0.25038 time= 0.02033
Epoch: 0010
Iter: 0004 train_loss= 0.49939 train_f1_mic= 0.47140 train_f1_mac= 0.24417 val_loss= 0.51517 val_f1_mic= 0.50668 val_f1_mac= 0.26952 time= 0.02029
Iter: 0009 train_loss= 0.49159 train_f1_mic= 0.48208 train_f1_mac= 0.25822 val_loss= 0.51517 val_f1_mic= 0.50668 val_f1_mac= 0.26952 time= 0.02012
Iter: 0014 train_loss= 0.50635 train_f1_mic= 0.48838 train_f1_mac= 0.25270 val_loss= 0.51517 val_f1_mic= 0.50668 val_f1_mac= 0.26952 time= 0.01997
Optimization Finished!
Full validation stats: loss= 0.51155 f1_micro= 0.51884 f1_macro= 0.28653 time= 0.10472
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4856794514238143
Rewards :  0.028662542974795813 Accuracy :  0.508609485803651
Total reward :  1.3721330173025017
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02866254]
Trial 270: Controller loss : 115.917465

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:54:18.194543: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:54:18.195008: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:54:18.195470: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:54:18.195805: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:54:18.196217: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69446 train_f1_mic= 0.38803 train_f1_mac= 0.30845 val_loss= 0.66730 val_f1_mic= 0.42753 val_f1_mac= 0.14666 time= 0.77088
Iter: 0005 train_loss= 0.60052 train_f1_mic= 0.37344 train_f1_mac= 0.09397 val_loss= 0.66730 val_f1_mic= 0.42753 val_f1_mac= 0.14666 time= 0.14062
Iter: 0010 train_loss= 0.54597 train_f1_mic= 0.38898 train_f1_mac= 0.09461 val_loss= 0.66730 val_f1_mic= 0.42753 val_f1_mac= 0.14666 time= 0.08513
Iter: 0015 train_loss= 0.54499 train_f1_mic= 0.40868 train_f1_mac= 0.10780 val_loss= 0.66730 val_f1_mic= 0.42753 val_f1_mac= 0.14666 time= 0.06376
Epoch: 0002
Iter: 0001 train_loss= 0.54624 train_f1_mic= 0.37784 train_f1_mac= 0.09339 val_loss= 0.55614 val_f1_mic= 0.37138 val_f1_mac= 0.09328 time= 0.05304
Iter: 0006 train_loss= 0.53713 train_f1_mic= 0.37954 train_f1_mac= 0.09366 val_loss= 0.55614 val_f1_mic= 0.37138 val_f1_mac= 0.09328 time= 0.04564
Iter: 0011 train_loss= 0.53426 train_f1_mic= 0.38793 train_f1_mac= 0.09839 val_loss= 0.55614 val_f1_mic= 0.37138 val_f1_mac= 0.09328 time= 0.04095
Iter: 0016 train_loss= 0.53661 train_f1_mic= 0.39140 train_f1_mac= 0.10702 val_loss= 0.55614 val_f1_mic= 0.37138 val_f1_mac= 0.09328 time= 0.03726
Epoch: 0003
Iter: 0002 train_loss= 0.53904 train_f1_mic= 0.38286 train_f1_mac= 0.11017 val_loss= 0.58168 val_f1_mic= 0.37616 val_f1_mac= 0.11732 time= 0.03517
Iter: 0007 train_loss= 0.51845 train_f1_mic= 0.41878 train_f1_mac= 0.12539 val_loss= 0.58168 val_f1_mic= 0.37616 val_f1_mac= 0.11732 time= 0.03300
Iter: 0012 train_loss= 0.53767 train_f1_mic= 0.41085 train_f1_mac= 0.12985 val_loss= 0.58168 val_f1_mic= 0.37616 val_f1_mac= 0.11732 time= 0.03121
Iter: 0017 train_loss= 0.53477 train_f1_mic= 0.40924 train_f1_mac= 0.12875 val_loss= 0.58168 val_f1_mic= 0.37616 val_f1_mac= 0.11732 time= 0.02981
Epoch: 0004
Iter: 0003 train_loss= 0.51489 train_f1_mic= 0.40962 train_f1_mac= 0.12632 val_loss= 0.55803 val_f1_mic= 0.42253 val_f1_mac= 0.14129 time= 0.02882
Iter: 0008 train_loss= 0.51655 train_f1_mic= 0.44133 train_f1_mac= 0.15152 val_loss= 0.55803 val_f1_mic= 0.42253 val_f1_mac= 0.14129 time= 0.02768
Iter: 0013 train_loss= 0.52020 train_f1_mic= 0.41809 train_f1_mac= 0.13687 val_loss= 0.55803 val_f1_mic= 0.42253 val_f1_mac= 0.14129 time= 0.02673
Iter: 0018 train_loss= 0.52513 train_f1_mic= 0.43432 train_f1_mac= 0.14965 val_loss= 0.55803 val_f1_mic= 0.42253 val_f1_mac= 0.14129 time= 0.02609
Epoch: 0005
Iter: 0004 train_loss= 0.51930 train_f1_mic= 0.43891 train_f1_mac= 0.16607 val_loss= 0.52754 val_f1_mic= 0.45975 val_f1_mac= 0.16946 time= 0.02558
Iter: 0009 train_loss= 0.52746 train_f1_mic= 0.43267 train_f1_mac= 0.15963 val_loss= 0.52754 val_f1_mic= 0.45975 val_f1_mac= 0.16946 time= 0.02495
Iter: 0014 train_loss= 0.50885 train_f1_mic= 0.44816 train_f1_mac= 0.17205 val_loss= 0.52754 val_f1_mic= 0.45975 val_f1_mac= 0.16946 time= 0.02444
Epoch: 0006
Iter: 0000 train_loss= 0.52341 train_f1_mic= 0.45482 train_f1_mac= 0.18703 val_loss= 0.53148 val_f1_mic= 0.44730 val_f1_mac= 0.18001 time= 0.02421
Iter: 0005 train_loss= 0.51231 train_f1_mic= 0.43802 train_f1_mac= 0.16799 val_loss= 0.53148 val_f1_mic= 0.44730 val_f1_mac= 0.18001 time= 0.02379
Iter: 0010 train_loss= 0.51648 train_f1_mic= 0.44995 train_f1_mac= 0.18738 val_loss= 0.53148 val_f1_mic= 0.44730 val_f1_mac= 0.18001 time= 0.02341
Iter: 0015 train_loss= 0.52232 train_f1_mic= 0.47092 train_f1_mac= 0.21132 val_loss= 0.53148 val_f1_mic= 0.44730 val_f1_mac= 0.18001 time= 0.02304
Epoch: 0007
Iter: 0001 train_loss= 0.51109 train_f1_mic= 0.43860 train_f1_mac= 0.17769 val_loss= 0.55391 val_f1_mic= 0.46130 val_f1_mac= 0.20975 time= 0.02289
Iter: 0006 train_loss= 0.51438 train_f1_mic= 0.45767 train_f1_mac= 0.19346 val_loss= 0.55391 val_f1_mic= 0.46130 val_f1_mac= 0.20975 time= 0.02257
Iter: 0011 train_loss= 0.51520 train_f1_mic= 0.49713 train_f1_mac= 0.23348 val_loss= 0.55391 val_f1_mic= 0.46130 val_f1_mac= 0.20975 time= 0.02223
Iter: 0016 train_loss= 0.50218 train_f1_mic= 0.46434 train_f1_mac= 0.22216 val_loss= 0.55391 val_f1_mic= 0.46130 val_f1_mac= 0.20975 time= 0.02196
Epoch: 0008
Iter: 0002 train_loss= 0.51855 train_f1_mic= 0.46483 train_f1_mac= 0.21485 val_loss= 0.53369 val_f1_mic= 0.48455 val_f1_mac= 0.25042 time= 0.02182
Iter: 0007 train_loss= 0.50278 train_f1_mic= 0.44656 train_f1_mac= 0.20065 val_loss= 0.53369 val_f1_mic= 0.48455 val_f1_mac= 0.25042 time= 0.02159
Iter: 0012 train_loss= 0.50566 train_f1_mic= 0.48519 train_f1_mac= 0.23011 val_loss= 0.53369 val_f1_mic= 0.48455 val_f1_mac= 0.25042 time= 0.02133
Iter: 0017 train_loss= 0.51047 train_f1_mic= 0.49286 train_f1_mac= 0.24350 val_loss= 0.53369 val_f1_mic= 0.48455 val_f1_mac= 0.25042 time= 0.02109
Epoch: 0009
Iter: 0003 train_loss= 0.49447 train_f1_mic= 0.49979 train_f1_mac= 0.26817 val_loss= 0.52032 val_f1_mic= 0.49961 val_f1_mac= 0.25312 time= 0.02101
Iter: 0008 train_loss= 0.51509 train_f1_mic= 0.49404 train_f1_mac= 0.24491 val_loss= 0.52032 val_f1_mic= 0.49961 val_f1_mac= 0.25312 time= 0.02080
Iter: 0013 train_loss= 0.49785 train_f1_mic= 0.48434 train_f1_mac= 0.24143 val_loss= 0.52032 val_f1_mic= 0.49961 val_f1_mac= 0.25312 time= 0.02059
Iter: 0018 train_loss= 0.49471 train_f1_mic= 0.46135 train_f1_mac= 0.22651 val_loss= 0.52032 val_f1_mic= 0.49961 val_f1_mac= 0.25312 time= 0.02039
Epoch: 0010
Iter: 0004 train_loss= 0.50438 train_f1_mic= 0.50100 train_f1_mac= 0.27222 val_loss= 0.50979 val_f1_mic= 0.52155 val_f1_mac= 0.28673 time= 0.02030
Iter: 0009 train_loss= 0.50010 train_f1_mic= 0.51771 train_f1_mac= 0.28813 val_loss= 0.50979 val_f1_mic= 0.52155 val_f1_mac= 0.28673 time= 0.02012
Iter: 0014 train_loss= 0.51304 train_f1_mic= 0.48877 train_f1_mac= 0.25523 val_loss= 0.50979 val_f1_mic= 0.52155 val_f1_mac= 0.28673 time= 0.01995
Optimization Finished!
Full validation stats: loss= 0.51979 f1_micro= 0.46358 f1_macro= 0.24367 time= 0.07779
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48177569047353536
Rewards :  -0.019518804751394725 Accuracy :  0.4661606466724196
Total reward :  1.352614212551107
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [-0.01951881]
Trial 271: Controller loss : 116.245087

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:54:27.180375: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:54:27.180895: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:54:27.181404: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:54:27.181786: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:54:27.182262: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69217 train_f1_mic= 0.34342 train_f1_mac= 0.26808 val_loss= 0.66220 val_f1_mic= 0.35550 val_f1_mac= 0.09673 time= 0.75199
Iter: 0005 train_loss= 0.59331 train_f1_mic= 0.36323 train_f1_mac= 0.08694 val_loss= 0.66220 val_f1_mic= 0.35550 val_f1_mac= 0.09673 time= 0.13830
Iter: 0010 train_loss= 0.55652 train_f1_mic= 0.35831 train_f1_mac= 0.08650 val_loss= 0.66220 val_f1_mic= 0.35550 val_f1_mac= 0.09673 time= 0.08196
Iter: 0015 train_loss= 0.53412 train_f1_mic= 0.40965 train_f1_mac= 0.10690 val_loss= 0.66220 val_f1_mic= 0.35550 val_f1_mac= 0.09673 time= 0.06096
Epoch: 0002
Iter: 0001 train_loss= 0.53216 train_f1_mic= 0.41739 train_f1_mac= 0.11184 val_loss= 0.56497 val_f1_mic= 0.40852 val_f1_mac= 0.11604 time= 0.05081
Iter: 0006 train_loss= 0.52943 train_f1_mic= 0.37864 train_f1_mac= 0.08955 val_loss= 0.56497 val_f1_mic= 0.40852 val_f1_mac= 0.11604 time= 0.04372
Iter: 0011 train_loss= 0.53176 train_f1_mic= 0.38109 train_f1_mac= 0.09501 val_loss= 0.56497 val_f1_mic= 0.40852 val_f1_mac= 0.11604 time= 0.03937
Iter: 0016 train_loss= 0.54337 train_f1_mic= 0.38707 train_f1_mac= 0.10404 val_loss= 0.56497 val_f1_mic= 0.40852 val_f1_mac= 0.11604 time= 0.03590
Epoch: 0003
Iter: 0002 train_loss= 0.53594 train_f1_mic= 0.39769 train_f1_mac= 0.11391 val_loss= 0.55400 val_f1_mic= 0.39100 val_f1_mac= 0.11869 time= 0.03369
Iter: 0007 train_loss= 0.54467 train_f1_mic= 0.39824 train_f1_mac= 0.12232 val_loss= 0.55400 val_f1_mic= 0.39100 val_f1_mac= 0.11869 time= 0.03165
Iter: 0012 train_loss= 0.52582 train_f1_mic= 0.43440 train_f1_mac= 0.13995 val_loss= 0.55400 val_f1_mic= 0.39100 val_f1_mac= 0.11869 time= 0.03011
Iter: 0017 train_loss= 0.52630 train_f1_mic= 0.41207 train_f1_mac= 0.12848 val_loss= 0.55400 val_f1_mic= 0.39100 val_f1_mac= 0.11869 time= 0.02886
Epoch: 0004
Iter: 0003 train_loss= 0.52567 train_f1_mic= 0.42417 train_f1_mac= 0.13535 val_loss= 0.54541 val_f1_mic= 0.43257 val_f1_mac= 0.14468 time= 0.02808
Iter: 0008 train_loss= 0.52312 train_f1_mic= 0.43063 train_f1_mac= 0.14309 val_loss= 0.54541 val_f1_mic= 0.43257 val_f1_mac= 0.14468 time= 0.02710
Iter: 0013 train_loss= 0.51719 train_f1_mic= 0.43831 train_f1_mac= 0.14985 val_loss= 0.54541 val_f1_mic= 0.43257 val_f1_mac= 0.14468 time= 0.02618
Iter: 0018 train_loss= 0.51424 train_f1_mic= 0.42255 train_f1_mac= 0.14022 val_loss= 0.54541 val_f1_mic= 0.43257 val_f1_mac= 0.14468 time= 0.02536
Epoch: 0005
Iter: 0004 train_loss= 0.52359 train_f1_mic= 0.41751 train_f1_mac= 0.14742 val_loss= 0.54269 val_f1_mic= 0.42002 val_f1_mac= 0.14986 time= 0.02494
Iter: 0009 train_loss= 0.51550 train_f1_mic= 0.43702 train_f1_mac= 0.16629 val_loss= 0.54269 val_f1_mic= 0.42002 val_f1_mac= 0.14986 time= 0.02442
Iter: 0014 train_loss= 0.51998 train_f1_mic= 0.44042 train_f1_mac= 0.16610 val_loss= 0.54269 val_f1_mic= 0.42002 val_f1_mac= 0.14986 time= 0.02383
Epoch: 0006
Iter: 0000 train_loss= 0.51800 train_f1_mic= 0.47489 train_f1_mac= 0.19956 val_loss= 0.53285 val_f1_mic= 0.46489 val_f1_mac= 0.19432 time= 0.02362
Iter: 0005 train_loss= 0.52109 train_f1_mic= 0.42196 train_f1_mac= 0.15218 val_loss= 0.53285 val_f1_mic= 0.46489 val_f1_mac= 0.19432 time= 0.02329
Iter: 0010 train_loss= 0.50981 train_f1_mic= 0.45097 train_f1_mac= 0.18188 val_loss= 0.53285 val_f1_mic= 0.46489 val_f1_mac= 0.19432 time= 0.02291
Iter: 0015 train_loss= 0.51673 train_f1_mic= 0.47240 train_f1_mac= 0.20945 val_loss= 0.53285 val_f1_mic= 0.46489 val_f1_mac= 0.19432 time= 0.02258
Epoch: 0007
Iter: 0001 train_loss= 0.52092 train_f1_mic= 0.44288 train_f1_mac= 0.18427 val_loss= 0.55500 val_f1_mic= 0.43503 val_f1_mac= 0.17167 time= 0.02242
Iter: 0006 train_loss= 0.50446 train_f1_mic= 0.47799 train_f1_mac= 0.21119 val_loss= 0.55500 val_f1_mic= 0.43503 val_f1_mac= 0.17167 time= 0.02207
Iter: 0011 train_loss= 0.50845 train_f1_mic= 0.47061 train_f1_mac= 0.20997 val_loss= 0.55500 val_f1_mic= 0.43503 val_f1_mac= 0.17167 time= 0.02174
Iter: 0016 train_loss= 0.51387 train_f1_mic= 0.41198 train_f1_mac= 0.15388 val_loss= 0.55500 val_f1_mic= 0.43503 val_f1_mac= 0.17167 time= 0.02150
Epoch: 0008
Iter: 0002 train_loss= 0.51340 train_f1_mic= 0.48866 train_f1_mac= 0.23161 val_loss= 0.52468 val_f1_mic= 0.50358 val_f1_mac= 0.24975 time= 0.02138
Iter: 0007 train_loss= 0.50796 train_f1_mic= 0.48263 train_f1_mac= 0.22181 val_loss= 0.52468 val_f1_mic= 0.50358 val_f1_mac= 0.24975 time= 0.02112
Iter: 0012 train_loss= 0.50112 train_f1_mic= 0.47848 train_f1_mac= 0.22421 val_loss= 0.52468 val_f1_mic= 0.50358 val_f1_mac= 0.24975 time= 0.02087
Iter: 0017 train_loss= 0.50125 train_f1_mic= 0.46734 train_f1_mac= 0.21731 val_loss= 0.52468 val_f1_mic= 0.50358 val_f1_mac= 0.24975 time= 0.02070
Epoch: 0009
Iter: 0003 train_loss= 0.50324 train_f1_mic= 0.50731 train_f1_mac= 0.24893 val_loss= 0.52270 val_f1_mic= 0.47556 val_f1_mac= 0.22641 time= 0.02060
Iter: 0008 train_loss= 0.49004 train_f1_mic= 0.49959 train_f1_mac= 0.24847 val_loss= 0.52270 val_f1_mic= 0.47556 val_f1_mac= 0.22641 time= 0.02042
Iter: 0013 train_loss= 0.51764 train_f1_mic= 0.48395 train_f1_mac= 0.23286 val_loss= 0.52270 val_f1_mic= 0.47556 val_f1_mac= 0.22641 time= 0.02028
Iter: 0018 train_loss= 0.49715 train_f1_mic= 0.46171 train_f1_mac= 0.23294 val_loss= 0.52270 val_f1_mic= 0.47556 val_f1_mac= 0.22641 time= 0.02012
Epoch: 0010
Iter: 0004 train_loss= 0.50504 train_f1_mic= 0.49423 train_f1_mac= 0.25839 val_loss= 0.51602 val_f1_mic= 0.52462 val_f1_mac= 0.29655 time= 0.02004
Iter: 0009 train_loss= 0.49801 train_f1_mic= 0.52480 train_f1_mac= 0.29153 val_loss= 0.51602 val_f1_mic= 0.52462 val_f1_mac= 0.29655 time= 0.01987
Iter: 0014 train_loss= 0.50130 train_f1_mic= 0.46906 train_f1_mac= 0.23842 val_loss= 0.51602 val_f1_mic= 0.52462 val_f1_mac= 0.29655 time= 0.01971
Optimization Finished!
Full validation stats: loss= 0.51671 f1_micro= 0.47294 f1_macro= 0.24841 time= 0.07778
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48163012140104927
Rewards :  -0.0007278453624305903 Accuracy :  0.48104784511110477
Total reward :  1.3518863671886763
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [-0.00072785]
Trial 272: Controller loss : 116.013618

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'relu', 2, 'linear']
2018-08-31 00:54:36.298394: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:54:36.299130: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:54:36.299841: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:54:36.300366: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:54:36.301010: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69139 train_f1_mic= 0.36242 train_f1_mac= 0.30208 val_loss= 0.66649 val_f1_mic= 0.40921 val_f1_mac= 0.11930 time= 0.84586
Iter: 0005 train_loss= 0.58318 train_f1_mic= 0.37832 train_f1_mac= 0.09317 val_loss= 0.66649 val_f1_mic= 0.40921 val_f1_mac= 0.11930 time= 0.17654
Iter: 0010 train_loss= 0.54919 train_f1_mic= 0.37977 train_f1_mac= 0.09253 val_loss= 0.66649 val_f1_mic= 0.40921 val_f1_mac= 0.11930 time= 0.11579
Iter: 0015 train_loss= 0.54015 train_f1_mic= 0.39259 train_f1_mac= 0.09728 val_loss= 0.66649 val_f1_mic= 0.40921 val_f1_mac= 0.11930 time= 0.09326
Epoch: 0002
Iter: 0001 train_loss= 0.53910 train_f1_mic= 0.37240 train_f1_mac= 0.08821 val_loss= 0.58700 val_f1_mic= 0.35076 val_f1_mac= 0.09181 time= 0.08259
Iter: 0006 train_loss= 0.53539 train_f1_mic= 0.38233 train_f1_mac= 0.09166 val_loss= 0.58700 val_f1_mic= 0.35076 val_f1_mac= 0.09181 time= 0.07553
Iter: 0011 train_loss= 0.54164 train_f1_mic= 0.37895 train_f1_mac= 0.09363 val_loss= 0.58700 val_f1_mic= 0.35076 val_f1_mac= 0.09181 time= 0.07072
Iter: 0016 train_loss= 0.54087 train_f1_mic= 0.38205 train_f1_mac= 0.09366 val_loss= 0.58700 val_f1_mic= 0.35076 val_f1_mac= 0.09181 time= 0.06691
Epoch: 0003
Iter: 0002 train_loss= 0.54896 train_f1_mic= 0.36946 train_f1_mac= 0.09163 val_loss= 0.55548 val_f1_mic= 0.38421 val_f1_mac= 0.09706 time= 0.06522
Iter: 0007 train_loss= 0.54030 train_f1_mic= 0.38482 train_f1_mac= 0.09301 val_loss= 0.55548 val_f1_mic= 0.38421 val_f1_mac= 0.09706 time= 0.06305
Iter: 0012 train_loss= 0.54114 train_f1_mic= 0.38618 train_f1_mac= 0.09638 val_loss= 0.55548 val_f1_mic= 0.38421 val_f1_mac= 0.09706 time= 0.06138
Iter: 0017 train_loss= 0.54460 train_f1_mic= 0.38519 train_f1_mac= 0.09643 val_loss= 0.55548 val_f1_mic= 0.38421 val_f1_mac= 0.09706 time= 0.05996
Epoch: 0004
Iter: 0003 train_loss= 0.53924 train_f1_mic= 0.37287 train_f1_mac= 0.08801 val_loss= 0.57350 val_f1_mic= 0.36550 val_f1_mac= 0.09339 time= 0.05914
Iter: 0008 train_loss= 0.54332 train_f1_mic= 0.38426 train_f1_mac= 0.09442 val_loss= 0.57350 val_f1_mic= 0.36550 val_f1_mac= 0.09339 time= 0.05803
Iter: 0013 train_loss= 0.54143 train_f1_mic= 0.39927 train_f1_mac= 0.10160 val_loss= 0.57350 val_f1_mic= 0.36550 val_f1_mac= 0.09339 time= 0.05696
Iter: 0018 train_loss= 0.54260 train_f1_mic= 0.38629 train_f1_mac= 0.09416 val_loss= 0.57350 val_f1_mic= 0.36550 val_f1_mac= 0.09339 time= 0.05602
Epoch: 0005
Iter: 0004 train_loss= 0.54602 train_f1_mic= 0.37072 train_f1_mac= 0.09140 val_loss= 0.55303 val_f1_mic= 0.37405 val_f1_mac= 0.09360 time= 0.05557
Iter: 0009 train_loss= 0.54101 train_f1_mic= 0.39476 train_f1_mac= 0.09848 val_loss= 0.55303 val_f1_mic= 0.37405 val_f1_mac= 0.09360 time= 0.05493
Iter: 0014 train_loss= 0.53337 train_f1_mic= 0.38809 train_f1_mac= 0.09496 val_loss= 0.55303 val_f1_mic= 0.37405 val_f1_mac= 0.09360 time= 0.05430
Epoch: 0006
Iter: 0000 train_loss= 0.54734 train_f1_mic= 0.38297 train_f1_mac= 0.10004 val_loss= 0.55564 val_f1_mic= 0.37805 val_f1_mac= 0.10315 time= 0.05426
Iter: 0005 train_loss= 0.53874 train_f1_mic= 0.38081 train_f1_mac= 0.10048 val_loss= 0.55564 val_f1_mic= 0.37805 val_f1_mac= 0.10315 time= 0.05378
Iter: 0010 train_loss= 0.52440 train_f1_mic= 0.40769 train_f1_mac= 0.11642 val_loss= 0.55564 val_f1_mic= 0.37805 val_f1_mac= 0.10315 time= 0.05345
Iter: 0015 train_loss= 0.54692 train_f1_mic= 0.41441 train_f1_mac= 0.12949 val_loss= 0.55564 val_f1_mic= 0.37805 val_f1_mac= 0.10315 time= 0.05306
Epoch: 0007
Iter: 0001 train_loss= 0.53091 train_f1_mic= 0.41903 train_f1_mac= 0.13142 val_loss= 0.54961 val_f1_mic= 0.42106 val_f1_mac= 0.13499 time= 0.05291
Iter: 0006 train_loss= 0.52837 train_f1_mic= 0.40325 train_f1_mac= 0.12085 val_loss= 0.54961 val_f1_mic= 0.42106 val_f1_mac= 0.13499 time= 0.05254
Iter: 0011 train_loss= 0.53592 train_f1_mic= 0.40910 train_f1_mac= 0.12614 val_loss= 0.54961 val_f1_mic= 0.42106 val_f1_mac= 0.13499 time= 0.05227
Iter: 0016 train_loss= 0.52195 train_f1_mic= 0.42162 train_f1_mac= 0.13543 val_loss= 0.54961 val_f1_mic= 0.42106 val_f1_mac= 0.13499 time= 0.05194
Epoch: 0008
Iter: 0002 train_loss= 0.53557 train_f1_mic= 0.44495 train_f1_mac= 0.15134 val_loss= 0.56648 val_f1_mic= 0.45810 val_f1_mac= 0.17659 time= 0.05194
Iter: 0007 train_loss= 0.51819 train_f1_mic= 0.42737 train_f1_mac= 0.13416 val_loss= 0.56648 val_f1_mic= 0.45810 val_f1_mac= 0.17659 time= 0.05164
Iter: 0012 train_loss= 0.52094 train_f1_mic= 0.43107 train_f1_mac= 0.15115 val_loss= 0.56648 val_f1_mic= 0.45810 val_f1_mac= 0.17659 time= 0.05135
Iter: 0017 train_loss= 0.52962 train_f1_mic= 0.42777 train_f1_mac= 0.14140 val_loss= 0.56648 val_f1_mic= 0.45810 val_f1_mac= 0.17659 time= 0.05109
Epoch: 0009
Iter: 0003 train_loss= 0.52033 train_f1_mic= 0.43375 train_f1_mac= 0.15053 val_loss= 0.54066 val_f1_mic= 0.43584 val_f1_mac= 0.15195 time= 0.05110
Iter: 0008 train_loss= 0.52375 train_f1_mic= 0.42056 train_f1_mac= 0.16236 val_loss= 0.54066 val_f1_mic= 0.43584 val_f1_mac= 0.15195 time= 0.05083
Iter: 0013 train_loss= 0.51418 train_f1_mic= 0.43241 train_f1_mac= 0.16028 val_loss= 0.54066 val_f1_mic= 0.43584 val_f1_mac= 0.15195 time= 0.05064
Iter: 0018 train_loss= 0.53745 train_f1_mic= 0.39891 train_f1_mac= 0.13515 val_loss= 0.54066 val_f1_mic= 0.43584 val_f1_mac= 0.15195 time= 0.05040
Epoch: 0010
Iter: 0004 train_loss= 0.51182 train_f1_mic= 0.40791 train_f1_mac= 0.15578 val_loss= 0.54795 val_f1_mic= 0.47740 val_f1_mac= 0.21170 time= 0.05037
Iter: 0009 train_loss= 0.51208 train_f1_mic= 0.46584 train_f1_mac= 0.19668 val_loss= 0.54795 val_f1_mic= 0.47740 val_f1_mac= 0.21170 time= 0.05023
Iter: 0014 train_loss= 0.50921 train_f1_mic= 0.48860 train_f1_mac= 0.22405 val_loss= 0.54795 val_f1_mic= 0.47740 val_f1_mac= 0.21170 time= 0.05004
Optimization Finished!
Full validation stats: loss= 0.53291 f1_micro= 0.47501 f1_macro= 0.22168 time= 0.12566
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47969575023128985
Rewards :  -0.009671855848797095 Accuracy :  0.4719582655522522
Total reward :  1.3422145113398791
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'relu', 2, 'linear']
Training RNN (Reward ip) :  [-0.00967186]
Trial 273: Controller loss : 8206.723633

Prediction action from Controller
State input to Controller for Action :  [0. 0. 3. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:54:51.933676: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:54:51.933910: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:54:51.934138: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:54:51.934308: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:54:51.934521: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69579 train_f1_mic= 0.35436 train_f1_mac= 0.28359 val_loss= 0.66653 val_f1_mic= 0.39634 val_f1_mac= 0.12050 time= 0.81485
Iter: 0005 train_loss= 0.58679 train_f1_mic= 0.36644 train_f1_mac= 0.08938 val_loss= 0.66653 val_f1_mic= 0.39634 val_f1_mac= 0.12050 time= 0.14745
Iter: 0010 train_loss= 0.54917 train_f1_mic= 0.37845 train_f1_mac= 0.09309 val_loss= 0.66653 val_f1_mic= 0.39634 val_f1_mac= 0.12050 time= 0.08678
Iter: 0015 train_loss= 0.52797 train_f1_mic= 0.42479 train_f1_mac= 0.11154 val_loss= 0.66653 val_f1_mic= 0.39634 val_f1_mac= 0.12050 time= 0.06402
Epoch: 0002
Iter: 0001 train_loss= 0.54109 train_f1_mic= 0.38777 train_f1_mac= 0.09725 val_loss= 0.57495 val_f1_mic= 0.37212 val_f1_mac= 0.09952 time= 0.05287
Iter: 0006 train_loss= 0.55085 train_f1_mic= 0.36267 train_f1_mac= 0.08866 val_loss= 0.57495 val_f1_mic= 0.37212 val_f1_mac= 0.09952 time= 0.04546
Iter: 0011 train_loss= 0.55252 train_f1_mic= 0.38188 train_f1_mac= 0.10101 val_loss= 0.57495 val_f1_mic= 0.37212 val_f1_mac= 0.09952 time= 0.04038
Iter: 0016 train_loss= 0.52767 train_f1_mic= 0.40373 train_f1_mac= 0.10624 val_loss= 0.57495 val_f1_mic= 0.37212 val_f1_mac= 0.09952 time= 0.03671
Epoch: 0003
Iter: 0002 train_loss= 0.53189 train_f1_mic= 0.38687 train_f1_mac= 0.10565 val_loss= 0.54189 val_f1_mic= 0.38123 val_f1_mac= 0.10533 time= 0.03435
Iter: 0007 train_loss= 0.53314 train_f1_mic= 0.39972 train_f1_mac= 0.11662 val_loss= 0.54189 val_f1_mic= 0.38123 val_f1_mac= 0.10533 time= 0.03216
Iter: 0012 train_loss= 0.53473 train_f1_mic= 0.40771 train_f1_mac= 0.12312 val_loss= 0.54189 val_f1_mic= 0.38123 val_f1_mac= 0.10533 time= 0.03037
Iter: 0017 train_loss= 0.52920 train_f1_mic= 0.39641 train_f1_mac= 0.11895 val_loss= 0.54189 val_f1_mic= 0.38123 val_f1_mac= 0.10533 time= 0.02908
Epoch: 0004
Iter: 0003 train_loss= 0.52720 train_f1_mic= 0.42892 train_f1_mac= 0.13782 val_loss= 0.54736 val_f1_mic= 0.42692 val_f1_mac= 0.13998 time= 0.02829
Iter: 0008 train_loss= 0.51806 train_f1_mic= 0.40962 train_f1_mac= 0.12538 val_loss= 0.54736 val_f1_mic= 0.42692 val_f1_mac= 0.13998 time= 0.02738
Iter: 0013 train_loss= 0.52503 train_f1_mic= 0.42992 train_f1_mac= 0.13857 val_loss= 0.54736 val_f1_mic= 0.42692 val_f1_mac= 0.13998 time= 0.02662
Iter: 0018 train_loss= 0.52271 train_f1_mic= 0.42181 train_f1_mac= 0.14114 val_loss= 0.54736 val_f1_mic= 0.42692 val_f1_mac= 0.13998 time= 0.02584
Epoch: 0005
Iter: 0004 train_loss= 0.52268 train_f1_mic= 0.43408 train_f1_mac= 0.15669 val_loss= 0.53992 val_f1_mic= 0.43435 val_f1_mac= 0.15954 time= 0.02553
Iter: 0009 train_loss= 0.53113 train_f1_mic= 0.44057 train_f1_mac= 0.16687 val_loss= 0.53992 val_f1_mic= 0.43435 val_f1_mac= 0.15954 time= 0.02497
Iter: 0014 train_loss= 0.51610 train_f1_mic= 0.38681 train_f1_mac= 0.12591 val_loss= 0.53992 val_f1_mic= 0.43435 val_f1_mac= 0.15954 time= 0.02452
Epoch: 0006
Iter: 0000 train_loss= 0.52941 train_f1_mic= 0.47168 train_f1_mac= 0.20306 val_loss= 0.53554 val_f1_mic= 0.47242 val_f1_mac= 0.20306 time= 0.02440
Iter: 0005 train_loss= 0.52156 train_f1_mic= 0.42546 train_f1_mac= 0.15832 val_loss= 0.53554 val_f1_mic= 0.47242 val_f1_mac= 0.20306 time= 0.02404
Iter: 0010 train_loss= 0.52100 train_f1_mic= 0.47078 train_f1_mac= 0.19326 val_loss= 0.53554 val_f1_mic= 0.47242 val_f1_mac= 0.20306 time= 0.02363
Iter: 0015 train_loss= 0.49524 train_f1_mic= 0.45177 train_f1_mac= 0.17728 val_loss= 0.53554 val_f1_mic= 0.47242 val_f1_mac= 0.20306 time= 0.02323
Epoch: 0007
Iter: 0001 train_loss= 0.50977 train_f1_mic= 0.43727 train_f1_mac= 0.17866 val_loss= 0.54022 val_f1_mic= 0.47395 val_f1_mac= 0.21968 time= 0.02312
Iter: 0006 train_loss= 0.51701 train_f1_mic= 0.48682 train_f1_mac= 0.22543 val_loss= 0.54022 val_f1_mic= 0.47395 val_f1_mac= 0.21968 time= 0.02282
Iter: 0011 train_loss= 0.51055 train_f1_mic= 0.45154 train_f1_mac= 0.18711 val_loss= 0.54022 val_f1_mic= 0.47395 val_f1_mac= 0.21968 time= 0.02256
Iter: 0016 train_loss= 0.51015 train_f1_mic= 0.47902 train_f1_mac= 0.22041 val_loss= 0.54022 val_f1_mic= 0.47395 val_f1_mac= 0.21968 time= 0.02235
Epoch: 0008
Iter: 0002 train_loss= 0.50109 train_f1_mic= 0.50397 train_f1_mac= 0.24952 val_loss= 0.52850 val_f1_mic= 0.48308 val_f1_mac= 0.23388 time= 0.02217
Iter: 0007 train_loss= 0.49980 train_f1_mic= 0.45450 train_f1_mac= 0.21695 val_loss= 0.52850 val_f1_mic= 0.48308 val_f1_mac= 0.23388 time= 0.02195
Iter: 0012 train_loss= 0.49466 train_f1_mic= 0.47539 train_f1_mac= 0.22300 val_loss= 0.52850 val_f1_mic= 0.48308 val_f1_mac= 0.23388 time= 0.02170
Iter: 0017 train_loss= 0.50264 train_f1_mic= 0.49871 train_f1_mac= 0.23803 val_loss= 0.52850 val_f1_mic= 0.48308 val_f1_mac= 0.23388 time= 0.02148
Epoch: 0009
Iter: 0003 train_loss= 0.49610 train_f1_mic= 0.46401 train_f1_mac= 0.21232 val_loss= 0.52516 val_f1_mic= 0.45053 val_f1_mac= 0.20097 time= 0.02142
Iter: 0008 train_loss= 0.49646 train_f1_mic= 0.48031 train_f1_mac= 0.23523 val_loss= 0.52516 val_f1_mic= 0.45053 val_f1_mac= 0.20097 time= 0.02120
Iter: 0013 train_loss= 0.50407 train_f1_mic= 0.49695 train_f1_mac= 0.25935 val_loss= 0.52516 val_f1_mic= 0.45053 val_f1_mac= 0.20097 time= 0.02102
Iter: 0018 train_loss= 0.49331 train_f1_mic= 0.50647 train_f1_mac= 0.27180 val_loss= 0.52516 val_f1_mic= 0.45053 val_f1_mac= 0.20097 time= 0.02086
Epoch: 0010
Iter: 0004 train_loss= 0.48847 train_f1_mic= 0.48202 train_f1_mac= 0.25491 val_loss= 0.52326 val_f1_mic= 0.48977 val_f1_mac= 0.26026 time= 0.02081
Iter: 0009 train_loss= 0.49346 train_f1_mic= 0.48905 train_f1_mac= 0.26071 val_loss= 0.52326 val_f1_mic= 0.48977 val_f1_mac= 0.26026 time= 0.02065
Iter: 0014 train_loss= 0.50508 train_f1_mic= 0.51379 train_f1_mac= 0.28236 val_loss= 0.52326 val_f1_mic= 0.48977 val_f1_mac= 0.26026 time= 0.02050
Optimization Finished!
Full validation stats: loss= 0.51202 f1_micro= 0.53710 f1_macro= 0.30753 time= 0.11968
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4899284831496562
Rewards :  0.05116366459183175 Accuracy :  0.5308594148231216
Total reward :  1.3933781759317108
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.05116367]
Trial 274: Controller loss : 116.190788
2018-08-31 00:55:01.379139: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:55:01.379386: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:55:01.379612: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:55:01.379783: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:55:01.379995: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:loc
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 4, 'sigmoid']
alhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69279 train_f1_mic= 0.32578 train_f1_mac= 0.18707 val_loss= 0.65471 val_f1_mic= 0.37434 val_f1_mac= 0.09463 time= 0.75001
Iter: 0005 train_loss= 0.56322 train_f1_mic= 0.37502 train_f1_mac= 0.08715 val_loss= 0.65471 val_f1_mic= 0.37434 val_f1_mac= 0.09463 time= 0.13480
Iter: 0010 train_loss= 0.55154 train_f1_mic= 0.37367 train_f1_mac= 0.08928 val_loss= 0.65471 val_f1_mic= 0.37434 val_f1_mac= 0.09463 time= 0.07861
Iter: 0015 train_loss= 0.55700 train_f1_mic= 0.37727 train_f1_mac= 0.09361 val_loss= 0.65471 val_f1_mic= 0.37434 val_f1_mac= 0.09463 time= 0.05784
Epoch: 0002
Iter: 0001 train_loss= 0.54668 train_f1_mic= 0.39853 train_f1_mac= 0.10284 val_loss= 0.55853 val_f1_mic= 0.38641 val_f1_mac= 0.10267 time= 0.04816
Iter: 0006 train_loss= 0.54854 train_f1_mic= 0.37556 train_f1_mac= 0.09247 val_loss= 0.55853 val_f1_mic= 0.38641 val_f1_mac= 0.10267 time= 0.04188
Iter: 0011 train_loss= 0.54334 train_f1_mic= 0.36482 train_f1_mac= 0.08712 val_loss= 0.55853 val_f1_mic= 0.38641 val_f1_mac= 0.10267 time= 0.03725
Iter: 0016 train_loss= 0.55103 train_f1_mic= 0.38114 train_f1_mac= 0.09777 val_loss= 0.55853 val_f1_mic= 0.38641 val_f1_mac= 0.10267 time= 0.03385
Epoch: 0003
Iter: 0002 train_loss= 0.54345 train_f1_mic= 0.38160 train_f1_mac= 0.09396 val_loss= 0.55269 val_f1_mic= 0.39223 val_f1_mac= 0.10389 time= 0.03160
Iter: 0007 train_loss= 0.53585 train_f1_mic= 0.39525 train_f1_mac= 0.10432 val_loss= 0.55269 val_f1_mic= 0.39223 val_f1_mac= 0.10389 time= 0.02946
Iter: 0012 train_loss= 0.53791 train_f1_mic= 0.40178 train_f1_mac= 0.11034 val_loss= 0.55269 val_f1_mic= 0.39223 val_f1_mac= 0.10389 time= 0.02769
Iter: 0017 train_loss= 0.53670 train_f1_mic= 0.38862 train_f1_mac= 0.10548 val_loss= 0.55269 val_f1_mic= 0.39223 val_f1_mac= 0.10389 time= 0.02637
Epoch: 0004
Iter: 0003 train_loss= 0.54804 train_f1_mic= 0.39690 train_f1_mac= 0.11575 val_loss= 0.55516 val_f1_mic= 0.39819 val_f1_mac= 0.11631 time= 0.02544
Iter: 0008 train_loss= 0.52391 train_f1_mic= 0.42708 train_f1_mac= 0.12862 val_loss= 0.55516 val_f1_mic= 0.39819 val_f1_mac= 0.11631 time= 0.02440
Iter: 0013 train_loss= 0.53529 train_f1_mic= 0.38469 train_f1_mac= 0.10658 val_loss= 0.55516 val_f1_mic= 0.39819 val_f1_mac= 0.11631 time= 0.02358
Iter: 0018 train_loss= 0.53078 train_f1_mic= 0.43736 train_f1_mac= 0.13692 val_loss= 0.55516 val_f1_mic= 0.39819 val_f1_mac= 0.11631 time= 0.02280
Epoch: 0005
Iter: 0004 train_loss= 0.53611 train_f1_mic= 0.41446 train_f1_mac= 0.12907 val_loss= 0.52878 val_f1_mic= 0.43079 val_f1_mac= 0.13350 time= 0.02250
Iter: 0009 train_loss= 0.51983 train_f1_mic= 0.41863 train_f1_mac= 0.12980 val_loss= 0.52878 val_f1_mic= 0.43079 val_f1_mac= 0.13350 time= 0.02201
Iter: 0014 train_loss= 0.52338 train_f1_mic= 0.42222 train_f1_mac= 0.13455 val_loss= 0.52878 val_f1_mic= 0.43079 val_f1_mac= 0.13350 time= 0.02149
Epoch: 0006
Iter: 0000 train_loss= 0.52965 train_f1_mic= 0.40668 train_f1_mac= 0.12529 val_loss= 0.54951 val_f1_mic= 0.41648 val_f1_mac= 0.14054 time= 0.02128
Iter: 0005 train_loss= 0.52520 train_f1_mic= 0.44241 train_f1_mac= 0.14933 val_loss= 0.54951 val_f1_mic= 0.41648 val_f1_mac= 0.14054 time= 0.02099
Iter: 0010 train_loss= 0.52256 train_f1_mic= 0.42798 train_f1_mac= 0.14654 val_loss= 0.54951 val_f1_mic= 0.41648 val_f1_mac= 0.14054 time= 0.02065
Iter: 0015 train_loss= 0.51931 train_f1_mic= 0.42525 train_f1_mac= 0.14258 val_loss= 0.54951 val_f1_mic= 0.41648 val_f1_mac= 0.14054 time= 0.02030
Epoch: 0007
Iter: 0001 train_loss= 0.50924 train_f1_mic= 0.44945 train_f1_mac= 0.16257 val_loss= 0.54333 val_f1_mic= 0.44313 val_f1_mac= 0.17186 time= 0.02017
Iter: 0006 train_loss= 0.52370 train_f1_mic= 0.44586 train_f1_mac= 0.16715 val_loss= 0.54333 val_f1_mic= 0.44313 val_f1_mac= 0.17186 time= 0.01985
Iter: 0011 train_loss= 0.53325 train_f1_mic= 0.43527 train_f1_mac= 0.16662 val_loss= 0.54333 val_f1_mic= 0.44313 val_f1_mac= 0.17186 time= 0.01955
Iter: 0016 train_loss= 0.51596 train_f1_mic= 0.46128 train_f1_mac= 0.18406 val_loss= 0.54333 val_f1_mic= 0.44313 val_f1_mac= 0.17186 time= 0.01931
Epoch: 0008
Iter: 0002 train_loss= 0.50939 train_f1_mic= 0.44380 train_f1_mac= 0.16342 val_loss= 0.55327 val_f1_mic= 0.42672 val_f1_mac= 0.16362 time= 0.01922
Iter: 0007 train_loss= 0.52197 train_f1_mic= 0.44634 train_f1_mac= 0.17332 val_loss= 0.55327 val_f1_mic= 0.42672 val_f1_mac= 0.16362 time= 0.01899
Iter: 0012 train_loss= 0.50920 train_f1_mic= 0.45531 train_f1_mac= 0.18277 val_loss= 0.55327 val_f1_mic= 0.42672 val_f1_mac= 0.16362 time= 0.01873
Iter: 0017 train_loss= 0.51326 train_f1_mic= 0.44540 train_f1_mac= 0.18246 val_loss= 0.55327 val_f1_mic= 0.42672 val_f1_mac= 0.16362 time= 0.01855
Epoch: 0009
Iter: 0003 train_loss= 0.51508 train_f1_mic= 0.43802 train_f1_mac= 0.17331 val_loss= 0.54479 val_f1_mic= 0.45099 val_f1_mac= 0.19709 time= 0.01859
Iter: 0008 train_loss= 0.51458 train_f1_mic= 0.46903 train_f1_mac= 0.20122 val_loss= 0.54479 val_f1_mic= 0.45099 val_f1_mac= 0.19709 time= 0.01839
Iter: 0013 train_loss= 0.51164 train_f1_mic= 0.44066 train_f1_mac= 0.17803 val_loss= 0.54479 val_f1_mic= 0.45099 val_f1_mac= 0.19709 time= 0.01819
Iter: 0018 train_loss= 0.51326 train_f1_mic= 0.45429 train_f1_mac= 0.18771 val_loss= 0.54479 val_f1_mic= 0.45099 val_f1_mac= 0.19709 time= 0.01803
Epoch: 0010
Iter: 0004 train_loss= 0.52000 train_f1_mic= 0.45659 train_f1_mac= 0.18083 val_loss= 0.54703 val_f1_mic= 0.45010 val_f1_mac= 0.19726 time= 0.01795
Iter: 0009 train_loss= 0.51135 train_f1_mic= 0.46710 train_f1_mac= 0.19662 val_loss= 0.54703 val_f1_mic= 0.45010 val_f1_mac= 0.19726 time= 0.01782
Iter: 0014 train_loss= 0.51328 train_f1_mic= 0.45382 train_f1_mac= 0.19041 val_loss= 0.54703 val_f1_mic= 0.45010 val_f1_mac= 0.19726 time= 0.01766
Optimization Finished!
Full validation stats: loss= 0.53259 f1_micro= 0.46095 f1_macro= 0.21287 time= 0.07380
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48369638867702014
Rewards :  -0.031160472363180425 Accuracy :  0.4587680107864758
Total reward :  1.3622177035685303
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 4, 'sigmoid']
Training RNN (Reward ip) :  [-0.03116047]
Trial 275: Controller loss : 6594.069336
2018-08-31 00:55:09.959210: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:55:09.959452: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:55:09.959679: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:55:09.959848: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:55:09.960059: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [3, 'linear', 0, 'linear']
Epoch: 0001
Iter: 0000 train_loss= 0.69316 train_f1_mic= 0.36061 train_f1_mac= 0.28053 val_loss= 0.67223 val_f1_mic= 0.39152 val_f1_mac= 0.14256 time= 0.89014
Iter: 0005 train_loss= 0.58957 train_f1_mic= 0.38293 train_f1_mac= 0.09923 val_loss= 0.67223 val_f1_mic= 0.39152 val_f1_mac= 0.14256 time= 0.20138
Iter: 0010 train_loss= 0.55552 train_f1_mic= 0.37793 train_f1_mac= 0.09502 val_loss= 0.67223 val_f1_mic= 0.39152 val_f1_mac= 0.14256 time= 0.13740
Iter: 0015 train_loss= 0.55008 train_f1_mic= 0.36348 train_f1_mac= 0.08694 val_loss= 0.67223 val_f1_mic= 0.39152 val_f1_mac= 0.14256 time= 0.11335
Epoch: 0002
Iter: 0001 train_loss= 0.54621 train_f1_mic= 0.39983 train_f1_mac= 0.10631 val_loss= 0.56754 val_f1_mic= 0.39500 val_f1_mac= 0.10910 time= 0.10161
Iter: 0006 train_loss= 0.53968 train_f1_mic= 0.39246 train_f1_mac= 0.10037 val_loss= 0.56754 val_f1_mic= 0.39500 val_f1_mac= 0.10910 time= 0.09357
Iter: 0011 train_loss= 0.53847 train_f1_mic= 0.37515 train_f1_mac= 0.09201 val_loss= 0.56754 val_f1_mic= 0.39500 val_f1_mac= 0.10910 time= 0.08810
Iter: 0016 train_loss= 0.53529 train_f1_mic= 0.39002 train_f1_mac= 0.10081 val_loss= 0.56754 val_f1_mic= 0.39500 val_f1_mac= 0.10910 time= 0.08420
Epoch: 0003
Iter: 0002 train_loss= 0.54560 train_f1_mic= 0.40871 train_f1_mac= 0.11610 val_loss= 0.54821 val_f1_mic= 0.40439 val_f1_mac= 0.11307 time= 0.08193
Iter: 0007 train_loss= 0.53670 train_f1_mic= 0.39031 train_f1_mac= 0.10771 val_loss= 0.54821 val_f1_mic= 0.40439 val_f1_mac= 0.11307 time= 0.07973
Iter: 0012 train_loss= 0.54528 train_f1_mic= 0.38373 train_f1_mac= 0.10328 val_loss= 0.54821 val_f1_mic= 0.40439 val_f1_mac= 0.11307 time= 0.07782
Iter: 0017 train_loss= 0.52868 train_f1_mic= 0.41379 train_f1_mac= 0.11797 val_loss= 0.54821 val_f1_mic= 0.40439 val_f1_mac= 0.11307 time= 0.07623
Epoch: 0004
Iter: 0003 train_loss= 0.53240 train_f1_mic= 0.41137 train_f1_mac= 0.12055 val_loss= 0.53457 val_f1_mic= 0.42182 val_f1_mac= 0.12861 time= 0.07531
Iter: 0008 train_loss= 0.53963 train_f1_mic= 0.38842 train_f1_mac= 0.11104 val_loss= 0.53457 val_f1_mic= 0.42182 val_f1_mac= 0.12861 time= 0.07414
Iter: 0013 train_loss= 0.53251 train_f1_mic= 0.40899 train_f1_mac= 0.11974 val_loss= 0.53457 val_f1_mic= 0.42182 val_f1_mac= 0.12861 time= 0.07312
Iter: 0018 train_loss= 0.53623 train_f1_mic= 0.41477 train_f1_mac= 0.12196 val_loss= 0.53457 val_f1_mic= 0.42182 val_f1_mac= 0.12861 time= 0.07223
Epoch: 0005
Iter: 0004 train_loss= 0.52117 train_f1_mic= 0.39123 train_f1_mac= 0.10483 val_loss= 0.55537 val_f1_mic= 0.40166 val_f1_mac= 0.11889 time= 0.07174
Iter: 0009 train_loss= 0.53499 train_f1_mic= 0.41359 train_f1_mac= 0.12643 val_loss= 0.55537 val_f1_mic= 0.40166 val_f1_mac= 0.11889 time= 0.07107
Iter: 0014 train_loss= 0.53359 train_f1_mic= 0.42770 train_f1_mac= 0.13407 val_loss= 0.55537 val_f1_mic= 0.40166 val_f1_mac= 0.11889 time= 0.07048
Epoch: 0006
Iter: 0000 train_loss= 0.52752 train_f1_mic= 0.40716 train_f1_mac= 0.12036 val_loss= 0.56101 val_f1_mic= 0.39245 val_f1_mac= 0.12400 time= 0.07014
Iter: 0005 train_loss= 0.52373 train_f1_mic= 0.41458 train_f1_mac= 0.12554 val_loss= 0.56101 val_f1_mic= 0.39245 val_f1_mac= 0.12400 time= 0.06964
Iter: 0010 train_loss= 0.53108 train_f1_mic= 0.40728 train_f1_mac= 0.12495 val_loss= 0.56101 val_f1_mic= 0.39245 val_f1_mac= 0.12400 time= 0.06920
Iter: 0015 train_loss= 0.53478 train_f1_mic= 0.40299 train_f1_mac= 0.12104 val_loss= 0.56101 val_f1_mic= 0.39245 val_f1_mac= 0.12400 time= 0.06883
Epoch: 0007
Iter: 0001 train_loss= 0.52554 train_f1_mic= 0.42843 train_f1_mac= 0.13860 val_loss= 0.54017 val_f1_mic= 0.42150 val_f1_mac= 0.14222 time= 0.06864
Iter: 0006 train_loss= 0.51832 train_f1_mic= 0.40922 train_f1_mac= 0.12242 val_loss= 0.54017 val_f1_mic= 0.42150 val_f1_mac= 0.14222 time= 0.06828
Iter: 0011 train_loss= 0.52500 train_f1_mic= 0.42981 train_f1_mac= 0.13629 val_loss= 0.54017 val_f1_mic= 0.42150 val_f1_mac= 0.14222 time= 0.06795
Iter: 0016 train_loss= 0.53495 train_f1_mic= 0.42289 train_f1_mac= 0.13808 val_loss= 0.54017 val_f1_mic= 0.42150 val_f1_mac= 0.14222 time= 0.06765
Epoch: 0008
Iter: 0002 train_loss= 0.52996 train_f1_mic= 0.40149 train_f1_mac= 0.12677 val_loss= 0.54247 val_f1_mic= 0.40946 val_f1_mac= 0.13508 time= 0.06752
Iter: 0007 train_loss= 0.52976 train_f1_mic= 0.41398 train_f1_mac= 0.13322 val_loss= 0.54247 val_f1_mic= 0.40946 val_f1_mac= 0.13508 time= 0.06727
Iter: 0012 train_loss= 0.53118 train_f1_mic= 0.43049 train_f1_mac= 0.15178 val_loss= 0.54247 val_f1_mic= 0.40946 val_f1_mac= 0.13508 time= 0.06703
Iter: 0017 train_loss= 0.53650 train_f1_mic= 0.42045 train_f1_mac= 0.13627 val_loss= 0.54247 val_f1_mic= 0.40946 val_f1_mac= 0.13508 time= 0.06679
Epoch: 0009
Iter: 0003 train_loss= 0.52781 train_f1_mic= 0.42924 train_f1_mac= 0.15037 val_loss= 0.53375 val_f1_mic= 0.45660 val_f1_mac= 0.18157 time= 0.06670
Iter: 0008 train_loss= 0.50931 train_f1_mic= 0.45556 train_f1_mac= 0.18787 val_loss= 0.53375 val_f1_mic= 0.45660 val_f1_mac= 0.18157 time= 0.06650
Iter: 0013 train_loss= 0.51653 train_f1_mic= 0.43064 train_f1_mac= 0.14676 val_loss= 0.53375 val_f1_mic= 0.45660 val_f1_mac= 0.18157 time= 0.06632
Iter: 0018 train_loss= 0.50926 train_f1_mic= 0.43273 train_f1_mac= 0.15240 val_loss= 0.53375 val_f1_mic= 0.45660 val_f1_mac= 0.18157 time= 0.06612
Epoch: 0010
Iter: 0004 train_loss= 0.51181 train_f1_mic= 0.44720 train_f1_mac= 0.18909 val_loss= 0.54560 val_f1_mic= 0.41570 val_f1_mac= 0.15211 time= 0.06613
Iter: 0009 train_loss= 0.51164 train_f1_mic= 0.44375 train_f1_mac= 0.17810 val_loss= 0.54560 val_f1_mic= 0.41570 val_f1_mac= 0.15211 time= 0.06597
Iter: 0014 train_loss= 0.52432 train_f1_mic= 0.47311 train_f1_mac= 0.20573 val_loss= 0.54560 val_f1_mic= 0.41570 val_f1_mac= 0.15211 time= 0.06581
Optimization Finished!
Full validation stats: loss= 0.53430 f1_micro= 0.48818 f1_macro= 0.24113 time= 0.11370
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4818942372166777
Rewards :  -0.009010757301712302 Accuracy :  0.47468563137530784
Total reward :  1.353206946266818
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 0, 'linear']
Training RNN (Reward ip) :  [-0.00901076]
Trial 276: Controller loss : 12170.109375

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [0, 'linear', 2, 'linear']
2018-08-31 00:55:27.723193: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:55:27.723713: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:55:27.724199: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:55:27.724558: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:55:27.725006: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69354 train_f1_mic= 0.38932 train_f1_mac= 0.35430 val_loss= 0.67458 val_f1_mic= 0.41831 val_f1_mac= 0.22874 time= 0.75399
Iter: 0005 train_loss= 0.59928 train_f1_mic= 0.37277 train_f1_mac= 0.09233 val_loss= 0.67458 val_f1_mic= 0.41831 val_f1_mac= 0.22874 time= 0.13712
Iter: 0010 train_loss= 0.54973 train_f1_mic= 0.37377 train_f1_mac= 0.08754 val_loss= 0.67458 val_f1_mic= 0.41831 val_f1_mac= 0.22874 time= 0.08105
Iter: 0015 train_loss= 0.54848 train_f1_mic= 0.38515 train_f1_mac= 0.10046 val_loss= 0.67458 val_f1_mic= 0.41831 val_f1_mac= 0.22874 time= 0.05977
Epoch: 0002
Iter: 0001 train_loss= 0.54119 train_f1_mic= 0.42432 train_f1_mac= 0.12505 val_loss= 0.55728 val_f1_mic= 0.41606 val_f1_mac= 0.12688 time= 0.04986
Iter: 0006 train_loss= 0.53631 train_f1_mic= 0.40301 train_f1_mac= 0.12883 val_loss= 0.55728 val_f1_mic= 0.41606 val_f1_mac= 0.12688 time= 0.04292
Iter: 0011 train_loss= 0.53602 train_f1_mic= 0.40362 train_f1_mac= 0.13595 val_loss= 0.55728 val_f1_mic= 0.41606 val_f1_mac= 0.12688 time= 0.03835
Iter: 0016 train_loss= 0.53406 train_f1_mic= 0.41478 train_f1_mac= 0.13401 val_loss= 0.55728 val_f1_mic= 0.41606 val_f1_mac= 0.12688 time= 0.03507
Epoch: 0003
Iter: 0002 train_loss= 0.53672 train_f1_mic= 0.40493 train_f1_mac= 0.12505 val_loss= 0.55624 val_f1_mic= 0.41339 val_f1_mac= 0.13456 time= 0.03344
Iter: 0007 train_loss= 0.52832 train_f1_mic= 0.41945 train_f1_mac= 0.14411 val_loss= 0.55624 val_f1_mic= 0.41339 val_f1_mac= 0.13456 time= 0.03133
Iter: 0012 train_loss= 0.52807 train_f1_mic= 0.42418 train_f1_mac= 0.14669 val_loss= 0.55624 val_f1_mic= 0.41339 val_f1_mac= 0.13456 time= 0.02956
Iter: 0017 train_loss= 0.53585 train_f1_mic= 0.40989 train_f1_mac= 0.14748 val_loss= 0.55624 val_f1_mic= 0.41339 val_f1_mac= 0.13456 time= 0.02808
Epoch: 0004
Iter: 0003 train_loss= 0.52661 train_f1_mic= 0.41588 train_f1_mac= 0.14123 val_loss= 0.55287 val_f1_mic= 0.41224 val_f1_mac= 0.14466 time= 0.02746
Iter: 0008 train_loss= 0.52390 train_f1_mic= 0.42614 train_f1_mac= 0.16119 val_loss= 0.55287 val_f1_mic= 0.41224 val_f1_mac= 0.14466 time= 0.02651
Iter: 0013 train_loss= 0.53106 train_f1_mic= 0.43006 train_f1_mac= 0.16030 val_loss= 0.55287 val_f1_mic= 0.41224 val_f1_mac= 0.14466 time= 0.02557
Iter: 0018 train_loss= 0.52588 train_f1_mic= 0.43882 train_f1_mac= 0.16545 val_loss= 0.55287 val_f1_mic= 0.41224 val_f1_mac= 0.14466 time= 0.02486
Epoch: 0005
Iter: 0004 train_loss= 0.52689 train_f1_mic= 0.41141 train_f1_mac= 0.14504 val_loss= 0.54789 val_f1_mic= 0.41472 val_f1_mac= 0.14863 time= 0.02456
Iter: 0009 train_loss= 0.51742 train_f1_mic= 0.43060 train_f1_mac= 0.15383 val_loss= 0.54789 val_f1_mic= 0.41472 val_f1_mac= 0.14863 time= 0.02389
Iter: 0014 train_loss= 0.53473 train_f1_mic= 0.43091 train_f1_mac= 0.15697 val_loss= 0.54789 val_f1_mic= 0.41472 val_f1_mac= 0.14863 time= 0.02344
Epoch: 0006
Iter: 0000 train_loss= 0.50999 train_f1_mic= 0.45162 train_f1_mac= 0.18369 val_loss= 0.54929 val_f1_mic= 0.44415 val_f1_mac= 0.18196 time= 0.02320
Iter: 0005 train_loss= 0.52139 train_f1_mic= 0.43636 train_f1_mac= 0.17286 val_loss= 0.54929 val_f1_mic= 0.44415 val_f1_mac= 0.18196 time= 0.02279
Iter: 0010 train_loss= 0.52568 train_f1_mic= 0.43115 train_f1_mac= 0.17132 val_loss= 0.54929 val_f1_mic= 0.44415 val_f1_mac= 0.18196 time= 0.02244
Iter: 0015 train_loss= 0.53470 train_f1_mic= 0.43895 train_f1_mac= 0.16975 val_loss= 0.54929 val_f1_mic= 0.44415 val_f1_mac= 0.18196 time= 0.02212
Epoch: 0007
Iter: 0001 train_loss= 0.50002 train_f1_mic= 0.44749 train_f1_mac= 0.16928 val_loss= 0.53952 val_f1_mic= 0.43682 val_f1_mac= 0.17636 time= 0.02195
Iter: 0006 train_loss= 0.51706 train_f1_mic= 0.45243 train_f1_mac= 0.19720 val_loss= 0.53952 val_f1_mic= 0.43682 val_f1_mac= 0.17636 time= 0.02162
Iter: 0011 train_loss= 0.52688 train_f1_mic= 0.43967 train_f1_mac= 0.17478 val_loss= 0.53952 val_f1_mic= 0.43682 val_f1_mac= 0.17636 time= 0.02140
Iter: 0016 train_loss= 0.51617 train_f1_mic= 0.47384 train_f1_mac= 0.20408 val_loss= 0.53952 val_f1_mic= 0.43682 val_f1_mac= 0.17636 time= 0.02117
Epoch: 0008
Iter: 0002 train_loss= 0.51756 train_f1_mic= 0.43726 train_f1_mac= 0.17751 val_loss= 0.56014 val_f1_mic= 0.42839 val_f1_mac= 0.17859 time= 0.02110
Iter: 0007 train_loss= 0.53049 train_f1_mic= 0.43626 train_f1_mac= 0.18170 val_loss= 0.56014 val_f1_mic= 0.42839 val_f1_mac= 0.17859 time= 0.02083
Iter: 0012 train_loss= 0.51480 train_f1_mic= 0.44858 train_f1_mac= 0.19144 val_loss= 0.56014 val_f1_mic= 0.42839 val_f1_mac= 0.17859 time= 0.02056
Iter: 0017 train_loss= 0.53159 train_f1_mic= 0.45670 train_f1_mac= 0.19748 val_loss= 0.56014 val_f1_mic= 0.42839 val_f1_mac= 0.17859 time= 0.02041
Epoch: 0009
Iter: 0003 train_loss= 0.52172 train_f1_mic= 0.45296 train_f1_mac= 0.19800 val_loss= 0.53852 val_f1_mic= 0.45217 val_f1_mac= 0.18978 time= 0.02038
Iter: 0008 train_loss= 0.52578 train_f1_mic= 0.42705 train_f1_mac= 0.17268 val_loss= 0.53852 val_f1_mic= 0.45217 val_f1_mac= 0.18978 time= 0.02029
Iter: 0013 train_loss= 0.51474 train_f1_mic= 0.46299 train_f1_mac= 0.20790 val_loss= 0.53852 val_f1_mic= 0.45217 val_f1_mac= 0.18978 time= 0.02011
Iter: 0018 train_loss= 0.51989 train_f1_mic= 0.43865 train_f1_mac= 0.17975 val_loss= 0.53852 val_f1_mic= 0.45217 val_f1_mac= 0.18978 time= 0.01990
Epoch: 0010
Iter: 0004 train_loss= 0.52039 train_f1_mic= 0.44346 train_f1_mac= 0.18361 val_loss= 0.51252 val_f1_mic= 0.46437 val_f1_mac= 0.20258 time= 0.01981
Iter: 0009 train_loss= 0.51502 train_f1_mic= 0.46873 train_f1_mac= 0.21034 val_loss= 0.51252 val_f1_mic= 0.46437 val_f1_mac= 0.20258 time= 0.01969
Iter: 0014 train_loss= 0.50008 train_f1_mic= 0.48317 train_f1_mac= 0.23670 val_loss= 0.51252 val_f1_mic= 0.46437 val_f1_mac= 0.20258 time= 0.01954
Optimization Finished!
Full validation stats: loss= 0.53586 f1_micro= 0.45754 f1_macro= 0.21969 time= 0.09276
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4760145216678817
Rewards :  -0.029398577743979915 Accuracy :  0.45249565947269776
Total reward :  1.3238083685228381
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'linear', 2, 'linear']
Training RNN (Reward ip) :  [-0.02939858]
Trial 277: Controller loss : 10958.687500
2018-08-31 00:55:37.055156: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:55:37.055663: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:55:37.056127: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:55:37.056853: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [0, 'linear', 3, 'linear']
2018-08-31 00:55:37.057491: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69206 train_f1_mic= 0.38027 train_f1_mac= 0.31569 val_loss= 0.67297 val_f1_mic= 0.42053 val_f1_mac= 0.18687 time= 0.75292
Iter: 0005 train_loss= 0.60027 train_f1_mic= 0.38240 train_f1_mac= 0.09563 val_loss= 0.67297 val_f1_mic= 0.42053 val_f1_mac= 0.18687 time= 0.13862
Iter: 0010 train_loss= 0.55335 train_f1_mic= 0.39227 train_f1_mac= 0.09726 val_loss= 0.67297 val_f1_mic= 0.42053 val_f1_mac= 0.18687 time= 0.08213
Iter: 0015 train_loss= 0.55172 train_f1_mic= 0.37951 train_f1_mac= 0.09925 val_loss= 0.67297 val_f1_mic= 0.42053 val_f1_mac= 0.18687 time= 0.06120
Epoch: 0002
Iter: 0001 train_loss= 0.54005 train_f1_mic= 0.38447 train_f1_mac= 0.10540 val_loss= 0.54212 val_f1_mic= 0.37664 val_f1_mac= 0.10093 time= 0.05171
Iter: 0006 train_loss= 0.54892 train_f1_mic= 0.39576 train_f1_mac= 0.11397 val_loss= 0.54212 val_f1_mic= 0.37664 val_f1_mac= 0.10093 time= 0.04522
Iter: 0011 train_loss= 0.54803 train_f1_mic= 0.40944 train_f1_mac= 0.14131 val_loss= 0.54212 val_f1_mic= 0.37664 val_f1_mac= 0.10093 time= 0.04018
Iter: 0016 train_loss= 0.52620 train_f1_mic= 0.39754 train_f1_mac= 0.12116 val_loss= 0.54212 val_f1_mic= 0.37664 val_f1_mac= 0.10093 time= 0.03682
Epoch: 0003
Iter: 0002 train_loss= 0.52652 train_f1_mic= 0.38933 train_f1_mac= 0.10335 val_loss= 0.56246 val_f1_mic= 0.38073 val_f1_mac= 0.11381 time= 0.03496
Iter: 0007 train_loss= 0.52051 train_f1_mic= 0.40347 train_f1_mac= 0.11080 val_loss= 0.56246 val_f1_mic= 0.38073 val_f1_mac= 0.11381 time= 0.03287
Iter: 0012 train_loss= 0.53175 train_f1_mic= 0.40263 train_f1_mac= 0.12152 val_loss= 0.56246 val_f1_mic= 0.38073 val_f1_mac= 0.11381 time= 0.03115
Iter: 0017 train_loss= 0.54340 train_f1_mic= 0.39564 train_f1_mac= 0.12177 val_loss= 0.56246 val_f1_mic= 0.38073 val_f1_mac= 0.11381 time= 0.02960
Epoch: 0004
Iter: 0003 train_loss= 0.52793 train_f1_mic= 0.39520 train_f1_mac= 0.11921 val_loss= 0.55639 val_f1_mic= 0.40849 val_f1_mac= 0.13312 time= 0.02899
Iter: 0008 train_loss= 0.53128 train_f1_mic= 0.39690 train_f1_mac= 0.11420 val_loss= 0.55639 val_f1_mic= 0.40849 val_f1_mac= 0.13312 time= 0.02797
Iter: 0013 train_loss= 0.52827 train_f1_mic= 0.39822 train_f1_mac= 0.12203 val_loss= 0.55639 val_f1_mic= 0.40849 val_f1_mac= 0.13312 time= 0.02698
Iter: 0018 train_loss= 0.53521 train_f1_mic= 0.41367 train_f1_mac= 0.12670 val_loss= 0.55639 val_f1_mic= 0.40849 val_f1_mac= 0.13312 time= 0.02622
Epoch: 0005
Iter: 0004 train_loss= 0.53737 train_f1_mic= 0.40121 train_f1_mac= 0.12087 val_loss= 0.54832 val_f1_mic= 0.40526 val_f1_mac= 0.13584 time= 0.02594
Iter: 0009 train_loss= 0.53186 train_f1_mic= 0.41226 train_f1_mac= 0.13012 val_loss= 0.54832 val_f1_mic= 0.40526 val_f1_mac= 0.13584 time= 0.02526
Iter: 0014 train_loss= 0.53650 train_f1_mic= 0.41717 train_f1_mac= 0.13923 val_loss= 0.54832 val_f1_mic= 0.40526 val_f1_mac= 0.13584 time= 0.02472
Epoch: 0006
Iter: 0000 train_loss= 0.51678 train_f1_mic= 0.42854 train_f1_mac= 0.14661 val_loss= 0.55821 val_f1_mic= 0.42063 val_f1_mac= 0.15075 time= 0.02441
Iter: 0005 train_loss= 0.51939 train_f1_mic= 0.42368 train_f1_mac= 0.13619 val_loss= 0.55821 val_f1_mic= 0.42063 val_f1_mac= 0.15075 time= 0.02395
Iter: 0010 train_loss= 0.53537 train_f1_mic= 0.41544 train_f1_mac= 0.14675 val_loss= 0.55821 val_f1_mic= 0.42063 val_f1_mac= 0.15075 time= 0.02347
Iter: 0015 train_loss= 0.53025 train_f1_mic= 0.41664 train_f1_mac= 0.14867 val_loss= 0.55821 val_f1_mic= 0.42063 val_f1_mac= 0.15075 time= 0.02302
Epoch: 0007
Iter: 0001 train_loss= 0.51464 train_f1_mic= 0.43963 train_f1_mac= 0.14936 val_loss= 0.55273 val_f1_mic= 0.43763 val_f1_mac= 0.16611 time= 0.02289
Iter: 0006 train_loss= 0.52898 train_f1_mic= 0.42871 train_f1_mac= 0.15097 val_loss= 0.55273 val_f1_mic= 0.43763 val_f1_mac= 0.16611 time= 0.02262
Iter: 0011 train_loss= 0.51600 train_f1_mic= 0.42467 train_f1_mac= 0.14612 val_loss= 0.55273 val_f1_mic= 0.43763 val_f1_mac= 0.16611 time= 0.02229
Iter: 0016 train_loss= 0.54699 train_f1_mic= 0.41153 train_f1_mac= 0.14049 val_loss= 0.55273 val_f1_mic= 0.43763 val_f1_mac= 0.16611 time= 0.02202
Epoch: 0008
Iter: 0002 train_loss= 0.51872 train_f1_mic= 0.44895 train_f1_mac= 0.17190 val_loss= 0.53831 val_f1_mic= 0.44388 val_f1_mac= 0.16883 time= 0.02188
Iter: 0007 train_loss= 0.52581 train_f1_mic= 0.41949 train_f1_mac= 0.15795 val_loss= 0.53831 val_f1_mic= 0.44388 val_f1_mac= 0.16883 time= 0.02165
Iter: 0012 train_loss= 0.51580 train_f1_mic= 0.44059 train_f1_mac= 0.15192 val_loss= 0.53831 val_f1_mic= 0.44388 val_f1_mac= 0.16883 time= 0.02145
Iter: 0017 train_loss= 0.51323 train_f1_mic= 0.44099 train_f1_mac= 0.17270 val_loss= 0.53831 val_f1_mic= 0.44388 val_f1_mac= 0.16883 time= 0.02122
Epoch: 0009
Iter: 0003 train_loss= 0.51914 train_f1_mic= 0.41267 train_f1_mac= 0.14358 val_loss= 0.53965 val_f1_mic= 0.45859 val_f1_mac= 0.20411 time= 0.02121
Iter: 0008 train_loss= 0.52330 train_f1_mic= 0.46084 train_f1_mac= 0.20898 val_loss= 0.53965 val_f1_mic= 0.45859 val_f1_mac= 0.20411 time= 0.02103
Iter: 0013 train_loss= 0.51743 train_f1_mic= 0.42860 train_f1_mac= 0.15895 val_loss= 0.53965 val_f1_mic= 0.45859 val_f1_mac= 0.20411 time= 0.02084
Iter: 0018 train_loss= 0.52133 train_f1_mic= 0.43484 train_f1_mac= 0.16585 val_loss= 0.53965 val_f1_mic= 0.45859 val_f1_mac= 0.20411 time= 0.02068
Epoch: 0010
Iter: 0004 train_loss= 0.51710 train_f1_mic= 0.47128 train_f1_mac= 0.20909 val_loss= 0.53914 val_f1_mic= 0.44497 val_f1_mac= 0.18686 time= 0.02068
Iter: 0009 train_loss= 0.51436 train_f1_mic= 0.47072 train_f1_mac= 0.20790 val_loss= 0.53914 val_f1_mic= 0.44497 val_f1_mac= 0.18686 time= 0.02050
Iter: 0014 train_loss= 0.51684 train_f1_mic= 0.41299 train_f1_mac= 0.14582 val_loss= 0.53914 val_f1_mic= 0.44497 val_f1_mac= 0.18686 time= 0.02037
Optimization Finished!
Full validation stats: loss= 0.53189 f1_micro= 0.46808 f1_macro= 0.21594 time= 0.10173
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47328747117405146
Rewards :  -0.013635252469151482 Accuracy :  0.46237926919873024
Total reward :  1.3101731160536867
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'linear', 3, 'linear']
Training RNN (Reward ip) :  [-0.01363525]
Trial 278: Controller loss : 9187.831055

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
2018-08-31 00:55:46.491873: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:55:46.492848: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:55:46.493785: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
]      0
2018-08-31 00:55:46.495206: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:55:46.496249: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69386 train_f1_mic= 0.41637 train_f1_mac= 0.33036 val_loss= 0.66396 val_f1_mic= 0.39387 val_f1_mac= 0.11802 time= 0.76096
Iter: 0005 train_loss= 0.59113 train_f1_mic= 0.39483 train_f1_mac= 0.09912 val_loss= 0.66396 val_f1_mic= 0.39387 val_f1_mac= 0.11802 time= 0.13995
Iter: 0010 train_loss= 0.54194 train_f1_mic= 0.37293 train_f1_mac= 0.08655 val_loss= 0.66396 val_f1_mic= 0.39387 val_f1_mac= 0.11802 time= 0.08359
Iter: 0015 train_loss= 0.55392 train_f1_mic= 0.41037 train_f1_mac= 0.11309 val_loss= 0.66396 val_f1_mic= 0.39387 val_f1_mac= 0.11802 time= 0.06239
Epoch: 0002
Iter: 0001 train_loss= 0.54262 train_f1_mic= 0.39525 train_f1_mac= 0.10430 val_loss= 0.55325 val_f1_mic= 0.38131 val_f1_mac= 0.10207 time= 0.05224
Iter: 0006 train_loss= 0.53834 train_f1_mic= 0.37523 train_f1_mac= 0.09233 val_loss= 0.55325 val_f1_mic= 0.38131 val_f1_mac= 0.10207 time= 0.04522
Iter: 0011 train_loss= 0.52673 train_f1_mic= 0.38595 train_f1_mac= 0.09461 val_loss= 0.55325 val_f1_mic= 0.38131 val_f1_mac= 0.10207 time= 0.04060
Iter: 0016 train_loss= 0.53753 train_f1_mic= 0.39641 train_f1_mac= 0.10753 val_loss= 0.55325 val_f1_mic= 0.38131 val_f1_mac= 0.10207 time= 0.03712
Epoch: 0003
Iter: 0002 train_loss= 0.52923 train_f1_mic= 0.39254 train_f1_mac= 0.10852 val_loss= 0.54186 val_f1_mic= 0.38349 val_f1_mac= 0.11045 time= 0.03512
Iter: 0007 train_loss= 0.53342 train_f1_mic= 0.40433 train_f1_mac= 0.11908 val_loss= 0.54186 val_f1_mic= 0.38349 val_f1_mac= 0.11045 time= 0.03282
Iter: 0012 train_loss= 0.53280 train_f1_mic= 0.40550 train_f1_mac= 0.12110 val_loss= 0.54186 val_f1_mic= 0.38349 val_f1_mac= 0.11045 time= 0.03124
Iter: 0017 train_loss= 0.53282 train_f1_mic= 0.41366 train_f1_mac= 0.12874 val_loss= 0.54186 val_f1_mic= 0.38349 val_f1_mac= 0.11045 time= 0.02972
Epoch: 0004
Iter: 0003 train_loss= 0.53411 train_f1_mic= 0.41538 train_f1_mac= 0.13138 val_loss= 0.55047 val_f1_mic= 0.42038 val_f1_mac= 0.13842 time= 0.02898
Iter: 0008 train_loss= 0.52427 train_f1_mic= 0.41324 train_f1_mac= 0.13241 val_loss= 0.55047 val_f1_mic= 0.42038 val_f1_mac= 0.13842 time= 0.02794
Iter: 0013 train_loss= 0.52021 train_f1_mic= 0.42894 train_f1_mac= 0.14662 val_loss= 0.55047 val_f1_mic= 0.42038 val_f1_mac= 0.13842 time= 0.02699
Iter: 0018 train_loss= 0.52258 train_f1_mic= 0.44212 train_f1_mac= 0.15636 val_loss= 0.55047 val_f1_mic= 0.42038 val_f1_mac= 0.13842 time= 0.02627
Epoch: 0005
Iter: 0004 train_loss= 0.53164 train_f1_mic= 0.43146 train_f1_mac= 0.15771 val_loss= 0.55419 val_f1_mic= 0.42618 val_f1_mac= 0.15308 time= 0.02580
Iter: 0009 train_loss= 0.53339 train_f1_mic= 0.40309 train_f1_mac= 0.13774 val_loss= 0.55419 val_f1_mic= 0.42618 val_f1_mac= 0.15308 time= 0.02521
Iter: 0014 train_loss= 0.51411 train_f1_mic= 0.44814 train_f1_mac= 0.16492 val_loss= 0.55419 val_f1_mic= 0.42618 val_f1_mac= 0.15308 time= 0.02469
Epoch: 0006
Iter: 0000 train_loss= 0.51404 train_f1_mic= 0.45110 train_f1_mac= 0.16374 val_loss= 0.52963 val_f1_mic= 0.47360 val_f1_mac= 0.19832 time= 0.02444
Iter: 0005 train_loss= 0.50807 train_f1_mic= 0.43370 train_f1_mac= 0.16763 val_loss= 0.52963 val_f1_mic= 0.47360 val_f1_mac= 0.19832 time= 0.02399
Iter: 0010 train_loss= 0.51578 train_f1_mic= 0.42415 train_f1_mac= 0.16410 val_loss= 0.52963 val_f1_mic= 0.47360 val_f1_mac= 0.19832 time= 0.02352
Iter: 0015 train_loss= 0.51470 train_f1_mic= 0.47992 train_f1_mac= 0.21216 val_loss= 0.52963 val_f1_mic= 0.47360 val_f1_mac= 0.19832 time= 0.02310
Epoch: 0007
Iter: 0001 train_loss= 0.50527 train_f1_mic= 0.44801 train_f1_mac= 0.18217 val_loss= 0.51683 val_f1_mic= 0.45485 val_f1_mac= 0.18723 time= 0.02285
Iter: 0006 train_loss= 0.51744 train_f1_mic= 0.43904 train_f1_mac= 0.17916 val_loss= 0.51683 val_f1_mic= 0.45485 val_f1_mac= 0.18723 time= 0.02251
Iter: 0011 train_loss= 0.49908 train_f1_mic= 0.47997 train_f1_mac= 0.22043 val_loss= 0.51683 val_f1_mic= 0.45485 val_f1_mac= 0.18723 time= 0.02223
Iter: 0016 train_loss= 0.50849 train_f1_mic= 0.48737 train_f1_mac= 0.22642 val_loss= 0.51683 val_f1_mic= 0.45485 val_f1_mac= 0.18723 time= 0.02202
Epoch: 0008
Iter: 0002 train_loss= 0.48537 train_f1_mic= 0.47705 train_f1_mac= 0.22336 val_loss= 0.52891 val_f1_mic= 0.46594 val_f1_mac= 0.20987 time= 0.02191
Iter: 0007 train_loss= 0.49634 train_f1_mic= 0.46078 train_f1_mac= 0.21401 val_loss= 0.52891 val_f1_mic= 0.46594 val_f1_mac= 0.20987 time= 0.02172
Iter: 0012 train_loss= 0.50808 train_f1_mic= 0.48645 train_f1_mac= 0.24326 val_loss= 0.52891 val_f1_mic= 0.46594 val_f1_mac= 0.20987 time= 0.02151
Iter: 0017 train_loss= 0.50281 train_f1_mic= 0.49024 train_f1_mac= 0.24186 val_loss= 0.52891 val_f1_mic= 0.46594 val_f1_mac= 0.20987 time= 0.02126
Epoch: 0009
Iter: 0003 train_loss= 0.50491 train_f1_mic= 0.48285 train_f1_mac= 0.24190 val_loss= 0.51975 val_f1_mic= 0.48886 val_f1_mac= 0.25291 time= 0.02127
Iter: 0008 train_loss= 0.49758 train_f1_mic= 0.46359 train_f1_mac= 0.21596 val_loss= 0.51975 val_f1_mic= 0.48886 val_f1_mac= 0.25291 time= 0.02107
Iter: 0013 train_loss= 0.50336 train_f1_mic= 0.46634 train_f1_mac= 0.22661 val_loss= 0.51975 val_f1_mic= 0.48886 val_f1_mac= 0.25291 time= 0.02090
Iter: 0018 train_loss= 0.49798 train_f1_mic= 0.49977 train_f1_mac= 0.25774 val_loss= 0.51975 val_f1_mic= 0.48886 val_f1_mac= 0.25291 time= 0.02076
Epoch: 0010
Iter: 0004 train_loss= 0.50518 train_f1_mic= 0.50230 train_f1_mac= 0.26884 val_loss= 0.49885 val_f1_mic= 0.48142 val_f1_mac= 0.24660 time= 0.02068
Iter: 0009 train_loss= 0.49435 train_f1_mic= 0.50502 train_f1_mac= 0.27134 val_loss= 0.49885 val_f1_mic= 0.48142 val_f1_mac= 0.24660 time= 0.02055
Iter: 0014 train_loss= 0.49022 train_f1_mic= 0.50480 train_f1_mac= 0.26136 val_loss= 0.49885 val_f1_mic= 0.48142 val_f1_mac= 0.24660 time= 0.02044
Optimization Finished!
Full validation stats: loss= 0.50924 f1_micro= 0.50359 f1_macro= 0.28297 time= 0.11372
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.478108133425606
Rewards :  0.024103311257772708 Accuracy :  0.49739078243182416
Total reward :  1.3342764273114593
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02410331]
Trial 279: Controller loss : 118.577072
2018-08-31 00:55:56.190001: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:55:56.190581: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:55:56.191135: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:55:56.191383: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:55:56.191694: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'tanh', 1, 'tanh']
Epoch: 0001
Iter: 0000 train_loss= 0.69339 train_f1_mic= 0.37848 train_f1_mac= 0.35221 val_loss= 0.67894 val_f1_mic= 0.40992 val_f1_mac= 0.33413 time= 1.53290
Iter: 0005 train_loss= 0.58674 train_f1_mic= 0.40167 train_f1_mac= 0.10569 val_loss= 0.67894 val_f1_mic= 0.40992 val_f1_mac= 0.33413 time= 0.36635
Iter: 0010 train_loss= 0.53712 train_f1_mic= 0.37413 train_f1_mac= 0.08815 val_loss= 0.67894 val_f1_mic= 0.40992 val_f1_mac= 0.33413 time= 0.26116
Iter: 0015 train_loss= 0.55324 train_f1_mic= 0.38014 train_f1_mac= 0.09470 val_loss= 0.67894 val_f1_mic= 0.40992 val_f1_mac= 0.33413 time= 0.22056
Epoch: 0002
Iter: 0001 train_loss= 0.54183 train_f1_mic= 0.38971 train_f1_mac= 0.09770 val_loss= 0.55869 val_f1_mic= 0.39126 val_f1_mac= 0.10161 time= 0.20195
Iter: 0006 train_loss= 0.54273 train_f1_mic= 0.36818 train_f1_mac= 0.08894 val_loss= 0.55869 val_f1_mic= 0.39126 val_f1_mac= 0.10161 time= 0.18885
Iter: 0011 train_loss= 0.53388 train_f1_mic= 0.39403 train_f1_mac= 0.09792 val_loss= 0.55869 val_f1_mic= 0.39126 val_f1_mac= 0.10161 time= 0.17979
Iter: 0016 train_loss= 0.55323 train_f1_mic= 0.39035 train_f1_mac= 0.10656 val_loss= 0.55869 val_f1_mic= 0.39126 val_f1_mac= 0.10161 time= 0.17319
Epoch: 0003
Iter: 0002 train_loss= 0.54155 train_f1_mic= 0.38935 train_f1_mac= 0.10131 val_loss= 0.56176 val_f1_mic= 0.37827 val_f1_mac= 0.10262 time= 0.16943
Iter: 0007 train_loss= 0.53621 train_f1_mic= 0.38315 train_f1_mac= 0.10254 val_loss= 0.56176 val_f1_mic= 0.37827 val_f1_mac= 0.10262 time= 0.16537
Iter: 0012 train_loss= 0.53868 train_f1_mic= 0.39486 train_f1_mac= 0.11030 val_loss= 0.56176 val_f1_mic= 0.37827 val_f1_mac= 0.10262 time= 0.16236
Iter: 0017 train_loss= 0.54511 train_f1_mic= 0.40249 train_f1_mac= 0.11889 val_loss= 0.56176 val_f1_mic= 0.37827 val_f1_mac= 0.10262 time= 0.15974
Epoch: 0004
Iter: 0003 train_loss= 0.53462 train_f1_mic= 0.40659 train_f1_mac= 0.12014 val_loss= 0.56026 val_f1_mic= 0.40529 val_f1_mac= 0.12606 time= 0.15847
Iter: 0008 train_loss= 0.54383 train_f1_mic= 0.39810 train_f1_mac= 0.11440 val_loss= 0.56026 val_f1_mic= 0.40529 val_f1_mac= 0.12606 time= 0.15666
Iter: 0013 train_loss= 0.54179 train_f1_mic= 0.40094 train_f1_mac= 0.11834 val_loss= 0.56026 val_f1_mic= 0.40529 val_f1_mac= 0.12606 time= 0.15507
Iter: 0018 train_loss= 0.53201 train_f1_mic= 0.40954 train_f1_mac= 0.11988 val_loss= 0.56026 val_f1_mic= 0.40529 val_f1_mac= 0.12606 time= 0.15388
Epoch: 0005
Iter: 0004 train_loss= 0.55012 train_f1_mic= 0.40190 train_f1_mac= 0.12124 val_loss= 0.55945 val_f1_mic= 0.40577 val_f1_mac= 0.12506 time= 0.15336
Iter: 0009 train_loss= 0.52009 train_f1_mic= 0.41526 train_f1_mac= 0.12195 val_loss= 0.55945 val_f1_mic= 0.40577 val_f1_mac= 0.12506 time= 0.15210
Iter: 0014 train_loss= 0.53365 train_f1_mic= 0.40493 train_f1_mac= 0.11853 val_loss= 0.55945 val_f1_mic= 0.40577 val_f1_mac= 0.12506 time= 0.15120
Epoch: 0006
Iter: 0000 train_loss= 0.52867 train_f1_mic= 0.40555 train_f1_mac= 0.11784 val_loss= 0.55154 val_f1_mic= 0.40477 val_f1_mac= 0.12538 time= 0.15087
Iter: 0005 train_loss= 0.54266 train_f1_mic= 0.40392 train_f1_mac= 0.12239 val_loss= 0.55154 val_f1_mic= 0.40477 val_f1_mac= 0.12538 time= 0.15026
Iter: 0010 train_loss= 0.53850 train_f1_mic= 0.41285 train_f1_mac= 0.12399 val_loss= 0.55154 val_f1_mic= 0.40477 val_f1_mac= 0.12538 time= 0.14948
Iter: 0015 train_loss= 0.54579 train_f1_mic= 0.40990 train_f1_mac= 0.12771 val_loss= 0.55154 val_f1_mic= 0.40477 val_f1_mac= 0.12538 time= 0.14876
Epoch: 0007
Iter: 0001 train_loss= 0.52381 train_f1_mic= 0.42453 train_f1_mac= 0.13276 val_loss= 0.55934 val_f1_mic= 0.41726 val_f1_mac= 0.13581 time= 0.14843
Iter: 0006 train_loss= 0.53815 train_f1_mic= 0.41788 train_f1_mac= 0.13585 val_loss= 0.55934 val_f1_mic= 0.41726 val_f1_mac= 0.13581 time= 0.14788
Iter: 0011 train_loss= 0.53169 train_f1_mic= 0.40138 train_f1_mac= 0.12575 val_loss= 0.55934 val_f1_mic= 0.41726 val_f1_mac= 0.13581 time= 0.14725
Iter: 0016 train_loss= 0.54313 train_f1_mic= 0.40156 train_f1_mac= 0.12399 val_loss= 0.55934 val_f1_mic= 0.41726 val_f1_mac= 0.13581 time= 0.14681
Epoch: 0008
Iter: 0002 train_loss= 0.53852 train_f1_mic= 0.41365 train_f1_mac= 0.13669 val_loss= 0.55840 val_f1_mic= 0.42630 val_f1_mac= 0.15289 time= 0.14678
Iter: 0007 train_loss= 0.53440 train_f1_mic= 0.42257 train_f1_mac= 0.14475 val_loss= 0.55840 val_f1_mic= 0.42630 val_f1_mac= 0.15289 time= 0.14630
Iter: 0012 train_loss= 0.52934 train_f1_mic= 0.42546 train_f1_mac= 0.15356 val_loss= 0.55840 val_f1_mic= 0.42630 val_f1_mac= 0.15289 time= 0.14601
Iter: 0017 train_loss= 0.53547 train_f1_mic= 0.42893 train_f1_mac= 0.14661 val_loss= 0.55840 val_f1_mic= 0.42630 val_f1_mac= 0.15289 time= 0.14556
Epoch: 0009
Iter: 0003 train_loss= 0.52610 train_f1_mic= 0.42392 train_f1_mac= 0.14408 val_loss= 0.54500 val_f1_mic= 0.42319 val_f1_mac= 0.15010 time= 0.14554
Iter: 0008 train_loss= 0.53363 train_f1_mic= 0.43203 train_f1_mac= 0.15808 val_loss= 0.54500 val_f1_mic= 0.42319 val_f1_mac= 0.15010 time= 0.14522
Iter: 0013 train_loss= 0.52390 train_f1_mic= 0.42022 train_f1_mac= 0.14827 val_loss= 0.54500 val_f1_mic= 0.42319 val_f1_mac= 0.15010 time= 0.14496
Iter: 0018 train_loss= 0.51751 train_f1_mic= 0.44801 train_f1_mac= 0.16810 val_loss= 0.54500 val_f1_mic= 0.42319 val_f1_mac= 0.15010 time= 0.14464
Epoch: 0010
Iter: 0004 train_loss= 0.52687 train_f1_mic= 0.42973 train_f1_mac= 0.15718 val_loss= 0.54608 val_f1_mic= 0.43764 val_f1_mac= 0.17135 time= 0.14460
Iter: 0009 train_loss= 0.52681 train_f1_mic= 0.43074 train_f1_mac= 0.16081 val_loss= 0.54608 val_f1_mic= 0.43764 val_f1_mac= 0.17135 time= 0.14435
Iter: 0014 train_loss= 0.52297 train_f1_mic= 0.46267 train_f1_mac= 0.19371 val_loss= 0.54608 val_f1_mic= 0.43764 val_f1_mac= 0.17135 time= 0.14415
Optimization Finished!
Full validation stats: loss= 0.54482 f1_micro= 0.43911 f1_macro= 0.17808 time= 0.26630
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4700875026067005
Rewards :  -0.040103154094527416 Accuracy :  0.43800497933107857
Total reward :  1.294173273216932
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'tanh', 1, 'tanh']
Training RNN (Reward ip) :  [-0.04010315]
Trial 280: Controller loss : 7484.285645

Prediction action from Controller
State input to Controller for Action :  [0. 2. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:56:31.435857: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:56:31.436387: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:56:31.436899: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:56:31.437284: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:56:31.438065: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69533 train_f1_mic= 0.35454 train_f1_mac= 0.29642 val_loss= 0.66640 val_f1_mic= 0.37786 val_f1_mac= 0.10656 time= 0.76447
Iter: 0005 train_loss= 0.59353 train_f1_mic= 0.38946 train_f1_mac= 0.09789 val_loss= 0.66640 val_f1_mic= 0.37786 val_f1_mac= 0.10656 time= 0.13987
Iter: 0010 train_loss= 0.55124 train_f1_mic= 0.38009 train_f1_mac= 0.09549 val_loss= 0.66640 val_f1_mic= 0.37786 val_f1_mac= 0.10656 time= 0.08373
Iter: 0015 train_loss= 0.55577 train_f1_mic= 0.40035 train_f1_mac= 0.10707 val_loss= 0.66640 val_f1_mic= 0.37786 val_f1_mac= 0.10656 time= 0.06249
Epoch: 0002
Iter: 0001 train_loss= 0.55791 train_f1_mic= 0.37963 train_f1_mac= 0.09916 val_loss= 0.56549 val_f1_mic= 0.37222 val_f1_mac= 0.09737 time= 0.05255
Iter: 0006 train_loss= 0.54513 train_f1_mic= 0.39886 train_f1_mac= 0.10276 val_loss= 0.56549 val_f1_mic= 0.37222 val_f1_mac= 0.09737 time= 0.04520
Iter: 0011 train_loss= 0.52945 train_f1_mic= 0.39120 train_f1_mac= 0.09970 val_loss= 0.56549 val_f1_mic= 0.37222 val_f1_mac= 0.09737 time= 0.04049
Iter: 0016 train_loss= 0.53173 train_f1_mic= 0.37653 train_f1_mac= 0.09612 val_loss= 0.56549 val_f1_mic= 0.37222 val_f1_mac= 0.09737 time= 0.03703
Epoch: 0003
Iter: 0002 train_loss= 0.52795 train_f1_mic= 0.38927 train_f1_mac= 0.10261 val_loss= 0.55318 val_f1_mic= 0.38185 val_f1_mac= 0.10719 time= 0.03497
Iter: 0007 train_loss= 0.52245 train_f1_mic= 0.38982 train_f1_mac= 0.10286 val_loss= 0.55318 val_f1_mic= 0.38185 val_f1_mac= 0.10719 time= 0.03279
Iter: 0012 train_loss= 0.53106 train_f1_mic= 0.40622 train_f1_mac= 0.11745 val_loss= 0.55318 val_f1_mic= 0.38185 val_f1_mac= 0.10719 time= 0.03114
Iter: 0017 train_loss= 0.53552 train_f1_mic= 0.41842 train_f1_mac= 0.13076 val_loss= 0.55318 val_f1_mic= 0.38185 val_f1_mac= 0.10719 time= 0.02986
Epoch: 0004
Iter: 0003 train_loss= 0.53038 train_f1_mic= 0.41864 train_f1_mac= 0.13253 val_loss= 0.56098 val_f1_mic= 0.41718 val_f1_mac= 0.14087 time= 0.02945
Iter: 0008 train_loss= 0.52574 train_f1_mic= 0.42601 train_f1_mac= 0.13684 val_loss= 0.56098 val_f1_mic= 0.41718 val_f1_mac= 0.14087 time= 0.02837
Iter: 0013 train_loss= 0.52613 train_f1_mic= 0.40502 train_f1_mac= 0.12625 val_loss= 0.56098 val_f1_mic= 0.41718 val_f1_mac= 0.14087 time= 0.02744
Iter: 0018 train_loss= 0.53133 train_f1_mic= 0.42835 train_f1_mac= 0.14584 val_loss= 0.56098 val_f1_mic= 0.41718 val_f1_mac= 0.14087 time= 0.02668
Epoch: 0005
Iter: 0004 train_loss= 0.53017 train_f1_mic= 0.42746 train_f1_mac= 0.14664 val_loss= 0.54206 val_f1_mic= 0.41437 val_f1_mac= 0.14270 time= 0.02636
Iter: 0009 train_loss= 0.53093 train_f1_mic= 0.42070 train_f1_mac= 0.14552 val_loss= 0.54206 val_f1_mic= 0.41437 val_f1_mac= 0.14270 time= 0.02582
Iter: 0014 train_loss= 0.51698 train_f1_mic= 0.43829 train_f1_mac= 0.15422 val_loss= 0.54206 val_f1_mic= 0.41437 val_f1_mac= 0.14270 time= 0.02519
Epoch: 0006
Iter: 0000 train_loss= 0.51729 train_f1_mic= 0.45567 train_f1_mac= 0.17334 val_loss= 0.53970 val_f1_mic= 0.44812 val_f1_mac= 0.17183 time= 0.02494
Iter: 0005 train_loss= 0.52386 train_f1_mic= 0.44583 train_f1_mac= 0.16722 val_loss= 0.53970 val_f1_mic= 0.44812 val_f1_mac= 0.17183 time= 0.02443
Iter: 0010 train_loss= 0.51601 train_f1_mic= 0.42892 train_f1_mac= 0.15962 val_loss= 0.53970 val_f1_mic= 0.44812 val_f1_mac= 0.17183 time= 0.02397
Iter: 0015 train_loss= 0.52898 train_f1_mic= 0.43069 train_f1_mac= 0.16780 val_loss= 0.53970 val_f1_mic= 0.44812 val_f1_mac= 0.17183 time= 0.02366
Epoch: 0007
Iter: 0001 train_loss= 0.51517 train_f1_mic= 0.43805 train_f1_mac= 0.17035 val_loss= 0.53774 val_f1_mic= 0.44349 val_f1_mac= 0.18904 time= 0.02352
Iter: 0006 train_loss= 0.50802 train_f1_mic= 0.44926 train_f1_mac= 0.18813 val_loss= 0.53774 val_f1_mic= 0.44349 val_f1_mac= 0.18904 time= 0.02319
Iter: 0011 train_loss= 0.50755 train_f1_mic= 0.46304 train_f1_mac= 0.20607 val_loss= 0.53774 val_f1_mic= 0.44349 val_f1_mac= 0.18904 time= 0.02285
Iter: 0016 train_loss= 0.51434 train_f1_mic= 0.46741 train_f1_mac= 0.20681 val_loss= 0.53774 val_f1_mic= 0.44349 val_f1_mac= 0.18904 time= 0.02259
Epoch: 0008
Iter: 0002 train_loss= 0.51508 train_f1_mic= 0.47039 train_f1_mac= 0.21272 val_loss= 0.55188 val_f1_mic= 0.46184 val_f1_mac= 0.21453 time= 0.02247
Iter: 0007 train_loss= 0.50788 train_f1_mic= 0.46837 train_f1_mac= 0.22695 val_loss= 0.55188 val_f1_mic= 0.46184 val_f1_mac= 0.21453 time= 0.02221
Iter: 0012 train_loss= 0.50896 train_f1_mic= 0.48180 train_f1_mac= 0.23577 val_loss= 0.55188 val_f1_mic= 0.46184 val_f1_mac= 0.21453 time= 0.02199
Iter: 0017 train_loss= 0.51003 train_f1_mic= 0.43424 train_f1_mac= 0.18101 val_loss= 0.55188 val_f1_mic= 0.46184 val_f1_mac= 0.21453 time= 0.02179
Epoch: 0009
Iter: 0003 train_loss= 0.50047 train_f1_mic= 0.46468 train_f1_mac= 0.20792 val_loss= 0.51910 val_f1_mic= 0.48747 val_f1_mac= 0.23277 time= 0.02177
Iter: 0008 train_loss= 0.50237 train_f1_mic= 0.49756 train_f1_mac= 0.24711 val_loss= 0.51910 val_f1_mic= 0.48747 val_f1_mac= 0.23277 time= 0.02157
Iter: 0013 train_loss= 0.49919 train_f1_mic= 0.47793 train_f1_mac= 0.22808 val_loss= 0.51910 val_f1_mic= 0.48747 val_f1_mac= 0.23277 time= 0.02138
Iter: 0018 train_loss= 0.50851 train_f1_mic= 0.48666 train_f1_mac= 0.24309 val_loss= 0.51910 val_f1_mic= 0.48747 val_f1_mac= 0.23277 time= 0.02120
Epoch: 0010
Iter: 0004 train_loss= 0.49016 train_f1_mic= 0.49450 train_f1_mac= 0.25171 val_loss= 0.51868 val_f1_mic= 0.48876 val_f1_mac= 0.24816 time= 0.02125
Iter: 0009 train_loss= 0.49177 train_f1_mic= 0.50520 train_f1_mac= 0.25725 val_loss= 0.51868 val_f1_mic= 0.48876 val_f1_mac= 0.24816 time= 0.02106
Iter: 0014 train_loss= 0.50077 train_f1_mic= 0.51385 train_f1_mac= 0.27753 val_loss= 0.51868 val_f1_mic= 0.48876 val_f1_mac= 0.24816 time= 0.02091
Optimization Finished!
Full validation stats: loss= 0.51270 f1_micro= 0.49962 f1_macro= 0.27181 time= 0.12264
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47563533518214035
Rewards :  0.02773916287719913 Accuracy :  0.49782666548389964
Total reward :  1.3219124360941312
Saved buffers to file `buffers.txt` !
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02773916]
Trial 281: Controller loss : 120.219696
2018-08-31 00:56:41.285965: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:56:41.286268: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:56:41.286560: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:56:41.286778: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:56:41.287266: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'tanh', 0, 'relu']
Epoch: 0001
Iter: 0000 train_loss= 0.69382 train_f1_mic= 0.36387 train_f1_mac= 0.32615 val_loss= 0.67052 val_f1_mic= 0.38776 val_f1_mac= 0.17890 time= 0.73700
Iter: 0005 train_loss= 0.59135 train_f1_mic= 0.38030 train_f1_mac= 0.09636 val_loss= 0.67052 val_f1_mic= 0.38776 val_f1_mac= 0.17890 time= 0.13264
Iter: 0010 train_loss= 0.54367 train_f1_mic= 0.37984 train_f1_mac= 0.09474 val_loss= 0.67052 val_f1_mic= 0.38776 val_f1_mac= 0.17890 time= 0.07788
Iter: 0015 train_loss= 0.55261 train_f1_mic= 0.42529 train_f1_mac= 0.13007 val_loss= 0.67052 val_f1_mic= 0.38776 val_f1_mac= 0.17890 time= 0.05759
Epoch: 0002
Iter: 0001 train_loss= 0.54459 train_f1_mic= 0.41737 train_f1_mac= 0.12923 val_loss= 0.56215 val_f1_mic= 0.43766 val_f1_mac= 0.13984 time= 0.04824
Iter: 0006 train_loss= 0.53680 train_f1_mic= 0.38864 train_f1_mac= 0.11175 val_loss= 0.56215 val_f1_mic= 0.43766 val_f1_mac= 0.13984 time= 0.04115
Iter: 0011 train_loss= 0.52831 train_f1_mic= 0.40671 train_f1_mac= 0.12344 val_loss= 0.56215 val_f1_mic= 0.43766 val_f1_mac= 0.13984 time= 0.03638
Iter: 0016 train_loss= 0.54105 train_f1_mic= 0.42063 train_f1_mac= 0.14189 val_loss= 0.56215 val_f1_mic= 0.43766 val_f1_mac= 0.13984 time= 0.03296
Epoch: 0003
Iter: 0002 train_loss= 0.52819 train_f1_mic= 0.43519 train_f1_mac= 0.15013 val_loss= 0.55185 val_f1_mic= 0.42905 val_f1_mac= 0.15066 time= 0.03104
Iter: 0007 train_loss= 0.51304 train_f1_mic= 0.44162 train_f1_mac= 0.15413 val_loss= 0.55185 val_f1_mic= 0.42905 val_f1_mac= 0.15066 time= 0.02905
Iter: 0012 train_loss= 0.52486 train_f1_mic= 0.43151 train_f1_mac= 0.15612 val_loss= 0.55185 val_f1_mic= 0.42905 val_f1_mac= 0.15066 time= 0.02745
Iter: 0017 train_loss= 0.52103 train_f1_mic= 0.44305 train_f1_mac= 0.16758 val_loss= 0.55185 val_f1_mic= 0.42905 val_f1_mac= 0.15066 time= 0.02621
Epoch: 0004
Iter: 0003 train_loss= 0.51691 train_f1_mic= 0.43093 train_f1_mac= 0.15918 val_loss= 0.54498 val_f1_mic= 0.43615 val_f1_mac= 0.17310 time= 0.02553
Iter: 0008 train_loss= 0.52186 train_f1_mic= 0.43766 train_f1_mac= 0.15895 val_loss= 0.54498 val_f1_mic= 0.43615 val_f1_mac= 0.17310 time= 0.02470
Iter: 0013 train_loss= 0.51511 train_f1_mic= 0.43385 train_f1_mac= 0.16022 val_loss= 0.54498 val_f1_mic= 0.43615 val_f1_mac= 0.17310 time= 0.02381
Iter: 0018 train_loss= 0.52608 train_f1_mic= 0.43869 train_f1_mac= 0.16850 val_loss= 0.54498 val_f1_mic= 0.43615 val_f1_mac= 0.17310 time= 0.02309
Epoch: 0005
Iter: 0004 train_loss= 0.52086 train_f1_mic= 0.44385 train_f1_mac= 0.18135 val_loss= 0.53407 val_f1_mic= 0.44687 val_f1_mac= 0.17090 time= 0.02264
Iter: 0009 train_loss= 0.51239 train_f1_mic= 0.45714 train_f1_mac= 0.18675 val_loss= 0.53407 val_f1_mic= 0.44687 val_f1_mac= 0.17090 time= 0.02199
Iter: 0014 train_loss= 0.51844 train_f1_mic= 0.44623 train_f1_mac= 0.18052 val_loss= 0.53407 val_f1_mic= 0.44687 val_f1_mac= 0.17090 time= 0.02151
Epoch: 0006
Iter: 0000 train_loss= 0.50425 train_f1_mic= 0.44187 train_f1_mac= 0.16986 val_loss= 0.53084 val_f1_mic= 0.44920 val_f1_mac= 0.18894 time= 0.02147
Iter: 0005 train_loss= 0.51951 train_f1_mic= 0.44736 train_f1_mac= 0.18348 val_loss= 0.53084 val_f1_mic= 0.44920 val_f1_mac= 0.18894 time= 0.02104
Iter: 0010 train_loss= 0.50847 train_f1_mic= 0.44873 train_f1_mac= 0.19066 val_loss= 0.53084 val_f1_mic= 0.44920 val_f1_mac= 0.18894 time= 0.02066
Iter: 0015 train_loss= 0.52639 train_f1_mic= 0.44249 train_f1_mac= 0.18471 val_loss= 0.53084 val_f1_mic= 0.44920 val_f1_mac= 0.18894 time= 0.02024
Epoch: 0007
Iter: 0001 train_loss= 0.52175 train_f1_mic= 0.46020 train_f1_mac= 0.20294 val_loss= 0.55209 val_f1_mic= 0.47577 val_f1_mac= 0.22440 time= 0.02010
Iter: 0006 train_loss= 0.52471 train_f1_mic= 0.45720 train_f1_mac= 0.19559 val_loss= 0.55209 val_f1_mic= 0.47577 val_f1_mac= 0.22440 time= 0.01980
Iter: 0011 train_loss= 0.50075 train_f1_mic= 0.46278 train_f1_mac= 0.18582 val_loss= 0.55209 val_f1_mic= 0.47577 val_f1_mac= 0.22440 time= 0.01949
Iter: 0016 train_loss= 0.51293 train_f1_mic= 0.43788 train_f1_mac= 0.18478 val_loss= 0.55209 val_f1_mic= 0.47577 val_f1_mac= 0.22440 time= 0.01924
Epoch: 0008
Iter: 0002 train_loss= 0.50152 train_f1_mic= 0.45418 train_f1_mac= 0.19476 val_loss= 0.54727 val_f1_mic= 0.47634 val_f1_mac= 0.22739 time= 0.01925
Iter: 0007 train_loss= 0.52961 train_f1_mic= 0.45414 train_f1_mac= 0.19739 val_loss= 0.54727 val_f1_mic= 0.47634 val_f1_mac= 0.22739 time= 0.01903
Iter: 0012 train_loss= 0.51386 train_f1_mic= 0.45352 train_f1_mac= 0.18968 val_loss= 0.54727 val_f1_mic= 0.47634 val_f1_mac= 0.22739 time= 0.01881
Iter: 0017 train_loss= 0.50744 train_f1_mic= 0.46457 train_f1_mac= 0.20456 val_loss= 0.54727 val_f1_mic= 0.47634 val_f1_mac= 0.22739 time= 0.01855
Epoch: 0009
Iter: 0003 train_loss= 0.51002 train_f1_mic= 0.46352 train_f1_mac= 0.20648 val_loss= 0.53618 val_f1_mic= 0.45842 val_f1_mac= 0.20459 time= 0.01843
Iter: 0008 train_loss= 0.51232 train_f1_mic= 0.44393 train_f1_mac= 0.18717 val_loss= 0.53618 val_f1_mic= 0.45842 val_f1_mac= 0.20459 time= 0.01823
Iter: 0013 train_loss= 0.50428 train_f1_mic= 0.46858 train_f1_mac= 0.21068 val_loss= 0.53618 val_f1_mic= 0.45842 val_f1_mac= 0.20459 time= 0.01803
Iter: 0018 train_loss= 0.51051 train_f1_mic= 0.47057 train_f1_mac= 0.21588 val_loss= 0.53618 val_f1_mic= 0.45842 val_f1_mac= 0.20459 time= 0.01789
Epoch: 0010
Iter: 0004 train_loss= 0.51317 train_f1_mic= 0.46601 train_f1_mac= 0.21715 val_loss= 0.53240 val_f1_mic= 0.48546 val_f1_mac= 0.23123 time= 0.01781
Iter: 0009 train_loss= 0.51019 train_f1_mic= 0.44588 train_f1_mac= 0.19011 val_loss= 0.53240 val_f1_mic= 0.48546 val_f1_mac= 0.23123 time= 0.01770
Iter: 0014 train_loss= 0.50649 train_f1_mic= 0.45747 train_f1_mac= 0.20482 val_loss= 0.53240 val_f1_mic= 0.48546 val_f1_mac= 0.23123 time= 0.01754
Optimization Finished!
Full validation stats: loss= 0.53182 f1_micro= 0.47623 f1_macro= 0.23197 time= 0.08680
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4743927022660134
Rewards :  -0.006213164580634922 Accuracy :  0.46942217060150543
Total reward :  1.3156992715134963
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'tanh', 0, 'relu']
Training RNN (Reward ip) :  [-0.00621316]
Trial 282: Controller loss : 5897.426758

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 0. 5.]
2018-08-31 00:56:49.906396: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:56:49.906931: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:56:49.907549: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:56:49.907972: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:56:49.908319: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:0Actions :
******************** Layer 1 ********************
0.0, compute capability: 6.1)
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
Epoch: 0001
Iter: 0000 train_loss= 0.69173 train_f1_mic= 0.39585 train_f1_mac= 0.31189 val_loss= 0.66160 val_f1_mic= 0.37024 val_f1_mac= 0.10982 time= 0.80983
Iter: 0005 train_loss= 0.58803 train_f1_mic= 0.39177 train_f1_mac= 0.09955 val_loss= 0.66160 val_f1_mic= 0.37024 val_f1_mac= 0.10982 time= 0.14776
Iter: 0010 train_loss= 0.54272 train_f1_mic= 0.36618 train_f1_mac= 0.08519 val_loss= 0.66160 val_f1_mic= 0.37024 val_f1_mac= 0.10982 time= 0.08794
Iter: 0015 train_loss= 0.54202 train_f1_mic= 0.40063 train_f1_mac= 0.10245 val_loss= 0.66160 val_f1_mic= 0.37024 val_f1_mac= 0.10982 time= 0.06588
Epoch: 0002
Iter: 0001 train_loss= 0.55579 train_f1_mic= 0.38325 train_f1_mac= 0.09956 val_loss= 0.56051 val_f1_mic= 0.38639 val_f1_mac= 0.10197 time= 0.05574
Iter: 0006 train_loss= 0.53975 train_f1_mic= 0.38710 train_f1_mac= 0.09809 val_loss= 0.56051 val_f1_mic= 0.38639 val_f1_mac= 0.10197 time= 0.04790
Iter: 0011 train_loss= 0.54245 train_f1_mic= 0.37600 train_f1_mac= 0.09249 val_loss= 0.56051 val_f1_mic= 0.38639 val_f1_mac= 0.10197 time= 0.04252
Iter: 0016 train_loss= 0.53895 train_f1_mic= 0.37503 train_f1_mac= 0.09341 val_loss= 0.56051 val_f1_mic= 0.38639 val_f1_mac= 0.10197 time= 0.03883
Epoch: 0003
Iter: 0002 train_loss= 0.53014 train_f1_mic= 0.39747 train_f1_mac= 0.10591 val_loss= 0.55584 val_f1_mic= 0.37532 val_f1_mac= 0.10418 time= 0.03643
Iter: 0007 train_loss= 0.53500 train_f1_mic= 0.39062 train_f1_mac= 0.10706 val_loss= 0.55584 val_f1_mic= 0.37532 val_f1_mac= 0.10418 time= 0.03425
Iter: 0012 train_loss= 0.52714 train_f1_mic= 0.41202 train_f1_mac= 0.12325 val_loss= 0.55584 val_f1_mic= 0.37532 val_f1_mac= 0.10418 time= 0.03236
Iter: 0017 train_loss= 0.53690 train_f1_mic= 0.40862 train_f1_mac= 0.12343 val_loss= 0.55584 val_f1_mic= 0.37532 val_f1_mac= 0.10418 time= 0.03077
Epoch: 0004
Iter: 0003 train_loss= 0.52446 train_f1_mic= 0.41507 train_f1_mac= 0.12853 val_loss= 0.54053 val_f1_mic= 0.40182 val_f1_mac= 0.12880 time= 0.02973
Iter: 0008 train_loss= 0.53323 train_f1_mic= 0.40693 train_f1_mac= 0.12884 val_loss= 0.54053 val_f1_mic= 0.40182 val_f1_mac= 0.12880 time= 0.02860
Iter: 0013 train_loss= 0.53387 train_f1_mic= 0.41612 train_f1_mac= 0.13490 val_loss= 0.54053 val_f1_mic= 0.40182 val_f1_mac= 0.12880 time= 0.02776
Iter: 0018 train_loss= 0.52526 train_f1_mic= 0.42874 train_f1_mac= 0.14776 val_loss= 0.54053 val_f1_mic= 0.40182 val_f1_mac= 0.12880 time= 0.02696
Epoch: 0005
Iter: 0004 train_loss= 0.51920 train_f1_mic= 0.43186 train_f1_mac= 0.14532 val_loss= 0.52752 val_f1_mic= 0.43894 val_f1_mac= 0.15654 time= 0.02647
Iter: 0009 train_loss= 0.52150 train_f1_mic= 0.44998 train_f1_mac= 0.17047 val_loss= 0.52752 val_f1_mic= 0.43894 val_f1_mac= 0.15654 time= 0.02589
Iter: 0014 train_loss= 0.51827 train_f1_mic= 0.42071 train_f1_mac= 0.14107 val_loss= 0.52752 val_f1_mic= 0.43894 val_f1_mac= 0.15654 time= 0.02529
Epoch: 0006
Iter: 0000 train_loss= 0.51427 train_f1_mic= 0.44332 train_f1_mac= 0.16800 val_loss= 0.53344 val_f1_mic= 0.44696 val_f1_mac= 0.17917 time= 0.02514
Iter: 0005 train_loss= 0.50626 train_f1_mic= 0.45309 train_f1_mac= 0.16565 val_loss= 0.53344 val_f1_mic= 0.44696 val_f1_mac= 0.17917 time= 0.02466
Iter: 0010 train_loss= 0.51406 train_f1_mic= 0.43114 train_f1_mac= 0.16203 val_loss= 0.53344 val_f1_mic= 0.44696 val_f1_mac= 0.17917 time= 0.02420
Iter: 0015 train_loss= 0.51611 train_f1_mic= 0.45323 train_f1_mac= 0.18221 val_loss= 0.53344 val_f1_mic= 0.44696 val_f1_mac= 0.17917 time= 0.02380
Epoch: 0007
Iter: 0001 train_loss= 0.51736 train_f1_mic= 0.44710 train_f1_mac= 0.18044 val_loss= 0.52911 val_f1_mic= 0.45197 val_f1_mac= 0.19520 time= 0.02365
Iter: 0006 train_loss= 0.52215 train_f1_mic= 0.45391 train_f1_mac= 0.19346 val_loss= 0.52911 val_f1_mic= 0.45197 val_f1_mac= 0.19520 time= 0.02336
Iter: 0011 train_loss= 0.51689 train_f1_mic= 0.46267 train_f1_mac= 0.20445 val_loss= 0.52911 val_f1_mic= 0.45197 val_f1_mac= 0.19520 time= 0.02300
Iter: 0016 train_loss= 0.49734 train_f1_mic= 0.44055 train_f1_mac= 0.18227 val_loss= 0.52911 val_f1_mic= 0.45197 val_f1_mac= 0.19520 time= 0.02266
Epoch: 0008
Iter: 0002 train_loss= 0.50886 train_f1_mic= 0.44851 train_f1_mac= 0.19191 val_loss= 0.50101 val_f1_mic= 0.49478 val_f1_mac= 0.23792 time= 0.02256
Iter: 0007 train_loss= 0.50611 train_f1_mic= 0.48307 train_f1_mac= 0.23113 val_loss= 0.50101 val_f1_mic= 0.49478 val_f1_mac= 0.23792 time= 0.02230
Iter: 0012 train_loss= 0.50896 train_f1_mic= 0.48928 train_f1_mac= 0.24294 val_loss= 0.50101 val_f1_mic= 0.49478 val_f1_mac= 0.23792 time= 0.02209
Iter: 0017 train_loss= 0.51373 train_f1_mic= 0.44823 train_f1_mac= 0.20487 val_loss= 0.50101 val_f1_mic= 0.49478 val_f1_mac= 0.23792 time= 0.02196
Epoch: 0009
Iter: 0003 train_loss= 0.50257 train_f1_mic= 0.46570 train_f1_mac= 0.22536 val_loss= 0.51509 val_f1_mic= 0.51522 val_f1_mac= 0.27434 time= 0.02192
Iter: 0008 train_loss= 0.51003 train_f1_mic= 0.51508 train_f1_mac= 0.27388 val_loss= 0.51509 val_f1_mic= 0.51522 val_f1_mac= 0.27434 time= 0.02177
Iter: 0013 train_loss= 0.50094 train_f1_mic= 0.48509 train_f1_mac= 0.24458 val_loss= 0.51509 val_f1_mic= 0.51522 val_f1_mac= 0.27434 time= 0.02158
Iter: 0018 train_loss= 0.51234 train_f1_mic= 0.46713 train_f1_mac= 0.23498 val_loss= 0.51509 val_f1_mic= 0.51522 val_f1_mac= 0.27434 time= 0.02138
Epoch: 0010
Iter: 0004 train_loss= 0.50093 train_f1_mic= 0.49422 train_f1_mac= 0.25108 val_loss= 0.51081 val_f1_mic= 0.51691 val_f1_mac= 0.28406 time= 0.02127
Iter: 0009 train_loss= 0.50118 train_f1_mic= 0.49204 train_f1_mac= 0.23820 val_loss= 0.51081 val_f1_mic= 0.51691 val_f1_mac= 0.28406 time= 0.02109
Iter: 0014 train_loss= 0.51047 train_f1_mic= 0.47253 train_f1_mac= 0.24929 val_loss= 0.51081 val_f1_mic= 0.51691 val_f1_mac= 0.28406 time= 0.02093
Optimization Finished!
Full validation stats: loss= 0.51760 f1_micro= 0.48979 f1_macro= 0.26593 time= 0.12763
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47642236297356966
Rewards :  0.010148303537781234 Accuracy :  0.4845410058037946
Total reward :  1.3258475750512775
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.0101483]
Trial 283: Controller loss : 120.602646

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:56:59.646802: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:56:59.647247: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:56:59.647685: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:56:59.648006: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:56:59.648424: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69354 train_f1_mic= 0.36039 train_f1_mac= 0.29464 val_loss= 0.66425 val_f1_mic= 0.39818 val_f1_mac= 0.11848 time= 0.77103
Iter: 0005 train_loss= 0.59007 train_f1_mic= 0.38987 train_f1_mac= 0.10064 val_loss= 0.66425 val_f1_mic= 0.39818 val_f1_mac= 0.11848 time= 0.14015
Iter: 0010 train_loss= 0.55065 train_f1_mic= 0.36897 train_f1_mac= 0.08747 val_loss= 0.66425 val_f1_mic= 0.39818 val_f1_mac= 0.11848 time= 0.08378
Iter: 0015 train_loss= 0.55095 train_f1_mic= 0.40908 train_f1_mac= 0.11242 val_loss= 0.66425 val_f1_mic= 0.39818 val_f1_mac= 0.11848 time= 0.06258
Epoch: 0002
Iter: 0001 train_loss= 0.54290 train_f1_mic= 0.40289 train_f1_mac= 0.10440 val_loss= 0.55891 val_f1_mic= 0.38682 val_f1_mac= 0.10396 time= 0.05238
Iter: 0006 train_loss= 0.52409 train_f1_mic= 0.38014 train_f1_mac= 0.08793 val_loss= 0.55891 val_f1_mic= 0.38682 val_f1_mac= 0.10396 time= 0.04534
Iter: 0011 train_loss= 0.54269 train_f1_mic= 0.36509 train_f1_mac= 0.08777 val_loss= 0.55891 val_f1_mic= 0.38682 val_f1_mac= 0.10396 time= 0.04057
Iter: 0016 train_loss= 0.54060 train_f1_mic= 0.38937 train_f1_mac= 0.10280 val_loss= 0.55891 val_f1_mic= 0.38682 val_f1_mac= 0.10396 time= 0.03698
Epoch: 0003
Iter: 0002 train_loss= 0.52941 train_f1_mic= 0.40517 train_f1_mac= 0.11092 val_loss= 0.54335 val_f1_mic= 0.40134 val_f1_mac= 0.11267 time= 0.03495
Iter: 0007 train_loss= 0.54100 train_f1_mic= 0.37105 train_f1_mac= 0.10426 val_loss= 0.54335 val_f1_mic= 0.40134 val_f1_mac= 0.11267 time= 0.03295
Iter: 0012 train_loss= 0.53925 train_f1_mic= 0.39162 train_f1_mac= 0.11450 val_loss= 0.54335 val_f1_mic= 0.40134 val_f1_mac= 0.11267 time= 0.03129
Iter: 0017 train_loss= 0.53541 train_f1_mic= 0.41953 train_f1_mac= 0.13039 val_loss= 0.54335 val_f1_mic= 0.40134 val_f1_mac= 0.11267 time= 0.02999
Epoch: 0004
Iter: 0003 train_loss= 0.52502 train_f1_mic= 0.42033 train_f1_mac= 0.13019 val_loss= 0.54411 val_f1_mic= 0.41746 val_f1_mac= 0.13258 time= 0.02926
Iter: 0008 train_loss= 0.51237 train_f1_mic= 0.41503 train_f1_mac= 0.13170 val_loss= 0.54411 val_f1_mic= 0.41746 val_f1_mac= 0.13258 time= 0.02818
Iter: 0013 train_loss= 0.52771 train_f1_mic= 0.43696 train_f1_mac= 0.14669 val_loss= 0.54411 val_f1_mic= 0.41746 val_f1_mac= 0.13258 time= 0.02726
Iter: 0018 train_loss= 0.50878 train_f1_mic= 0.41813 train_f1_mac= 0.13744 val_loss= 0.54411 val_f1_mic= 0.41746 val_f1_mac= 0.13258 time= 0.02657
Epoch: 0005
Iter: 0004 train_loss= 0.51531 train_f1_mic= 0.45926 train_f1_mac= 0.16669 val_loss= 0.54870 val_f1_mic= 0.41600 val_f1_mac= 0.14507 time= 0.02620
Iter: 0009 train_loss= 0.52205 train_f1_mic= 0.41485 train_f1_mac= 0.14400 val_loss= 0.54870 val_f1_mic= 0.41600 val_f1_mac= 0.14507 time= 0.02551
Iter: 0014 train_loss= 0.52213 train_f1_mic= 0.44164 train_f1_mac= 0.17462 val_loss= 0.54870 val_f1_mic= 0.41600 val_f1_mac= 0.14507 time= 0.02495
Epoch: 0006
Iter: 0000 train_loss= 0.51521 train_f1_mic= 0.44302 train_f1_mac= 0.17162 val_loss= 0.53503 val_f1_mic= 0.45342 val_f1_mac= 0.17809 time= 0.02476
Iter: 0005 train_loss= 0.52246 train_f1_mic= 0.44627 train_f1_mac= 0.17165 val_loss= 0.53503 val_f1_mic= 0.45342 val_f1_mac= 0.17809 time= 0.02434
Iter: 0010 train_loss= 0.51540 train_f1_mic= 0.47020 train_f1_mac= 0.20179 val_loss= 0.53503 val_f1_mic= 0.45342 val_f1_mac= 0.17809 time= 0.02389
Iter: 0015 train_loss= 0.51753 train_f1_mic= 0.43865 train_f1_mac= 0.17757 val_loss= 0.53503 val_f1_mic= 0.45342 val_f1_mac= 0.17809 time= 0.02352
Epoch: 0007
Iter: 0001 train_loss= 0.52095 train_f1_mic= 0.43637 train_f1_mac= 0.17055 val_loss= 0.53023 val_f1_mic= 0.44263 val_f1_mac= 0.18874 time= 0.02342
Iter: 0006 train_loss= 0.51007 train_f1_mic= 0.46499 train_f1_mac= 0.20445 val_loss= 0.53023 val_f1_mic= 0.44263 val_f1_mac= 0.18874 time= 0.02307
Iter: 0011 train_loss= 0.52458 train_f1_mic= 0.44483 train_f1_mac= 0.18726 val_loss= 0.53023 val_f1_mic= 0.44263 val_f1_mac= 0.18874 time= 0.02279
Iter: 0016 train_loss= 0.51246 train_f1_mic= 0.44145 train_f1_mac= 0.17105 val_loss= 0.53023 val_f1_mic= 0.44263 val_f1_mac= 0.18874 time= 0.02251
Epoch: 0008
Iter: 0002 train_loss= 0.50402 train_f1_mic= 0.45098 train_f1_mac= 0.19189 val_loss= 0.52552 val_f1_mic= 0.47998 val_f1_mac= 0.21414 time= 0.02243
Iter: 0007 train_loss= 0.51472 train_f1_mic= 0.47594 train_f1_mac= 0.21872 val_loss= 0.52552 val_f1_mic= 0.47998 val_f1_mac= 0.21414 time= 0.02221
Iter: 0012 train_loss= 0.50796 train_f1_mic= 0.45465 train_f1_mac= 0.20762 val_loss= 0.52552 val_f1_mic= 0.47998 val_f1_mac= 0.21414 time= 0.02201
Iter: 0017 train_loss= 0.49780 train_f1_mic= 0.45621 train_f1_mac= 0.20409 val_loss= 0.52552 val_f1_mic= 0.47998 val_f1_mac= 0.21414 time= 0.02180
Epoch: 0009
Iter: 0003 train_loss= 0.50361 train_f1_mic= 0.47822 train_f1_mac= 0.21713 val_loss= 0.53398 val_f1_mic= 0.51087 val_f1_mac= 0.26673 time= 0.02175
Iter: 0008 train_loss= 0.49878 train_f1_mic= 0.50435 train_f1_mac= 0.25309 val_loss= 0.53398 val_f1_mic= 0.51087 val_f1_mac= 0.26673 time= 0.02153
Iter: 0013 train_loss= 0.51048 train_f1_mic= 0.46645 train_f1_mac= 0.21336 val_loss= 0.53398 val_f1_mic= 0.51087 val_f1_mac= 0.26673 time= 0.02132
Iter: 0018 train_loss= 0.51669 train_f1_mic= 0.45198 train_f1_mac= 0.21222 val_loss= 0.53398 val_f1_mic= 0.51087 val_f1_mac= 0.26673 time= 0.02121
Epoch: 0010
Iter: 0004 train_loss= 0.50071 train_f1_mic= 0.50205 train_f1_mac= 0.24208 val_loss= 0.53049 val_f1_mic= 0.50503 val_f1_mac= 0.26446 time= 0.02113
Iter: 0009 train_loss= 0.48264 train_f1_mic= 0.48284 train_f1_mac= 0.24017 val_loss= 0.53049 val_f1_mic= 0.50503 val_f1_mac= 0.26446 time= 0.02093
Iter: 0014 train_loss= 0.50864 train_f1_mic= 0.49093 train_f1_mac= 0.24933 val_loss= 0.53049 val_f1_mic= 0.50503 val_f1_mac= 0.26446 time= 0.02078
Optimization Finished!
Full validation stats: loss= 0.51776 f1_micro= 0.49645 f1_macro= 0.26396 time= 0.11070
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48131069986865893
Rewards :  0.024441684475446146 Accuracy :  0.5008640474490158
Total reward :  1.3502892595267237
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02444168]
Trial 284: Controller loss : 120.710205

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:57:09.505519: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:57:09.505960: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:57:09.506384: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:57:09.506691: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:57:09.507547: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69401 train_f1_mic= 0.39134 train_f1_mac= 0.30579 val_loss= 0.66712 val_f1_mic= 0.36992 val_f1_mac= 0.10902 time= 0.84574
Iter: 0005 train_loss= 0.58896 train_f1_mic= 0.38129 train_f1_mac= 0.09048 val_loss= 0.66712 val_f1_mic= 0.36992 val_f1_mac= 0.10902 time= 0.15359
Iter: 0010 train_loss= 0.55287 train_f1_mic= 0.35292 train_f1_mac= 0.08190 val_loss= 0.66712 val_f1_mic= 0.36992 val_f1_mac= 0.10902 time= 0.09093
Iter: 0015 train_loss= 0.55186 train_f1_mic= 0.40946 train_f1_mac= 0.11100 val_loss= 0.66712 val_f1_mic= 0.36992 val_f1_mac= 0.10902 time= 0.06688
Epoch: 0002
Iter: 0001 train_loss= 0.54258 train_f1_mic= 0.38354 train_f1_mac= 0.09715 val_loss= 0.56967 val_f1_mic= 0.37059 val_f1_mac= 0.10002 time= 0.05580
Iter: 0006 train_loss= 0.54269 train_f1_mic= 0.37038 train_f1_mac= 0.09047 val_loss= 0.56967 val_f1_mic= 0.37059 val_f1_mac= 0.10002 time= 0.04802
Iter: 0011 train_loss= 0.53781 train_f1_mic= 0.39034 train_f1_mac= 0.09961 val_loss= 0.56967 val_f1_mic= 0.37059 val_f1_mac= 0.10002 time= 0.04285
Iter: 0016 train_loss= 0.52284 train_f1_mic= 0.40042 train_f1_mac= 0.10354 val_loss= 0.56967 val_f1_mic= 0.37059 val_f1_mac= 0.10002 time= 0.03914
Epoch: 0003
Iter: 0002 train_loss= 0.53107 train_f1_mic= 0.39699 train_f1_mac= 0.11077 val_loss= 0.56427 val_f1_mic= 0.38261 val_f1_mac= 0.11343 time= 0.03683
Iter: 0007 train_loss= 0.52339 train_f1_mic= 0.41608 train_f1_mac= 0.12459 val_loss= 0.56427 val_f1_mic= 0.38261 val_f1_mac= 0.11343 time= 0.03447
Iter: 0012 train_loss= 0.53256 train_f1_mic= 0.41311 train_f1_mac= 0.12835 val_loss= 0.56427 val_f1_mic= 0.38261 val_f1_mac= 0.11343 time= 0.03266
Iter: 0017 train_loss= 0.53288 train_f1_mic= 0.42650 train_f1_mac= 0.13522 val_loss= 0.56427 val_f1_mic= 0.38261 val_f1_mac= 0.11343 time= 0.03115
Epoch: 0004
Iter: 0003 train_loss= 0.54202 train_f1_mic= 0.40180 train_f1_mac= 0.12491 val_loss= 0.55273 val_f1_mic= 0.40868 val_f1_mac= 0.13053 time= 0.03043
Iter: 0008 train_loss= 0.51395 train_f1_mic= 0.43342 train_f1_mac= 0.13892 val_loss= 0.55273 val_f1_mic= 0.40868 val_f1_mac= 0.13053 time= 0.02948
Iter: 0013 train_loss= 0.50607 train_f1_mic= 0.42890 train_f1_mac= 0.14254 val_loss= 0.55273 val_f1_mic= 0.40868 val_f1_mac= 0.13053 time= 0.02841
Iter: 0018 train_loss= 0.51918 train_f1_mic= 0.42083 train_f1_mac= 0.14659 val_loss= 0.55273 val_f1_mic= 0.40868 val_f1_mac= 0.13053 time= 0.02757
Epoch: 0005
Iter: 0004 train_loss= 0.51505 train_f1_mic= 0.44675 train_f1_mac= 0.16946 val_loss= 0.55392 val_f1_mic= 0.41252 val_f1_mac= 0.15419 time= 0.02718
Iter: 0009 train_loss= 0.51019 train_f1_mic= 0.41207 train_f1_mac= 0.13441 val_loss= 0.55392 val_f1_mic= 0.41252 val_f1_mac= 0.15419 time= 0.02648
Iter: 0014 train_loss= 0.52099 train_f1_mic= 0.45295 train_f1_mac= 0.18856 val_loss= 0.55392 val_f1_mic= 0.41252 val_f1_mac= 0.15419 time= 0.02580
Epoch: 0006
Iter: 0000 train_loss= 0.51151 train_f1_mic= 0.45957 train_f1_mac= 0.18599 val_loss= 0.53804 val_f1_mic= 0.47386 val_f1_mac= 0.21506 time= 0.02558
Iter: 0005 train_loss= 0.51437 train_f1_mic= 0.43832 train_f1_mac= 0.16878 val_loss= 0.53804 val_f1_mic= 0.47386 val_f1_mac= 0.21506 time= 0.02504
Iter: 0010 train_loss= 0.51691 train_f1_mic= 0.45107 train_f1_mac= 0.18068 val_loss= 0.53804 val_f1_mic= 0.47386 val_f1_mac= 0.21506 time= 0.02462
Iter: 0015 train_loss= 0.50636 train_f1_mic= 0.45137 train_f1_mac= 0.18436 val_loss= 0.53804 val_f1_mic= 0.47386 val_f1_mac= 0.21506 time= 0.02425
Epoch: 0007
Iter: 0001 train_loss= 0.51111 train_f1_mic= 0.47002 train_f1_mac= 0.20915 val_loss= 0.54024 val_f1_mic= 0.47734 val_f1_mac= 0.21885 time= 0.02411
Iter: 0006 train_loss= 0.49810 train_f1_mic= 0.45807 train_f1_mac= 0.20122 val_loss= 0.54024 val_f1_mic= 0.47734 val_f1_mac= 0.21885 time= 0.02378
Iter: 0011 train_loss= 0.51745 train_f1_mic= 0.48495 train_f1_mac= 0.22424 val_loss= 0.54024 val_f1_mic= 0.47734 val_f1_mac= 0.21885 time= 0.02344
Iter: 0016 train_loss= 0.52529 train_f1_mic= 0.43843 train_f1_mac= 0.18728 val_loss= 0.54024 val_f1_mic= 0.47734 val_f1_mac= 0.21885 time= 0.02311
Epoch: 0008
Iter: 0002 train_loss= 0.50135 train_f1_mic= 0.43174 train_f1_mac= 0.18062 val_loss= 0.52267 val_f1_mic= 0.44850 val_f1_mac= 0.19820 time= 0.02307
Iter: 0007 train_loss= 0.50603 train_f1_mic= 0.50545 train_f1_mac= 0.26190 val_loss= 0.52267 val_f1_mic= 0.44850 val_f1_mac= 0.19820 time= 0.02275
Iter: 0012 train_loss= 0.50529 train_f1_mic= 0.46966 train_f1_mac= 0.22288 val_loss= 0.52267 val_f1_mic= 0.44850 val_f1_mac= 0.19820 time= 0.02244
Iter: 0017 train_loss= 0.51198 train_f1_mic= 0.48600 train_f1_mac= 0.23907 val_loss= 0.52267 val_f1_mic= 0.44850 val_f1_mac= 0.19820 time= 0.02225
Epoch: 0009
Iter: 0003 train_loss= 0.49275 train_f1_mic= 0.50312 train_f1_mac= 0.25410 val_loss= 0.51041 val_f1_mic= 0.46517 val_f1_mac= 0.23497 time= 0.02208
Iter: 0008 train_loss= 0.50919 train_f1_mic= 0.46396 train_f1_mac= 0.22301 val_loss= 0.51041 val_f1_mic= 0.46517 val_f1_mac= 0.23497 time= 0.02189
Iter: 0013 train_loss= 0.48930 train_f1_mic= 0.46660 train_f1_mac= 0.22469 val_loss= 0.51041 val_f1_mic= 0.46517 val_f1_mac= 0.23497 time= 0.02166
Iter: 0018 train_loss= 0.50677 train_f1_mic= 0.48226 train_f1_mac= 0.23579 val_loss= 0.51041 val_f1_mic= 0.46517 val_f1_mac= 0.23497 time= 0.02149
Epoch: 0010
Iter: 0004 train_loss= 0.50262 train_f1_mic= 0.47840 train_f1_mac= 0.23390 val_loss= 0.50394 val_f1_mic= 0.49131 val_f1_mac= 0.25847 time= 0.02146
Iter: 0009 train_loss= 0.50134 train_f1_mic= 0.49197 train_f1_mac= 0.26925 val_loss= 0.50394 val_f1_mic= 0.49131 val_f1_mac= 0.25847 time= 0.02128
Iter: 0014 train_loss= 0.49402 train_f1_mic= 0.48651 train_f1_mac= 0.25227 val_loss= 0.50394 val_f1_mic= 0.49131 val_f1_mac= 0.25847 time= 0.02111
Optimization Finished!
Full validation stats: loss= 0.51569 f1_micro= 0.48988 f1_macro= 0.26687 time= 0.07780
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48176509975092463
Rewards :  0.0022719994113287734 Accuracy :  0.4835826992799877
Total reward :  1.3525612589380525
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.002272]
Trial 285: Controller loss : 120.981956

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:57:18.970622: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:57:18.970996: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:57:18.971362: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:57:18.971630: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:57:18.971954: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69278 train_f1_mic= 0.36313 train_f1_mac= 0.28674 val_loss= 0.66360 val_f1_mic= 0.37885 val_f1_mac= 0.11271 time= 0.76493
Iter: 0005 train_loss= 0.59044 train_f1_mic= 0.38262 train_f1_mac= 0.09419 val_loss= 0.66360 val_f1_mic= 0.37885 val_f1_mac= 0.11271 time= 0.14046
Iter: 0010 train_loss= 0.54756 train_f1_mic= 0.38061 train_f1_mac= 0.09214 val_loss= 0.66360 val_f1_mic= 0.37885 val_f1_mac= 0.11271 time= 0.08323
Iter: 0015 train_loss= 0.54053 train_f1_mic= 0.41867 train_f1_mac= 0.11260 val_loss= 0.66360 val_f1_mic= 0.37885 val_f1_mac= 0.11271 time= 0.06196
Epoch: 0002
Iter: 0001 train_loss= 0.53235 train_f1_mic= 0.38175 train_f1_mac= 0.09403 val_loss= 0.56614 val_f1_mic= 0.36743 val_f1_mac= 0.09900 time= 0.05201
Iter: 0006 train_loss= 0.53645 train_f1_mic= 0.36864 train_f1_mac= 0.08872 val_loss= 0.56614 val_f1_mic= 0.36743 val_f1_mac= 0.09900 time= 0.04534
Iter: 0011 train_loss= 0.54177 train_f1_mic= 0.37926 train_f1_mac= 0.09610 val_loss= 0.56614 val_f1_mic= 0.36743 val_f1_mac= 0.09900 time= 0.04051
Iter: 0016 train_loss= 0.53161 train_f1_mic= 0.39804 train_f1_mac= 0.10526 val_loss= 0.56614 val_f1_mic= 0.36743 val_f1_mac= 0.09900 time= 0.03721
Epoch: 0003
Iter: 0002 train_loss= 0.53134 train_f1_mic= 0.39373 train_f1_mac= 0.10984 val_loss= 0.55597 val_f1_mic= 0.38923 val_f1_mac= 0.11542 time= 0.03527
Iter: 0007 train_loss= 0.52303 train_f1_mic= 0.41105 train_f1_mac= 0.12079 val_loss= 0.55597 val_f1_mic= 0.38923 val_f1_mac= 0.11542 time= 0.03315
Iter: 0012 train_loss= 0.54659 train_f1_mic= 0.38947 train_f1_mac= 0.11622 val_loss= 0.55597 val_f1_mic= 0.38923 val_f1_mac= 0.11542 time= 0.03143
Iter: 0017 train_loss= 0.53587 train_f1_mic= 0.40918 train_f1_mac= 0.12779 val_loss= 0.55597 val_f1_mic= 0.38923 val_f1_mac= 0.11542 time= 0.03020
Epoch: 0004
Iter: 0003 train_loss= 0.52366 train_f1_mic= 0.42850 train_f1_mac= 0.13567 val_loss= 0.52940 val_f1_mic= 0.43124 val_f1_mac= 0.13926 time= 0.02922
Iter: 0008 train_loss= 0.52607 train_f1_mic= 0.42370 train_f1_mac= 0.13540 val_loss= 0.52940 val_f1_mic= 0.43124 val_f1_mac= 0.13926 time= 0.02812
Iter: 0013 train_loss= 0.52589 train_f1_mic= 0.40783 train_f1_mac= 0.12836 val_loss= 0.52940 val_f1_mic= 0.43124 val_f1_mac= 0.13926 time= 0.02712
Iter: 0018 train_loss= 0.52138 train_f1_mic= 0.42805 train_f1_mac= 0.14516 val_loss= 0.52940 val_f1_mic= 0.43124 val_f1_mac= 0.13926 time= 0.02624
Epoch: 0005
Iter: 0004 train_loss= 0.51499 train_f1_mic= 0.43263 train_f1_mac= 0.15571 val_loss= 0.52827 val_f1_mic= 0.44070 val_f1_mac= 0.15591 time= 0.02572
Iter: 0009 train_loss= 0.51661 train_f1_mic= 0.43659 train_f1_mac= 0.15924 val_loss= 0.52827 val_f1_mic= 0.44070 val_f1_mac= 0.15591 time= 0.02528
Iter: 0014 train_loss= 0.51048 train_f1_mic= 0.44687 train_f1_mac= 0.16808 val_loss= 0.52827 val_f1_mic= 0.44070 val_f1_mac= 0.15591 time= 0.02479
Epoch: 0006
Iter: 0000 train_loss= 0.51559 train_f1_mic= 0.43576 train_f1_mac= 0.16928 val_loss= 0.54187 val_f1_mic= 0.43908 val_f1_mac= 0.18260 time= 0.02466
Iter: 0005 train_loss= 0.51359 train_f1_mic= 0.45569 train_f1_mac= 0.18541 val_loss= 0.54187 val_f1_mic= 0.43908 val_f1_mac= 0.18260 time= 0.02420
Iter: 0010 train_loss= 0.51627 train_f1_mic= 0.46635 train_f1_mac= 0.19554 val_loss= 0.54187 val_f1_mic= 0.43908 val_f1_mac= 0.18260 time= 0.02383
Iter: 0015 train_loss= 0.50839 train_f1_mic= 0.42298 train_f1_mac= 0.15787 val_loss= 0.54187 val_f1_mic= 0.43908 val_f1_mac= 0.18260 time= 0.02352
Epoch: 0007
Iter: 0001 train_loss= 0.50634 train_f1_mic= 0.44674 train_f1_mac= 0.19154 val_loss= 0.52866 val_f1_mic= 0.45928 val_f1_mac= 0.20890 time= 0.02328
Iter: 0006 train_loss= 0.50735 train_f1_mic= 0.46509 train_f1_mac= 0.19717 val_loss= 0.52866 val_f1_mic= 0.45928 val_f1_mac= 0.20890 time= 0.02298
Iter: 0011 train_loss= 0.51088 train_f1_mic= 0.47708 train_f1_mac= 0.21730 val_loss= 0.52866 val_f1_mic= 0.45928 val_f1_mac= 0.20890 time= 0.02268
Iter: 0016 train_loss= 0.52067 train_f1_mic= 0.46830 train_f1_mac= 0.20411 val_loss= 0.52866 val_f1_mic= 0.45928 val_f1_mac= 0.20890 time= 0.02245
Epoch: 0008
Iter: 0002 train_loss= 0.52274 train_f1_mic= 0.44772 train_f1_mac= 0.19353 val_loss= 0.53560 val_f1_mic= 0.46222 val_f1_mac= 0.22398 time= 0.02245
Iter: 0007 train_loss= 0.51551 train_f1_mic= 0.46975 train_f1_mac= 0.22224 val_loss= 0.53560 val_f1_mic= 0.46222 val_f1_mac= 0.22398 time= 0.02218
Iter: 0012 train_loss= 0.51012 train_f1_mic= 0.48634 train_f1_mac= 0.22916 val_loss= 0.53560 val_f1_mic= 0.46222 val_f1_mac= 0.22398 time= 0.02196
Iter: 0017 train_loss= 0.51011 train_f1_mic= 0.45704 train_f1_mac= 0.21614 val_loss= 0.53560 val_f1_mic= 0.46222 val_f1_mac= 0.22398 time= 0.02181
Epoch: 0009
Iter: 0003 train_loss= 0.51405 train_f1_mic= 0.46396 train_f1_mac= 0.22669 val_loss= 0.53790 val_f1_mic= 0.47406 val_f1_mac= 0.23708 time= 0.02178
Iter: 0008 train_loss= 0.49916 train_f1_mic= 0.49006 train_f1_mac= 0.24348 val_loss= 0.53790 val_f1_mic= 0.47406 val_f1_mac= 0.23708 time= 0.02156
Iter: 0013 train_loss= 0.50617 train_f1_mic= 0.51032 train_f1_mac= 0.27109 val_loss= 0.53790 val_f1_mic= 0.47406 val_f1_mac= 0.23708 time= 0.02136
Iter: 0018 train_loss= 0.49403 train_f1_mic= 0.49703 train_f1_mac= 0.25341 val_loss= 0.53790 val_f1_mic= 0.47406 val_f1_mac= 0.23708 time= 0.02117
Epoch: 0010
Iter: 0004 train_loss= 0.50568 train_f1_mic= 0.46471 train_f1_mac= 0.23047 val_loss= 0.52141 val_f1_mic= 0.52043 val_f1_mac= 0.28132 time= 0.02122
Iter: 0009 train_loss= 0.50595 train_f1_mic= 0.46770 train_f1_mac= 0.23933 val_loss= 0.52141 val_f1_mic= 0.52043 val_f1_mac= 0.28132 time= 0.02105
Iter: 0014 train_loss= 0.48541 train_f1_mic= 0.49727 train_f1_mac= 0.25695 val_loss= 0.52141 val_f1_mic= 0.52043 val_f1_mac= 0.28132 time= 0.02089
Optimization Finished!
Full validation stats: loss= 0.51179 f1_micro= 0.50203 f1_macro= 0.27279 time= 0.12766
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4830282160343471
Rewards :  0.006315581417112526 Accuracy :  0.48808068116803716
Total reward :  1.358876840355165
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.00631558]
Trial 286: Controller loss : 121.012672

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:57:28.721693: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:57:28.722259: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:57:28.722812: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:57:28.723212: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:57:28.723707: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69536 train_f1_mic= 0.36896 train_f1_mac= 0.29323 val_loss= 0.66367 val_f1_mic= 0.41338 val_f1_mac= 0.12840 time= 0.80279
Iter: 0005 train_loss= 0.59888 train_f1_mic= 0.36745 train_f1_mac= 0.08876 val_loss= 0.66367 val_f1_mic= 0.41338 val_f1_mac= 0.12840 time= 0.14510
Iter: 0010 train_loss= 0.55371 train_f1_mic= 0.36324 train_f1_mac= 0.08654 val_loss= 0.66367 val_f1_mic= 0.41338 val_f1_mac= 0.12840 time= 0.08613
Iter: 0015 train_loss= 0.54418 train_f1_mic= 0.40061 train_f1_mac= 0.10452 val_loss= 0.66367 val_f1_mic= 0.41338 val_f1_mac= 0.12840 time= 0.06370
Epoch: 0002
Iter: 0001 train_loss= 0.52908 train_f1_mic= 0.40884 train_f1_mac= 0.10596 val_loss= 0.57302 val_f1_mic= 0.38584 val_f1_mac= 0.10946 time= 0.05347
Iter: 0006 train_loss= 0.53940 train_f1_mic= 0.37412 train_f1_mac= 0.09404 val_loss= 0.57302 val_f1_mic= 0.38584 val_f1_mac= 0.10946 time= 0.04657
Iter: 0011 train_loss= 0.54133 train_f1_mic= 0.37892 train_f1_mac= 0.09593 val_loss= 0.57302 val_f1_mic= 0.38584 val_f1_mac= 0.10946 time= 0.04156
Iter: 0016 train_loss= 0.54210 train_f1_mic= 0.39291 train_f1_mac= 0.10837 val_loss= 0.57302 val_f1_mic= 0.38584 val_f1_mac= 0.10946 time= 0.03806
Epoch: 0003
Iter: 0002 train_loss= 0.53481 train_f1_mic= 0.39557 train_f1_mac= 0.11474 val_loss= 0.55420 val_f1_mic= 0.39928 val_f1_mac= 0.11893 time= 0.03586
Iter: 0007 train_loss= 0.53326 train_f1_mic= 0.40015 train_f1_mac= 0.12065 val_loss= 0.55420 val_f1_mic= 0.39928 val_f1_mac= 0.11893 time= 0.03363
Iter: 0012 train_loss= 0.53600 train_f1_mic= 0.40977 train_f1_mac= 0.12615 val_loss= 0.55420 val_f1_mic= 0.39928 val_f1_mac= 0.11893 time= 0.03187
Iter: 0017 train_loss= 0.52155 train_f1_mic= 0.42772 train_f1_mac= 0.13198 val_loss= 0.55420 val_f1_mic= 0.39928 val_f1_mac= 0.11893 time= 0.03042
Epoch: 0004
Iter: 0003 train_loss= 0.52561 train_f1_mic= 0.39701 train_f1_mac= 0.12016 val_loss= 0.53827 val_f1_mic= 0.42712 val_f1_mac= 0.13568 time= 0.02976
Iter: 0008 train_loss= 0.52899 train_f1_mic= 0.43388 train_f1_mac= 0.14475 val_loss= 0.53827 val_f1_mic= 0.42712 val_f1_mac= 0.13568 time= 0.02876
Iter: 0013 train_loss= 0.52250 train_f1_mic= 0.40404 train_f1_mac= 0.12815 val_loss= 0.53827 val_f1_mic= 0.42712 val_f1_mac= 0.13568 time= 0.02781
Iter: 0018 train_loss= 0.52160 train_f1_mic= 0.44868 train_f1_mac= 0.15879 val_loss= 0.53827 val_f1_mic= 0.42712 val_f1_mac= 0.13568 time= 0.02703
Epoch: 0005
Iter: 0004 train_loss= 0.51641 train_f1_mic= 0.42029 train_f1_mac= 0.13561 val_loss= 0.56250 val_f1_mic= 0.41844 val_f1_mac= 0.14872 time= 0.02647
Iter: 0009 train_loss= 0.52632 train_f1_mic= 0.44564 train_f1_mac= 0.16156 val_loss= 0.56250 val_f1_mic= 0.41844 val_f1_mac= 0.14872 time= 0.02586
Iter: 0014 train_loss= 0.51989 train_f1_mic= 0.42240 train_f1_mac= 0.14635 val_loss= 0.56250 val_f1_mic= 0.41844 val_f1_mac= 0.14872 time= 0.02534
Epoch: 0006
Iter: 0000 train_loss= 0.51823 train_f1_mic= 0.44398 train_f1_mac= 0.16753 val_loss= 0.53383 val_f1_mic= 0.42233 val_f1_mac= 0.15950 time= 0.02508
Iter: 0005 train_loss= 0.50323 train_f1_mic= 0.46544 train_f1_mac= 0.18023 val_loss= 0.53383 val_f1_mic= 0.42233 val_f1_mac= 0.15950 time= 0.02457
Iter: 0010 train_loss= 0.51490 train_f1_mic= 0.45317 train_f1_mac= 0.18597 val_loss= 0.53383 val_f1_mic= 0.42233 val_f1_mac= 0.15950 time= 0.02417
Iter: 0015 train_loss= 0.51319 train_f1_mic= 0.46071 train_f1_mac= 0.19082 val_loss= 0.53383 val_f1_mic= 0.42233 val_f1_mac= 0.15950 time= 0.02373
Epoch: 0007
Iter: 0001 train_loss= 0.51464 train_f1_mic= 0.44276 train_f1_mac= 0.18090 val_loss= 0.53547 val_f1_mic= 0.43461 val_f1_mac= 0.17661 time= 0.02367
Iter: 0006 train_loss= 0.50830 train_f1_mic= 0.47499 train_f1_mac= 0.21259 val_loss= 0.53547 val_f1_mic= 0.43461 val_f1_mac= 0.17661 time= 0.02334
Iter: 0011 train_loss= 0.50836 train_f1_mic= 0.43869 train_f1_mac= 0.17998 val_loss= 0.53547 val_f1_mic= 0.43461 val_f1_mac= 0.17661 time= 0.02309
Iter: 0016 train_loss= 0.50575 train_f1_mic= 0.47466 train_f1_mac= 0.21754 val_loss= 0.53547 val_f1_mic= 0.43461 val_f1_mac= 0.17661 time= 0.02279
Epoch: 0008
Iter: 0002 train_loss= 0.50631 train_f1_mic= 0.46491 train_f1_mac= 0.21185 val_loss= 0.52017 val_f1_mic= 0.48355 val_f1_mac= 0.22880 time= 0.02278
Iter: 0007 train_loss= 0.48856 train_f1_mic= 0.49560 train_f1_mac= 0.24430 val_loss= 0.52017 val_f1_mic= 0.48355 val_f1_mac= 0.22880 time= 0.02247
Iter: 0012 train_loss= 0.50701 train_f1_mic= 0.50394 train_f1_mac= 0.24875 val_loss= 0.52017 val_f1_mic= 0.48355 val_f1_mac= 0.22880 time= 0.02225
Iter: 0017 train_loss= 0.50617 train_f1_mic= 0.45895 train_f1_mac= 0.21928 val_loss= 0.52017 val_f1_mic= 0.48355 val_f1_mac= 0.22880 time= 0.02203
Epoch: 0009
Iter: 0003 train_loss= 0.49631 train_f1_mic= 0.48887 train_f1_mac= 0.24568 val_loss= 0.51492 val_f1_mic= 0.49454 val_f1_mac= 0.24943 time= 0.02203
Iter: 0008 train_loss= 0.49082 train_f1_mic= 0.47950 train_f1_mac= 0.23132 val_loss= 0.51492 val_f1_mic= 0.49454 val_f1_mac= 0.24943 time= 0.02185
Iter: 0013 train_loss= 0.51060 train_f1_mic= 0.45851 train_f1_mac= 0.21434 val_loss= 0.51492 val_f1_mic= 0.49454 val_f1_mac= 0.24943 time= 0.02167
Iter: 0018 train_loss= 0.50491 train_f1_mic= 0.48428 train_f1_mac= 0.23501 val_loss= 0.51492 val_f1_mic= 0.49454 val_f1_mac= 0.24943 time= 0.02149
Epoch: 0010
Iter: 0004 train_loss= 0.49336 train_f1_mic= 0.49180 train_f1_mac= 0.26609 val_loss= 0.51012 val_f1_mic= 0.49900 val_f1_mac= 0.26493 time= 0.02142
Iter: 0009 train_loss= 0.50543 train_f1_mic= 0.47467 train_f1_mac= 0.23839 val_loss= 0.51012 val_f1_mic= 0.49900 val_f1_mac= 0.26493 time= 0.02125
Iter: 0014 train_loss= 0.49287 train_f1_mic= 0.48663 train_f1_mac= 0.24192 val_loss= 0.51012 val_f1_mic= 0.49900 val_f1_mac= 0.26493 time= 0.02111
Optimization Finished!
Full validation stats: loss= 0.51344 f1_micro= 0.50456 f1_macro= 0.27445 time= 0.11666
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48775935920825236
Rewards :  0.023655715869526306 Accuracy :  0.5066839319038734
Total reward :  1.3825325562246913
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02365572]
Trial 287: Controller loss : 121.103821

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [2, 'sigmoid', 4, 'relu']
2018-08-31 00:57:38.451214: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:57:38.451466: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:57:38.451807: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:57:38.451957: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:57:38.452175: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69386 train_f1_mic= 0.32847 train_f1_mac= 0.18546 val_loss= 0.66431 val_f1_mic= 0.33213 val_f1_mac= 0.09029 time= 0.83693
Iter: 0005 train_loss= 0.59733 train_f1_mic= 0.36750 train_f1_mac= 0.08689 val_loss= 0.66431 val_f1_mic= 0.33213 val_f1_mac= 0.09029 time= 0.17637
Iter: 0010 train_loss= 0.56792 train_f1_mic= 0.39130 train_f1_mac= 0.10050 val_loss= 0.66431 val_f1_mic= 0.33213 val_f1_mac= 0.09029 time= 0.11670
Iter: 0015 train_loss= 0.54309 train_f1_mic= 0.40457 train_f1_mac= 0.10288 val_loss= 0.66431 val_f1_mic= 0.33213 val_f1_mac= 0.09029 time= 0.09400
Epoch: 0002
Iter: 0001 train_loss= 0.54022 train_f1_mic= 0.37154 train_f1_mac= 0.08727 val_loss= 0.56312 val_f1_mic= 0.36469 val_f1_mac= 0.08956 time= 0.08240
Iter: 0006 train_loss= 0.54097 train_f1_mic= 0.36990 train_f1_mac= 0.08713 val_loss= 0.56312 val_f1_mic= 0.36469 val_f1_mac= 0.08956 time= 0.07519
Iter: 0011 train_loss= 0.53313 train_f1_mic= 0.39725 train_f1_mac= 0.09708 val_loss= 0.56312 val_f1_mic= 0.36469 val_f1_mac= 0.08956 time= 0.06975
Iter: 0016 train_loss= 0.54677 train_f1_mic= 0.36758 train_f1_mac= 0.08794 val_loss= 0.56312 val_f1_mic= 0.36469 val_f1_mac= 0.08956 time= 0.06638
Epoch: 0003
Iter: 0002 train_loss= 0.53404 train_f1_mic= 0.38723 train_f1_mac= 0.09266 val_loss= 0.56407 val_f1_mic= 0.37686 val_f1_mac= 0.09619 time= 0.06407
Iter: 0007 train_loss= 0.53439 train_f1_mic= 0.37287 train_f1_mac= 0.08678 val_loss= 0.56407 val_f1_mic= 0.37686 val_f1_mac= 0.09619 time= 0.06155
Iter: 0012 train_loss= 0.54185 train_f1_mic= 0.37975 train_f1_mac= 0.09242 val_loss= 0.56407 val_f1_mic= 0.37686 val_f1_mac= 0.09619 time= 0.05986
Iter: 0017 train_loss= 0.54318 train_f1_mic= 0.39231 train_f1_mac= 0.09832 val_loss= 0.56407 val_f1_mic= 0.37686 val_f1_mac= 0.09619 time= 0.05833
Epoch: 0004
Iter: 0003 train_loss= 0.53978 train_f1_mic= 0.38398 train_f1_mac= 0.09471 val_loss= 0.57841 val_f1_mic= 0.37241 val_f1_mac= 0.09950 time= 0.05780
Iter: 0008 train_loss= 0.53787 train_f1_mic= 0.38088 train_f1_mac= 0.09243 val_loss= 0.57841 val_f1_mic= 0.37241 val_f1_mac= 0.09950 time= 0.05659
Iter: 0013 train_loss= 0.54001 train_f1_mic= 0.36875 train_f1_mac= 0.08783 val_loss= 0.57841 val_f1_mic= 0.37241 val_f1_mac= 0.09950 time= 0.05561
Iter: 0018 train_loss= 0.52765 train_f1_mic= 0.38392 train_f1_mac= 0.09142 val_loss= 0.57841 val_f1_mic= 0.37241 val_f1_mac= 0.09950 time= 0.05492
Epoch: 0005
Iter: 0004 train_loss= 0.52921 train_f1_mic= 0.40102 train_f1_mac= 0.10510 val_loss= 0.56067 val_f1_mic= 0.36227 val_f1_mac= 0.09301 time= 0.05443
Iter: 0009 train_loss= 0.53960 train_f1_mic= 0.39992 train_f1_mac= 0.11237 val_loss= 0.56067 val_f1_mic= 0.36227 val_f1_mac= 0.09301 time= 0.05384
Iter: 0014 train_loss= 0.53538 train_f1_mic= 0.41150 train_f1_mac= 0.12542 val_loss= 0.56067 val_f1_mic= 0.36227 val_f1_mac= 0.09301 time= 0.05331
Epoch: 0006
Iter: 0000 train_loss= 0.53363 train_f1_mic= 0.42020 train_f1_mac= 0.12787 val_loss= 0.54274 val_f1_mic= 0.44786 val_f1_mac= 0.14670 time= 0.05311
Iter: 0005 train_loss= 0.52924 train_f1_mic= 0.40120 train_f1_mac= 0.11055 val_loss= 0.54274 val_f1_mic= 0.44786 val_f1_mac= 0.14670 time= 0.05263
Iter: 0010 train_loss= 0.52834 train_f1_mic= 0.40146 train_f1_mac= 0.11670 val_loss= 0.54274 val_f1_mic= 0.44786 val_f1_mac= 0.14670 time= 0.05211
Iter: 0015 train_loss= 0.53281 train_f1_mic= 0.43735 train_f1_mac= 0.14281 val_loss= 0.54274 val_f1_mic= 0.44786 val_f1_mac= 0.14670 time= 0.05165
Epoch: 0007
Iter: 0001 train_loss= 0.52414 train_f1_mic= 0.42502 train_f1_mac= 0.13205 val_loss= 0.52785 val_f1_mic= 0.43254 val_f1_mac= 0.14092 time= 0.05146
Iter: 0006 train_loss= 0.53228 train_f1_mic= 0.38293 train_f1_mac= 0.11041 val_loss= 0.52785 val_f1_mic= 0.43254 val_f1_mac= 0.14092 time= 0.05109
Iter: 0011 train_loss= 0.53599 train_f1_mic= 0.39461 train_f1_mac= 0.11747 val_loss= 0.52785 val_f1_mic= 0.43254 val_f1_mac= 0.14092 time= 0.05079
Iter: 0016 train_loss= 0.54134 train_f1_mic= 0.40864 train_f1_mac= 0.12543 val_loss= 0.52785 val_f1_mic= 0.43254 val_f1_mac= 0.14092 time= 0.05050
Epoch: 0008
Iter: 0002 train_loss= 0.53147 train_f1_mic= 0.40771 train_f1_mac= 0.12173 val_loss= 0.56709 val_f1_mic= 0.40506 val_f1_mac= 0.13510 time= 0.05050
Iter: 0007 train_loss= 0.53594 train_f1_mic= 0.39313 train_f1_mac= 0.11432 val_loss= 0.56709 val_f1_mic= 0.40506 val_f1_mac= 0.13510 time= 0.05020
Iter: 0012 train_loss= 0.51813 train_f1_mic= 0.40621 train_f1_mac= 0.11703 val_loss= 0.56709 val_f1_mic= 0.40506 val_f1_mac= 0.13510 time= 0.05000
Iter: 0017 train_loss= 0.53483 train_f1_mic= 0.42281 train_f1_mac= 0.14559 val_loss= 0.56709 val_f1_mic= 0.40506 val_f1_mac= 0.13510 time= 0.04974
Epoch: 0009
Iter: 0003 train_loss= 0.52594 train_f1_mic= 0.43217 train_f1_mac= 0.14775 val_loss= 0.55082 val_f1_mic= 0.41317 val_f1_mac= 0.14620 time= 0.04965
Iter: 0008 train_loss= 0.52695 train_f1_mic= 0.43772 train_f1_mac= 0.14674 val_loss= 0.55082 val_f1_mic= 0.41317 val_f1_mac= 0.14620 time= 0.04941
Iter: 0013 train_loss= 0.53404 train_f1_mic= 0.44264 train_f1_mac= 0.16264 val_loss= 0.55082 val_f1_mic= 0.41317 val_f1_mac= 0.14620 time= 0.04924
Iter: 0018 train_loss= 0.53999 train_f1_mic= 0.41322 train_f1_mac= 0.13715 val_loss= 0.55082 val_f1_mic= 0.41317 val_f1_mac= 0.14620 time= 0.04903
Epoch: 0010
Iter: 0004 train_loss= 0.52881 train_f1_mic= 0.38865 train_f1_mac= 0.11269 val_loss= 0.55313 val_f1_mic= 0.47002 val_f1_mac= 0.18900 time= 0.04896
Iter: 0009 train_loss= 0.52850 train_f1_mic= 0.41624 train_f1_mac= 0.13452 val_loss= 0.55313 val_f1_mic= 0.47002 val_f1_mac= 0.18900 time= 0.04875
Iter: 0014 train_loss= 0.53497 train_f1_mic= 0.45281 train_f1_mac= 0.17600 val_loss= 0.55313 val_f1_mic= 0.47002 val_f1_mac= 0.18900 time= 0.04857
Optimization Finished!
Full validation stats: loss= 0.54703 f1_micro= 0.44812 f1_macro= 0.17064 time= 0.14261
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4786067776895506
Rewards :  -0.04576290759350893 Accuracy :  0.44199645161474344
Total reward :  1.3367696486311824
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'sigmoid', 4, 'relu']
Training RNN (Reward ip) :  [-0.04576291]
Trial 288: Controller loss : 9188.333984
2018-08-31 00:57:53.848711: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:57:53.849381: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device inter
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [4, 'linear', 3, 'linear']
connect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:57:53.850453: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:57:53.850873: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:57:53.851286: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69452 train_f1_mic= 0.35246 train_f1_mac= 0.30984 val_loss= 0.67444 val_f1_mic= 0.43610 val_f1_mac= 0.19432 time= 0.74501
Iter: 0005 train_loss= 0.59669 train_f1_mic= 0.36764 train_f1_mac= 0.08641 val_loss= 0.67444 val_f1_mic= 0.43610 val_f1_mac= 0.19432 time= 0.13630
Iter: 0010 train_loss= 0.56414 train_f1_mic= 0.38843 train_f1_mac= 0.09906 val_loss= 0.67444 val_f1_mic= 0.43610 val_f1_mac= 0.19432 time= 0.08096
Iter: 0015 train_loss= 0.55336 train_f1_mic= 0.39643 train_f1_mac= 0.10584 val_loss= 0.67444 val_f1_mic= 0.43610 val_f1_mac= 0.19432 time= 0.06071
Epoch: 0002
Iter: 0001 train_loss= 0.54447 train_f1_mic= 0.37588 train_f1_mac= 0.09570 val_loss= 0.56269 val_f1_mic= 0.36480 val_f1_mac= 0.09636 time= 0.05081
Iter: 0006 train_loss= 0.54502 train_f1_mic= 0.37336 train_f1_mac= 0.09512 val_loss= 0.56269 val_f1_mic= 0.36480 val_f1_mac= 0.09636 time= 0.04395
Iter: 0011 train_loss= 0.52904 train_f1_mic= 0.40067 train_f1_mac= 0.10845 val_loss= 0.56269 val_f1_mic= 0.36480 val_f1_mac= 0.09636 time= 0.03908
Iter: 0016 train_loss= 0.54547 train_f1_mic= 0.38459 train_f1_mac= 0.11164 val_loss= 0.56269 val_f1_mic= 0.36480 val_f1_mac= 0.09636 time= 0.03559
Epoch: 0003
Iter: 0002 train_loss= 0.54563 train_f1_mic= 0.38763 train_f1_mac= 0.11070 val_loss= 0.56575 val_f1_mic= 0.37704 val_f1_mac= 0.11245 time= 0.03329
Iter: 0007 train_loss= 0.53979 train_f1_mic= 0.38901 train_f1_mac= 0.11113 val_loss= 0.56575 val_f1_mic= 0.37704 val_f1_mac= 0.11245 time= 0.03126
Iter: 0012 train_loss= 0.53379 train_f1_mic= 0.40602 train_f1_mac= 0.12041 val_loss= 0.56575 val_f1_mic= 0.37704 val_f1_mac= 0.11245 time= 0.02960
Iter: 0017 train_loss= 0.52462 train_f1_mic= 0.40556 train_f1_mac= 0.11459 val_loss= 0.56575 val_f1_mic= 0.37704 val_f1_mac= 0.11245 time= 0.02852
Epoch: 0004
Iter: 0003 train_loss= 0.53439 train_f1_mic= 0.39500 train_f1_mac= 0.10769 val_loss= 0.54849 val_f1_mic= 0.39145 val_f1_mac= 0.11307 time= 0.02787
Iter: 0008 train_loss= 0.53039 train_f1_mic= 0.40107 train_f1_mac= 0.11746 val_loss= 0.54849 val_f1_mic= 0.39145 val_f1_mac= 0.11307 time= 0.02697
Iter: 0013 train_loss= 0.53037 train_f1_mic= 0.41187 train_f1_mac= 0.13134 val_loss= 0.54849 val_f1_mic= 0.39145 val_f1_mac= 0.11307 time= 0.02613
Iter: 0018 train_loss= 0.53879 train_f1_mic= 0.42379 train_f1_mac= 0.15027 val_loss= 0.54849 val_f1_mic= 0.39145 val_f1_mac= 0.11307 time= 0.02535
Epoch: 0005
Iter: 0004 train_loss= 0.53738 train_f1_mic= 0.40738 train_f1_mac= 0.12571 val_loss= 0.55530 val_f1_mic= 0.42265 val_f1_mac= 0.14168 time= 0.02486
Iter: 0009 train_loss= 0.52916 train_f1_mic= 0.40208 train_f1_mac= 0.12538 val_loss= 0.55530 val_f1_mic= 0.42265 val_f1_mac= 0.14168 time= 0.02425
Iter: 0014 train_loss= 0.53290 train_f1_mic= 0.41771 train_f1_mac= 0.14624 val_loss= 0.55530 val_f1_mic= 0.42265 val_f1_mac= 0.14168 time= 0.02378
Epoch: 0006
Iter: 0000 train_loss= 0.52264 train_f1_mic= 0.41983 train_f1_mac= 0.14554 val_loss= 0.54307 val_f1_mic= 0.42103 val_f1_mac= 0.14209 time= 0.02360
Iter: 0005 train_loss= 0.54863 train_f1_mic= 0.40491 train_f1_mac= 0.13342 val_loss= 0.54307 val_f1_mic= 0.42103 val_f1_mac= 0.14209 time= 0.02321
Iter: 0010 train_loss= 0.51998 train_f1_mic= 0.41256 train_f1_mac= 0.13002 val_loss= 0.54307 val_f1_mic= 0.42103 val_f1_mac= 0.14209 time= 0.02289
Iter: 0015 train_loss= 0.53324 train_f1_mic= 0.43908 train_f1_mac= 0.16390 val_loss= 0.54307 val_f1_mic= 0.42103 val_f1_mac= 0.14209 time= 0.02266
Epoch: 0007
Iter: 0001 train_loss= 0.53173 train_f1_mic= 0.40946 train_f1_mac= 0.13121 val_loss= 0.55076 val_f1_mic= 0.41588 val_f1_mac= 0.14505 time= 0.02263
Iter: 0006 train_loss= 0.53293 train_f1_mic= 0.44353 train_f1_mac= 0.16600 val_loss= 0.55076 val_f1_mic= 0.41588 val_f1_mac= 0.14505 time= 0.02232
Iter: 0011 train_loss= 0.53013 train_f1_mic= 0.40478 train_f1_mac= 0.13092 val_loss= 0.55076 val_f1_mic= 0.41588 val_f1_mac= 0.14505 time= 0.02199
Iter: 0016 train_loss= 0.52153 train_f1_mic= 0.41270 train_f1_mac= 0.13471 val_loss= 0.55076 val_f1_mic= 0.41588 val_f1_mac= 0.14505 time= 0.02171
Epoch: 0008
Iter: 0002 train_loss= 0.51337 train_f1_mic= 0.43120 train_f1_mac= 0.14454 val_loss= 0.54647 val_f1_mic= 0.41229 val_f1_mac= 0.14007 time= 0.02157
Iter: 0007 train_loss= 0.53503 train_f1_mic= 0.43374 train_f1_mac= 0.16071 val_loss= 0.54647 val_f1_mic= 0.41229 val_f1_mac= 0.14007 time= 0.02130
Iter: 0012 train_loss= 0.53352 train_f1_mic= 0.42594 train_f1_mac= 0.15255 val_loss= 0.54647 val_f1_mic= 0.41229 val_f1_mac= 0.14007 time= 0.02111
Iter: 0017 train_loss= 0.52856 train_f1_mic= 0.42426 train_f1_mac= 0.14566 val_loss= 0.54647 val_f1_mic= 0.41229 val_f1_mac= 0.14007 time= 0.02089
Epoch: 0009
Iter: 0003 train_loss= 0.52894 train_f1_mic= 0.41482 train_f1_mac= 0.14628 val_loss= 0.56740 val_f1_mic= 0.42329 val_f1_mac= 0.16174 time= 0.02091
Iter: 0008 train_loss= 0.53372 train_f1_mic= 0.42678 train_f1_mac= 0.15525 val_loss= 0.56740 val_f1_mic= 0.42329 val_f1_mac= 0.16174 time= 0.02072
Iter: 0013 train_loss= 0.51845 train_f1_mic= 0.43267 train_f1_mac= 0.15499 val_loss= 0.56740 val_f1_mic= 0.42329 val_f1_mac= 0.16174 time= 0.02052
Iter: 0018 train_loss= 0.52705 train_f1_mic= 0.41709 train_f1_mac= 0.14133 val_loss= 0.56740 val_f1_mic= 0.42329 val_f1_mac= 0.16174 time= 0.02031
Epoch: 0010
Iter: 0004 train_loss= 0.52866 train_f1_mic= 0.41545 train_f1_mac= 0.13683 val_loss= 0.55038 val_f1_mic= 0.41721 val_f1_mac= 0.14356 time= 0.02036
Iter: 0009 train_loss= 0.52049 train_f1_mic= 0.42733 train_f1_mac= 0.16125 val_loss= 0.55038 val_f1_mic= 0.41721 val_f1_mac= 0.14356 time= 0.02020
Iter: 0014 train_loss= 0.53541 train_f1_mic= 0.41708 train_f1_mac= 0.14923 val_loss= 0.55038 val_f1_mic= 0.41721 val_f1_mac= 0.14356 time= 0.02004
Optimization Finished!
Full validation stats: loss= 0.54760 f1_micro= 0.41133 f1_macro= 0.14576 time= 0.11270
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4657403373695623
Rewards :  -0.06433220159994169 Accuracy :  0.41427457608960894
Total reward :  1.2724374470312407
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'linear', 3, 'linear']
Training RNN (Reward ip) :  [-0.0643322]
Trial 289: Controller loss : 12807.318359

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [1, 'sigmoid', 3, 'relu']
2018-08-31 00:58:03.073587: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:58:03.074166: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:58:03.074721: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:58:03.075124: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:58:03.075621: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69452 train_f1_mic= 0.39037 train_f1_mac= 0.27102 val_loss= 0.66853 val_f1_mic= 0.39840 val_f1_mac= 0.12554 time= 1.30354
Iter: 0005 train_loss= 0.59581 train_f1_mic= 0.39955 train_f1_mac= 0.09931 val_loss= 0.66853 val_f1_mic= 0.39840 val_f1_mac= 0.12554 time= 0.31848
Iter: 0010 train_loss= 0.56220 train_f1_mic= 0.36314 train_f1_mac= 0.08749 val_loss= 0.66853 val_f1_mic= 0.39840 val_f1_mac= 0.12554 time= 0.22966
Iter: 0015 train_loss= 0.54217 train_f1_mic= 0.36628 train_f1_mac= 0.08618 val_loss= 0.66853 val_f1_mic= 0.39840 val_f1_mac= 0.12554 time= 0.19597
Epoch: 0002
Iter: 0001 train_loss= 0.53353 train_f1_mic= 0.39638 train_f1_mac= 0.09689 val_loss= 0.56014 val_f1_mic= 0.39704 val_f1_mac= 0.10247 time= 0.18032
Iter: 0006 train_loss= 0.54290 train_f1_mic= 0.38258 train_f1_mac= 0.09302 val_loss= 0.56014 val_f1_mic= 0.39704 val_f1_mac= 0.10247 time= 0.16912
Iter: 0011 train_loss= 0.54498 train_f1_mic= 0.36723 train_f1_mac= 0.08754 val_loss= 0.56014 val_f1_mic= 0.39704 val_f1_mac= 0.10247 time= 0.16143
Iter: 0016 train_loss= 0.55546 train_f1_mic= 0.39014 train_f1_mac= 0.10012 val_loss= 0.56014 val_f1_mic= 0.39704 val_f1_mac= 0.10247 time= 0.15585
Epoch: 0003
Iter: 0002 train_loss= 0.53643 train_f1_mic= 0.39909 train_f1_mac= 0.10141 val_loss= 0.57270 val_f1_mic= 0.38555 val_f1_mac= 0.10537 time= 0.15268
Iter: 0007 train_loss= 0.53700 train_f1_mic= 0.37609 train_f1_mac= 0.09103 val_loss= 0.57270 val_f1_mic= 0.38555 val_f1_mac= 0.10537 time= 0.14923
Iter: 0012 train_loss= 0.53612 train_f1_mic= 0.38072 train_f1_mac= 0.09179 val_loss= 0.57270 val_f1_mic= 0.38555 val_f1_mac= 0.10537 time= 0.14662
Iter: 0017 train_loss= 0.54284 train_f1_mic= 0.38571 train_f1_mac= 0.09834 val_loss= 0.57270 val_f1_mic= 0.38555 val_f1_mac= 0.10537 time= 0.14443
Epoch: 0004
Iter: 0003 train_loss= 0.54856 train_f1_mic= 0.37770 train_f1_mac= 0.09695 val_loss= 0.54149 val_f1_mic= 0.38869 val_f1_mac= 0.09941 time= 0.14328
Iter: 0008 train_loss= 0.53502 train_f1_mic= 0.37713 train_f1_mac= 0.09618 val_loss= 0.54149 val_f1_mic= 0.38869 val_f1_mac= 0.09941 time= 0.14168
Iter: 0013 train_loss= 0.53307 train_f1_mic= 0.40383 train_f1_mac= 0.11078 val_loss= 0.54149 val_f1_mic= 0.38869 val_f1_mac= 0.09941 time= 0.14038
Iter: 0018 train_loss= 0.53328 train_f1_mic= 0.39701 train_f1_mac= 0.11085 val_loss= 0.54149 val_f1_mic= 0.38869 val_f1_mac= 0.09941 time= 0.13912
Epoch: 0005
Iter: 0004 train_loss= 0.53353 train_f1_mic= 0.39495 train_f1_mac= 0.11070 val_loss= 0.55386 val_f1_mic= 0.37730 val_f1_mac= 0.10842 time= 0.13859
Iter: 0009 train_loss= 0.53664 train_f1_mic= 0.40372 train_f1_mac= 0.12102 val_loss= 0.55386 val_f1_mic= 0.37730 val_f1_mac= 0.10842 time= 0.13764
Iter: 0014 train_loss= 0.54307 train_f1_mic= 0.41383 train_f1_mac= 0.13219 val_loss= 0.55386 val_f1_mic= 0.37730 val_f1_mac= 0.10842 time= 0.13681
Epoch: 0006
Iter: 0000 train_loss= 0.53051 train_f1_mic= 0.40755 train_f1_mac= 0.12614 val_loss= 0.55666 val_f1_mic= 0.41942 val_f1_mac= 0.13989 time= 0.13643
Iter: 0005 train_loss= 0.52161 train_f1_mic= 0.41700 train_f1_mac= 0.13273 val_loss= 0.55666 val_f1_mic= 0.41942 val_f1_mac= 0.13989 time= 0.13575
Iter: 0010 train_loss= 0.52773 train_f1_mic= 0.41259 train_f1_mac= 0.13370 val_loss= 0.55666 val_f1_mic= 0.41942 val_f1_mac= 0.13989 time= 0.13514
Iter: 0015 train_loss= 0.52734 train_f1_mic= 0.42569 train_f1_mac= 0.14031 val_loss= 0.55666 val_f1_mic= 0.41942 val_f1_mac= 0.13989 time= 0.13454
Epoch: 0007
Iter: 0001 train_loss= 0.52791 train_f1_mic= 0.44388 train_f1_mac= 0.15394 val_loss= 0.53914 val_f1_mic= 0.43853 val_f1_mac= 0.15470 time= 0.13435
Iter: 0006 train_loss= 0.52902 train_f1_mic= 0.40687 train_f1_mac= 0.13030 val_loss= 0.53914 val_f1_mic= 0.43853 val_f1_mac= 0.15470 time= 0.13384
Iter: 0011 train_loss= 0.53104 train_f1_mic= 0.41111 train_f1_mac= 0.13447 val_loss= 0.53914 val_f1_mic= 0.43853 val_f1_mac= 0.15470 time= 0.13337
Iter: 0016 train_loss= 0.52393 train_f1_mic= 0.39144 train_f1_mac= 0.11934 val_loss= 0.53914 val_f1_mic= 0.43853 val_f1_mac= 0.15470 time= 0.13292
Epoch: 0008
Iter: 0002 train_loss= 0.52264 train_f1_mic= 0.41413 train_f1_mac= 0.13425 val_loss= 0.53286 val_f1_mic= 0.44070 val_f1_mac= 0.16707 time= 0.13285
Iter: 0007 train_loss= 0.54255 train_f1_mic= 0.43623 train_f1_mac= 0.15513 val_loss= 0.53286 val_f1_mic= 0.44070 val_f1_mac= 0.16707 time= 0.13248
Iter: 0012 train_loss= 0.52321 train_f1_mic= 0.43090 train_f1_mac= 0.15421 val_loss= 0.53286 val_f1_mic= 0.44070 val_f1_mac= 0.16707 time= 0.13213
Iter: 0017 train_loss= 0.52265 train_f1_mic= 0.44092 train_f1_mac= 0.15642 val_loss= 0.53286 val_f1_mic= 0.44070 val_f1_mac= 0.16707 time= 0.13185
Epoch: 0009
Iter: 0003 train_loss= 0.52947 train_f1_mic= 0.40616 train_f1_mac= 0.13438 val_loss= 0.54681 val_f1_mic= 0.41777 val_f1_mac= 0.14960 time= 0.13182
Iter: 0008 train_loss= 0.52435 train_f1_mic= 0.43813 train_f1_mac= 0.16016 val_loss= 0.54681 val_f1_mic= 0.41777 val_f1_mac= 0.14960 time= 0.13152
Iter: 0013 train_loss= 0.51656 train_f1_mic= 0.43260 train_f1_mac= 0.15447 val_loss= 0.54681 val_f1_mic= 0.41777 val_f1_mac= 0.14960 time= 0.13131
Iter: 0018 train_loss= 0.51730 train_f1_mic= 0.44735 train_f1_mac= 0.16457 val_loss= 0.54681 val_f1_mic= 0.41777 val_f1_mac= 0.14960 time= 0.13111
Epoch: 0010
Iter: 0004 train_loss= 0.52317 train_f1_mic= 0.44270 train_f1_mac= 0.16419 val_loss= 0.53404 val_f1_mic= 0.42893 val_f1_mac= 0.16298 time= 0.13115
Iter: 0009 train_loss= 0.51390 train_f1_mic= 0.40706 train_f1_mac= 0.14213 val_loss= 0.53404 val_f1_mic= 0.42893 val_f1_mac= 0.16298 time= 0.13094
Iter: 0014 train_loss= 0.51486 train_f1_mic= 0.41501 train_f1_mac= 0.14903 val_loss= 0.53404 val_f1_mic= 0.42893 val_f1_mac= 0.16298 time= 0.13075
Optimization Finished!
Full validation stats: loss= 0.53996 f1_micro= 0.48895 f1_macro= 0.21762 time= 0.24435
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4693742321868627
Rewards :  0.018169474086502158 Accuracy :  0.48390981145606443
Total reward :  1.290606921117743
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'sigmoid', 3, 'relu']
Training RNN (Reward ip) :  [0.01816947]
Trial 290: Controller loss : 2817.053955
2018-08-31 00:58:34.981226: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:58:34.981762: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:58:34.982313: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:58:34.982999: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [1, 'sigmoid', 4, 'relu']
2018-08-31 00:58:34.983481: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69369 train_f1_mic= 0.38163 train_f1_mac= 0.24200 val_loss= 0.66351 val_f1_mic= 0.36560 val_f1_mac= 0.09811 time= 1.34045
Iter: 0005 train_loss= 0.59921 train_f1_mic= 0.36299 train_f1_mac= 0.08776 val_loss= 0.66351 val_f1_mic= 0.36560 val_f1_mac= 0.09811 time= 0.32944
Iter: 0010 train_loss= 0.54898 train_f1_mic= 0.39710 train_f1_mac= 0.09748 val_loss= 0.66351 val_f1_mic= 0.36560 val_f1_mac= 0.09811 time= 0.23437
Iter: 0015 train_loss= 0.55068 train_f1_mic= 0.37752 train_f1_mac= 0.09269 val_loss= 0.66351 val_f1_mic= 0.36560 val_f1_mac= 0.09811 time= 0.19903
Epoch: 0002
Iter: 0001 train_loss= 0.54408 train_f1_mic= 0.39604 train_f1_mac= 0.09884 val_loss= 0.58231 val_f1_mic= 0.39802 val_f1_mac= 0.10610 time= 0.18246
Iter: 0006 train_loss= 0.55351 train_f1_mic= 0.36598 train_f1_mac= 0.08879 val_loss= 0.58231 val_f1_mic= 0.39802 val_f1_mac= 0.10610 time= 0.17062
Iter: 0011 train_loss= 0.54788 train_f1_mic= 0.38177 train_f1_mac= 0.09369 val_loss= 0.58231 val_f1_mic= 0.39802 val_f1_mac= 0.10610 time= 0.16282
Iter: 0016 train_loss= 0.54660 train_f1_mic= 0.38411 train_f1_mac= 0.09650 val_loss= 0.58231 val_f1_mic= 0.39802 val_f1_mac= 0.10610 time= 0.15685
Epoch: 0003
Iter: 0002 train_loss= 0.53333 train_f1_mic= 0.39035 train_f1_mac= 0.09275 val_loss= 0.56221 val_f1_mic= 0.36453 val_f1_mac= 0.09300 time= 0.15334
Iter: 0007 train_loss= 0.55436 train_f1_mic= 0.37679 train_f1_mac= 0.09683 val_loss= 0.56221 val_f1_mic= 0.36453 val_f1_mac= 0.09300 time= 0.14981
Iter: 0012 train_loss= 0.54482 train_f1_mic= 0.36864 train_f1_mac= 0.09038 val_loss= 0.56221 val_f1_mic= 0.36453 val_f1_mac= 0.09300 time= 0.14698
Iter: 0017 train_loss= 0.53812 train_f1_mic= 0.38750 train_f1_mac= 0.09341 val_loss= 0.56221 val_f1_mic= 0.36453 val_f1_mac= 0.09300 time= 0.14463
Epoch: 0004
Iter: 0003 train_loss= 0.54385 train_f1_mic= 0.37368 train_f1_mac= 0.09155 val_loss= 0.56313 val_f1_mic= 0.37168 val_f1_mac= 0.09471 time= 0.14330
Iter: 0008 train_loss= 0.54631 train_f1_mic= 0.37137 train_f1_mac= 0.09240 val_loss= 0.56313 val_f1_mic= 0.37168 val_f1_mac= 0.09471 time= 0.14168
Iter: 0013 train_loss= 0.55149 train_f1_mic= 0.38260 train_f1_mac= 0.09812 val_loss= 0.56313 val_f1_mic= 0.37168 val_f1_mac= 0.09471 time= 0.14054
Iter: 0018 train_loss= 0.53510 train_f1_mic= 0.38491 train_f1_mac= 0.09251 val_loss= 0.56313 val_f1_mic= 0.37168 val_f1_mac= 0.09471 time= 0.13937
Epoch: 0005
Iter: 0004 train_loss= 0.54168 train_f1_mic= 0.37792 train_f1_mac= 0.09372 val_loss= 0.54803 val_f1_mic= 0.37222 val_f1_mac= 0.09224 time= 0.13880
Iter: 0009 train_loss= 0.53075 train_f1_mic= 0.39011 train_f1_mac= 0.09838 val_loss= 0.54803 val_f1_mic= 0.37222 val_f1_mac= 0.09224 time= 0.13792
Iter: 0014 train_loss= 0.55045 train_f1_mic= 0.38467 train_f1_mac= 0.10128 val_loss= 0.54803 val_f1_mic= 0.37222 val_f1_mac= 0.09224 time= 0.13707
Epoch: 0006
Iter: 0000 train_loss= 0.54068 train_f1_mic= 0.38991 train_f1_mac= 0.10189 val_loss= 0.56035 val_f1_mic= 0.38095 val_f1_mac= 0.10551 time= 0.13671
Iter: 0005 train_loss= 0.54338 train_f1_mic= 0.38333 train_f1_mac= 0.10376 val_loss= 0.56035 val_f1_mic= 0.38095 val_f1_mac= 0.10551 time= 0.13614
Iter: 0010 train_loss= 0.53941 train_f1_mic= 0.38178 train_f1_mac= 0.10259 val_loss= 0.56035 val_f1_mic= 0.38095 val_f1_mac= 0.10551 time= 0.13548
Iter: 0015 train_loss= 0.53758 train_f1_mic= 0.38763 train_f1_mac= 0.10733 val_loss= 0.56035 val_f1_mic= 0.38095 val_f1_mac= 0.10551 time= 0.13493
Epoch: 0007
Iter: 0001 train_loss= 0.54082 train_f1_mic= 0.40232 train_f1_mac= 0.12088 val_loss= 0.55462 val_f1_mic= 0.39605 val_f1_mac= 0.12063 time= 0.13477
Iter: 0006 train_loss= 0.53959 train_f1_mic= 0.40068 train_f1_mac= 0.11251 val_loss= 0.55462 val_f1_mic= 0.39605 val_f1_mac= 0.12063 time= 0.13428
Iter: 0011 train_loss= 0.54087 train_f1_mic= 0.41275 train_f1_mac= 0.12159 val_loss= 0.55462 val_f1_mic= 0.39605 val_f1_mac= 0.12063 time= 0.13394
Iter: 0016 train_loss= 0.53063 train_f1_mic= 0.38458 train_f1_mac= 0.10348 val_loss= 0.55462 val_f1_mic= 0.39605 val_f1_mac= 0.12063 time= 0.13347
Epoch: 0008
Iter: 0002 train_loss= 0.52569 train_f1_mic= 0.40049 train_f1_mac= 0.11303 val_loss= 0.56676 val_f1_mic= 0.37799 val_f1_mac= 0.11140 time= 0.13340
Iter: 0007 train_loss= 0.53622 train_f1_mic= 0.40437 train_f1_mac= 0.11353 val_loss= 0.56676 val_f1_mic= 0.37799 val_f1_mac= 0.11140 time= 0.13302
Iter: 0012 train_loss= 0.54299 train_f1_mic= 0.39751 train_f1_mac= 0.10922 val_loss= 0.56676 val_f1_mic= 0.37799 val_f1_mac= 0.11140 time= 0.13268
Iter: 0017 train_loss= 0.54421 train_f1_mic= 0.39693 train_f1_mac= 0.11618 val_loss= 0.56676 val_f1_mic= 0.37799 val_f1_mac= 0.11140 time= 0.13237
Epoch: 0009
Iter: 0003 train_loss= 0.52354 train_f1_mic= 0.40439 train_f1_mac= 0.11897 val_loss= 0.54773 val_f1_mic= 0.40205 val_f1_mac= 0.12283 time= 0.13241
Iter: 0008 train_loss= 0.52774 train_f1_mic= 0.40584 train_f1_mac= 0.11792 val_loss= 0.54773 val_f1_mic= 0.40205 val_f1_mac= 0.12283 time= 0.13213
Iter: 0013 train_loss= 0.52910 train_f1_mic= 0.43624 train_f1_mac= 0.13414 val_loss= 0.54773 val_f1_mic= 0.40205 val_f1_mac= 0.12283 time= 0.13184
Iter: 0018 train_loss= 0.53865 train_f1_mic= 0.38294 train_f1_mac= 0.10344 val_loss= 0.54773 val_f1_mic= 0.40205 val_f1_mac= 0.12283 time= 0.13159
Epoch: 0010
Iter: 0004 train_loss= 0.53882 train_f1_mic= 0.38875 train_f1_mac= 0.10676 val_loss= 0.55372 val_f1_mic= 0.38079 val_f1_mac= 0.10325 time= 0.13163
Iter: 0009 train_loss= 0.52912 train_f1_mic= 0.39299 train_f1_mac= 0.11249 val_loss= 0.55372 val_f1_mic= 0.38079 val_f1_mac= 0.10325 time= 0.13140
Iter: 0014 train_loss= 0.53090 train_f1_mic= 0.42086 train_f1_mac= 0.12838 val_loss= 0.55372 val_f1_mic= 0.38079 val_f1_mac= 0.10325 time= 0.13120
Optimization Finished!
Full validation stats: loss= 0.55625 f1_micro= 0.39523 f1_macro= 0.12224 time= 0.26426
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4556063578646928
Rewards :  -0.06883937161084958 Accuracy :  0.4005348605760131
Total reward :  1.2217675495068934
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'sigmoid', 4, 'relu']
Training RNN (Reward ip) :  [-0.06883937]
Trial 291: Controller loss : 8523.127930

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'sigmoid', 0, 'relu']
2018-08-31 00:59:06.786442: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:59:06.786686: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:59:06.786916: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:59:06.787085: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:59:06.787293: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69092 train_f1_mic= 0.31846 train_f1_mac= 0.16329 val_loss= 0.66298 val_f1_mic= 0.34719 val_f1_mac= 0.08864 time= 0.71606
Iter: 0005 train_loss= 0.59615 train_f1_mic= 0.40394 train_f1_mac= 0.10331 val_loss= 0.66298 val_f1_mic= 0.34719 val_f1_mac= 0.08864 time= 0.12948
Iter: 0010 train_loss= 0.55461 train_f1_mic= 0.38791 train_f1_mac= 0.09629 val_loss= 0.66298 val_f1_mic= 0.34719 val_f1_mac= 0.08864 time= 0.07633
Iter: 0015 train_loss= 0.54725 train_f1_mic= 0.36532 train_f1_mac= 0.08677 val_loss= 0.66298 val_f1_mic= 0.34719 val_f1_mac= 0.08864 time= 0.05622
Epoch: 0002
Iter: 0001 train_loss= 0.53180 train_f1_mic= 0.38945 train_f1_mac= 0.09256 val_loss= 0.56784 val_f1_mic= 0.36529 val_f1_mac= 0.09300 time= 0.04630
Iter: 0006 train_loss= 0.54787 train_f1_mic= 0.39041 train_f1_mac= 0.09842 val_loss= 0.56784 val_f1_mic= 0.36529 val_f1_mac= 0.09300 time= 0.03958
Iter: 0011 train_loss= 0.53810 train_f1_mic= 0.38412 train_f1_mac= 0.09242 val_loss= 0.56784 val_f1_mic= 0.36529 val_f1_mac= 0.09300 time= 0.03500
Iter: 0016 train_loss= 0.54290 train_f1_mic= 0.37201 train_f1_mac= 0.08814 val_loss= 0.56784 val_f1_mic= 0.36529 val_f1_mac= 0.09300 time= 0.03188
Epoch: 0003
Iter: 0002 train_loss= 0.55129 train_f1_mic= 0.36465 train_f1_mac= 0.08806 val_loss= 0.57421 val_f1_mic= 0.35645 val_f1_mac= 0.09001 time= 0.02986
Iter: 0007 train_loss= 0.53568 train_f1_mic= 0.37065 train_f1_mac= 0.08666 val_loss= 0.57421 val_f1_mic= 0.35645 val_f1_mac= 0.09001 time= 0.02801
Iter: 0012 train_loss= 0.54463 train_f1_mic= 0.38137 train_f1_mac= 0.09316 val_loss= 0.57421 val_f1_mic= 0.35645 val_f1_mac= 0.09001 time= 0.02639
Iter: 0017 train_loss= 0.53808 train_f1_mic= 0.39411 train_f1_mac= 0.09775 val_loss= 0.57421 val_f1_mic= 0.35645 val_f1_mac= 0.09001 time= 0.02510
Epoch: 0004
Iter: 0003 train_loss= 0.54901 train_f1_mic= 0.36985 train_f1_mac= 0.09149 val_loss= 0.57848 val_f1_mic= 0.36994 val_f1_mac= 0.09895 time= 0.02437
Iter: 0008 train_loss= 0.54151 train_f1_mic= 0.36790 train_f1_mac= 0.08711 val_loss= 0.57848 val_f1_mic= 0.36994 val_f1_mac= 0.09895 time= 0.02348
Iter: 0013 train_loss= 0.54002 train_f1_mic= 0.37148 train_f1_mac= 0.08773 val_loss= 0.57848 val_f1_mic= 0.36994 val_f1_mac= 0.09895 time= 0.02266
Iter: 0018 train_loss= 0.53875 train_f1_mic= 0.40083 train_f1_mac= 0.10457 val_loss= 0.57848 val_f1_mic= 0.36994 val_f1_mac= 0.09895 time= 0.02197
Epoch: 0005
Iter: 0004 train_loss= 0.54164 train_f1_mic= 0.39759 train_f1_mac= 0.10486 val_loss= 0.56611 val_f1_mic= 0.39238 val_f1_mac= 0.10655 time= 0.02163
Iter: 0009 train_loss= 0.54319 train_f1_mic= 0.40568 train_f1_mac= 0.12293 val_loss= 0.56611 val_f1_mic= 0.39238 val_f1_mac= 0.10655 time= 0.02107
Iter: 0014 train_loss= 0.53442 train_f1_mic= 0.37681 train_f1_mac= 0.09958 val_loss= 0.56611 val_f1_mic= 0.39238 val_f1_mac= 0.10655 time= 0.02058
Epoch: 0006
Iter: 0000 train_loss= 0.53389 train_f1_mic= 0.40636 train_f1_mac= 0.11949 val_loss= 0.55005 val_f1_mic= 0.40935 val_f1_mac= 0.12663 time= 0.02036
Iter: 0005 train_loss= 0.52013 train_f1_mic= 0.43286 train_f1_mac= 0.12799 val_loss= 0.55005 val_f1_mic= 0.40935 val_f1_mac= 0.12663 time= 0.01995
Iter: 0010 train_loss= 0.53022 train_f1_mic= 0.39928 train_f1_mac= 0.11026 val_loss= 0.55005 val_f1_mic= 0.40935 val_f1_mac= 0.12663 time= 0.01975
Iter: 0015 train_loss= 0.54998 train_f1_mic= 0.37887 train_f1_mac= 0.11123 val_loss= 0.55005 val_f1_mic= 0.40935 val_f1_mac= 0.12663 time= 0.01941
Epoch: 0007
Iter: 0001 train_loss= 0.53183 train_f1_mic= 0.40328 train_f1_mac= 0.12043 val_loss= 0.55624 val_f1_mic= 0.41199 val_f1_mac= 0.13036 time= 0.01919
Iter: 0006 train_loss= 0.52638 train_f1_mic= 0.38989 train_f1_mac= 0.10532 val_loss= 0.55624 val_f1_mic= 0.41199 val_f1_mac= 0.13036 time= 0.01886
Iter: 0011 train_loss= 0.52782 train_f1_mic= 0.42750 train_f1_mac= 0.13008 val_loss= 0.55624 val_f1_mic= 0.41199 val_f1_mac= 0.13036 time= 0.01855
Iter: 0016 train_loss= 0.53271 train_f1_mic= 0.41053 train_f1_mac= 0.12595 val_loss= 0.55624 val_f1_mic= 0.41199 val_f1_mac= 0.13036 time= 0.01833
Epoch: 0008
Iter: 0002 train_loss= 0.52425 train_f1_mic= 0.41061 train_f1_mac= 0.12480 val_loss= 0.55682 val_f1_mic= 0.40618 val_f1_mac= 0.13335 time= 0.01831
Iter: 0007 train_loss= 0.53757 train_f1_mic= 0.41735 train_f1_mac= 0.13175 val_loss= 0.55682 val_f1_mic= 0.40618 val_f1_mac= 0.13335 time= 0.01811
Iter: 0012 train_loss= 0.52711 train_f1_mic= 0.41000 train_f1_mac= 0.12599 val_loss= 0.55682 val_f1_mic= 0.40618 val_f1_mac= 0.13335 time= 0.01788
Iter: 0017 train_loss= 0.51484 train_f1_mic= 0.40448 train_f1_mac= 0.11860 val_loss= 0.55682 val_f1_mic= 0.40618 val_f1_mac= 0.13335 time= 0.01765
Epoch: 0009
Iter: 0003 train_loss= 0.52942 train_f1_mic= 0.41461 train_f1_mac= 0.12827 val_loss= 0.55308 val_f1_mic= 0.42673 val_f1_mac= 0.13922 time= 0.01753
Iter: 0008 train_loss= 0.52385 train_f1_mic= 0.40743 train_f1_mac= 0.12259 val_loss= 0.55308 val_f1_mic= 0.42673 val_f1_mac= 0.13922 time= 0.01742
Iter: 0013 train_loss= 0.53468 train_f1_mic= 0.42267 train_f1_mac= 0.13764 val_loss= 0.55308 val_f1_mic= 0.42673 val_f1_mac= 0.13922 time= 0.01729
Iter: 0018 train_loss= 0.53007 train_f1_mic= 0.42492 train_f1_mac= 0.13581 val_loss= 0.55308 val_f1_mic= 0.42673 val_f1_mac= 0.13922 time= 0.01718
Epoch: 0010
Iter: 0004 train_loss= 0.53006 train_f1_mic= 0.40275 train_f1_mac= 0.12355 val_loss= 0.54820 val_f1_mic= 0.41225 val_f1_mac= 0.13603 time= 0.01710
Iter: 0009 train_loss= 0.52515 train_f1_mic= 0.41972 train_f1_mac= 0.13419 val_loss= 0.54820 val_f1_mic= 0.41225 val_f1_mac= 0.13603 time= 0.01693
Iter: 0014 train_loss= 0.52491 train_f1_mic= 0.43195 train_f1_mac= 0.14537 val_loss= 0.54820 val_f1_mic= 0.41225 val_f1_mac= 0.13603 time= 0.01678
Optimization Finished!
Full validation stats: loss= 0.54814 f1_micro= 0.41812 f1_macro= 0.14432 time= 0.11167
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.44970336648703435
Rewards :  -0.029514956888292032 Accuracy :  0.42609140097640075
Total reward :  1.1922525926186014
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'sigmoid', 0, 'relu']
Training RNN (Reward ip) :  [-0.02951496]
Trial 292: Controller loss : 5773.506348

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 4, 'relu']
2018-08-31 00:59:15.021162: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:59:15.022062: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:59:15.022918: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:59:15.023550: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:59:15.024358: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69621 train_f1_mic= 0.31104 train_f1_mac= 0.22768 val_loss= 0.66877 val_f1_mic= 0.35056 val_f1_mac= 0.09632 time= 0.81518
Iter: 0005 train_loss= 0.58884 train_f1_mic= 0.37748 train_f1_mac= 0.09233 val_loss= 0.66877 val_f1_mic= 0.35056 val_f1_mac= 0.09632 time= 0.18589
Iter: 0010 train_loss= 0.54930 train_f1_mic= 0.37707 train_f1_mac= 0.09153 val_loss= 0.66877 val_f1_mic= 0.35056 val_f1_mac= 0.09632 time= 0.12896
Iter: 0015 train_loss= 0.54687 train_f1_mic= 0.38412 train_f1_mac= 0.09379 val_loss= 0.66877 val_f1_mic= 0.35056 val_f1_mac= 0.09632 time= 0.10742
Epoch: 0002
Iter: 0001 train_loss= 0.54541 train_f1_mic= 0.37985 train_f1_mac= 0.09260 val_loss= 0.57819 val_f1_mic= 0.37507 val_f1_mac= 0.09733 time= 0.09719
Iter: 0006 train_loss= 0.54832 train_f1_mic= 0.38344 train_f1_mac= 0.09402 val_loss= 0.57819 val_f1_mic= 0.37507 val_f1_mac= 0.09733 time= 0.09008
Iter: 0011 train_loss= 0.54147 train_f1_mic= 0.39049 train_f1_mac= 0.09712 val_loss= 0.57819 val_f1_mic= 0.37507 val_f1_mac= 0.09733 time= 0.08520
Iter: 0016 train_loss= 0.53763 train_f1_mic= 0.36836 train_f1_mac= 0.08605 val_loss= 0.57819 val_f1_mic= 0.37507 val_f1_mac= 0.09733 time= 0.08171
Epoch: 0003
Iter: 0002 train_loss= 0.53142 train_f1_mic= 0.37150 train_f1_mac= 0.08595 val_loss= 0.56873 val_f1_mic= 0.35205 val_f1_mac= 0.08789 time= 0.07952
Iter: 0007 train_loss= 0.53696 train_f1_mic= 0.38433 train_f1_mac= 0.09239 val_loss= 0.56873 val_f1_mic= 0.35205 val_f1_mac= 0.08789 time= 0.07743
Iter: 0012 train_loss= 0.54487 train_f1_mic= 0.38564 train_f1_mac= 0.09685 val_loss= 0.56873 val_f1_mic= 0.35205 val_f1_mac= 0.08789 time= 0.07568
Iter: 0017 train_loss= 0.53619 train_f1_mic= 0.39683 train_f1_mac= 0.09767 val_loss= 0.56873 val_f1_mic= 0.35205 val_f1_mac= 0.08789 time= 0.07432
Epoch: 0004
Iter: 0003 train_loss= 0.55037 train_f1_mic= 0.37465 train_f1_mac= 0.09301 val_loss= 0.57039 val_f1_mic= 0.36270 val_f1_mac= 0.09221 time= 0.07373
Iter: 0008 train_loss= 0.55246 train_f1_mic= 0.36930 train_f1_mac= 0.08922 val_loss= 0.57039 val_f1_mic= 0.36270 val_f1_mac= 0.09221 time= 0.07270
Iter: 0013 train_loss= 0.54222 train_f1_mic= 0.36880 train_f1_mac= 0.08726 val_loss= 0.57039 val_f1_mic= 0.36270 val_f1_mac= 0.09221 time= 0.07180
Iter: 0018 train_loss= 0.54189 train_f1_mic= 0.39292 train_f1_mac= 0.09850 val_loss= 0.57039 val_f1_mic= 0.36270 val_f1_mac= 0.09221 time= 0.07101
Epoch: 0005
Iter: 0004 train_loss= 0.53303 train_f1_mic= 0.38270 train_f1_mac= 0.09301 val_loss= 0.55128 val_f1_mic= 0.37699 val_f1_mac= 0.09478 time= 0.07060
Iter: 0009 train_loss= 0.54200 train_f1_mic= 0.37879 train_f1_mac= 0.09261 val_loss= 0.55128 val_f1_mic= 0.37699 val_f1_mac= 0.09478 time= 0.06999
Iter: 0014 train_loss= 0.54223 train_f1_mic= 0.37763 train_f1_mac= 0.09657 val_loss= 0.55128 val_f1_mic= 0.37699 val_f1_mac= 0.09478 time= 0.06943
Epoch: 0006
Iter: 0000 train_loss= 0.53108 train_f1_mic= 0.38735 train_f1_mac= 0.09408 val_loss= 0.55163 val_f1_mic= 0.37663 val_f1_mac= 0.09801 time= 0.06918
Iter: 0005 train_loss= 0.54665 train_f1_mic= 0.38214 train_f1_mac= 0.09839 val_loss= 0.55163 val_f1_mic= 0.37663 val_f1_mac= 0.09801 time= 0.06873
Iter: 0010 train_loss= 0.54844 train_f1_mic= 0.39214 train_f1_mac= 0.10791 val_loss= 0.55163 val_f1_mic= 0.37663 val_f1_mac= 0.09801 time= 0.06845
Iter: 0015 train_loss= 0.53218 train_f1_mic= 0.39884 train_f1_mac= 0.10830 val_loss= 0.55163 val_f1_mic= 0.37663 val_f1_mac= 0.09801 time= 0.06813
Epoch: 0007
Iter: 0001 train_loss= 0.54797 train_f1_mic= 0.39046 train_f1_mac= 0.11365 val_loss= 0.56463 val_f1_mic= 0.37963 val_f1_mac= 0.11306 time= 0.06798
Iter: 0006 train_loss= 0.53494 train_f1_mic= 0.41239 train_f1_mac= 0.11958 val_loss= 0.56463 val_f1_mic= 0.37963 val_f1_mac= 0.11306 time= 0.06775
Iter: 0011 train_loss= 0.54629 train_f1_mic= 0.40550 train_f1_mac= 0.11674 val_loss= 0.56463 val_f1_mic= 0.37963 val_f1_mac= 0.11306 time= 0.06749
Iter: 0016 train_loss= 0.53394 train_f1_mic= 0.38850 train_f1_mac= 0.10509 val_loss= 0.56463 val_f1_mic= 0.37963 val_f1_mac= 0.11306 time= 0.06723
Epoch: 0008
Iter: 0002 train_loss= 0.53011 train_f1_mic= 0.42429 train_f1_mac= 0.13007 val_loss= 0.55474 val_f1_mic= 0.42327 val_f1_mac= 0.13664 time= 0.06714
Iter: 0007 train_loss= 0.53148 train_f1_mic= 0.43197 train_f1_mac= 0.13322 val_loss= 0.55474 val_f1_mic= 0.42327 val_f1_mac= 0.13664 time= 0.06693
Iter: 0012 train_loss= 0.52144 train_f1_mic= 0.41410 train_f1_mac= 0.12085 val_loss= 0.55474 val_f1_mic= 0.42327 val_f1_mac= 0.13664 time= 0.06670
Iter: 0017 train_loss= 0.53278 train_f1_mic= 0.38951 train_f1_mac= 0.11135 val_loss= 0.55474 val_f1_mic= 0.42327 val_f1_mac= 0.13664 time= 0.06651
Epoch: 0009
Iter: 0003 train_loss= 0.52036 train_f1_mic= 0.41437 train_f1_mac= 0.12549 val_loss= 0.54930 val_f1_mic= 0.40170 val_f1_mac= 0.12711 time= 0.06646
Iter: 0008 train_loss= 0.52893 train_f1_mic= 0.42892 train_f1_mac= 0.13708 val_loss= 0.54930 val_f1_mic= 0.40170 val_f1_mac= 0.12711 time= 0.06627
Iter: 0013 train_loss= 0.52049 train_f1_mic= 0.42606 train_f1_mac= 0.14775 val_loss= 0.54930 val_f1_mic= 0.40170 val_f1_mac= 0.12711 time= 0.06611
Iter: 0018 train_loss= 0.53514 train_f1_mic= 0.45864 train_f1_mac= 0.18158 val_loss= 0.54930 val_f1_mic= 0.40170 val_f1_mac= 0.12711 time= 0.06594
Epoch: 0010
Iter: 0004 train_loss= 0.52924 train_f1_mic= 0.46332 train_f1_mac= 0.17512 val_loss= 0.54548 val_f1_mic= 0.39735 val_f1_mac= 0.13100 time= 0.06594
Iter: 0009 train_loss= 0.53777 train_f1_mic= 0.43869 train_f1_mac= 0.17260 val_loss= 0.54548 val_f1_mic= 0.39735 val_f1_mac= 0.13100 time= 0.06579
Iter: 0014 train_loss= 0.52957 train_f1_mic= 0.42099 train_f1_mac= 0.13528 val_loss= 0.54548 val_f1_mic= 0.39735 val_f1_mac= 0.13100 time= 0.06564
Optimization Finished!
Full validation stats: loss= 0.53986 f1_micro= 0.43176 f1_macro= 0.17103 time= 0.11671
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4440980529139107
Rewards :  -0.028026567865618468 Accuracy :  0.4216767986214159
Total reward :  1.164226024752983
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 4, 'relu']
Training RNN (Reward ip) :  [-0.02802657]
Trial 293: Controller loss : 13792.708984

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [4, 'relu', 3, 'sigmoid']
2018-08-31 00:59:32.610774: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:59:32.611350: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:59:32.611929: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:59:32.612335: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:59:32.612843: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69283 train_f1_mic= 0.34880 train_f1_mac= 0.20917 val_loss= 0.65500 val_f1_mic= 0.38963 val_f1_mac= 0.10458 time= 0.74355
Iter: 0005 train_loss= 0.57540 train_f1_mic= 0.37241 train_f1_mac= 0.09263 val_loss= 0.65500 val_f1_mic= 0.38963 val_f1_mac= 0.10458 time= 0.13640
Iter: 0010 train_loss= 0.53293 train_f1_mic= 0.38872 train_f1_mac= 0.09176 val_loss= 0.65500 val_f1_mic= 0.38963 val_f1_mac= 0.10458 time= 0.08229
Iter: 0015 train_loss= 0.54182 train_f1_mic= 0.40441 train_f1_mac= 0.10307 val_loss= 0.65500 val_f1_mic= 0.38963 val_f1_mac= 0.10458 time= 0.06181
Epoch: 0002
Iter: 0001 train_loss= 0.53887 train_f1_mic= 0.38509 train_f1_mac= 0.09266 val_loss= 0.56203 val_f1_mic= 0.37323 val_f1_mac= 0.09420 time= 0.05212
Iter: 0006 train_loss= 0.55150 train_f1_mic= 0.36536 train_f1_mac= 0.08802 val_loss= 0.56203 val_f1_mic= 0.37323 val_f1_mac= 0.09420 time= 0.04532
Iter: 0011 train_loss= 0.54238 train_f1_mic= 0.39725 train_f1_mac= 0.10284 val_loss= 0.56203 val_f1_mic= 0.37323 val_f1_mac= 0.09420 time= 0.04059
Iter: 0016 train_loss= 0.54218 train_f1_mic= 0.38249 train_f1_mac= 0.09638 val_loss= 0.56203 val_f1_mic= 0.37323 val_f1_mac= 0.09420 time= 0.03711
Epoch: 0003
Iter: 0002 train_loss= 0.53088 train_f1_mic= 0.38578 train_f1_mac= 0.09221 val_loss= 0.54979 val_f1_mic= 0.37000 val_f1_mac= 0.09163 time= 0.03536
Iter: 0007 train_loss= 0.53243 train_f1_mic= 0.38967 train_f1_mac= 0.10266 val_loss= 0.54979 val_f1_mic= 0.37000 val_f1_mac= 0.09163 time= 0.03316
Iter: 0012 train_loss= 0.52594 train_f1_mic= 0.40277 train_f1_mac= 0.11077 val_loss= 0.54979 val_f1_mic= 0.37000 val_f1_mac= 0.09163 time= 0.03148
Iter: 0017 train_loss= 0.54785 train_f1_mic= 0.40976 train_f1_mac= 0.12810 val_loss= 0.54979 val_f1_mic= 0.37000 val_f1_mac= 0.09163 time= 0.03009
Epoch: 0004
Iter: 0003 train_loss= 0.54204 train_f1_mic= 0.42700 train_f1_mac= 0.13411 val_loss= 0.56806 val_f1_mic= 0.40947 val_f1_mac= 0.13447 time= 0.02944
Iter: 0008 train_loss= 0.54203 train_f1_mic= 0.40150 train_f1_mac= 0.12341 val_loss= 0.56806 val_f1_mic= 0.40947 val_f1_mac= 0.13447 time= 0.02853
Iter: 0013 train_loss= 0.53266 train_f1_mic= 0.40020 train_f1_mac= 0.11938 val_loss= 0.56806 val_f1_mic= 0.40947 val_f1_mac= 0.13447 time= 0.02768
Iter: 0018 train_loss= 0.53281 train_f1_mic= 0.41882 train_f1_mac= 0.13131 val_loss= 0.56806 val_f1_mic= 0.40947 val_f1_mac= 0.13447 time= 0.02682
Epoch: 0005
Iter: 0004 train_loss= 0.51075 train_f1_mic= 0.41861 train_f1_mac= 0.12775 val_loss= 0.55401 val_f1_mic= 0.43034 val_f1_mac= 0.14512 time= 0.02630
Iter: 0009 train_loss= 0.52898 train_f1_mic= 0.42548 train_f1_mac= 0.13962 val_loss= 0.55401 val_f1_mic= 0.43034 val_f1_mac= 0.14512 time= 0.02571
Iter: 0014 train_loss= 0.53325 train_f1_mic= 0.40832 train_f1_mac= 0.13376 val_loss= 0.55401 val_f1_mic= 0.43034 val_f1_mac= 0.14512 time= 0.02516
Epoch: 0006
Iter: 0000 train_loss= 0.53116 train_f1_mic= 0.42977 train_f1_mac= 0.15011 val_loss= 0.55765 val_f1_mic= 0.43341 val_f1_mac= 0.15811 time= 0.02478
Iter: 0005 train_loss= 0.52985 train_f1_mic= 0.42032 train_f1_mac= 0.14426 val_loss= 0.55765 val_f1_mic= 0.43341 val_f1_mac= 0.15811 time= 0.02439
Iter: 0010 train_loss= 0.52855 train_f1_mic= 0.43031 train_f1_mac= 0.15438 val_loss= 0.55765 val_f1_mic= 0.43341 val_f1_mac= 0.15811 time= 0.02404
Iter: 0015 train_loss= 0.51946 train_f1_mic= 0.44028 train_f1_mac= 0.17431 val_loss= 0.55765 val_f1_mic= 0.43341 val_f1_mac= 0.15811 time= 0.02367
Epoch: 0007
Iter: 0001 train_loss= 0.52181 train_f1_mic= 0.44343 train_f1_mac= 0.16706 val_loss= 0.55845 val_f1_mic= 0.43406 val_f1_mac= 0.17407 time= 0.02361
Iter: 0006 train_loss= 0.52042 train_f1_mic= 0.42672 train_f1_mac= 0.16134 val_loss= 0.55845 val_f1_mic= 0.43406 val_f1_mac= 0.17407 time= 0.02335
Iter: 0011 train_loss= 0.51377 train_f1_mic= 0.45674 train_f1_mac= 0.18472 val_loss= 0.55845 val_f1_mic= 0.43406 val_f1_mac= 0.17407 time= 0.02314
Iter: 0016 train_loss= 0.51949 train_f1_mic= 0.46326 train_f1_mac= 0.19309 val_loss= 0.55845 val_f1_mic= 0.43406 val_f1_mac= 0.17407 time= 0.02282
Epoch: 0008
Iter: 0002 train_loss= 0.51426 train_f1_mic= 0.45532 train_f1_mac= 0.19175 val_loss= 0.54208 val_f1_mic= 0.42609 val_f1_mac= 0.17054 time= 0.02276
Iter: 0007 train_loss= 0.51312 train_f1_mic= 0.44597 train_f1_mac= 0.18799 val_loss= 0.54208 val_f1_mic= 0.42609 val_f1_mac= 0.17054 time= 0.02257
Iter: 0012 train_loss= 0.52837 train_f1_mic= 0.45474 train_f1_mac= 0.18525 val_loss= 0.54208 val_f1_mic= 0.42609 val_f1_mac= 0.17054 time= 0.02242
Iter: 0017 train_loss= 0.51903 train_f1_mic= 0.44259 train_f1_mac= 0.17764 val_loss= 0.54208 val_f1_mic= 0.42609 val_f1_mac= 0.17054 time= 0.02218
Epoch: 0009
Iter: 0003 train_loss= 0.51186 train_f1_mic= 0.45069 train_f1_mac= 0.19083 val_loss= 0.54039 val_f1_mic= 0.43618 val_f1_mac= 0.17950 time= 0.02210
Iter: 0008 train_loss= 0.50242 train_f1_mic= 0.45086 train_f1_mac= 0.18559 val_loss= 0.54039 val_f1_mic= 0.43618 val_f1_mac= 0.17950 time= 0.02192
Iter: 0013 train_loss= 0.51844 train_f1_mic= 0.44151 train_f1_mac= 0.18103 val_loss= 0.54039 val_f1_mic= 0.43618 val_f1_mac= 0.17950 time= 0.02169
Iter: 0018 train_loss= 0.52247 train_f1_mic= 0.47989 train_f1_mac= 0.22584 val_loss= 0.54039 val_f1_mic= 0.43618 val_f1_mac= 0.17950 time= 0.02154
Epoch: 0010
Iter: 0004 train_loss= 0.49681 train_f1_mic= 0.46130 train_f1_mac= 0.20274 val_loss= 0.52136 val_f1_mic= 0.45585 val_f1_mac= 0.20384 time= 0.02157
Iter: 0009 train_loss= 0.51671 train_f1_mic= 0.45308 train_f1_mac= 0.20446 val_loss= 0.52136 val_f1_mic= 0.45585 val_f1_mac= 0.20384 time= 0.02141
Iter: 0014 train_loss= 0.51312 train_f1_mic= 0.46272 train_f1_mac= 0.20839 val_loss= 0.52136 val_f1_mic= 0.45585 val_f1_mac= 0.20384 time= 0.02128
Optimization Finished!
Full validation stats: loss= 0.52809 f1_micro= 0.46458 f1_macro= 0.21651 time= 0.10772
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.44846843091579797
Rewards :  0.021851890009436215 Accuracy :  0.4659499429233469
Total reward :  1.1860779147624192
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'relu', 3, 'sigmoid']
Training RNN (Reward ip) :  [0.02185189]
Trial 294: Controller loss : 4577.807129

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 0. 5.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 00:59:42.487815: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:59:42.488183: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:59:42.488548: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:59:42.488812: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:59:42.489135: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69289 train_f1_mic= 0.35504 train_f1_mac= 0.29267 val_loss= 0.66506 val_f1_mic= 0.38453 val_f1_mac= 0.10986 time= 0.75299
Iter: 0005 train_loss= 0.59456 train_f1_mic= 0.37051 train_f1_mac= 0.08802 val_loss= 0.66506 val_f1_mic= 0.38453 val_f1_mac= 0.10986 time= 0.13862
Iter: 0010 train_loss= 0.55715 train_f1_mic= 0.37833 train_f1_mac= 0.09342 val_loss= 0.66506 val_f1_mic= 0.38453 val_f1_mac= 0.10986 time= 0.08332
Iter: 0015 train_loss= 0.53891 train_f1_mic= 0.39949 train_f1_mac= 0.10119 val_loss= 0.66506 val_f1_mic= 0.38453 val_f1_mac= 0.10986 time= 0.06220
Epoch: 0002
Iter: 0001 train_loss= 0.54313 train_f1_mic= 0.41003 train_f1_mac= 0.11065 val_loss= 0.56283 val_f1_mic= 0.39524 val_f1_mac= 0.11098 time= 0.05247
Iter: 0006 train_loss= 0.53646 train_f1_mic= 0.39903 train_f1_mac= 0.10186 val_loss= 0.56283 val_f1_mic= 0.39524 val_f1_mac= 0.11098 time= 0.04526
Iter: 0011 train_loss= 0.53956 train_f1_mic= 0.37612 train_f1_mac= 0.09452 val_loss= 0.56283 val_f1_mic= 0.39524 val_f1_mac= 0.11098 time= 0.04047
Iter: 0016 train_loss= 0.53215 train_f1_mic= 0.38438 train_f1_mac= 0.09840 val_loss= 0.56283 val_f1_mic= 0.39524 val_f1_mac= 0.11098 time= 0.03715
Epoch: 0003
Iter: 0002 train_loss= 0.53582 train_f1_mic= 0.38548 train_f1_mac= 0.10668 val_loss= 0.56128 val_f1_mic= 0.37374 val_f1_mac= 0.10824 time= 0.03532
Iter: 0007 train_loss= 0.53512 train_f1_mic= 0.41530 train_f1_mac= 0.12608 val_loss= 0.56128 val_f1_mic= 0.37374 val_f1_mac= 0.10824 time= 0.03330
Iter: 0012 train_loss= 0.52649 train_f1_mic= 0.42302 train_f1_mac= 0.12850 val_loss= 0.56128 val_f1_mic= 0.37374 val_f1_mac= 0.10824 time= 0.03162
Iter: 0017 train_loss= 0.54211 train_f1_mic= 0.39553 train_f1_mac= 0.11999 val_loss= 0.56128 val_f1_mic= 0.37374 val_f1_mac= 0.10824 time= 0.03013
Epoch: 0004
Iter: 0003 train_loss= 0.52685 train_f1_mic= 0.42503 train_f1_mac= 0.13490 val_loss= 0.54386 val_f1_mic= 0.41361 val_f1_mac= 0.13231 time= 0.02946
Iter: 0008 train_loss= 0.52438 train_f1_mic= 0.41329 train_f1_mac= 0.12995 val_loss= 0.54386 val_f1_mic= 0.41361 val_f1_mac= 0.13231 time= 0.02854
Iter: 0013 train_loss= 0.52880 train_f1_mic= 0.43378 train_f1_mac= 0.14753 val_loss= 0.54386 val_f1_mic= 0.41361 val_f1_mac= 0.13231 time= 0.02771
Iter: 0018 train_loss= 0.51910 train_f1_mic= 0.42581 train_f1_mac= 0.14340 val_loss= 0.54386 val_f1_mic= 0.41361 val_f1_mac= 0.13231 time= 0.02691
Epoch: 0005
Iter: 0004 train_loss= 0.51821 train_f1_mic= 0.42484 train_f1_mac= 0.14622 val_loss= 0.55030 val_f1_mic= 0.40794 val_f1_mac= 0.14254 time= 0.02651
Iter: 0009 train_loss= 0.52777 train_f1_mic= 0.43136 train_f1_mac= 0.16011 val_loss= 0.55030 val_f1_mic= 0.40794 val_f1_mac= 0.14254 time= 0.02583
Iter: 0014 train_loss= 0.51822 train_f1_mic= 0.44212 train_f1_mac= 0.16205 val_loss= 0.55030 val_f1_mic= 0.40794 val_f1_mac= 0.14254 time= 0.02530
Epoch: 0006
Iter: 0000 train_loss= 0.52382 train_f1_mic= 0.46617 train_f1_mac= 0.19209 val_loss= 0.53604 val_f1_mic= 0.48444 val_f1_mac= 0.21463 time= 0.02499
Iter: 0005 train_loss= 0.50823 train_f1_mic= 0.43238 train_f1_mac= 0.16073 val_loss= 0.53604 val_f1_mic= 0.48444 val_f1_mac= 0.21463 time= 0.02453
Iter: 0010 train_loss= 0.51438 train_f1_mic= 0.47825 train_f1_mac= 0.20279 val_loss= 0.53604 val_f1_mic= 0.48444 val_f1_mac= 0.21463 time= 0.02417
Iter: 0015 train_loss= 0.50329 train_f1_mic= 0.45261 train_f1_mac= 0.18354 val_loss= 0.53604 val_f1_mic= 0.48444 val_f1_mac= 0.21463 time= 0.02376
Epoch: 0007
Iter: 0001 train_loss= 0.51117 train_f1_mic= 0.44940 train_f1_mac= 0.18367 val_loss= 0.51756 val_f1_mic= 0.46965 val_f1_mac= 0.20106 time= 0.02350
Iter: 0006 train_loss= 0.51658 train_f1_mic= 0.45209 train_f1_mac= 0.18518 val_loss= 0.51756 val_f1_mic= 0.46965 val_f1_mac= 0.20106 time= 0.02314
Iter: 0011 train_loss= 0.51844 train_f1_mic= 0.46491 train_f1_mac= 0.20296 val_loss= 0.51756 val_f1_mic= 0.46965 val_f1_mac= 0.20106 time= 0.02282
Iter: 0016 train_loss= 0.51495 train_f1_mic= 0.44131 train_f1_mac= 0.18664 val_loss= 0.51756 val_f1_mic= 0.46965 val_f1_mac= 0.20106 time= 0.02250
Epoch: 0008
Iter: 0002 train_loss= 0.51011 train_f1_mic= 0.46764 train_f1_mac= 0.20939 val_loss= 0.52179 val_f1_mic= 0.47424 val_f1_mac= 0.22625 time= 0.02237
Iter: 0007 train_loss= 0.51595 train_f1_mic= 0.46424 train_f1_mac= 0.21565 val_loss= 0.52179 val_f1_mic= 0.47424 val_f1_mac= 0.22625 time= 0.02215
Iter: 0012 train_loss= 0.51495 train_f1_mic= 0.44459 train_f1_mac= 0.21120 val_loss= 0.52179 val_f1_mic= 0.47424 val_f1_mac= 0.22625 time= 0.02190
Iter: 0017 train_loss= 0.49955 train_f1_mic= 0.49245 train_f1_mac= 0.24342 val_loss= 0.52179 val_f1_mic= 0.47424 val_f1_mac= 0.22625 time= 0.02166
Epoch: 0009
Iter: 0003 train_loss= 0.51316 train_f1_mic= 0.45619 train_f1_mac= 0.20462 val_loss= 0.51122 val_f1_mic= 0.47888 val_f1_mac= 0.22903 time= 0.02153
Iter: 0008 train_loss= 0.50418 train_f1_mic= 0.47652 train_f1_mac= 0.22330 val_loss= 0.51122 val_f1_mic= 0.47888 val_f1_mac= 0.22903 time= 0.02134
Iter: 0013 train_loss= 0.50126 train_f1_mic= 0.49302 train_f1_mac= 0.24125 val_loss= 0.51122 val_f1_mic= 0.47888 val_f1_mac= 0.22903 time= 0.02116
Iter: 0018 train_loss= 0.50487 train_f1_mic= 0.48717 train_f1_mac= 0.25909 val_loss= 0.51122 val_f1_mic= 0.47888 val_f1_mac= 0.22903 time= 0.02105
Epoch: 0010
Iter: 0004 train_loss= 0.48946 train_f1_mic= 0.49051 train_f1_mac= 0.25639 val_loss= 0.51532 val_f1_mic= 0.44652 val_f1_mac= 0.21725 time= 0.02101
Iter: 0009 train_loss= 0.50935 train_f1_mic= 0.47368 train_f1_mac= 0.24014 val_loss= 0.51532 val_f1_mic= 0.44652 val_f1_mac= 0.21725 time= 0.02087
Iter: 0014 train_loss= 0.51352 train_f1_mic= 0.48867 train_f1_mac= 0.24925 val_loss= 0.51532 val_f1_mic= 0.44652 val_f1_mac= 0.21725 time= 0.02078
Optimization Finished!
Full validation stats: loss= 0.51487 f1_micro= 0.50047 f1_macro= 0.27688 time= 0.11765
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4574895171079868
Rewards :  0.045105430960944104 Accuracy :  0.49357386187674207
Total reward :  1.2311833457233634
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.04510543]
Trial 295: Controller loss : 126.917351

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'sigmoid', 4, 'sigmoid']
2018-08-31 00:59:52.215645: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 00:59:52.215886: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 00:59:52.216117: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 00:59:52.216288: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 00:59:52.216501: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69493 train_f1_mic= 0.33307 train_f1_mac= 0.19998 val_loss= 0.65555 val_f1_mic= 0.35351 val_f1_mac= 0.08917 time= 0.81985
Iter: 0005 train_loss= 0.57222 train_f1_mic= 0.39028 train_f1_mac= 0.09707 val_loss= 0.65555 val_f1_mic= 0.35351 val_f1_mac= 0.08917 time= 0.18766
Iter: 0010 train_loss= 0.54194 train_f1_mic= 0.38124 train_f1_mac= 0.09156 val_loss= 0.65555 val_f1_mic= 0.35351 val_f1_mac= 0.08917 time= 0.13001
Iter: 0015 train_loss= 0.55943 train_f1_mic= 0.37828 train_f1_mac= 0.09417 val_loss= 0.65555 val_f1_mic= 0.35351 val_f1_mac= 0.08917 time= 0.10809
Epoch: 0002
Iter: 0001 train_loss= 0.54833 train_f1_mic= 0.38826 train_f1_mac= 0.09784 val_loss= 0.57153 val_f1_mic= 0.37897 val_f1_mac= 0.09982 time= 0.09759
Iter: 0006 train_loss= 0.54587 train_f1_mic= 0.40317 train_f1_mac= 0.10371 val_loss= 0.57153 val_f1_mic= 0.37897 val_f1_mac= 0.09982 time= 0.09049
Iter: 0011 train_loss= 0.53573 train_f1_mic= 0.37416 train_f1_mac= 0.08709 val_loss= 0.57153 val_f1_mic= 0.37897 val_f1_mac= 0.09982 time= 0.08571
Iter: 0016 train_loss= 0.54151 train_f1_mic= 0.39274 train_f1_mac= 0.09780 val_loss= 0.57153 val_f1_mic= 0.37897 val_f1_mac= 0.09982 time= 0.08211
Epoch: 0003
Iter: 0002 train_loss= 0.53269 train_f1_mic= 0.40874 train_f1_mac= 0.10214 val_loss= 0.57053 val_f1_mic= 0.38981 val_f1_mac= 0.10572 time= 0.07993
Iter: 0007 train_loss= 0.54042 train_f1_mic= 0.37330 train_f1_mac= 0.08807 val_loss= 0.57053 val_f1_mic= 0.38981 val_f1_mac= 0.10572 time= 0.07779
Iter: 0012 train_loss= 0.53574 train_f1_mic= 0.38706 train_f1_mac= 0.09277 val_loss= 0.57053 val_f1_mic= 0.38981 val_f1_mac= 0.10572 time= 0.07615
Iter: 0017 train_loss= 0.55073 train_f1_mic= 0.37743 train_f1_mac= 0.09333 val_loss= 0.57053 val_f1_mic= 0.38981 val_f1_mac= 0.10572 time= 0.07476
Epoch: 0004
Iter: 0003 train_loss= 0.53863 train_f1_mic= 0.38127 train_f1_mac= 0.09208 val_loss= 0.57355 val_f1_mic= 0.37222 val_f1_mac= 0.09610 time= 0.07395
Iter: 0008 train_loss= 0.53615 train_f1_mic= 0.39307 train_f1_mac= 0.09733 val_loss= 0.57355 val_f1_mic= 0.37222 val_f1_mac= 0.09610 time= 0.07292
Iter: 0013 train_loss= 0.55006 train_f1_mic= 0.36821 train_f1_mac= 0.08853 val_loss= 0.57355 val_f1_mic= 0.37222 val_f1_mac= 0.09610 time= 0.07200
Iter: 0018 train_loss= 0.54425 train_f1_mic= 0.38102 train_f1_mac= 0.09294 val_loss= 0.57355 val_f1_mic= 0.37222 val_f1_mac= 0.09610 time= 0.07120
Epoch: 0005
Iter: 0004 train_loss= 0.52926 train_f1_mic= 0.39071 train_f1_mac= 0.09245 val_loss= 0.58680 val_f1_mic= 0.36393 val_f1_mac= 0.09748 time= 0.07083
Iter: 0009 train_loss= 0.53935 train_f1_mic= 0.38149 train_f1_mac= 0.09212 val_loss= 0.58680 val_f1_mic= 0.36393 val_f1_mac= 0.09748 time= 0.07020
Iter: 0014 train_loss= 0.54579 train_f1_mic= 0.37828 train_f1_mac= 0.09270 val_loss= 0.58680 val_f1_mic= 0.36393 val_f1_mac= 0.09748 time= 0.06964
Epoch: 0006
Iter: 0000 train_loss= 0.53493 train_f1_mic= 0.38588 train_f1_mac= 0.09189 val_loss= 0.56937 val_f1_mic= 0.37171 val_f1_mac= 0.09583 time= 0.06934
Iter: 0005 train_loss= 0.54626 train_f1_mic= 0.37668 train_f1_mac= 0.09231 val_loss= 0.56937 val_f1_mic= 0.37171 val_f1_mac= 0.09583 time= 0.06888
Iter: 0010 train_loss= 0.55563 train_f1_mic= 0.37868 train_f1_mac= 0.09432 val_loss= 0.56937 val_f1_mic= 0.37171 val_f1_mac= 0.09583 time= 0.06849
Iter: 0015 train_loss= 0.53565 train_f1_mic= 0.37228 train_f1_mac= 0.08702 val_loss= 0.56937 val_f1_mic= 0.37171 val_f1_mac= 0.09583 time= 0.06811
Epoch: 0007
Iter: 0001 train_loss= 0.54824 train_f1_mic= 0.37958 train_f1_mac= 0.09366 val_loss= 0.55560 val_f1_mic= 0.37270 val_f1_mac= 0.09326 time= 0.06795
Iter: 0006 train_loss= 0.54174 train_f1_mic= 0.38849 train_f1_mac= 0.09777 val_loss= 0.55560 val_f1_mic= 0.37270 val_f1_mac= 0.09326 time= 0.06762
Iter: 0011 train_loss= 0.54422 train_f1_mic= 0.36556 train_f1_mac= 0.08682 val_loss= 0.55560 val_f1_mic= 0.37270 val_f1_mac= 0.09326 time= 0.06733
Iter: 0016 train_loss= 0.53531 train_f1_mic= 0.37689 train_f1_mac= 0.08745 val_loss= 0.55560 val_f1_mic= 0.37270 val_f1_mac= 0.09326 time= 0.06704
Epoch: 0008
Iter: 0002 train_loss= 0.53986 train_f1_mic= 0.39282 train_f1_mac= 0.10002 val_loss= 0.55512 val_f1_mic= 0.38836 val_f1_mac= 0.09997 time= 0.06692
Iter: 0007 train_loss= 0.54518 train_f1_mic= 0.38580 train_f1_mac= 0.09738 val_loss= 0.55512 val_f1_mic= 0.38836 val_f1_mac= 0.09997 time= 0.06667
Iter: 0012 train_loss= 0.54951 train_f1_mic= 0.36259 train_f1_mac= 0.08720 val_loss= 0.55512 val_f1_mic= 0.38836 val_f1_mac= 0.09997 time= 0.06644
Iter: 0017 train_loss= 0.55392 train_f1_mic= 0.36574 train_f1_mac= 0.08882 val_loss= 0.55512 val_f1_mic= 0.38836 val_f1_mac= 0.09997 time= 0.06626
Epoch: 0009
Iter: 0003 train_loss= 0.53738 train_f1_mic= 0.36891 train_f1_mac= 0.08680 val_loss= 0.55610 val_f1_mic= 0.36642 val_f1_mac= 0.09001 time= 0.06624
Iter: 0008 train_loss= 0.55727 train_f1_mic= 0.37268 train_f1_mac= 0.09633 val_loss= 0.55610 val_f1_mic= 0.36642 val_f1_mac= 0.09001 time= 0.06605
Iter: 0013 train_loss= 0.54421 train_f1_mic= 0.38850 train_f1_mac= 0.10163 val_loss= 0.55610 val_f1_mic= 0.36642 val_f1_mac= 0.09001 time= 0.06588
Iter: 0018 train_loss= 0.54419 train_f1_mic= 0.38957 train_f1_mac= 0.09817 val_loss= 0.55610 val_f1_mic= 0.36642 val_f1_mac= 0.09001 time= 0.06568
Epoch: 0010
Iter: 0004 train_loss= 0.53837 train_f1_mic= 0.38433 train_f1_mac= 0.09632 val_loss= 0.55810 val_f1_mic= 0.38958 val_f1_mac= 0.10423 time= 0.06567
Iter: 0009 train_loss= 0.52483 train_f1_mic= 0.40894 train_f1_mac= 0.10501 val_loss= 0.55810 val_f1_mic= 0.38958 val_f1_mac= 0.10423 time= 0.06551
Iter: 0014 train_loss= 0.53967 train_f1_mic= 0.39680 train_f1_mac= 0.10377 val_loss= 0.55810 val_f1_mic= 0.38958 val_f1_mac= 0.10423 time= 0.06537
Optimization Finished!
Full validation stats: loss= 0.55829 f1_micro= 0.39389 f1_macro= 0.10926 time= 0.11270
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4463365791050597
Rewards :  -0.05576469001463541 Accuracy :  0.4017248270933514
Total reward :  1.175418655708728
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'sigmoid', 4, 'sigmoid']
Training RNN (Reward ip) :  [-0.05576469]
Trial 296: Controller loss : 11144.353516

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [4, 'sigmoid', 3, 'tanh']
2018-08-31 01:00:09.780156: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:00:09.780519: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:00:09.781974: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:00:09.782942: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:00:09.783965: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69373 train_f1_mic= 0.39107 train_f1_mac= 0.24023 val_loss= 0.66602 val_f1_mic= 0.41613 val_f1_mac= 0.11992 time= 0.75957
Iter: 0005 train_loss= 0.57622 train_f1_mic= 0.40270 train_f1_mac= 0.09996 val_loss= 0.66602 val_f1_mic= 0.41613 val_f1_mac= 0.11992 time= 0.13841
Iter: 0010 train_loss= 0.54552 train_f1_mic= 0.36861 train_f1_mac= 0.08674 val_loss= 0.66602 val_f1_mic= 0.41613 val_f1_mac= 0.11992 time= 0.08194
Iter: 0015 train_loss= 0.55003 train_f1_mic= 0.37839 train_f1_mac= 0.09352 val_loss= 0.66602 val_f1_mic= 0.41613 val_f1_mac= 0.11992 time= 0.06069
Epoch: 0002
Iter: 0001 train_loss= 0.54488 train_f1_mic= 0.39681 train_f1_mac= 0.09891 val_loss= 0.58588 val_f1_mic= 0.37875 val_f1_mac= 0.10105 time= 0.05123
Iter: 0006 train_loss= 0.56560 train_f1_mic= 0.37281 train_f1_mac= 0.09378 val_loss= 0.58588 val_f1_mic= 0.37875 val_f1_mac= 0.10105 time= 0.04415
Iter: 0011 train_loss= 0.54319 train_f1_mic= 0.35366 train_f1_mac= 0.08153 val_loss= 0.58588 val_f1_mic= 0.37875 val_f1_mac= 0.10105 time= 0.03937
Iter: 0016 train_loss= 0.54043 train_f1_mic= 0.39508 train_f1_mac= 0.09765 val_loss= 0.58588 val_f1_mic= 0.37875 val_f1_mac= 0.10105 time= 0.03612
Epoch: 0003
Iter: 0002 train_loss= 0.53601 train_f1_mic= 0.39100 train_f1_mac= 0.09615 val_loss= 0.57006 val_f1_mic= 0.39847 val_f1_mac= 0.10811 time= 0.03447
Iter: 0007 train_loss= 0.53695 train_f1_mic= 0.38153 train_f1_mac= 0.08862 val_loss= 0.57006 val_f1_mic= 0.39847 val_f1_mac= 0.10811 time= 0.03237
Iter: 0012 train_loss= 0.53771 train_f1_mic= 0.41013 train_f1_mac= 0.10393 val_loss= 0.57006 val_f1_mic= 0.39847 val_f1_mac= 0.10811 time= 0.03062
Iter: 0017 train_loss= 0.54538 train_f1_mic= 0.36867 train_f1_mac= 0.08776 val_loss= 0.57006 val_f1_mic= 0.39847 val_f1_mac= 0.10811 time= 0.02921
Epoch: 0004
Iter: 0003 train_loss= 0.54507 train_f1_mic= 0.37317 train_f1_mac= 0.08832 val_loss= 0.54260 val_f1_mic= 0.36783 val_f1_mac= 0.08740 time= 0.02863
Iter: 0008 train_loss= 0.54487 train_f1_mic= 0.37901 train_f1_mac= 0.09264 val_loss= 0.54260 val_f1_mic= 0.36783 val_f1_mac= 0.08740 time= 0.02779
Iter: 0013 train_loss= 0.55304 train_f1_mic= 0.36695 train_f1_mac= 0.08884 val_loss= 0.54260 val_f1_mic= 0.36783 val_f1_mac= 0.08740 time= 0.02697
Iter: 0018 train_loss= 0.53922 train_f1_mic= 0.39045 train_f1_mac= 0.09678 val_loss= 0.54260 val_f1_mic= 0.36783 val_f1_mac= 0.08740 time= 0.02623
Epoch: 0005
Iter: 0004 train_loss= 0.54036 train_f1_mic= 0.39312 train_f1_mac= 0.09785 val_loss= 0.56275 val_f1_mic= 0.38595 val_f1_mac= 0.10045 time= 0.02577
Iter: 0009 train_loss= 0.54463 train_f1_mic= 0.37158 train_f1_mac= 0.08827 val_loss= 0.56275 val_f1_mic= 0.38595 val_f1_mac= 0.10045 time= 0.02514
Iter: 0014 train_loss= 0.54414 train_f1_mic= 0.40407 train_f1_mac= 0.10378 val_loss= 0.56275 val_f1_mic= 0.38595 val_f1_mac= 0.10045 time= 0.02453
Epoch: 0006
Iter: 0000 train_loss= 0.54799 train_f1_mic= 0.36560 train_f1_mac= 0.08745 val_loss= 0.57873 val_f1_mic= 0.35131 val_f1_mac= 0.08963 time= 0.02429
Iter: 0005 train_loss= 0.55150 train_f1_mic= 0.36516 train_f1_mac= 0.08819 val_loss= 0.57873 val_f1_mic= 0.35131 val_f1_mac= 0.08963 time= 0.02400
Iter: 0010 train_loss= 0.53725 train_f1_mic= 0.41163 train_f1_mac= 0.10431 val_loss= 0.57873 val_f1_mic= 0.35131 val_f1_mac= 0.08963 time= 0.02360
Iter: 0015 train_loss= 0.55563 train_f1_mic= 0.37579 train_f1_mac= 0.09397 val_loss= 0.57873 val_f1_mic= 0.35131 val_f1_mac= 0.08963 time= 0.02339
Epoch: 0007
Iter: 0001 train_loss= 0.53839 train_f1_mic= 0.37248 train_f1_mac= 0.08719 val_loss= 0.57886 val_f1_mic= 0.35287 val_f1_mac= 0.09011 time= 0.02325
Iter: 0006 train_loss= 0.54335 train_f1_mic= 0.40800 train_f1_mac= 0.10472 val_loss= 0.57886 val_f1_mic= 0.35287 val_f1_mac= 0.09011 time= 0.02294
Iter: 0011 train_loss= 0.54847 train_f1_mic= 0.38163 train_f1_mac= 0.09418 val_loss= 0.57886 val_f1_mic= 0.35287 val_f1_mac= 0.09011 time= 0.02262
Iter: 0016 train_loss= 0.53272 train_f1_mic= 0.37406 train_f1_mac= 0.08687 val_loss= 0.57886 val_f1_mic= 0.35287 val_f1_mac= 0.09011 time= 0.02234
Epoch: 0008
Iter: 0002 train_loss= 0.53429 train_f1_mic= 0.35759 train_f1_mac= 0.08090 val_loss= 0.56756 val_f1_mic= 0.34180 val_f1_mac= 0.08345 time= 0.02226
Iter: 0007 train_loss= 0.54480 train_f1_mic= 0.37962 train_f1_mac= 0.09258 val_loss= 0.56756 val_f1_mic= 0.34180 val_f1_mac= 0.08345 time= 0.02200
Iter: 0012 train_loss= 0.53255 train_f1_mic= 0.39942 train_f1_mac= 0.09792 val_loss= 0.56756 val_f1_mic= 0.34180 val_f1_mac= 0.08345 time= 0.02173
Iter: 0017 train_loss= 0.54767 train_f1_mic= 0.37488 train_f1_mac= 0.09208 val_loss= 0.56756 val_f1_mic= 0.34180 val_f1_mac= 0.08345 time= 0.02152
Epoch: 0009
Iter: 0003 train_loss= 0.54258 train_f1_mic= 0.37241 train_f1_mac= 0.08797 val_loss= 0.57057 val_f1_mic= 0.35723 val_f1_mac= 0.08981 time= 0.02149
Iter: 0008 train_loss= 0.54975 train_f1_mic= 0.39211 train_f1_mac= 0.10251 val_loss= 0.57057 val_f1_mic= 0.35723 val_f1_mac= 0.08981 time= 0.02136
Iter: 0013 train_loss= 0.53032 train_f1_mic= 0.37409 train_f1_mac= 0.08825 val_loss= 0.57057 val_f1_mic= 0.35723 val_f1_mac= 0.08981 time= 0.02119
Iter: 0018 train_loss= 0.54838 train_f1_mic= 0.37649 train_f1_mac= 0.09285 val_loss= 0.57057 val_f1_mic= 0.35723 val_f1_mac= 0.08981 time= 0.02105
Epoch: 0010
Iter: 0004 train_loss= 0.54292 train_f1_mic= 0.39452 train_f1_mac= 0.09928 val_loss= 0.56798 val_f1_mic= 0.37812 val_f1_mac= 0.10002 time= 0.02100
Iter: 0009 train_loss= 0.54890 train_f1_mic= 0.37141 train_f1_mac= 0.09189 val_loss= 0.56798 val_f1_mic= 0.37812 val_f1_mac= 0.10002 time= 0.02084
Iter: 0014 train_loss= 0.54652 train_f1_mic= 0.37881 train_f1_mac= 0.09595 val_loss= 0.56798 val_f1_mic= 0.37812 val_f1_mac= 0.10002 time= 0.02069
Optimization Finished!
Full validation stats: loss= 0.56277 f1_micro= 0.36667 f1_macro= 0.09400 time= 0.09378
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.43221380114160535
Rewards :  -0.07061388981727157 Accuracy :  0.3757226892877881
Total reward :  1.1048047658914566
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'sigmoid', 3, 'tanh']
Training RNN (Reward ip) :  [-0.07061389]
Trial 297: Controller loss : 7763.841797

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'tanh', 1, 'relu']
2018-08-31 01:00:19.073195: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:00:19.073444: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:00:19.073675: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:00:19.073850: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:00:19.074071: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69364 train_f1_mic= 0.37709 train_f1_mac= 0.32966 val_loss= 0.66760 val_f1_mic= 0.40177 val_f1_mac= 0.18719 time= 0.96641
Iter: 0005 train_loss= 0.58562 train_f1_mic= 0.37338 train_f1_mac= 0.08850 val_loss= 0.66760 val_f1_mic= 0.40177 val_f1_mac= 0.18719 time= 0.18201
Iter: 0010 train_loss= 0.54300 train_f1_mic= 0.39845 train_f1_mac= 0.10217 val_loss= 0.66760 val_f1_mic= 0.40177 val_f1_mac= 0.18719 time= 0.11061
Iter: 0015 train_loss= 0.54336 train_f1_mic= 0.38517 train_f1_mac= 0.10044 val_loss= 0.66760 val_f1_mic= 0.40177 val_f1_mac= 0.18719 time= 0.08377
Epoch: 0002
Iter: 0001 train_loss= 0.54005 train_f1_mic= 0.38814 train_f1_mac= 0.10788 val_loss= 0.55924 val_f1_mic= 0.38506 val_f1_mac= 0.11261 time= 0.07200
Iter: 0006 train_loss= 0.53384 train_f1_mic= 0.41488 train_f1_mac= 0.12242 val_loss= 0.55924 val_f1_mic= 0.38506 val_f1_mac= 0.11261 time= 0.06294
Iter: 0011 train_loss= 0.52682 train_f1_mic= 0.41273 train_f1_mac= 0.12268 val_loss= 0.55924 val_f1_mic= 0.38506 val_f1_mac= 0.11261 time= 0.05668
Iter: 0016 train_loss= 0.52827 train_f1_mic= 0.42320 train_f1_mac= 0.13609 val_loss= 0.55924 val_f1_mic= 0.38506 val_f1_mac= 0.11261 time= 0.05216
Epoch: 0003
Iter: 0002 train_loss= 0.52576 train_f1_mic= 0.41823 train_f1_mac= 0.13475 val_loss= 0.55665 val_f1_mic= 0.40977 val_f1_mac= 0.13585 time= 0.04962
Iter: 0007 train_loss= 0.52585 train_f1_mic= 0.42315 train_f1_mac= 0.13932 val_loss= 0.55665 val_f1_mic= 0.40977 val_f1_mac= 0.13585 time= 0.04685
Iter: 0012 train_loss= 0.51566 train_f1_mic= 0.43276 train_f1_mac= 0.14688 val_loss= 0.55665 val_f1_mic= 0.40977 val_f1_mac= 0.13585 time= 0.04472
Iter: 0017 train_loss= 0.53194 train_f1_mic= 0.43327 train_f1_mac= 0.15006 val_loss= 0.55665 val_f1_mic= 0.40977 val_f1_mac= 0.13585 time= 0.04308
Epoch: 0004
Iter: 0003 train_loss= 0.52380 train_f1_mic= 0.43565 train_f1_mac= 0.15523 val_loss= 0.52750 val_f1_mic= 0.44620 val_f1_mac= 0.16085 time= 0.04198
Iter: 0008 train_loss= 0.51811 train_f1_mic= 0.41986 train_f1_mac= 0.15065 val_loss= 0.52750 val_f1_mic= 0.44620 val_f1_mac= 0.16085 time= 0.04066
Iter: 0013 train_loss= 0.51432 train_f1_mic= 0.45951 train_f1_mac= 0.17974 val_loss= 0.52750 val_f1_mic= 0.44620 val_f1_mac= 0.16085 time= 0.03950
Iter: 0018 train_loss= 0.53204 train_f1_mic= 0.42110 train_f1_mac= 0.14961 val_loss= 0.52750 val_f1_mic= 0.44620 val_f1_mac= 0.16085 time= 0.03868
Epoch: 0005
Iter: 0004 train_loss= 0.51490 train_f1_mic= 0.44270 train_f1_mac= 0.17074 val_loss= 0.53126 val_f1_mic= 0.42930 val_f1_mac= 0.16100 time= 0.03805
Iter: 0009 train_loss= 0.52296 train_f1_mic= 0.45051 train_f1_mac= 0.17894 val_loss= 0.53126 val_f1_mic= 0.42930 val_f1_mac= 0.16100 time= 0.03726
Iter: 0014 train_loss= 0.51960 train_f1_mic= 0.43883 train_f1_mac= 0.16838 val_loss= 0.53126 val_f1_mic= 0.42930 val_f1_mac= 0.16100 time= 0.03655
Epoch: 0006
Iter: 0000 train_loss= 0.51955 train_f1_mic= 0.46402 train_f1_mac= 0.19574 val_loss= 0.53448 val_f1_mic= 0.46367 val_f1_mac= 0.19767 time= 0.03612
Iter: 0005 train_loss= 0.52286 train_f1_mic= 0.44569 train_f1_mac= 0.18006 val_loss= 0.53448 val_f1_mic= 0.46367 val_f1_mac= 0.19767 time= 0.03571
Iter: 0010 train_loss= 0.51624 train_f1_mic= 0.46598 train_f1_mac= 0.19992 val_loss= 0.53448 val_f1_mic= 0.46367 val_f1_mac= 0.19767 time= 0.03530
Iter: 0015 train_loss= 0.51547 train_f1_mic= 0.44287 train_f1_mac= 0.17730 val_loss= 0.53448 val_f1_mic= 0.46367 val_f1_mac= 0.19767 time= 0.03493
Epoch: 0007
Iter: 0001 train_loss= 0.51374 train_f1_mic= 0.45151 train_f1_mac= 0.18226 val_loss= 0.52517 val_f1_mic= 0.46718 val_f1_mac= 0.20119 time= 0.03514
Iter: 0006 train_loss= 0.51459 train_f1_mic= 0.46605 train_f1_mac= 0.20292 val_loss= 0.52517 val_f1_mic= 0.46718 val_f1_mac= 0.20119 time= 0.03486
Iter: 0011 train_loss= 0.50940 train_f1_mic= 0.45892 train_f1_mac= 0.19812 val_loss= 0.52517 val_f1_mic= 0.46718 val_f1_mac= 0.20119 time= 0.03445
Iter: 0016 train_loss= 0.52271 train_f1_mic= 0.44364 train_f1_mac= 0.19391 val_loss= 0.52517 val_f1_mic= 0.46718 val_f1_mac= 0.20119 time= 0.03405
Epoch: 0008
Iter: 0002 train_loss= 0.51676 train_f1_mic= 0.45100 train_f1_mac= 0.18807 val_loss= 0.54160 val_f1_mic= 0.47822 val_f1_mac= 0.22915 time= 0.03389
Iter: 0007 train_loss= 0.51259 train_f1_mic= 0.46096 train_f1_mac= 0.19647 val_loss= 0.54160 val_f1_mic= 0.47822 val_f1_mac= 0.22915 time= 0.03355
Iter: 0012 train_loss= 0.50078 train_f1_mic= 0.46846 train_f1_mac= 0.20622 val_loss= 0.54160 val_f1_mic= 0.47822 val_f1_mac= 0.22915 time= 0.03324
Iter: 0017 train_loss= 0.50998 train_f1_mic= 0.45177 train_f1_mac= 0.19024 val_loss= 0.54160 val_f1_mic= 0.47822 val_f1_mac= 0.22915 time= 0.03303
Epoch: 0009
Iter: 0003 train_loss= 0.51463 train_f1_mic= 0.47495 train_f1_mac= 0.23122 val_loss= 0.53689 val_f1_mic= 0.48943 val_f1_mac= 0.24282 time= 0.03288
Iter: 0008 train_loss= 0.51661 train_f1_mic= 0.43421 train_f1_mac= 0.18504 val_loss= 0.53689 val_f1_mic= 0.48943 val_f1_mac= 0.24282 time= 0.03261
Iter: 0013 train_loss= 0.51842 train_f1_mic= 0.47772 train_f1_mac= 0.22412 val_loss= 0.53689 val_f1_mic= 0.48943 val_f1_mac= 0.24282 time= 0.03237
Iter: 0018 train_loss= 0.49609 train_f1_mic= 0.46236 train_f1_mac= 0.20311 val_loss= 0.53689 val_f1_mic= 0.48943 val_f1_mac= 0.24282 time= 0.03216
Epoch: 0010
Iter: 0004 train_loss= 0.50199 train_f1_mic= 0.47270 train_f1_mac= 0.21867 val_loss= 0.53920 val_f1_mic= 0.46816 val_f1_mac= 0.22737 time= 0.03235
Iter: 0009 train_loss= 0.50274 train_f1_mic= 0.47654 train_f1_mac= 0.22024 val_loss= 0.53920 val_f1_mic= 0.46816 val_f1_mac= 0.22737 time= 0.03215
Iter: 0014 train_loss= 0.50354 train_f1_mic= 0.45484 train_f1_mac= 0.20999 val_loss= 0.53920 val_f1_mic= 0.46816 val_f1_mac= 0.22737 time= 0.03194
Optimization Finished!
Full validation stats: loss= 0.52738 f1_micro= 0.46057 f1_macro= 0.21559 time= 0.12068
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.43839982853229925
Rewards :  0.030930136953469523 Accuracy :  0.46314393809507487
Total reward :  1.1357349028449262
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'tanh', 1, 'relu']
Training RNN (Reward ip) :  [0.03093014]
Trial 298: Controller loss : 7246.560059
2018-08-31 01:00:30.785472: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:00:30.785716: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:00:30.785946: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:00:30.786116: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:00:30.786324: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [0, 'tanh', 1, 'sigmoid']
Epoch: 0001
Iter: 0000 train_loss= 0.69357 train_f1_mic= 0.38105 train_f1_mac= 0.24573 val_loss= 0.65728 val_f1_mic= 0.37339 val_f1_mac= 0.09646 time= 1.00831
Iter: 0005 train_loss= 0.56523 train_f1_mic= 0.39669 train_f1_mac= 0.09833 val_loss= 0.65728 val_f1_mic= 0.37339 val_f1_mac= 0.09646 time= 0.18816
Iter: 0010 train_loss= 0.54608 train_f1_mic= 0.36342 train_f1_mac= 0.08620 val_loss= 0.65728 val_f1_mic= 0.37339 val_f1_mac= 0.09646 time= 0.11559
Iter: 0015 train_loss= 0.53827 train_f1_mic= 0.37389 train_f1_mac= 0.09130 val_loss= 0.65728 val_f1_mic= 0.37339 val_f1_mac= 0.09646 time= 0.08745
Epoch: 0002
Iter: 0001 train_loss= 0.53168 train_f1_mic= 0.42331 train_f1_mac= 0.11825 val_loss= 0.56058 val_f1_mic= 0.40300 val_f1_mac= 0.11866 time= 0.07389
Iter: 0006 train_loss= 0.53846 train_f1_mic= 0.42001 train_f1_mac= 0.12862 val_loss= 0.56058 val_f1_mic= 0.40300 val_f1_mac= 0.11866 time= 0.06432
Iter: 0011 train_loss= 0.53261 train_f1_mic= 0.41263 train_f1_mac= 0.12695 val_loss= 0.56058 val_f1_mic= 0.40300 val_f1_mac= 0.11866 time= 0.05781
Iter: 0016 train_loss= 0.52634 train_f1_mic= 0.39538 train_f1_mac= 0.12041 val_loss= 0.56058 val_f1_mic= 0.40300 val_f1_mac= 0.11866 time= 0.05369
Epoch: 0003
Iter: 0002 train_loss= 0.54021 train_f1_mic= 0.41521 train_f1_mac= 0.13322 val_loss= 0.55269 val_f1_mic= 0.40829 val_f1_mac= 0.13106 time= 0.05101
Iter: 0007 train_loss= 0.53409 train_f1_mic= 0.42504 train_f1_mac= 0.13658 val_loss= 0.55269 val_f1_mic= 0.40829 val_f1_mac= 0.13106 time= 0.04837
Iter: 0012 train_loss= 0.52710 train_f1_mic= 0.41735 train_f1_mac= 0.14131 val_loss= 0.55269 val_f1_mic= 0.40829 val_f1_mac= 0.13106 time= 0.04599
Iter: 0017 train_loss= 0.53465 train_f1_mic= 0.42131 train_f1_mac= 0.14840 val_loss= 0.55269 val_f1_mic= 0.40829 val_f1_mac= 0.13106 time= 0.04399
Epoch: 0004
Iter: 0003 train_loss= 0.52826 train_f1_mic= 0.45288 train_f1_mac= 0.17095 val_loss= 0.54623 val_f1_mic= 0.44156 val_f1_mac= 0.16671 time= 0.04270
Iter: 0008 train_loss= 0.52618 train_f1_mic= 0.42616 train_f1_mac= 0.14857 val_loss= 0.54623 val_f1_mic= 0.44156 val_f1_mac= 0.16671 time= 0.04128
Iter: 0013 train_loss= 0.53317 train_f1_mic= 0.41711 train_f1_mac= 0.14712 val_loss= 0.54623 val_f1_mic= 0.44156 val_f1_mac= 0.16671 time= 0.04048
Iter: 0018 train_loss= 0.52205 train_f1_mic= 0.42604 train_f1_mac= 0.14740 val_loss= 0.54623 val_f1_mic= 0.44156 val_f1_mac= 0.16671 time= 0.03970
Epoch: 0005
Iter: 0004 train_loss= 0.51627 train_f1_mic= 0.44165 train_f1_mac= 0.16151 val_loss= 0.53556 val_f1_mic= 0.43167 val_f1_mac= 0.15830 time= 0.03912
Iter: 0009 train_loss= 0.52664 train_f1_mic= 0.43429 train_f1_mac= 0.16085 val_loss= 0.53556 val_f1_mic= 0.43167 val_f1_mac= 0.15830 time= 0.03822
Iter: 0014 train_loss= 0.51958 train_f1_mic= 0.45827 train_f1_mac= 0.18120 val_loss= 0.53556 val_f1_mic= 0.43167 val_f1_mac= 0.15830 time= 0.03745
Epoch: 0006
Iter: 0000 train_loss= 0.50719 train_f1_mic= 0.43395 train_f1_mac= 0.16758 val_loss= 0.55056 val_f1_mic= 0.41052 val_f1_mac= 0.15887 time= 0.03697
Iter: 0005 train_loss= 0.52663 train_f1_mic= 0.44566 train_f1_mac= 0.17672 val_loss= 0.55056 val_f1_mic= 0.41052 val_f1_mac= 0.15887 time= 0.03673
Iter: 0010 train_loss= 0.51238 train_f1_mic= 0.43729 train_f1_mac= 0.16362 val_loss= 0.55056 val_f1_mic= 0.41052 val_f1_mac= 0.15887 time= 0.03612
Iter: 0015 train_loss= 0.51310 train_f1_mic= 0.45866 train_f1_mac= 0.19252 val_loss= 0.55056 val_f1_mic= 0.41052 val_f1_mac= 0.15887 time= 0.03565
Epoch: 0007
Iter: 0001 train_loss= 0.51152 train_f1_mic= 0.47721 train_f1_mac= 0.21352 val_loss= 0.53297 val_f1_mic= 0.47270 val_f1_mac= 0.21298 time= 0.03533
Iter: 0006 train_loss= 0.49277 train_f1_mic= 0.46261 train_f1_mac= 0.19605 val_loss= 0.53297 val_f1_mic= 0.47270 val_f1_mac= 0.21298 time= 0.03489
Iter: 0011 train_loss= 0.51119 train_f1_mic= 0.47351 train_f1_mac= 0.20957 val_loss= 0.53297 val_f1_mic= 0.47270 val_f1_mac= 0.21298 time= 0.03475
Iter: 0016 train_loss= 0.50234 train_f1_mic= 0.47134 train_f1_mac= 0.20515 val_loss= 0.53297 val_f1_mic= 0.47270 val_f1_mac= 0.21298 time= 0.03442
Epoch: 0008
Iter: 0002 train_loss= 0.49131 train_f1_mic= 0.48129 train_f1_mac= 0.21668 val_loss= 0.52200 val_f1_mic= 0.46936 val_f1_mac= 0.21797 time= 0.03419
Iter: 0007 train_loss= 0.49899 train_f1_mic= 0.46764 train_f1_mac= 0.21410 val_loss= 0.52200 val_f1_mic= 0.46936 val_f1_mac= 0.21797 time= 0.03388
Iter: 0012 train_loss= 0.50922 train_f1_mic= 0.46846 train_f1_mac= 0.20863 val_loss= 0.52200 val_f1_mic= 0.46936 val_f1_mac= 0.21797 time= 0.03353
Iter: 0017 train_loss= 0.51097 train_f1_mic= 0.47890 train_f1_mac= 0.22573 val_loss= 0.52200 val_f1_mic= 0.46936 val_f1_mac= 0.21797 time= 0.03322
Epoch: 0009
Iter: 0003 train_loss= 0.49391 train_f1_mic= 0.48497 train_f1_mac= 0.22892 val_loss= 0.53184 val_f1_mic= 0.44738 val_f1_mac= 0.20967 time= 0.03310
Iter: 0008 train_loss= 0.49650 train_f1_mic= 0.48440 train_f1_mac= 0.23806 val_loss= 0.53184 val_f1_mic= 0.44738 val_f1_mac= 0.20967 time= 0.03286
Iter: 0013 train_loss= 0.51175 train_f1_mic= 0.48953 train_f1_mac= 0.23930 val_loss= 0.53184 val_f1_mic= 0.44738 val_f1_mac= 0.20967 time= 0.03259
Iter: 0018 train_loss= 0.50081 train_f1_mic= 0.46722 train_f1_mac= 0.21769 val_loss= 0.53184 val_f1_mic= 0.44738 val_f1_mac= 0.20967 time= 0.03235
Epoch: 0010
Iter: 0004 train_loss= 0.48280 train_f1_mic= 0.51336 train_f1_mac= 0.27629 val_loss= 0.52532 val_f1_mic= 0.48856 val_f1_mac= 0.25779 time= 0.03223
Iter: 0009 train_loss= 0.49591 train_f1_mic= 0.48190 train_f1_mac= 0.23711 val_loss= 0.52532 val_f1_mic= 0.48856 val_f1_mac= 0.25779 time= 0.03201
Iter: 0014 train_loss= 0.50398 train_f1_mic= 0.49581 train_f1_mac= 0.25560 val_loss= 0.52532 val_f1_mic= 0.48856 val_f1_mac= 0.25779 time= 0.03179
Optimization Finished!
Full validation stats: loss= 0.51715 f1_micro= 0.49140 f1_macro= 0.25384 time= 0.15063
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4493931142200075
Rewards :  0.054966428438541104 Accuracy :  0.49336625697084036
Total reward :  1.1907013312834673
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'tanh', 1, 'sigmoid']
Training RNN (Reward ip) :  [0.05496643]
Trial 299: Controller loss : 4822.126465

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:00:42.757670: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:00:42.758605: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:00:42.759246: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:00:42.759733: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:00:42.760734: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69694 train_f1_mic= 0.38346 train_f1_mac= 0.31497 val_loss= 0.66512 val_f1_mic= 0.40360 val_f1_mac= 0.12465 time= 0.76898
Iter: 0005 train_loss= 0.58962 train_f1_mic= 0.36843 train_f1_mac= 0.08729 val_loss= 0.66512 val_f1_mic= 0.40360 val_f1_mac= 0.12465 time= 0.13997
Iter: 0010 train_loss= 0.55339 train_f1_mic= 0.39392 train_f1_mac= 0.09979 val_loss= 0.66512 val_f1_mic= 0.40360 val_f1_mac= 0.12465 time= 0.08342
Iter: 0015 train_loss= 0.55352 train_f1_mic= 0.40766 train_f1_mac= 0.11085 val_loss= 0.66512 val_f1_mic= 0.40360 val_f1_mac= 0.12465 time= 0.06227
Epoch: 0002
Iter: 0001 train_loss= 0.53888 train_f1_mic= 0.38122 train_f1_mac= 0.09431 val_loss= 0.56891 val_f1_mic= 0.36903 val_f1_mac= 0.09723 time= 0.05243
Iter: 0006 train_loss= 0.54073 train_f1_mic= 0.36862 train_f1_mac= 0.09162 val_loss= 0.56891 val_f1_mic= 0.36903 val_f1_mac= 0.09723 time= 0.04534
Iter: 0011 train_loss= 0.53652 train_f1_mic= 0.39310 train_f1_mac= 0.10163 val_loss= 0.56891 val_f1_mic= 0.36903 val_f1_mac= 0.09723 time= 0.04060
Iter: 0016 train_loss= 0.54068 train_f1_mic= 0.38974 train_f1_mac= 0.10453 val_loss= 0.56891 val_f1_mic= 0.36903 val_f1_mac= 0.09723 time= 0.03693
Epoch: 0003
Iter: 0002 train_loss= 0.53954 train_f1_mic= 0.38722 train_f1_mac= 0.10931 val_loss= 0.55717 val_f1_mic= 0.37922 val_f1_mac= 0.10763 time= 0.03529
Iter: 0007 train_loss= 0.52726 train_f1_mic= 0.41006 train_f1_mac= 0.12405 val_loss= 0.55717 val_f1_mic= 0.37922 val_f1_mac= 0.10763 time= 0.03298
Iter: 0012 train_loss= 0.53408 train_f1_mic= 0.41018 train_f1_mac= 0.12851 val_loss= 0.55717 val_f1_mic= 0.37922 val_f1_mac= 0.10763 time= 0.03121
Iter: 0017 train_loss= 0.52741 train_f1_mic= 0.41852 train_f1_mac= 0.13565 val_loss= 0.55717 val_f1_mic= 0.37922 val_f1_mac= 0.10763 time= 0.02994
Epoch: 0004
Iter: 0003 train_loss= 0.52784 train_f1_mic= 0.41489 train_f1_mac= 0.13149 val_loss= 0.55027 val_f1_mic= 0.40071 val_f1_mac= 0.13261 time= 0.02922
Iter: 0008 train_loss= 0.52798 train_f1_mic= 0.42301 train_f1_mac= 0.13887 val_loss= 0.55027 val_f1_mic= 0.40071 val_f1_mac= 0.13261 time= 0.02808
Iter: 0013 train_loss= 0.52570 train_f1_mic= 0.42632 train_f1_mac= 0.14813 val_loss= 0.55027 val_f1_mic= 0.40071 val_f1_mac= 0.13261 time= 0.02719
Iter: 0018 train_loss= 0.53209 train_f1_mic= 0.41543 train_f1_mac= 0.14259 val_loss= 0.55027 val_f1_mic= 0.40071 val_f1_mac= 0.13261 time= 0.02643
Epoch: 0005
Iter: 0004 train_loss= 0.52391 train_f1_mic= 0.44596 train_f1_mac= 0.16536 val_loss= 0.54524 val_f1_mic= 0.43283 val_f1_mac= 0.17045 time= 0.02593
Iter: 0009 train_loss= 0.52620 train_f1_mic= 0.43806 train_f1_mac= 0.15924 val_loss= 0.54524 val_f1_mic= 0.43283 val_f1_mac= 0.17045 time= 0.02534
Iter: 0014 train_loss= 0.52803 train_f1_mic= 0.39974 train_f1_mac= 0.13446 val_loss= 0.54524 val_f1_mic= 0.43283 val_f1_mac= 0.17045 time= 0.02473
Epoch: 0006
Iter: 0000 train_loss= 0.51619 train_f1_mic= 0.45613 train_f1_mac= 0.18047 val_loss= 0.53779 val_f1_mic= 0.48421 val_f1_mac= 0.21974 time= 0.02451
Iter: 0005 train_loss= 0.50803 train_f1_mic= 0.42183 train_f1_mac= 0.15617 val_loss= 0.53779 val_f1_mic= 0.48421 val_f1_mac= 0.21974 time= 0.02411
Iter: 0010 train_loss= 0.52813 train_f1_mic= 0.44474 train_f1_mac= 0.17542 val_loss= 0.53779 val_f1_mic= 0.48421 val_f1_mac= 0.21974 time= 0.02374
Iter: 0015 train_loss= 0.51630 train_f1_mic= 0.45562 train_f1_mac= 0.19265 val_loss= 0.53779 val_f1_mic= 0.48421 val_f1_mac= 0.21974 time= 0.02335
Epoch: 0007
Iter: 0001 train_loss= 0.51233 train_f1_mic= 0.45691 train_f1_mac= 0.19184 val_loss= 0.52258 val_f1_mic= 0.47160 val_f1_mac= 0.20984 time= 0.02320
Iter: 0006 train_loss= 0.50916 train_f1_mic= 0.43612 train_f1_mac= 0.16758 val_loss= 0.52258 val_f1_mic= 0.47160 val_f1_mac= 0.20984 time= 0.02288
Iter: 0011 train_loss= 0.53232 train_f1_mic= 0.47158 train_f1_mac= 0.21357 val_loss= 0.52258 val_f1_mic= 0.47160 val_f1_mac= 0.20984 time= 0.02253
Iter: 0016 train_loss= 0.50757 train_f1_mic= 0.48993 train_f1_mac= 0.23735 val_loss= 0.52258 val_f1_mic= 0.47160 val_f1_mac= 0.20984 time= 0.02222
Epoch: 0008
Iter: 0002 train_loss= 0.51445 train_f1_mic= 0.44400 train_f1_mac= 0.19505 val_loss= 0.51635 val_f1_mic= 0.42912 val_f1_mac= 0.17960 time= 0.02214
Iter: 0007 train_loss= 0.51064 train_f1_mic= 0.47231 train_f1_mac= 0.22041 val_loss= 0.51635 val_f1_mic= 0.42912 val_f1_mac= 0.17960 time= 0.02189
Iter: 0012 train_loss= 0.51207 train_f1_mic= 0.46925 train_f1_mac= 0.22188 val_loss= 0.51635 val_f1_mic= 0.42912 val_f1_mac= 0.17960 time= 0.02169
Iter: 0017 train_loss= 0.51039 train_f1_mic= 0.47883 train_f1_mac= 0.22213 val_loss= 0.51635 val_f1_mic= 0.42912 val_f1_mac= 0.17960 time= 0.02151
Epoch: 0009
Iter: 0003 train_loss= 0.50911 train_f1_mic= 0.46876 train_f1_mac= 0.21673 val_loss= 0.53686 val_f1_mic= 0.50416 val_f1_mac= 0.25934 time= 0.02141
Iter: 0008 train_loss= 0.50238 train_f1_mic= 0.47431 train_f1_mac= 0.23135 val_loss= 0.53686 val_f1_mic= 0.50416 val_f1_mac= 0.25934 time= 0.02119
Iter: 0013 train_loss= 0.50126 train_f1_mic= 0.50127 train_f1_mac= 0.25530 val_loss= 0.53686 val_f1_mic= 0.50416 val_f1_mac= 0.25934 time= 0.02099
Iter: 0018 train_loss= 0.50267 train_f1_mic= 0.50466 train_f1_mac= 0.26966 val_loss= 0.53686 val_f1_mic= 0.50416 val_f1_mac= 0.25934 time= 0.02084
Epoch: 0010
Iter: 0004 train_loss= 0.49144 train_f1_mic= 0.49206 train_f1_mac= 0.25563 val_loss= 0.51118 val_f1_mic= 0.49757 val_f1_mac= 0.26469 time= 0.02077
Iter: 0009 train_loss= 0.49452 train_f1_mic= 0.49100 train_f1_mac= 0.24662 val_loss= 0.51118 val_f1_mic= 0.49757 val_f1_mac= 0.26469 time= 0.02068
Iter: 0014 train_loss= 0.50350 train_f1_mic= 0.49207 train_f1_mac= 0.26092 val_loss= 0.51118 val_f1_mic= 0.49757 val_f1_mac= 0.26469 time= 0.02056
Optimization Finished!
Full validation stats: loss= 0.51152 f1_micro= 0.50988 f1_macro= 0.28496 time= 0.11371
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4604983043158865
Rewards :  0.055525950479395125 Accuracy :  0.5049190646994026
Total reward :  1.2462272817628626
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.05552595]
Trial 300: Controller loss : 128.582153
2018-08-31 01:00:52.283272: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:00:52.283518: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:00:52.283748: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:00:52.283921: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:00:52.284132: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 1, 'relu']
Epoch: 0001
Iter: 0000 train_loss= 0.69558 train_f1_mic= 0.36189 train_f1_mac= 0.30761 val_loss= 0.66774 val_f1_mic= 0.38694 val_f1_mac= 0.12731 time= 1.09607
Iter: 0005 train_loss= 0.59526 train_f1_mic= 0.36268 train_f1_mac= 0.08747 val_loss= 0.66774 val_f1_mic= 0.38694 val_f1_mac= 0.12731 time= 0.24336
Iter: 0010 train_loss= 0.54824 train_f1_mic= 0.36913 train_f1_mac= 0.08757 val_loss= 0.66774 val_f1_mic= 0.38694 val_f1_mac= 0.12731 time= 0.16548
Iter: 0015 train_loss= 0.54974 train_f1_mic= 0.41064 train_f1_mac= 0.11336 val_loss= 0.66774 val_f1_mic= 0.38694 val_f1_mac= 0.12731 time= 0.13640
Epoch: 0002
Iter: 0001 train_loss= 0.53294 train_f1_mic= 0.40454 train_f1_mac= 0.10992 val_loss= 0.55901 val_f1_mic= 0.39094 val_f1_mac= 0.11197 time= 0.12411
Iter: 0006 train_loss= 0.52530 train_f1_mic= 0.39429 train_f1_mac= 0.10149 val_loss= 0.55901 val_f1_mic= 0.39094 val_f1_mac= 0.11197 time= 0.11505
Iter: 0011 train_loss= 0.52305 train_f1_mic= 0.39184 train_f1_mac= 0.10389 val_loss= 0.55901 val_f1_mic= 0.39094 val_f1_mac= 0.11197 time= 0.10849
Iter: 0016 train_loss= 0.53485 train_f1_mic= 0.39643 train_f1_mac= 0.11217 val_loss= 0.55901 val_f1_mic= 0.39094 val_f1_mac= 0.11197 time= 0.10362
Epoch: 0003
Iter: 0002 train_loss= 0.53695 train_f1_mic= 0.40711 train_f1_mac= 0.12070 val_loss= 0.54017 val_f1_mic= 0.39051 val_f1_mac= 0.11611 time= 0.10045
Iter: 0007 train_loss= 0.52493 train_f1_mic= 0.42675 train_f1_mac= 0.13176 val_loss= 0.54017 val_f1_mic= 0.39051 val_f1_mac= 0.11611 time= 0.09742
Iter: 0012 train_loss= 0.53677 train_f1_mic= 0.41624 train_f1_mac= 0.13306 val_loss= 0.54017 val_f1_mic= 0.39051 val_f1_mac= 0.11611 time= 0.09515
Iter: 0017 train_loss= 0.52631 train_f1_mic= 0.40630 train_f1_mac= 0.12301 val_loss= 0.54017 val_f1_mic= 0.39051 val_f1_mac= 0.11611 time= 0.09324
Epoch: 0004
Iter: 0003 train_loss= 0.52847 train_f1_mic= 0.43221 train_f1_mac= 0.13591 val_loss= 0.55447 val_f1_mic= 0.40902 val_f1_mac= 0.13025 time= 0.09228
Iter: 0008 train_loss= 0.53699 train_f1_mic= 0.40188 train_f1_mac= 0.12583 val_loss= 0.55447 val_f1_mic= 0.40902 val_f1_mac= 0.13025 time= 0.09087
Iter: 0013 train_loss= 0.51714 train_f1_mic= 0.42362 train_f1_mac= 0.13335 val_loss= 0.55447 val_f1_mic= 0.40902 val_f1_mac= 0.13025 time= 0.08976
Iter: 0018 train_loss= 0.52101 train_f1_mic= 0.44346 train_f1_mac= 0.14607 val_loss= 0.55447 val_f1_mic= 0.40902 val_f1_mac= 0.13025 time= 0.08866
Epoch: 0005
Iter: 0004 train_loss= 0.53188 train_f1_mic= 0.40339 train_f1_mac= 0.12728 val_loss= 0.55113 val_f1_mic= 0.43647 val_f1_mac= 0.15260 time= 0.08840
Iter: 0009 train_loss= 0.52336 train_f1_mic= 0.43975 train_f1_mac= 0.15028 val_loss= 0.55113 val_f1_mic= 0.43647 val_f1_mac= 0.15260 time= 0.08743
Iter: 0014 train_loss= 0.53342 train_f1_mic= 0.41105 train_f1_mac= 0.13419 val_loss= 0.55113 val_f1_mic= 0.43647 val_f1_mac= 0.15260 time= 0.08668
Epoch: 0006
Iter: 0000 train_loss= 0.52581 train_f1_mic= 0.43823 train_f1_mac= 0.16330 val_loss= 0.54047 val_f1_mic= 0.44249 val_f1_mac= 0.16575 time= 0.08625
Iter: 0005 train_loss= 0.52574 train_f1_mic= 0.43817 train_f1_mac= 0.16087 val_loss= 0.54047 val_f1_mic= 0.44249 val_f1_mac= 0.16575 time= 0.08577
Iter: 0010 train_loss= 0.51229 train_f1_mic= 0.43175 train_f1_mac= 0.15347 val_loss= 0.54047 val_f1_mic= 0.44249 val_f1_mac= 0.16575 time= 0.08532
Iter: 0015 train_loss= 0.51557 train_f1_mic= 0.42357 train_f1_mac= 0.14723 val_loss= 0.54047 val_f1_mic= 0.44249 val_f1_mac= 0.16575 time= 0.08472
Epoch: 0007
Iter: 0001 train_loss= 0.52676 train_f1_mic= 0.43749 train_f1_mac= 0.16392 val_loss= 0.53994 val_f1_mic= 0.42594 val_f1_mac= 0.15798 time= 0.08452
Iter: 0006 train_loss= 0.51761 train_f1_mic= 0.44222 train_f1_mac= 0.16029 val_loss= 0.53994 val_f1_mic= 0.42594 val_f1_mac= 0.15798 time= 0.08404
Iter: 0011 train_loss= 0.51293 train_f1_mic= 0.44666 train_f1_mac= 0.17685 val_loss= 0.53994 val_f1_mic= 0.42594 val_f1_mac= 0.15798 time= 0.08360
Iter: 0016 train_loss= 0.51350 train_f1_mic= 0.43408 train_f1_mac= 0.16010 val_loss= 0.53994 val_f1_mic= 0.42594 val_f1_mac= 0.15798 time= 0.08324
Epoch: 0008
Iter: 0002 train_loss= 0.51017 train_f1_mic= 0.43695 train_f1_mac= 0.16811 val_loss= 0.53686 val_f1_mic= 0.44432 val_f1_mac= 0.18225 time= 0.08315
Iter: 0007 train_loss= 0.50933 train_f1_mic= 0.47818 train_f1_mac= 0.21299 val_loss= 0.53686 val_f1_mic= 0.44432 val_f1_mac= 0.18225 time= 0.08280
Iter: 0012 train_loss= 0.51415 train_f1_mic= 0.45781 train_f1_mac= 0.19038 val_loss= 0.53686 val_f1_mic= 0.44432 val_f1_mac= 0.18225 time= 0.08251
Iter: 0017 train_loss= 0.52260 train_f1_mic= 0.43265 train_f1_mac= 0.16919 val_loss= 0.53686 val_f1_mic= 0.44432 val_f1_mac= 0.18225 time= 0.08236
Epoch: 0009
Iter: 0003 train_loss= 0.52177 train_f1_mic= 0.44518 train_f1_mac= 0.17382 val_loss= 0.51578 val_f1_mic= 0.47880 val_f1_mac= 0.21356 time= 0.08221
Iter: 0008 train_loss= 0.52148 train_f1_mic= 0.44979 train_f1_mac= 0.19134 val_loss= 0.51578 val_f1_mic= 0.47880 val_f1_mac= 0.21356 time= 0.08191
Iter: 0013 train_loss= 0.51038 train_f1_mic= 0.46107 train_f1_mac= 0.19591 val_loss= 0.51578 val_f1_mic= 0.47880 val_f1_mac= 0.21356 time= 0.08169
Iter: 0018 train_loss= 0.51416 train_f1_mic= 0.45292 train_f1_mac= 0.19420 val_loss= 0.51578 val_f1_mic= 0.47880 val_f1_mac= 0.21356 time= 0.08146
Epoch: 0010
Iter: 0004 train_loss= 0.50781 train_f1_mic= 0.48486 train_f1_mac= 0.21342 val_loss= 0.53391 val_f1_mic= 0.44934 val_f1_mac= 0.20062 time= 0.08146
Iter: 0009 train_loss= 0.52022 train_f1_mic= 0.48227 train_f1_mac= 0.22627 val_loss= 0.53391 val_f1_mic= 0.44934 val_f1_mac= 0.20062 time= 0.08139
Iter: 0014 train_loss= 0.51969 train_f1_mic= 0.47769 train_f1_mac= 0.21955 val_loss= 0.53391 val_f1_mic= 0.44934 val_f1_mac= 0.20062 time= 0.08117
Optimization Finished!
Full validation stats: loss= 0.52908 f1_micro= 0.46911 f1_macro= 0.21066 time= 0.16955
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4628741898518493
Rewards :  0.011879427679813925 Accuracy :  0.47237773199570043
Total reward :  1.2581067094426766
Saved buffers to file `buffers.txt` !
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 1, 'relu']
Training RNN (Reward ip) :  [0.01187943]
Trial 301: Controller loss : 9947.914062

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'sigmoid', 4, 'linear']
2018-08-31 01:01:13.914593: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:01:13.914831: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:01:13.915063: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:01:13.915233: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:01:13.915448: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69392 train_f1_mic= 0.36693 train_f1_mac= 0.22848 val_loss= 0.66573 val_f1_mic= 0.39399 val_f1_mac= 0.11116 time= 0.83380
Iter: 0005 train_loss= 0.57802 train_f1_mic= 0.37290 train_f1_mac= 0.08728 val_loss= 0.66573 val_f1_mic= 0.39399 val_f1_mac= 0.11116 time= 0.17421
Iter: 0010 train_loss= 0.54044 train_f1_mic= 0.40199 train_f1_mac= 0.10123 val_loss= 0.66573 val_f1_mic= 0.39399 val_f1_mac= 0.11116 time= 0.11479
Iter: 0015 train_loss= 0.54200 train_f1_mic= 0.38395 train_f1_mac= 0.09272 val_loss= 0.66573 val_f1_mic= 0.39399 val_f1_mac= 0.11116 time= 0.09244
Epoch: 0002
Iter: 0001 train_loss= 0.55516 train_f1_mic= 0.36997 train_f1_mac= 0.08897 val_loss= 0.57805 val_f1_mic= 0.35648 val_f1_mac= 0.08973 time= 0.08264
Iter: 0006 train_loss= 0.53423 train_f1_mic= 0.38564 train_f1_mac= 0.09189 val_loss= 0.57805 val_f1_mic= 0.35648 val_f1_mac= 0.08973 time= 0.07484
Iter: 0011 train_loss= 0.54130 train_f1_mic= 0.37219 train_f1_mac= 0.08768 val_loss= 0.57805 val_f1_mic= 0.35648 val_f1_mac= 0.08973 time= 0.06927
Iter: 0016 train_loss= 0.55232 train_f1_mic= 0.37429 train_f1_mac= 0.09281 val_loss= 0.57805 val_f1_mic= 0.35648 val_f1_mac= 0.08973 time= 0.06563
Epoch: 0003
Iter: 0002 train_loss= 0.55080 train_f1_mic= 0.39932 train_f1_mac= 0.10413 val_loss= 0.56696 val_f1_mic= 0.39276 val_f1_mac= 0.10618 time= 0.06337
Iter: 0007 train_loss= 0.53168 train_f1_mic= 0.38172 train_f1_mac= 0.09148 val_loss= 0.56696 val_f1_mic= 0.39276 val_f1_mac= 0.10618 time= 0.06112
Iter: 0012 train_loss= 0.53878 train_f1_mic= 0.37451 train_f1_mac= 0.08754 val_loss= 0.56696 val_f1_mic= 0.39276 val_f1_mac= 0.10618 time= 0.05920
Iter: 0017 train_loss= 0.53672 train_f1_mic= 0.38612 train_f1_mac= 0.09300 val_loss= 0.56696 val_f1_mic= 0.39276 val_f1_mac= 0.10618 time= 0.05767
Epoch: 0004
Iter: 0003 train_loss= 0.54827 train_f1_mic= 0.39978 train_f1_mac= 0.10393 val_loss= 0.56374 val_f1_mic= 0.38753 val_f1_mac= 0.10449 time= 0.05689
Iter: 0008 train_loss= 0.53579 train_f1_mic= 0.37313 train_f1_mac= 0.08718 val_loss= 0.56374 val_f1_mic= 0.38753 val_f1_mac= 0.10449 time= 0.05588
Iter: 0013 train_loss= 0.53539 train_f1_mic= 0.37049 train_f1_mac= 0.08668 val_loss= 0.56374 val_f1_mic= 0.38753 val_f1_mac= 0.10449 time= 0.05490
Iter: 0018 train_loss= 0.53234 train_f1_mic= 0.40414 train_f1_mac= 0.10159 val_loss= 0.56374 val_f1_mic= 0.38753 val_f1_mac= 0.10449 time= 0.05415
Epoch: 0005
Iter: 0004 train_loss= 0.54966 train_f1_mic= 0.39208 train_f1_mac= 0.10022 val_loss= 0.58546 val_f1_mic= 0.38244 val_f1_mac= 0.10703 time= 0.05367
Iter: 0009 train_loss= 0.54744 train_f1_mic= 0.36377 train_f1_mac= 0.08725 val_loss= 0.58546 val_f1_mic= 0.38244 val_f1_mac= 0.10703 time= 0.05298
Iter: 0014 train_loss= 0.53886 train_f1_mic= 0.36966 train_f1_mac= 0.08738 val_loss= 0.58546 val_f1_mic= 0.38244 val_f1_mac= 0.10703 time= 0.05231
Epoch: 0006
Iter: 0000 train_loss= 0.53729 train_f1_mic= 0.40199 train_f1_mac= 0.10307 val_loss= 0.55022 val_f1_mic= 0.40475 val_f1_mac= 0.10945 time= 0.05191
Iter: 0005 train_loss= 0.53468 train_f1_mic= 0.39308 train_f1_mac= 0.10095 val_loss= 0.55022 val_f1_mic= 0.40475 val_f1_mac= 0.10945 time= 0.05152
Iter: 0010 train_loss= 0.53666 train_f1_mic= 0.37846 train_f1_mac= 0.10140 val_loss= 0.55022 val_f1_mic= 0.40475 val_f1_mac= 0.10945 time= 0.05111
Iter: 0015 train_loss= 0.53173 train_f1_mic= 0.40280 train_f1_mac= 0.11393 val_loss= 0.55022 val_f1_mic= 0.40475 val_f1_mac= 0.10945 time= 0.05074
Epoch: 0007
Iter: 0001 train_loss= 0.53072 train_f1_mic= 0.41646 train_f1_mac= 0.12566 val_loss= 0.55640 val_f1_mic= 0.41391 val_f1_mac= 0.13355 time= 0.05051
Iter: 0006 train_loss= 0.53194 train_f1_mic= 0.40768 train_f1_mac= 0.12763 val_loss= 0.55640 val_f1_mic= 0.41391 val_f1_mac= 0.13355 time= 0.05017
Iter: 0011 train_loss= 0.53458 train_f1_mic= 0.39935 train_f1_mac= 0.12064 val_loss= 0.55640 val_f1_mic= 0.41391 val_f1_mac= 0.13355 time= 0.04987
Iter: 0016 train_loss= 0.52817 train_f1_mic= 0.41429 train_f1_mac= 0.12554 val_loss= 0.55640 val_f1_mic= 0.41391 val_f1_mac= 0.13355 time= 0.04958
Epoch: 0008
Iter: 0002 train_loss= 0.52860 train_f1_mic= 0.43329 train_f1_mac= 0.14448 val_loss= 0.56816 val_f1_mic= 0.43122 val_f1_mac= 0.15508 time= 0.04969
Iter: 0007 train_loss= 0.52915 train_f1_mic= 0.41672 train_f1_mac= 0.13577 val_loss= 0.56816 val_f1_mic= 0.43122 val_f1_mac= 0.15508 time= 0.04941
Iter: 0012 train_loss= 0.51908 train_f1_mic= 0.38589 train_f1_mac= 0.10512 val_loss= 0.56816 val_f1_mic= 0.43122 val_f1_mac= 0.15508 time= 0.04927
Iter: 0017 train_loss= 0.53774 train_f1_mic= 0.41515 train_f1_mac= 0.12757 val_loss= 0.56816 val_f1_mic= 0.43122 val_f1_mac= 0.15508 time= 0.04902
Epoch: 0009
Iter: 0003 train_loss= 0.53264 train_f1_mic= 0.41630 train_f1_mac= 0.12711 val_loss= 0.55635 val_f1_mic= 0.39856 val_f1_mac= 0.12836 time= 0.04893
Iter: 0008 train_loss= 0.53079 train_f1_mic= 0.40427 train_f1_mac= 0.12692 val_loss= 0.55635 val_f1_mic= 0.39856 val_f1_mac= 0.12836 time= 0.04881
Iter: 0013 train_loss= 0.54545 train_f1_mic= 0.42121 train_f1_mac= 0.14835 val_loss= 0.55635 val_f1_mic= 0.39856 val_f1_mac= 0.12836 time= 0.04867
Iter: 0018 train_loss= 0.52634 train_f1_mic= 0.38181 train_f1_mac= 0.10806 val_loss= 0.55635 val_f1_mic= 0.39856 val_f1_mac= 0.12836 time= 0.04851
Epoch: 0010
Iter: 0004 train_loss= 0.53091 train_f1_mic= 0.41496 train_f1_mac= 0.12942 val_loss= 0.55541 val_f1_mic= 0.42209 val_f1_mac= 0.14227 time= 0.04865
Iter: 0009 train_loss= 0.52257 train_f1_mic= 0.43240 train_f1_mac= 0.13951 val_loss= 0.55541 val_f1_mic= 0.42209 val_f1_mac= 0.14227 time= 0.04849
Iter: 0014 train_loss= 0.53682 train_f1_mic= 0.38221 train_f1_mac= 0.11588 val_loss= 0.55541 val_f1_mic= 0.42209 val_f1_mac= 0.14227 time= 0.04832
Optimization Finished!
Full validation stats: loss= 0.55139 f1_micro= 0.40245 f1_macro= 0.13266 time= 0.11269
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4503704107194224
Rewards :  -0.06251889566213442 Accuracy :  0.4003552941897149
Total reward :  1.1955878137805422
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'sigmoid', 4, 'linear']
Training RNN (Reward ip) :  [-0.06251889]
Trial 302: Controller loss : 13824.828125

Prediction action from Controller
State input to Controller for Action :  [0. 0. 3. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:01:29.029380: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:01:29.029834: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:01:29.030287: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:01:29.030613: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:01:29.031013: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69387 train_f1_mic= 0.34544 train_f1_mac= 0.28471 val_loss= 0.66670 val_f1_mic= 0.41847 val_f1_mac= 0.14182 time= 0.77209
Iter: 0005 train_loss= 0.59427 train_f1_mic= 0.37827 train_f1_mac= 0.09637 val_loss= 0.66670 val_f1_mic= 0.41847 val_f1_mac= 0.14182 time= 0.14032
Iter: 0010 train_loss= 0.55453 train_f1_mic= 0.36129 train_f1_mac= 0.08748 val_loss= 0.66670 val_f1_mic= 0.41847 val_f1_mac= 0.14182 time= 0.08297
Iter: 0015 train_loss= 0.54135 train_f1_mic= 0.41130 train_f1_mac= 0.11090 val_loss= 0.66670 val_f1_mic= 0.41847 val_f1_mac= 0.14182 time= 0.06128
Epoch: 0002
Iter: 0001 train_loss= 0.53977 train_f1_mic= 0.38637 train_f1_mac= 0.09727 val_loss= 0.56030 val_f1_mic= 0.38363 val_f1_mac= 0.10076 time= 0.05073
Iter: 0006 train_loss= 0.52979 train_f1_mic= 0.37541 train_f1_mac= 0.09042 val_loss= 0.56030 val_f1_mic= 0.38363 val_f1_mac= 0.10076 time= 0.04404
Iter: 0011 train_loss= 0.53096 train_f1_mic= 0.38242 train_f1_mac= 0.09847 val_loss= 0.56030 val_f1_mic= 0.38363 val_f1_mac= 0.10076 time= 0.03919
Iter: 0016 train_loss= 0.53737 train_f1_mic= 0.40687 train_f1_mac= 0.11186 val_loss= 0.56030 val_f1_mic= 0.38363 val_f1_mac= 0.10076 time= 0.03566
Epoch: 0003
Iter: 0002 train_loss= 0.52486 train_f1_mic= 0.39491 train_f1_mac= 0.10735 val_loss= 0.57110 val_f1_mic= 0.38102 val_f1_mac= 0.11172 time= 0.03389
Iter: 0007 train_loss= 0.53958 train_f1_mic= 0.38578 train_f1_mac= 0.11230 val_loss= 0.57110 val_f1_mic= 0.38102 val_f1_mac= 0.11172 time= 0.03228
Iter: 0012 train_loss= 0.53426 train_f1_mic= 0.42136 train_f1_mac= 0.13357 val_loss= 0.57110 val_f1_mic= 0.38102 val_f1_mac= 0.11172 time= 0.03055
Iter: 0017 train_loss= 0.52051 train_f1_mic= 0.40563 train_f1_mac= 0.12424 val_loss= 0.57110 val_f1_mic= 0.38102 val_f1_mac= 0.11172 time= 0.02905
Epoch: 0004
Iter: 0003 train_loss= 0.52904 train_f1_mic= 0.42501 train_f1_mac= 0.13674 val_loss= 0.55903 val_f1_mic= 0.39639 val_f1_mac= 0.12871 time= 0.02806
Iter: 0008 train_loss= 0.51247 train_f1_mic= 0.42993 train_f1_mac= 0.13656 val_loss= 0.55903 val_f1_mic= 0.39639 val_f1_mac= 0.12871 time= 0.02718
Iter: 0013 train_loss= 0.51642 train_f1_mic= 0.42711 train_f1_mac= 0.13237 val_loss= 0.55903 val_f1_mic= 0.39639 val_f1_mac= 0.12871 time= 0.02629
Iter: 0018 train_loss= 0.50953 train_f1_mic= 0.42924 train_f1_mac= 0.13649 val_loss= 0.55903 val_f1_mic= 0.39639 val_f1_mac= 0.12871 time= 0.02554
Epoch: 0005
Iter: 0004 train_loss= 0.51739 train_f1_mic= 0.43935 train_f1_mac= 0.14755 val_loss= 0.56716 val_f1_mic= 0.40111 val_f1_mac= 0.13842 time= 0.02509
Iter: 0009 train_loss= 0.51917 train_f1_mic= 0.42858 train_f1_mac= 0.14790 val_loss= 0.56716 val_f1_mic= 0.40111 val_f1_mac= 0.13842 time= 0.02455
Iter: 0014 train_loss= 0.51465 train_f1_mic= 0.43963 train_f1_mac= 0.15886 val_loss= 0.56716 val_f1_mic= 0.40111 val_f1_mac= 0.13842 time= 0.02406
Epoch: 0006
Iter: 0000 train_loss= 0.50644 train_f1_mic= 0.44273 train_f1_mac= 0.16791 val_loss= 0.53947 val_f1_mic= 0.46449 val_f1_mac= 0.19835 time= 0.02377
Iter: 0005 train_loss= 0.52604 train_f1_mic= 0.45539 train_f1_mac= 0.17728 val_loss= 0.53947 val_f1_mic= 0.46449 val_f1_mac= 0.19835 time= 0.02331
Iter: 0010 train_loss= 0.49994 train_f1_mic= 0.44651 train_f1_mac= 0.16769 val_loss= 0.53947 val_f1_mic= 0.46449 val_f1_mac= 0.19835 time= 0.02302
Iter: 0015 train_loss= 0.52080 train_f1_mic= 0.45229 train_f1_mac= 0.17819 val_loss= 0.53947 val_f1_mic= 0.46449 val_f1_mac= 0.19835 time= 0.02265
Epoch: 0007
Iter: 0001 train_loss= 0.50728 train_f1_mic= 0.46190 train_f1_mac= 0.19534 val_loss= 0.54616 val_f1_mic= 0.46283 val_f1_mac= 0.20159 time= 0.02248
Iter: 0006 train_loss= 0.51854 train_f1_mic= 0.45490 train_f1_mac= 0.19806 val_loss= 0.54616 val_f1_mic= 0.46283 val_f1_mac= 0.20159 time= 0.02216
Iter: 0011 train_loss= 0.51833 train_f1_mic= 0.43203 train_f1_mac= 0.16304 val_loss= 0.54616 val_f1_mic= 0.46283 val_f1_mac= 0.20159 time= 0.02190
Iter: 0016 train_loss= 0.51433 train_f1_mic= 0.45119 train_f1_mac= 0.18594 val_loss= 0.54616 val_f1_mic= 0.46283 val_f1_mac= 0.20159 time= 0.02162
Epoch: 0008
Iter: 0002 train_loss= 0.51575 train_f1_mic= 0.44742 train_f1_mac= 0.19093 val_loss= 0.53357 val_f1_mic= 0.46481 val_f1_mac= 0.20890 time= 0.02147
Iter: 0007 train_loss= 0.51429 train_f1_mic= 0.46236 train_f1_mac= 0.20572 val_loss= 0.53357 val_f1_mic= 0.46481 val_f1_mac= 0.20890 time= 0.02125
Iter: 0012 train_loss= 0.50054 train_f1_mic= 0.48504 train_f1_mac= 0.23089 val_loss= 0.53357 val_f1_mic= 0.46481 val_f1_mac= 0.20890 time= 0.02103
Iter: 0017 train_loss= 0.50660 train_f1_mic= 0.45340 train_f1_mac= 0.20280 val_loss= 0.53357 val_f1_mic= 0.46481 val_f1_mac= 0.20890 time= 0.02082
Epoch: 0009
Iter: 0003 train_loss= 0.51122 train_f1_mic= 0.46581 train_f1_mac= 0.21036 val_loss= 0.53464 val_f1_mic= 0.47415 val_f1_mac= 0.23289 time= 0.02083
Iter: 0008 train_loss= 0.51237 train_f1_mic= 0.47340 train_f1_mac= 0.22823 val_loss= 0.53464 val_f1_mic= 0.47415 val_f1_mac= 0.23289 time= 0.02068
Iter: 0013 train_loss= 0.50576 train_f1_mic= 0.46422 train_f1_mac= 0.21398 val_loss= 0.53464 val_f1_mic= 0.47415 val_f1_mac= 0.23289 time= 0.02051
Iter: 0018 train_loss= 0.49553 train_f1_mic= 0.46447 train_f1_mac= 0.22545 val_loss= 0.53464 val_f1_mic= 0.47415 val_f1_mac= 0.23289 time= 0.02038
Epoch: 0010
Iter: 0004 train_loss= 0.50276 train_f1_mic= 0.50728 train_f1_mac= 0.26928 val_loss= 0.52706 val_f1_mic= 0.49743 val_f1_mac= 0.27835 time= 0.02030
Iter: 0009 train_loss= 0.49507 train_f1_mic= 0.51790 train_f1_mac= 0.28386 val_loss= 0.52706 val_f1_mic= 0.49743 val_f1_mac= 0.27835 time= 0.02016
Iter: 0014 train_loss= 0.49879 train_f1_mic= 0.51091 train_f1_mac= 0.26700 val_loss= 0.52706 val_f1_mic= 0.49743 val_f1_mac= 0.27835 time= 0.02005
Optimization Finished!
Full validation stats: loss= 0.52349 f1_micro= 0.46217 f1_macro= 0.23723 time= 0.12068
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.45265001402500094
Rewards :  0.011398016527892574 Accuracy :  0.461768427247315
Total reward :  1.2069858303084349
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.01139802]
Trial 303: Controller loss : 130.249863

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:01:38.254719: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:01:38.255209: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:01:38.255674: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:01:38.256023: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:01:38.256441: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69242 train_f1_mic= 0.37391 train_f1_mac= 0.28941 val_loss= 0.66783 val_f1_mic= 0.38450 val_f1_mac= 0.11496 time= 0.78824
Iter: 0005 train_loss= 0.59150 train_f1_mic= 0.36752 train_f1_mac= 0.08763 val_loss= 0.66783 val_f1_mic= 0.38450 val_f1_mac= 0.11496 time= 0.14317
Iter: 0010 train_loss= 0.55127 train_f1_mic= 0.39294 train_f1_mac= 0.09899 val_loss= 0.66783 val_f1_mic= 0.38450 val_f1_mac= 0.11496 time= 0.08453
Iter: 0015 train_loss= 0.55478 train_f1_mic= 0.39445 train_f1_mac= 0.10273 val_loss= 0.66783 val_f1_mic= 0.38450 val_f1_mac= 0.11496 time= 0.06304
Epoch: 0002
Iter: 0001 train_loss= 0.53373 train_f1_mic= 0.39036 train_f1_mac= 0.09720 val_loss= 0.54316 val_f1_mic= 0.38152 val_f1_mac= 0.09747 time= 0.05226
Iter: 0006 train_loss= 0.54587 train_f1_mic= 0.36580 train_f1_mac= 0.09159 val_loss= 0.54316 val_f1_mic= 0.38152 val_f1_mac= 0.09747 time= 0.04497
Iter: 0011 train_loss= 0.53221 train_f1_mic= 0.38312 train_f1_mac= 0.09698 val_loss= 0.54316 val_f1_mic= 0.38152 val_f1_mac= 0.09747 time= 0.04039
Iter: 0016 train_loss= 0.53192 train_f1_mic= 0.38328 train_f1_mac= 0.10085 val_loss= 0.54316 val_f1_mic= 0.38152 val_f1_mac= 0.09747 time= 0.03702
Epoch: 0003
Iter: 0002 train_loss= 0.52466 train_f1_mic= 0.40588 train_f1_mac= 0.10929 val_loss= 0.55581 val_f1_mic= 0.37758 val_f1_mac= 0.10818 time= 0.03467
Iter: 0007 train_loss= 0.52870 train_f1_mic= 0.38303 train_f1_mac= 0.10737 val_loss= 0.55581 val_f1_mic= 0.37758 val_f1_mac= 0.10818 time= 0.03257
Iter: 0012 train_loss= 0.53446 train_f1_mic= 0.40285 train_f1_mac= 0.12288 val_loss= 0.55581 val_f1_mic= 0.37758 val_f1_mac= 0.10818 time= 0.03078
Iter: 0017 train_loss= 0.52694 train_f1_mic= 0.41909 train_f1_mac= 0.13023 val_loss= 0.55581 val_f1_mic= 0.37758 val_f1_mac= 0.10818 time= 0.02942
Epoch: 0004
Iter: 0003 train_loss= 0.52854 train_f1_mic= 0.43431 train_f1_mac= 0.13942 val_loss= 0.54408 val_f1_mic= 0.43872 val_f1_mac= 0.14543 time= 0.02840
Iter: 0008 train_loss= 0.53019 train_f1_mic= 0.41062 train_f1_mac= 0.13344 val_loss= 0.54408 val_f1_mic= 0.43872 val_f1_mac= 0.14543 time= 0.02729
Iter: 0013 train_loss= 0.53207 train_f1_mic= 0.41273 train_f1_mac= 0.13637 val_loss= 0.54408 val_f1_mic= 0.43872 val_f1_mac= 0.14543 time= 0.02652
Iter: 0018 train_loss= 0.53260 train_f1_mic= 0.42501 train_f1_mac= 0.14757 val_loss= 0.54408 val_f1_mic= 0.43872 val_f1_mac= 0.14543 time= 0.02577
Epoch: 0005
Iter: 0004 train_loss= 0.51461 train_f1_mic= 0.44747 train_f1_mac= 0.15991 val_loss= 0.53396 val_f1_mic= 0.43416 val_f1_mac= 0.15122 time= 0.02531
Iter: 0009 train_loss= 0.51410 train_f1_mic= 0.43098 train_f1_mac= 0.15609 val_loss= 0.53396 val_f1_mic= 0.43416 val_f1_mac= 0.15122 time= 0.02485
Iter: 0014 train_loss= 0.52081 train_f1_mic= 0.44412 train_f1_mac= 0.17265 val_loss= 0.53396 val_f1_mic= 0.43416 val_f1_mac= 0.15122 time= 0.02446
Epoch: 0006
Iter: 0000 train_loss= 0.51175 train_f1_mic= 0.44741 train_f1_mac= 0.17035 val_loss= 0.54460 val_f1_mic= 0.46785 val_f1_mac= 0.20505 time= 0.02411
Iter: 0005 train_loss= 0.52231 train_f1_mic= 0.41969 train_f1_mac= 0.15904 val_loss= 0.54460 val_f1_mic= 0.46785 val_f1_mac= 0.20505 time= 0.02364
Iter: 0010 train_loss= 0.52014 train_f1_mic= 0.46657 train_f1_mac= 0.19226 val_loss= 0.54460 val_f1_mic= 0.46785 val_f1_mac= 0.20505 time= 0.02321
Iter: 0015 train_loss= 0.51707 train_f1_mic= 0.44682 train_f1_mac= 0.17901 val_loss= 0.54460 val_f1_mic= 0.46785 val_f1_mac= 0.20505 time= 0.02283
Epoch: 0007
Iter: 0001 train_loss= 0.52103 train_f1_mic= 0.43238 train_f1_mac= 0.17673 val_loss= 0.52881 val_f1_mic= 0.44936 val_f1_mac= 0.18946 time= 0.02268
Iter: 0006 train_loss= 0.50246 train_f1_mic= 0.46260 train_f1_mac= 0.19989 val_loss= 0.52881 val_f1_mic= 0.44936 val_f1_mac= 0.18946 time= 0.02240
Iter: 0011 train_loss= 0.51470 train_f1_mic= 0.48460 train_f1_mac= 0.22396 val_loss= 0.52881 val_f1_mic= 0.44936 val_f1_mac= 0.18946 time= 0.02217
Iter: 0016 train_loss= 0.50677 train_f1_mic= 0.47226 train_f1_mac= 0.21882 val_loss= 0.52881 val_f1_mic= 0.44936 val_f1_mac= 0.18946 time= 0.02186
Epoch: 0008
Iter: 0002 train_loss= 0.50195 train_f1_mic= 0.44405 train_f1_mac= 0.18483 val_loss= 0.53743 val_f1_mic= 0.44931 val_f1_mac= 0.19814 time= 0.02182
Iter: 0007 train_loss= 0.51104 train_f1_mic= 0.48941 train_f1_mac= 0.23364 val_loss= 0.53743 val_f1_mic= 0.44931 val_f1_mac= 0.19814 time= 0.02162
Iter: 0012 train_loss= 0.50954 train_f1_mic= 0.46247 train_f1_mac= 0.21081 val_loss= 0.53743 val_f1_mic= 0.44931 val_f1_mac= 0.19814 time= 0.02137
Iter: 0017 train_loss= 0.50687 train_f1_mic= 0.44708 train_f1_mac= 0.19423 val_loss= 0.53743 val_f1_mic= 0.44931 val_f1_mac= 0.19814 time= 0.02113
Epoch: 0009
Iter: 0003 train_loss= 0.49825 train_f1_mic= 0.50058 train_f1_mac= 0.25723 val_loss= 0.52184 val_f1_mic= 0.51321 val_f1_mac= 0.27631 time= 0.02113
Iter: 0008 train_loss= 0.50342 train_f1_mic= 0.49275 train_f1_mac= 0.24374 val_loss= 0.52184 val_f1_mic= 0.51321 val_f1_mac= 0.27631 time= 0.02092
Iter: 0013 train_loss= 0.49725 train_f1_mic= 0.47423 train_f1_mac= 0.23814 val_loss= 0.52184 val_f1_mic= 0.51321 val_f1_mac= 0.27631 time= 0.02075
Iter: 0018 train_loss= 0.50889 train_f1_mic= 0.47194 train_f1_mac= 0.23875 val_loss= 0.52184 val_f1_mic= 0.51321 val_f1_mac= 0.27631 time= 0.02056
Epoch: 0010
Iter: 0004 train_loss= 0.49825 train_f1_mic= 0.48564 train_f1_mac= 0.24142 val_loss= 0.52637 val_f1_mic= 0.46102 val_f1_mac= 0.23317 time= 0.02054
Iter: 0009 train_loss= 0.49777 train_f1_mic= 0.51419 train_f1_mac= 0.27146 val_loss= 0.52637 val_f1_mic= 0.46102 val_f1_mac= 0.23317 time= 0.02039
Iter: 0014 train_loss= 0.49728 train_f1_mic= 0.50024 train_f1_mac= 0.25885 val_loss= 0.52637 val_f1_mic= 0.46102 val_f1_mac= 0.23317 time= 0.02026
Optimization Finished!
Full validation stats: loss= 0.51755 f1_micro= 0.48027 f1_macro= 0.25865 time= 0.11370
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4570993812454224
Rewards :  0.022246836102107315 Accuracy :  0.47489685012710825
Total reward :  1.2292326664105422
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02224684]
Trial 304: Controller loss : 130.287842

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'relu', 3, 'relu']
2018-08-31 01:01:47.553300: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:01:47.553547: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:01:47.553780: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:01:47.554122: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:01:47.554305: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69738 train_f1_mic= 0.35664 train_f1_mac= 0.30688 val_loss= 0.66426 val_f1_mic= 0.39188 val_f1_mac= 0.11289 time= 0.74605
Iter: 0005 train_loss= 0.58605 train_f1_mic= 0.38574 train_f1_mac= 0.09365 val_loss= 0.66426 val_f1_mic= 0.39188 val_f1_mac= 0.11289 time= 0.13696
Iter: 0010 train_loss= 0.54659 train_f1_mic= 0.38656 train_f1_mac= 0.09578 val_loss= 0.66426 val_f1_mic= 0.39188 val_f1_mac= 0.11289 time= 0.08141
Iter: 0015 train_loss= 0.55119 train_f1_mic= 0.39860 train_f1_mac= 0.10834 val_loss= 0.66426 val_f1_mic= 0.39188 val_f1_mac= 0.11289 time= 0.06034
Epoch: 0002
Iter: 0001 train_loss= 0.54368 train_f1_mic= 0.39195 train_f1_mac= 0.10453 val_loss= 0.56397 val_f1_mic= 0.38116 val_f1_mac= 0.10711 time= 0.05020
Iter: 0006 train_loss= 0.54827 train_f1_mic= 0.37839 train_f1_mac= 0.09977 val_loss= 0.56397 val_f1_mic= 0.38116 val_f1_mac= 0.10711 time= 0.04334
Iter: 0011 train_loss= 0.53903 train_f1_mic= 0.37888 train_f1_mac= 0.09946 val_loss= 0.56397 val_f1_mic= 0.38116 val_f1_mac= 0.10711 time= 0.03896
Iter: 0016 train_loss= 0.53300 train_f1_mic= 0.39391 train_f1_mac= 0.10725 val_loss= 0.56397 val_f1_mic= 0.38116 val_f1_mac= 0.10711 time= 0.03557
Epoch: 0003
Iter: 0002 train_loss= 0.52156 train_f1_mic= 0.40332 train_f1_mac= 0.10976 val_loss= 0.57257 val_f1_mic= 0.38861 val_f1_mac= 0.11793 time= 0.03391
Iter: 0007 train_loss= 0.53058 train_f1_mic= 0.40698 train_f1_mac= 0.12102 val_loss= 0.57257 val_f1_mic= 0.38861 val_f1_mac= 0.11793 time= 0.03198
Iter: 0012 train_loss= 0.52408 train_f1_mic= 0.40063 train_f1_mac= 0.12002 val_loss= 0.57257 val_f1_mic= 0.38861 val_f1_mac= 0.11793 time= 0.03039
Iter: 0017 train_loss= 0.52205 train_f1_mic= 0.42595 train_f1_mac= 0.13422 val_loss= 0.57257 val_f1_mic= 0.38861 val_f1_mac= 0.11793 time= 0.02908
Epoch: 0004
Iter: 0003 train_loss= 0.51777 train_f1_mic= 0.42862 train_f1_mac= 0.13806 val_loss= 0.53475 val_f1_mic= 0.42991 val_f1_mac= 0.14476 time= 0.02815
Iter: 0008 train_loss= 0.54119 train_f1_mic= 0.43516 train_f1_mac= 0.15484 val_loss= 0.53475 val_f1_mic= 0.42991 val_f1_mac= 0.14476 time= 0.02712
Iter: 0013 train_loss= 0.53587 train_f1_mic= 0.41458 train_f1_mac= 0.13930 val_loss= 0.53475 val_f1_mic= 0.42991 val_f1_mac= 0.14476 time= 0.02617
Iter: 0018 train_loss= 0.52866 train_f1_mic= 0.42918 train_f1_mac= 0.14421 val_loss= 0.53475 val_f1_mic= 0.42991 val_f1_mac= 0.14476 time= 0.02543
Epoch: 0005
Iter: 0004 train_loss= 0.52405 train_f1_mic= 0.43302 train_f1_mac= 0.15256 val_loss= 0.53415 val_f1_mic= 0.45022 val_f1_mac= 0.16207 time= 0.02497
Iter: 0009 train_loss= 0.51070 train_f1_mic= 0.43260 train_f1_mac= 0.15288 val_loss= 0.53415 val_f1_mic= 0.45022 val_f1_mac= 0.16207 time= 0.02449
Iter: 0014 train_loss= 0.52044 train_f1_mic= 0.43036 train_f1_mac= 0.15485 val_loss= 0.53415 val_f1_mic= 0.45022 val_f1_mac= 0.16207 time= 0.02397
Epoch: 0006
Iter: 0000 train_loss= 0.51100 train_f1_mic= 0.42774 train_f1_mac= 0.15323 val_loss= 0.54055 val_f1_mic= 0.42129 val_f1_mac= 0.15251 time= 0.02362
Iter: 0005 train_loss= 0.51514 train_f1_mic= 0.44650 train_f1_mac= 0.17158 val_loss= 0.54055 val_f1_mic= 0.42129 val_f1_mac= 0.15251 time= 0.02322
Iter: 0010 train_loss= 0.52459 train_f1_mic= 0.42959 train_f1_mac= 0.16399 val_loss= 0.54055 val_f1_mic= 0.42129 val_f1_mac= 0.15251 time= 0.02282
Iter: 0015 train_loss= 0.52464 train_f1_mic= 0.43755 train_f1_mac= 0.17019 val_loss= 0.54055 val_f1_mic= 0.42129 val_f1_mac= 0.15251 time= 0.02251
Epoch: 0007
Iter: 0001 train_loss= 0.52783 train_f1_mic= 0.45842 train_f1_mac= 0.19405 val_loss= 0.53413 val_f1_mic= 0.47873 val_f1_mac= 0.22072 time= 0.02228
Iter: 0006 train_loss= 0.51568 train_f1_mic= 0.43881 train_f1_mac= 0.16877 val_loss= 0.53413 val_f1_mic= 0.47873 val_f1_mac= 0.22072 time= 0.02197
Iter: 0011 train_loss= 0.52301 train_f1_mic= 0.42184 train_f1_mac= 0.16146 val_loss= 0.53413 val_f1_mic= 0.47873 val_f1_mac= 0.22072 time= 0.02172
Iter: 0016 train_loss= 0.51436 train_f1_mic= 0.48521 train_f1_mac= 0.21552 val_loss= 0.53413 val_f1_mic= 0.47873 val_f1_mac= 0.22072 time= 0.02145
Epoch: 0008
Iter: 0002 train_loss= 0.52030 train_f1_mic= 0.42735 train_f1_mac= 0.17006 val_loss= 0.53956 val_f1_mic= 0.45427 val_f1_mac= 0.20548 time= 0.02129
Iter: 0007 train_loss= 0.51937 train_f1_mic= 0.47795 train_f1_mac= 0.22321 val_loss= 0.53956 val_f1_mic= 0.45427 val_f1_mac= 0.20548 time= 0.02105
Iter: 0012 train_loss= 0.50178 train_f1_mic= 0.43619 train_f1_mac= 0.17535 val_loss= 0.53956 val_f1_mic= 0.45427 val_f1_mac= 0.20548 time= 0.02085
Iter: 0017 train_loss= 0.50673 train_f1_mic= 0.47639 train_f1_mac= 0.21232 val_loss= 0.53956 val_f1_mic= 0.45427 val_f1_mac= 0.20548 time= 0.02067
Epoch: 0009
Iter: 0003 train_loss= 0.51447 train_f1_mic= 0.44859 train_f1_mac= 0.19449 val_loss= 0.53417 val_f1_mic= 0.45810 val_f1_mac= 0.21128 time= 0.02069
Iter: 0008 train_loss= 0.50130 train_f1_mic= 0.43830 train_f1_mac= 0.18120 val_loss= 0.53417 val_f1_mic= 0.45810 val_f1_mac= 0.21128 time= 0.02055
Iter: 0013 train_loss= 0.51488 train_f1_mic= 0.49047 train_f1_mac= 0.22599 val_loss= 0.53417 val_f1_mic= 0.45810 val_f1_mac= 0.21128 time= 0.02038
Iter: 0018 train_loss= 0.50244 train_f1_mic= 0.45522 train_f1_mac= 0.19564 val_loss= 0.53417 val_f1_mic= 0.45810 val_f1_mac= 0.21128 time= 0.02022
Epoch: 0010
Iter: 0004 train_loss= 0.50418 train_f1_mic= 0.48932 train_f1_mac= 0.23901 val_loss= 0.51447 val_f1_mic= 0.46897 val_f1_mac= 0.22335 time= 0.02017
Iter: 0009 train_loss= 0.49713 train_f1_mic= 0.48088 train_f1_mac= 0.22762 val_loss= 0.51447 val_f1_mic= 0.46897 val_f1_mac= 0.22335 time= 0.02005
Iter: 0014 train_loss= 0.52011 train_f1_mic= 0.43897 train_f1_mac= 0.18514 val_loss= 0.51447 val_f1_mic= 0.46897 val_f1_mac= 0.22335 time= 0.01992
Optimization Finished!
Full validation stats: loss= 0.52682 f1_micro= 0.46816 f1_macro= 0.22656 time= 0.07679
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4587414551262554
Rewards :  0.008210369404165141 Accuracy :  0.4653097506495875
Total reward :  1.2374430358147073
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.00821037]
Trial 305: Controller loss : 3573.703857

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 4, 'tanh']
2018-08-31 01:01:56.591371: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:01:56.591989: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:01:56.592575: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:01:56.593005: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:01:56.593529: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69435 train_f1_mic= 0.38716 train_f1_mac= 0.28083 val_loss= 0.67539 val_f1_mic= 0.37129 val_f1_mac= 0.13668 time= 0.82341
Iter: 0005 train_loss= 0.58983 train_f1_mic= 0.37462 train_f1_mac= 0.09257 val_loss= 0.67539 val_f1_mic= 0.37129 val_f1_mac= 0.13668 time= 0.18794
Iter: 0010 train_loss= 0.53803 train_f1_mic= 0.39534 train_f1_mac= 0.09655 val_loss= 0.67539 val_f1_mic= 0.37129 val_f1_mac= 0.13668 time= 0.12971
Iter: 0015 train_loss= 0.53875 train_f1_mic= 0.38987 train_f1_mac= 0.09624 val_loss= 0.67539 val_f1_mic= 0.37129 val_f1_mac= 0.13668 time= 0.10794
Epoch: 0002
Iter: 0001 train_loss= 0.53636 train_f1_mic= 0.37905 train_f1_mac= 0.08730 val_loss= 0.55638 val_f1_mic= 0.37075 val_f1_mac= 0.08854 time= 0.09739
Iter: 0006 train_loss= 0.55432 train_f1_mic= 0.37794 train_f1_mac= 0.09285 val_loss= 0.55638 val_f1_mic= 0.37075 val_f1_mac= 0.08854 time= 0.09017
Iter: 0011 train_loss= 0.54960 train_f1_mic= 0.39151 train_f1_mac= 0.09853 val_loss= 0.55638 val_f1_mic= 0.37075 val_f1_mac= 0.08854 time= 0.08528
Iter: 0016 train_loss= 0.56386 train_f1_mic= 0.35905 train_f1_mac= 0.08862 val_loss= 0.55638 val_f1_mic= 0.37075 val_f1_mac= 0.08854 time= 0.08183
Epoch: 0003
Iter: 0002 train_loss= 0.54529 train_f1_mic= 0.39791 train_f1_mac= 0.09961 val_loss= 0.57104 val_f1_mic= 0.37605 val_f1_mac= 0.10002 time= 0.07963
Iter: 0007 train_loss= 0.54964 train_f1_mic= 0.40343 train_f1_mac= 0.10464 val_loss= 0.57104 val_f1_mic= 0.37605 val_f1_mac= 0.10002 time= 0.07757
Iter: 0012 train_loss= 0.53835 train_f1_mic= 0.35616 train_f1_mac= 0.08114 val_loss= 0.57104 val_f1_mic= 0.37605 val_f1_mac= 0.10002 time= 0.07591
Iter: 0017 train_loss= 0.53258 train_f1_mic= 0.36930 train_f1_mac= 0.08563 val_loss= 0.57104 val_f1_mic= 0.37605 val_f1_mac= 0.10002 time= 0.07453
Epoch: 0004
Iter: 0003 train_loss= 0.54067 train_f1_mic= 0.39842 train_f1_mac= 0.09887 val_loss= 0.57062 val_f1_mic= 0.38534 val_f1_mac= 0.10142 time= 0.07365
Iter: 0008 train_loss= 0.53932 train_f1_mic= 0.36894 train_f1_mac= 0.08674 val_loss= 0.57062 val_f1_mic= 0.38534 val_f1_mac= 0.10142 time= 0.07257
Iter: 0013 train_loss= 0.55049 train_f1_mic= 0.36653 train_f1_mac= 0.08830 val_loss= 0.57062 val_f1_mic= 0.38534 val_f1_mac= 0.10142 time= 0.07168
Iter: 0018 train_loss= 0.54171 train_f1_mic= 0.40335 train_f1_mac= 0.10331 val_loss= 0.57062 val_f1_mic= 0.38534 val_f1_mac= 0.10142 time= 0.07090
Epoch: 0005
Iter: 0004 train_loss= 0.53354 train_f1_mic= 0.39997 train_f1_mac= 0.09783 val_loss= 0.55450 val_f1_mic= 0.39898 val_f1_mac= 0.10518 time= 0.07057
Iter: 0009 train_loss= 0.54772 train_f1_mic= 0.36752 train_f1_mac= 0.08791 val_loss= 0.55450 val_f1_mic= 0.39898 val_f1_mac= 0.10518 time= 0.06997
Iter: 0014 train_loss= 0.54198 train_f1_mic= 0.37915 train_f1_mac= 0.09193 val_loss= 0.55450 val_f1_mic= 0.39898 val_f1_mac= 0.10518 time= 0.06941
Epoch: 0006
Iter: 0000 train_loss= 0.53467 train_f1_mic= 0.39934 train_f1_mac= 0.09806 val_loss= 0.56256 val_f1_mic= 0.38792 val_f1_mac= 0.10135 time= 0.06914
Iter: 0005 train_loss= 0.53960 train_f1_mic= 0.38226 train_f1_mac= 0.09217 val_loss= 0.56256 val_f1_mic= 0.38792 val_f1_mac= 0.10135 time= 0.06869
Iter: 0010 train_loss= 0.54506 train_f1_mic= 0.37050 train_f1_mac= 0.09077 val_loss= 0.56256 val_f1_mic= 0.38792 val_f1_mac= 0.10135 time= 0.06830
Iter: 0015 train_loss= 0.55206 train_f1_mic= 0.36268 train_f1_mac= 0.08778 val_loss= 0.56256 val_f1_mic= 0.38792 val_f1_mac= 0.10135 time= 0.06795
Epoch: 0007
Iter: 0001 train_loss= 0.53540 train_f1_mic= 0.39935 train_f1_mac= 0.09784 val_loss= 0.56569 val_f1_mic= 0.39617 val_f1_mac= 0.10345 time= 0.06777
Iter: 0006 train_loss= 0.54241 train_f1_mic= 0.38412 train_f1_mac= 0.09314 val_loss= 0.56569 val_f1_mic= 0.39617 val_f1_mac= 0.10345 time= 0.06745
Iter: 0011 train_loss= 0.54298 train_f1_mic= 0.37021 train_f1_mac= 0.08736 val_loss= 0.56569 val_f1_mic= 0.39617 val_f1_mac= 0.10345 time= 0.06718
Iter: 0016 train_loss= 0.53960 train_f1_mic= 0.40208 train_f1_mac= 0.09982 val_loss= 0.56569 val_f1_mic= 0.39617 val_f1_mac= 0.10345 time= 0.06692
Epoch: 0008
Iter: 0002 train_loss= 0.53937 train_f1_mic= 0.37308 train_f1_mac= 0.08742 val_loss= 0.55297 val_f1_mic= 0.37237 val_f1_mac= 0.09290 time= 0.06680
Iter: 0007 train_loss= 0.53309 train_f1_mic= 0.37885 train_f1_mac= 0.08777 val_loss= 0.55297 val_f1_mic= 0.37237 val_f1_mac= 0.09290 time= 0.06658
Iter: 0012 train_loss= 0.54866 train_f1_mic= 0.39187 train_f1_mac= 0.09915 val_loss= 0.55297 val_f1_mic= 0.37237 val_f1_mac= 0.09290 time= 0.06640
Iter: 0017 train_loss= 0.55346 train_f1_mic= 0.40394 train_f1_mac= 0.10586 val_loss= 0.55297 val_f1_mic= 0.37237 val_f1_mac= 0.09290 time= 0.06619
Epoch: 0009
Iter: 0003 train_loss= 0.54295 train_f1_mic= 0.38873 train_f1_mac= 0.09704 val_loss= 0.54433 val_f1_mic= 0.39594 val_f1_mac= 0.10005 time= 0.06612
Iter: 0008 train_loss= 0.54617 train_f1_mic= 0.37591 train_f1_mac= 0.08943 val_loss= 0.54433 val_f1_mic= 0.39594 val_f1_mac= 0.10005 time= 0.06595
Iter: 0013 train_loss= 0.52974 train_f1_mic= 0.38885 train_f1_mac= 0.09194 val_loss= 0.54433 val_f1_mic= 0.39594 val_f1_mac= 0.10005 time= 0.06576
Iter: 0018 train_loss= 0.54056 train_f1_mic= 0.37502 train_f1_mac= 0.09070 val_loss= 0.54433 val_f1_mic= 0.39594 val_f1_mac= 0.10005 time= 0.06558
Epoch: 0010
Iter: 0004 train_loss= 0.52594 train_f1_mic= 0.39312 train_f1_mac= 0.09212 val_loss= 0.55871 val_f1_mic= 0.37372 val_f1_mac= 0.09407 time= 0.06556
Iter: 0009 train_loss= 0.54935 train_f1_mic= 0.37842 train_f1_mac= 0.09330 val_loss= 0.55871 val_f1_mic= 0.37372 val_f1_mac= 0.09407 time= 0.06541
Iter: 0014 train_loss= 0.55354 train_f1_mic= 0.36438 train_f1_mac= 0.08843 val_loss= 0.55871 val_f1_mic= 0.37372 val_f1_mac= 0.09407 time= 0.06526
Optimization Finished!
Full validation stats: loss= 0.56365 f1_micro= 0.38407 f1_macro= 0.10070 time= 0.12570
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4454448750903252
Rewards :  -0.06648290017965103 Accuracy :  0.3922585549466044
Total reward :  1.1709601356350563
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 4, 'tanh']
Training RNN (Reward ip) :  [-0.0664829]
Trial 306: Controller loss : 16946.089844

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [3, 'tanh', 3, 'linear']
2018-08-31 01:02:14.190410: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:02:14.190984: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:02:14.191314: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:02:14.191552: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:02:14.191868: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69187 train_f1_mic= 0.32509 train_f1_mac= 0.25782 val_loss= 0.67284 val_f1_mic= 0.39639 val_f1_mac= 0.14629 time= 0.88130
Iter: 0005 train_loss= 0.58501 train_f1_mic= 0.36672 train_f1_mac= 0.09065 val_loss= 0.67284 val_f1_mic= 0.39639 val_f1_mac= 0.14629 time= 0.20107
Iter: 0010 train_loss= 0.55405 train_f1_mic= 0.36998 train_f1_mac= 0.09023 val_loss= 0.67284 val_f1_mic= 0.39639 val_f1_mac= 0.14629 time= 0.13832
Iter: 0015 train_loss= 0.54241 train_f1_mic= 0.40097 train_f1_mac= 0.10325 val_loss= 0.67284 val_f1_mic= 0.39639 val_f1_mac= 0.14629 time= 0.11479
Epoch: 0002
Iter: 0001 train_loss= 0.54552 train_f1_mic= 0.37534 train_f1_mac= 0.09238 val_loss= 0.56304 val_f1_mic= 0.37505 val_f1_mac= 0.09549 time= 0.10337
Iter: 0006 train_loss= 0.54035 train_f1_mic= 0.38201 train_f1_mac= 0.09345 val_loss= 0.56304 val_f1_mic= 0.37505 val_f1_mac= 0.09549 time= 0.09581
Iter: 0011 train_loss= 0.53015 train_f1_mic= 0.40242 train_f1_mac= 0.10756 val_loss= 0.56304 val_f1_mic= 0.37505 val_f1_mac= 0.09549 time= 0.09055
Iter: 0016 train_loss= 0.53856 train_f1_mic= 0.39710 train_f1_mac= 0.11227 val_loss= 0.56304 val_f1_mic= 0.37505 val_f1_mac= 0.09549 time= 0.08687
Epoch: 0003
Iter: 0002 train_loss= 0.53379 train_f1_mic= 0.39494 train_f1_mac= 0.11797 val_loss= 0.55405 val_f1_mic= 0.39438 val_f1_mac= 0.12091 time= 0.08445
Iter: 0007 train_loss= 0.53156 train_f1_mic= 0.42285 train_f1_mac= 0.12844 val_loss= 0.55405 val_f1_mic= 0.39438 val_f1_mac= 0.12091 time= 0.08210
Iter: 0012 train_loss= 0.52524 train_f1_mic= 0.42431 train_f1_mac= 0.13326 val_loss= 0.55405 val_f1_mic= 0.39438 val_f1_mac= 0.12091 time= 0.08027
Iter: 0017 train_loss= 0.52763 train_f1_mic= 0.42121 train_f1_mac= 0.13845 val_loss= 0.55405 val_f1_mic= 0.39438 val_f1_mac= 0.12091 time= 0.07876
Epoch: 0004
Iter: 0003 train_loss= 0.53194 train_f1_mic= 0.44151 train_f1_mac= 0.15522 val_loss= 0.53890 val_f1_mic= 0.44455 val_f1_mac= 0.15621 time= 0.07778
Iter: 0008 train_loss= 0.52434 train_f1_mic= 0.43746 train_f1_mac= 0.16152 val_loss= 0.53890 val_f1_mic= 0.44455 val_f1_mac= 0.15621 time= 0.07665
Iter: 0013 train_loss= 0.51991 train_f1_mic= 0.43859 train_f1_mac= 0.16422 val_loss= 0.53890 val_f1_mic= 0.44455 val_f1_mac= 0.15621 time= 0.07568
Iter: 0018 train_loss= 0.52316 train_f1_mic= 0.41514 train_f1_mac= 0.14341 val_loss= 0.53890 val_f1_mic= 0.44455 val_f1_mac= 0.15621 time= 0.07479
Epoch: 0005
Iter: 0004 train_loss= 0.53689 train_f1_mic= 0.42126 train_f1_mac= 0.14831 val_loss= 0.54672 val_f1_mic= 0.42705 val_f1_mac= 0.16141 time= 0.07434
Iter: 0009 train_loss= 0.52681 train_f1_mic= 0.43515 train_f1_mac= 0.17172 val_loss= 0.54672 val_f1_mic= 0.42705 val_f1_mac= 0.16141 time= 0.07368
Iter: 0014 train_loss= 0.52140 train_f1_mic= 0.45136 train_f1_mac= 0.18853 val_loss= 0.54672 val_f1_mic= 0.42705 val_f1_mac= 0.16141 time= 0.07307
Epoch: 0006
Iter: 0000 train_loss= 0.51821 train_f1_mic= 0.45717 train_f1_mac= 0.19179 val_loss= 0.54229 val_f1_mic= 0.45017 val_f1_mac= 0.19876 time= 0.07275
Iter: 0005 train_loss= 0.51056 train_f1_mic= 0.44911 train_f1_mac= 0.17912 val_loss= 0.54229 val_f1_mic= 0.45017 val_f1_mac= 0.19876 time= 0.07229
Iter: 0010 train_loss= 0.51574 train_f1_mic= 0.42908 train_f1_mac= 0.17305 val_loss= 0.54229 val_f1_mic= 0.45017 val_f1_mac= 0.19876 time= 0.07185
Iter: 0015 train_loss= 0.51844 train_f1_mic= 0.43549 train_f1_mac= 0.16997 val_loss= 0.54229 val_f1_mic= 0.45017 val_f1_mac= 0.19876 time= 0.07145
Epoch: 0007
Iter: 0001 train_loss= 0.51444 train_f1_mic= 0.42744 train_f1_mac= 0.16507 val_loss= 0.54161 val_f1_mic= 0.42662 val_f1_mac= 0.17083 time= 0.07128
Iter: 0006 train_loss= 0.52398 train_f1_mic= 0.41537 train_f1_mac= 0.16113 val_loss= 0.54161 val_f1_mic= 0.42662 val_f1_mac= 0.17083 time= 0.07092
Iter: 0011 train_loss= 0.51246 train_f1_mic= 0.44309 train_f1_mac= 0.18436 val_loss= 0.54161 val_f1_mic= 0.42662 val_f1_mac= 0.17083 time= 0.07061
Iter: 0016 train_loss= 0.51892 train_f1_mic= 0.50995 train_f1_mac= 0.27470 val_loss= 0.54161 val_f1_mic= 0.42662 val_f1_mac= 0.17083 time= 0.07032
Epoch: 0008
Iter: 0002 train_loss= 0.50330 train_f1_mic= 0.46790 train_f1_mac= 0.20016 val_loss= 0.56364 val_f1_mic= 0.43006 val_f1_mac= 0.17835 time= 0.07027
Iter: 0007 train_loss= 0.51647 train_f1_mic= 0.45776 train_f1_mac= 0.20883 val_loss= 0.56364 val_f1_mic= 0.43006 val_f1_mac= 0.17835 time= 0.07001
Iter: 0012 train_loss= 0.51371 train_f1_mic= 0.48472 train_f1_mac= 0.24552 val_loss= 0.56364 val_f1_mic= 0.43006 val_f1_mac= 0.17835 time= 0.06976
Iter: 0017 train_loss= 0.50577 train_f1_mic= 0.46813 train_f1_mac= 0.21733 val_loss= 0.56364 val_f1_mic= 0.43006 val_f1_mac= 0.17835 time= 0.06952
Epoch: 0009
Iter: 0003 train_loss= 0.51069 train_f1_mic= 0.45212 train_f1_mac= 0.21559 val_loss= 0.53155 val_f1_mic= 0.49164 val_f1_mac= 0.26310 time= 0.06947
Iter: 0008 train_loss= 0.50544 train_f1_mic= 0.47364 train_f1_mac= 0.23034 val_loss= 0.53155 val_f1_mic= 0.49164 val_f1_mac= 0.26310 time= 0.06927
Iter: 0013 train_loss= 0.49858 train_f1_mic= 0.48772 train_f1_mac= 0.25830 val_loss= 0.53155 val_f1_mic= 0.49164 val_f1_mac= 0.26310 time= 0.06907
Iter: 0018 train_loss= 0.50340 train_f1_mic= 0.48557 train_f1_mac= 0.25041 val_loss= 0.53155 val_f1_mic= 0.49164 val_f1_mac= 0.26310 time= 0.06889
Epoch: 0010
Iter: 0004 train_loss= 0.49330 train_f1_mic= 0.46930 train_f1_mac= 0.23736 val_loss= 0.52239 val_f1_mic= 0.48413 val_f1_mac= 0.24108 time= 0.06886
Iter: 0009 train_loss= 0.51996 train_f1_mic= 0.47294 train_f1_mac= 0.24583 val_loss= 0.52239 val_f1_mic= 0.48413 val_f1_mac= 0.24108 time= 0.06869
Iter: 0014 train_loss= 0.50647 train_f1_mic= 0.45765 train_f1_mac= 0.21822 val_loss= 0.52239 val_f1_mic= 0.48413 val_f1_mac= 0.24108 time= 0.06853
Optimization Finished!
Full validation stats: loss= 0.51999 f1_micro= 0.51881 f1_macro= 0.30334 time= 0.12966
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4578142880795226
Rewards :  0.061847064945987185 Accuracy :  0.5072919400363124
Total reward :  1.2328072005810435
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'tanh', 3, 'linear']
Training RNN (Reward ip) :  [0.06184706]
Trial 307: Controller loss : 9112.364258
2018-08-31 01:02:32.614979: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:02:32.615286: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:02:32.615578: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:02:32.615789: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:02:32.616053: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] C
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'sigmoid', 1, 'linear']
reated TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69527 train_f1_mic= 0.37544 train_f1_mac= 0.25246 val_loss= 0.66609 val_f1_mic= 0.43151 val_f1_mac= 0.13940 time= 1.06856
Iter: 0005 train_loss= 0.58285 train_f1_mic= 0.36262 train_f1_mac= 0.08664 val_loss= 0.66609 val_f1_mic= 0.43151 val_f1_mac= 0.13940 time= 0.22512
Iter: 0010 train_loss= 0.54453 train_f1_mic= 0.38153 train_f1_mac= 0.09226 val_loss= 0.66609 val_f1_mic= 0.43151 val_f1_mac= 0.13940 time= 0.14664
Iter: 0015 train_loss= 0.55098 train_f1_mic= 0.38860 train_f1_mac= 0.09686 val_loss= 0.66609 val_f1_mic= 0.43151 val_f1_mac= 0.13940 time= 0.11820
Epoch: 0002
Iter: 0001 train_loss= 0.55530 train_f1_mic= 0.39484 train_f1_mac= 0.10316 val_loss= 0.58658 val_f1_mic= 0.38404 val_f1_mac= 0.10604 time= 0.10416
Iter: 0006 train_loss= 0.52911 train_f1_mic= 0.39080 train_f1_mac= 0.09172 val_loss= 0.58658 val_f1_mic= 0.38404 val_f1_mac= 0.10604 time= 0.09434
Iter: 0011 train_loss= 0.55343 train_f1_mic= 0.36523 train_f1_mac= 0.08867 val_loss= 0.58658 val_f1_mic= 0.38404 val_f1_mac= 0.10604 time= 0.08758
Iter: 0016 train_loss= 0.54926 train_f1_mic= 0.38028 train_f1_mac= 0.09380 val_loss= 0.58658 val_f1_mic= 0.38404 val_f1_mac= 0.10604 time= 0.08290
Epoch: 0003
Iter: 0002 train_loss= 0.54524 train_f1_mic= 0.37728 train_f1_mac= 0.09461 val_loss= 0.56270 val_f1_mic= 0.37831 val_f1_mac= 0.09953 time= 0.08009
Iter: 0007 train_loss= 0.53828 train_f1_mic= 0.38868 train_f1_mac= 0.10031 val_loss= 0.56270 val_f1_mic= 0.37831 val_f1_mac= 0.09953 time= 0.07734
Iter: 0012 train_loss= 0.54011 train_f1_mic= 0.39677 train_f1_mac= 0.10319 val_loss= 0.56270 val_f1_mic= 0.37831 val_f1_mac= 0.09953 time= 0.07510
Iter: 0017 train_loss= 0.52284 train_f1_mic= 0.39511 train_f1_mac= 0.10256 val_loss= 0.56270 val_f1_mic= 0.37831 val_f1_mac= 0.09953 time= 0.07347
Epoch: 0004
Iter: 0003 train_loss= 0.53904 train_f1_mic= 0.38355 train_f1_mac= 0.10228 val_loss= 0.58366 val_f1_mic= 0.37497 val_f1_mac= 0.11093 time= 0.07255
Iter: 0008 train_loss= 0.53029 train_f1_mic= 0.42550 train_f1_mac= 0.12977 val_loss= 0.58366 val_f1_mic= 0.37497 val_f1_mac= 0.11093 time= 0.07127
Iter: 0013 train_loss= 0.54917 train_f1_mic= 0.39078 train_f1_mac= 0.12074 val_loss= 0.58366 val_f1_mic= 0.37497 val_f1_mac= 0.11093 time= 0.07022
Iter: 0018 train_loss= 0.52720 train_f1_mic= 0.43454 train_f1_mac= 0.13780 val_loss= 0.58366 val_f1_mic= 0.37497 val_f1_mac= 0.11093 time= 0.06916
Epoch: 0005
Iter: 0004 train_loss= 0.53234 train_f1_mic= 0.41471 train_f1_mac= 0.12886 val_loss= 0.56325 val_f1_mic= 0.41169 val_f1_mac= 0.13738 time= 0.06897
Iter: 0009 train_loss= 0.52442 train_f1_mic= 0.40853 train_f1_mac= 0.12632 val_loss= 0.56325 val_f1_mic= 0.41169 val_f1_mac= 0.13738 time= 0.06822
Iter: 0014 train_loss= 0.53536 train_f1_mic= 0.40863 train_f1_mac= 0.12459 val_loss= 0.56325 val_f1_mic= 0.41169 val_f1_mac= 0.13738 time= 0.06741
Epoch: 0006
Iter: 0000 train_loss= 0.53152 train_f1_mic= 0.43125 train_f1_mac= 0.14727 val_loss= 0.57110 val_f1_mic= 0.42529 val_f1_mac= 0.15213 time= 0.06724
Iter: 0005 train_loss= 0.53182 train_f1_mic= 0.39235 train_f1_mac= 0.11853 val_loss= 0.57110 val_f1_mic= 0.42529 val_f1_mac= 0.15213 time= 0.06656
Iter: 0010 train_loss= 0.53260 train_f1_mic= 0.40429 train_f1_mac= 0.13032 val_loss= 0.57110 val_f1_mic= 0.42529 val_f1_mac= 0.15213 time= 0.06597
Iter: 0015 train_loss= 0.51924 train_f1_mic= 0.43297 train_f1_mac= 0.14039 val_loss= 0.57110 val_f1_mic= 0.42529 val_f1_mac= 0.15213 time= 0.06538
Epoch: 0007
Iter: 0001 train_loss= 0.53511 train_f1_mic= 0.43388 train_f1_mac= 0.15420 val_loss= 0.55660 val_f1_mic= 0.42927 val_f1_mac= 0.16070 time= 0.06533
Iter: 0006 train_loss= 0.52438 train_f1_mic= 0.41271 train_f1_mac= 0.13965 val_loss= 0.55660 val_f1_mic= 0.42927 val_f1_mac= 0.16070 time= 0.06481
Iter: 0011 train_loss= 0.52669 train_f1_mic= 0.43901 train_f1_mac= 0.15675 val_loss= 0.55660 val_f1_mic= 0.42927 val_f1_mac= 0.16070 time= 0.06442
Iter: 0016 train_loss= 0.52854 train_f1_mic= 0.43468 train_f1_mac= 0.15981 val_loss= 0.55660 val_f1_mic= 0.42927 val_f1_mac= 0.16070 time= 0.06399
Epoch: 0008
Iter: 0002 train_loss= 0.53344 train_f1_mic= 0.39649 train_f1_mac= 0.12910 val_loss= 0.54915 val_f1_mic= 0.40274 val_f1_mac= 0.14029 time= 0.06391
Iter: 0007 train_loss= 0.53439 train_f1_mic= 0.44612 train_f1_mac= 0.17791 val_loss= 0.54915 val_f1_mic= 0.40274 val_f1_mac= 0.14029 time= 0.06351
Iter: 0012 train_loss= 0.51908 train_f1_mic= 0.42907 train_f1_mac= 0.14683 val_loss= 0.54915 val_f1_mic= 0.40274 val_f1_mac= 0.14029 time= 0.06315
Iter: 0017 train_loss= 0.52831 train_f1_mic= 0.44980 train_f1_mac= 0.17176 val_loss= 0.54915 val_f1_mic= 0.40274 val_f1_mac= 0.14029 time= 0.06292
Epoch: 0009
Iter: 0003 train_loss= 0.52828 train_f1_mic= 0.42649 train_f1_mac= 0.16700 val_loss= 0.55116 val_f1_mic= 0.42016 val_f1_mac= 0.16665 time= 0.06291
Iter: 0008 train_loss= 0.51981 train_f1_mic= 0.42885 train_f1_mac= 0.16518 val_loss= 0.55116 val_f1_mic= 0.42016 val_f1_mac= 0.16665 time= 0.06276
Iter: 0013 train_loss= 0.50655 train_f1_mic= 0.46145 train_f1_mac= 0.18685 val_loss= 0.55116 val_f1_mic= 0.42016 val_f1_mac= 0.16665 time= 0.06251
Iter: 0018 train_loss= 0.51809 train_f1_mic= 0.45535 train_f1_mac= 0.18230 val_loss= 0.55116 val_f1_mic= 0.42016 val_f1_mac= 0.16665 time= 0.06224
Epoch: 0010
Iter: 0004 train_loss= 0.52241 train_f1_mic= 0.42031 train_f1_mac= 0.15694 val_loss= 0.56214 val_f1_mic= 0.44570 val_f1_mac= 0.18872 time= 0.06217
Iter: 0009 train_loss= 0.52069 train_f1_mic= 0.42094 train_f1_mac= 0.16104 val_loss= 0.56214 val_f1_mic= 0.44570 val_f1_mac= 0.18872 time= 0.06196
Iter: 0014 train_loss= 0.53080 train_f1_mic= 0.44011 train_f1_mac= 0.17761 val_loss= 0.56214 val_f1_mic= 0.44570 val_f1_mac= 0.18872 time= 0.06172
Optimization Finished!
Full validation stats: loss= 0.54039 f1_micro= 0.43271 f1_macro= 0.17805 time= 0.16752
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4535310006106108
Rewards :  -0.021416437344559225 Accuracy :  0.4363978507349634
Total reward :  1.2113907632364844
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'sigmoid', 1, 'linear']
Training RNN (Reward ip) :  [-0.02141644]
Trial 308: Controller loss : 9828.095703

Prediction action from Controller
State input to Controller for Action :  [0. 0. 3. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:02:50.774507: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:02:50.774865: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:02:50.775215: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:02:50.775476: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:02:50.775789: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69276 train_f1_mic= 0.38486 train_f1_mac= 0.29886 val_loss= 0.66313 val_f1_mic= 0.38198 val_f1_mac= 0.11408 time= 0.76892
Iter: 0005 train_loss= 0.58637 train_f1_mic= 0.36506 train_f1_mac= 0.08650 val_loss= 0.66313 val_f1_mic= 0.38198 val_f1_mac= 0.11408 time= 0.13978
Iter: 0010 train_loss= 0.55715 train_f1_mic= 0.37109 train_f1_mac= 0.09020 val_loss= 0.66313 val_f1_mic= 0.38198 val_f1_mac= 0.11408 time= 0.08349
Iter: 0015 train_loss= 0.55148 train_f1_mic= 0.42251 train_f1_mac= 0.11586 val_loss= 0.66313 val_f1_mic= 0.38198 val_f1_mac= 0.11408 time= 0.06270
Epoch: 0002
Iter: 0001 train_loss= 0.53854 train_f1_mic= 0.38595 train_f1_mac= 0.09458 val_loss= 0.54972 val_f1_mic= 0.37684 val_f1_mac= 0.09542 time= 0.05342
Iter: 0006 train_loss= 0.54251 train_f1_mic= 0.36578 train_f1_mac= 0.08747 val_loss= 0.54972 val_f1_mic= 0.37684 val_f1_mac= 0.09542 time= 0.04618
Iter: 0011 train_loss= 0.53262 train_f1_mic= 0.38114 train_f1_mac= 0.09640 val_loss= 0.54972 val_f1_mic= 0.37684 val_f1_mac= 0.09542 time= 0.04120
Iter: 0016 train_loss= 0.53152 train_f1_mic= 0.40539 train_f1_mac= 0.10783 val_loss= 0.54972 val_f1_mic= 0.37684 val_f1_mac= 0.09542 time= 0.03767
Epoch: 0003
Iter: 0002 train_loss= 0.52998 train_f1_mic= 0.38778 train_f1_mac= 0.10560 val_loss= 0.55667 val_f1_mic= 0.38425 val_f1_mac= 0.10840 time= 0.03604
Iter: 0007 train_loss= 0.52084 train_f1_mic= 0.39406 train_f1_mac= 0.10873 val_loss= 0.55667 val_f1_mic= 0.38425 val_f1_mac= 0.10840 time= 0.03371
Iter: 0012 train_loss= 0.53889 train_f1_mic= 0.42080 train_f1_mac= 0.12831 val_loss= 0.55667 val_f1_mic= 0.38425 val_f1_mac= 0.10840 time= 0.03183
Iter: 0017 train_loss= 0.53893 train_f1_mic= 0.40977 train_f1_mac= 0.12967 val_loss= 0.55667 val_f1_mic= 0.38425 val_f1_mac= 0.10840 time= 0.03021
Epoch: 0004
Iter: 0003 train_loss= 0.53040 train_f1_mic= 0.40230 train_f1_mac= 0.12409 val_loss= 0.53177 val_f1_mic= 0.40735 val_f1_mac= 0.12669 time= 0.02944
Iter: 0008 train_loss= 0.52000 train_f1_mic= 0.41822 train_f1_mac= 0.13705 val_loss= 0.53177 val_f1_mic= 0.40735 val_f1_mac= 0.12669 time= 0.02834
Iter: 0013 train_loss= 0.51900 train_f1_mic= 0.43546 train_f1_mac= 0.14586 val_loss= 0.53177 val_f1_mic= 0.40735 val_f1_mac= 0.12669 time= 0.02736
Iter: 0018 train_loss= 0.52616 train_f1_mic= 0.42011 train_f1_mac= 0.14045 val_loss= 0.53177 val_f1_mic= 0.40735 val_f1_mac= 0.12669 time= 0.02649
Epoch: 0005
Iter: 0004 train_loss= 0.52229 train_f1_mic= 0.44627 train_f1_mac= 0.16213 val_loss= 0.53112 val_f1_mic= 0.44229 val_f1_mac= 0.16941 time= 0.02602
Iter: 0009 train_loss= 0.51902 train_f1_mic= 0.43536 train_f1_mac= 0.16014 val_loss= 0.53112 val_f1_mic= 0.44229 val_f1_mac= 0.16941 time= 0.02544
Iter: 0014 train_loss= 0.52054 train_f1_mic= 0.44239 train_f1_mac= 0.17381 val_loss= 0.53112 val_f1_mic= 0.44229 val_f1_mac= 0.16941 time= 0.02494
Epoch: 0006
Iter: 0000 train_loss= 0.51132 train_f1_mic= 0.44404 train_f1_mac= 0.17330 val_loss= 0.53826 val_f1_mic= 0.41540 val_f1_mac= 0.15879 time= 0.02482
Iter: 0005 train_loss= 0.51636 train_f1_mic= 0.45320 train_f1_mac= 0.18399 val_loss= 0.53826 val_f1_mic= 0.41540 val_f1_mac= 0.15879 time= 0.02435
Iter: 0010 train_loss= 0.51155 train_f1_mic= 0.47974 train_f1_mac= 0.21120 val_loss= 0.53826 val_f1_mic= 0.41540 val_f1_mac= 0.15879 time= 0.02390
Iter: 0015 train_loss= 0.52313 train_f1_mic= 0.45309 train_f1_mac= 0.19181 val_loss= 0.53826 val_f1_mic= 0.41540 val_f1_mac= 0.15879 time= 0.02357
Epoch: 0007
Iter: 0001 train_loss= 0.50968 train_f1_mic= 0.47105 train_f1_mac= 0.20597 val_loss= 0.51679 val_f1_mic= 0.46175 val_f1_mac= 0.20400 time= 0.02354
Iter: 0006 train_loss= 0.52086 train_f1_mic= 0.46070 train_f1_mac= 0.21563 val_loss= 0.51679 val_f1_mic= 0.46175 val_f1_mac= 0.20400 time= 0.02318
Iter: 0011 train_loss= 0.50875 train_f1_mic= 0.44417 train_f1_mac= 0.19526 val_loss= 0.51679 val_f1_mic= 0.46175 val_f1_mac= 0.20400 time= 0.02292
Iter: 0016 train_loss= 0.49047 train_f1_mic= 0.50397 train_f1_mac= 0.25952 val_loss= 0.51679 val_f1_mic= 0.46175 val_f1_mac= 0.20400 time= 0.02258
Epoch: 0008
Iter: 0002 train_loss= 0.50936 train_f1_mic= 0.50705 train_f1_mac= 0.25870 val_loss= 0.53490 val_f1_mic= 0.45209 val_f1_mac= 0.21565 time= 0.02250
Iter: 0007 train_loss= 0.49841 train_f1_mic= 0.44374 train_f1_mac= 0.18244 val_loss= 0.53490 val_f1_mic= 0.45209 val_f1_mac= 0.21565 time= 0.02222
Iter: 0012 train_loss= 0.50930 train_f1_mic= 0.50611 train_f1_mac= 0.26395 val_loss= 0.53490 val_f1_mic= 0.45209 val_f1_mac= 0.21565 time= 0.02193
Iter: 0017 train_loss= 0.49849 train_f1_mic= 0.48085 train_f1_mac= 0.24257 val_loss= 0.53490 val_f1_mic= 0.45209 val_f1_mac= 0.21565 time= 0.02175
Epoch: 0009
Iter: 0003 train_loss= 0.49836 train_f1_mic= 0.49511 train_f1_mac= 0.26238 val_loss= 0.51796 val_f1_mic= 0.45930 val_f1_mac= 0.22814 time= 0.02169
Iter: 0008 train_loss= 0.48640 train_f1_mic= 0.49243 train_f1_mac= 0.25847 val_loss= 0.51796 val_f1_mic= 0.45930 val_f1_mac= 0.22814 time= 0.02148
Iter: 0013 train_loss= 0.50313 train_f1_mic= 0.50748 train_f1_mac= 0.27001 val_loss= 0.51796 val_f1_mic= 0.45930 val_f1_mac= 0.22814 time= 0.02134
Iter: 0018 train_loss= 0.50486 train_f1_mic= 0.50163 train_f1_mac= 0.26612 val_loss= 0.51796 val_f1_mic= 0.45930 val_f1_mac= 0.22814 time= 0.02118
Epoch: 0010
Iter: 0004 train_loss= 0.48555 train_f1_mic= 0.49055 train_f1_mac= 0.25506 val_loss= 0.50558 val_f1_mic= 0.49692 val_f1_mac= 0.26171 time= 0.02106
Iter: 0009 train_loss= 0.49619 train_f1_mic= 0.48881 train_f1_mac= 0.25620 val_loss= 0.50558 val_f1_mic= 0.49692 val_f1_mac= 0.26171 time= 0.02093
Iter: 0014 train_loss= 0.49735 train_f1_mic= 0.50348 train_f1_mac= 0.27121 val_loss= 0.50558 val_f1_mic= 0.49692 val_f1_mac= 0.26171 time= 0.02076
Optimization Finished!
Full validation stats: loss= 0.51011 f1_micro= 0.52368 f1_macro= 0.30261 time= 0.11569
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46698458867525977
Rewards :  0.06726794032324501 Accuracy :  0.5207989409338558
Total reward :  1.2786587035597294
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.06726794]
Trial 309: Controller loss : 132.020096

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [0, 'sigmoid', 1, 'relu']
2018-08-31 01:03:00.280357: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:03:00.280603: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:03:00.280927: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:03:00.281071: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:03:00.281289: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69586 train_f1_mic= 0.37256 train_f1_mac= 0.26456 val_loss= 0.66338 val_f1_mic= 0.40351 val_f1_mac= 0.11419 time= 0.95045
Iter: 0005 train_loss= 0.59381 train_f1_mic= 0.36406 train_f1_mac= 0.08750 val_loss= 0.66338 val_f1_mic= 0.40351 val_f1_mac= 0.11419 time= 0.17937
Iter: 0010 train_loss= 0.55097 train_f1_mic= 0.37139 train_f1_mac= 0.08740 val_loss= 0.66338 val_f1_mic= 0.40351 val_f1_mac= 0.11419 time= 0.11044
Iter: 0015 train_loss= 0.53378 train_f1_mic= 0.38728 train_f1_mac= 0.09193 val_loss= 0.66338 val_f1_mic= 0.40351 val_f1_mac= 0.11419 time= 0.08391
Epoch: 0002
Iter: 0001 train_loss= 0.54997 train_f1_mic= 0.37870 train_f1_mac= 0.09289 val_loss= 0.56784 val_f1_mic= 0.38121 val_f1_mac= 0.09658 time= 0.07091
Iter: 0006 train_loss= 0.53991 train_f1_mic= 0.36224 train_f1_mac= 0.08520 val_loss= 0.56784 val_f1_mic= 0.38121 val_f1_mac= 0.09658 time= 0.06288
Iter: 0011 train_loss= 0.54862 train_f1_mic= 0.36609 train_f1_mac= 0.08746 val_loss= 0.56784 val_f1_mic= 0.38121 val_f1_mac= 0.09658 time= 0.05653
Iter: 0016 train_loss= 0.54100 train_f1_mic= 0.38756 train_f1_mac= 0.09396 val_loss= 0.56784 val_f1_mic= 0.38121 val_f1_mac= 0.09658 time= 0.05200
Epoch: 0003
Iter: 0002 train_loss= 0.53516 train_f1_mic= 0.40402 train_f1_mac= 0.10191 val_loss= 0.57152 val_f1_mic= 0.39222 val_f1_mac= 0.10702 time= 0.04921
Iter: 0007 train_loss= 0.54348 train_f1_mic= 0.36415 train_f1_mac= 0.08667 val_loss= 0.57152 val_f1_mic= 0.39222 val_f1_mac= 0.10702 time= 0.04668
Iter: 0012 train_loss= 0.54388 train_f1_mic= 0.36821 train_f1_mac= 0.08765 val_loss= 0.57152 val_f1_mic= 0.39222 val_f1_mac= 0.10702 time= 0.04488
Iter: 0017 train_loss= 0.53634 train_f1_mic= 0.39151 train_f1_mac= 0.09728 val_loss= 0.57152 val_f1_mic= 0.39222 val_f1_mac= 0.10702 time= 0.04312
Epoch: 0004
Iter: 0003 train_loss= 0.53435 train_f1_mic= 0.38109 train_f1_mac= 0.09357 val_loss= 0.56300 val_f1_mic= 0.38033 val_f1_mac= 0.10192 time= 0.04203
Iter: 0008 train_loss= 0.53962 train_f1_mic= 0.37627 train_f1_mac= 0.09397 val_loss= 0.56300 val_f1_mic= 0.38033 val_f1_mac= 0.10192 time= 0.04069
Iter: 0013 train_loss= 0.54617 train_f1_mic= 0.38309 train_f1_mac= 0.10061 val_loss= 0.56300 val_f1_mic= 0.38033 val_f1_mac= 0.10192 time= 0.03979
Iter: 0018 train_loss= 0.52087 train_f1_mic= 0.38063 train_f1_mac= 0.09199 val_loss= 0.56300 val_f1_mic= 0.38033 val_f1_mac= 0.10192 time= 0.03878
Epoch: 0005
Iter: 0004 train_loss= 0.53246 train_f1_mic= 0.38245 train_f1_mac= 0.10016 val_loss= 0.57211 val_f1_mic= 0.36910 val_f1_mac= 0.09651 time= 0.03829
Iter: 0009 train_loss= 0.54231 train_f1_mic= 0.39700 train_f1_mac= 0.11573 val_loss= 0.57211 val_f1_mic= 0.36910 val_f1_mac= 0.09651 time= 0.03762
Iter: 0014 train_loss= 0.53478 train_f1_mic= 0.39567 train_f1_mac= 0.11099 val_loss= 0.57211 val_f1_mic= 0.36910 val_f1_mac= 0.09651 time= 0.03688
Epoch: 0006
Iter: 0000 train_loss= 0.53348 train_f1_mic= 0.41562 train_f1_mac= 0.12288 val_loss= 0.54585 val_f1_mic= 0.41385 val_f1_mac= 0.12733 time= 0.03642
Iter: 0005 train_loss= 0.53505 train_f1_mic= 0.39837 train_f1_mac= 0.11750 val_loss= 0.54585 val_f1_mic= 0.41385 val_f1_mac= 0.12733 time= 0.03587
Iter: 0010 train_loss= 0.52954 train_f1_mic= 0.40865 train_f1_mac= 0.12258 val_loss= 0.54585 val_f1_mic= 0.41385 val_f1_mac= 0.12733 time= 0.03542
Iter: 0015 train_loss= 0.54083 train_f1_mic= 0.43008 train_f1_mac= 0.13528 val_loss= 0.54585 val_f1_mic= 0.41385 val_f1_mac= 0.12733 time= 0.03491
Epoch: 0007
Iter: 0001 train_loss= 0.53990 train_f1_mic= 0.39456 train_f1_mac= 0.11878 val_loss= 0.55499 val_f1_mic= 0.38319 val_f1_mac= 0.11838 time= 0.03463
Iter: 0006 train_loss= 0.53581 train_f1_mic= 0.40173 train_f1_mac= 0.12022 val_loss= 0.55499 val_f1_mic= 0.38319 val_f1_mac= 0.11838 time= 0.03420
Iter: 0011 train_loss= 0.53089 train_f1_mic= 0.39988 train_f1_mac= 0.11833 val_loss= 0.55499 val_f1_mic= 0.38319 val_f1_mac= 0.11838 time= 0.03400
Iter: 0016 train_loss= 0.53777 train_f1_mic= 0.41407 train_f1_mac= 0.12679 val_loss= 0.55499 val_f1_mic= 0.38319 val_f1_mac= 0.11838 time= 0.03376
Epoch: 0008
Iter: 0002 train_loss= 0.53709 train_f1_mic= 0.39461 train_f1_mac= 0.11559 val_loss= 0.55572 val_f1_mic= 0.40009 val_f1_mac= 0.12343 time= 0.03376
Iter: 0007 train_loss= 0.54270 train_f1_mic= 0.41106 train_f1_mac= 0.12830 val_loss= 0.55572 val_f1_mic= 0.40009 val_f1_mac= 0.12343 time= 0.03347
Iter: 0012 train_loss= 0.52696 train_f1_mic= 0.39611 train_f1_mac= 0.11372 val_loss= 0.55572 val_f1_mic= 0.40009 val_f1_mac= 0.12343 time= 0.03336
Iter: 0017 train_loss= 0.53194 train_f1_mic= 0.40816 train_f1_mac= 0.12580 val_loss= 0.55572 val_f1_mic= 0.40009 val_f1_mac= 0.12343 time= 0.03312
Epoch: 0009
Iter: 0003 train_loss= 0.53008 train_f1_mic= 0.42491 train_f1_mac= 0.13401 val_loss= 0.55693 val_f1_mic= 0.42497 val_f1_mac= 0.14175 time= 0.03297
Iter: 0008 train_loss= 0.53185 train_f1_mic= 0.41385 train_f1_mac= 0.13183 val_loss= 0.55693 val_f1_mic= 0.42497 val_f1_mac= 0.14175 time= 0.03285
Iter: 0013 train_loss= 0.53359 train_f1_mic= 0.39620 train_f1_mac= 0.12079 val_loss= 0.55693 val_f1_mic= 0.42497 val_f1_mac= 0.14175 time= 0.03279
Iter: 0018 train_loss= 0.52544 train_f1_mic= 0.41358 train_f1_mac= 0.13092 val_loss= 0.55693 val_f1_mic= 0.42497 val_f1_mac= 0.14175 time= 0.03255
Epoch: 0010
Iter: 0004 train_loss= 0.53818 train_f1_mic= 0.42641 train_f1_mac= 0.14430 val_loss= 0.54328 val_f1_mic= 0.41482 val_f1_mac= 0.13787 time= 0.03253
Iter: 0009 train_loss= 0.52226 train_f1_mic= 0.42800 train_f1_mac= 0.13590 val_loss= 0.54328 val_f1_mic= 0.41482 val_f1_mac= 0.13787 time= 0.03241
Iter: 0014 train_loss= 0.53793 train_f1_mic= 0.40608 train_f1_mac= 0.13056 val_loss= 0.54328 val_f1_mic= 0.41482 val_f1_mac= 0.13787 time= 0.03219
Optimization Finished!
Full validation stats: loss= 0.55116 f1_micro= 0.40354 f1_macro= 0.13538 time= 0.12669
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4558595742634707
Rewards :  -0.05562507205894557 Accuracy :  0.4113595166163142
Total reward :  1.223033631500784
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'sigmoid', 1, 'relu']
Training RNN (Reward ip) :  [-0.05562507]
Trial 310: Controller loss : 3463.674561

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'relu', 1, 'sigmoid']
2018-08-31 01:03:12.299987: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:03:12.300232: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:03:12.300463: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:03:12.301086: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:03:12.301483: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69507 train_f1_mic= 0.35220 train_f1_mac= 0.22989 val_loss= 0.65973 val_f1_mic= 0.33814 val_f1_mac= 0.08868 time= 1.55923
Iter: 0005 train_loss= 0.56769 train_f1_mic= 0.40642 train_f1_mac= 0.10371 val_loss= 0.65973 val_f1_mic= 0.33814 val_f1_mac= 0.08868 time= 0.37356
Iter: 0010 train_loss= 0.54930 train_f1_mic= 0.36807 train_f1_mac= 0.08751 val_loss= 0.65973 val_f1_mic= 0.33814 val_f1_mac= 0.08868 time= 0.26550
Iter: 0015 train_loss= 0.54680 train_f1_mic= 0.38001 train_f1_mac= 0.09307 val_loss= 0.65973 val_f1_mic= 0.33814 val_f1_mac= 0.08868 time= 0.22461
Epoch: 0002
Iter: 0001 train_loss= 0.54509 train_f1_mic= 0.37570 train_f1_mac= 0.09213 val_loss= 0.54797 val_f1_mic= 0.37759 val_f1_mac= 0.09289 time= 0.20570
Iter: 0006 train_loss= 0.54606 train_f1_mic= 0.36250 train_f1_mac= 0.08663 val_loss= 0.54797 val_f1_mic= 0.37759 val_f1_mac= 0.09289 time= 0.19192
Iter: 0011 train_loss= 0.53776 train_f1_mic= 0.40573 train_f1_mac= 0.11050 val_loss= 0.54797 val_f1_mic= 0.37759 val_f1_mac= 0.09289 time= 0.18236
Iter: 0016 train_loss= 0.51755 train_f1_mic= 0.42472 train_f1_mac= 0.11602 val_loss= 0.54797 val_f1_mic= 0.37759 val_f1_mac= 0.09289 time= 0.17651
Epoch: 0003
Iter: 0002 train_loss= 0.53585 train_f1_mic= 0.38827 train_f1_mac= 0.10771 val_loss= 0.56319 val_f1_mic= 0.39557 val_f1_mac= 0.11808 time= 0.17279
Iter: 0007 train_loss= 0.54157 train_f1_mic= 0.37599 train_f1_mac= 0.09736 val_loss= 0.56319 val_f1_mic= 0.39557 val_f1_mac= 0.11808 time= 0.16860
Iter: 0012 train_loss= 0.52605 train_f1_mic= 0.40722 train_f1_mac= 0.10553 val_loss= 0.56319 val_f1_mic= 0.39557 val_f1_mac= 0.11808 time= 0.16531
Iter: 0017 train_loss= 0.53639 train_f1_mic= 0.39223 train_f1_mac= 0.10184 val_loss= 0.56319 val_f1_mic= 0.39557 val_f1_mac= 0.11808 time= 0.16284
Epoch: 0004
Iter: 0003 train_loss= 0.53122 train_f1_mic= 0.38602 train_f1_mac= 0.10134 val_loss= 0.55685 val_f1_mic= 0.38225 val_f1_mac= 0.10320 time= 0.16129
Iter: 0008 train_loss= 0.54181 train_f1_mic= 0.37677 train_f1_mac= 0.09650 val_loss= 0.55685 val_f1_mic= 0.38225 val_f1_mac= 0.10320 time= 0.15927
Iter: 0013 train_loss= 0.52363 train_f1_mic= 0.40402 train_f1_mac= 0.10815 val_loss= 0.55685 val_f1_mic= 0.38225 val_f1_mac= 0.10320 time= 0.15779
Iter: 0018 train_loss= 0.54079 train_f1_mic= 0.38850 train_f1_mac= 0.10276 val_loss= 0.55685 val_f1_mic= 0.38225 val_f1_mac= 0.10320 time= 0.15631
Epoch: 0005
Iter: 0004 train_loss= 0.52286 train_f1_mic= 0.41916 train_f1_mac= 0.11552 val_loss= 0.54836 val_f1_mic= 0.37926 val_f1_mac= 0.10294 time= 0.15587
Iter: 0009 train_loss= 0.53649 train_f1_mic= 0.38420 train_f1_mac= 0.11016 val_loss= 0.54836 val_f1_mic= 0.37926 val_f1_mac= 0.10294 time= 0.15471
Iter: 0014 train_loss= 0.53860 train_f1_mic= 0.41195 train_f1_mac= 0.12999 val_loss= 0.54836 val_f1_mic= 0.37926 val_f1_mac= 0.10294 time= 0.15365
Epoch: 0006
Iter: 0000 train_loss= 0.52358 train_f1_mic= 0.42187 train_f1_mac= 0.12863 val_loss= 0.55012 val_f1_mic= 0.40121 val_f1_mac= 0.12703 time= 0.15319
Iter: 0005 train_loss= 0.52508 train_f1_mic= 0.40188 train_f1_mac= 0.12278 val_loss= 0.55012 val_f1_mic= 0.40121 val_f1_mac= 0.12703 time= 0.15216
Iter: 0010 train_loss= 0.53094 train_f1_mic= 0.41894 train_f1_mac= 0.13673 val_loss= 0.55012 val_f1_mic= 0.40121 val_f1_mac= 0.12703 time= 0.15144
Iter: 0015 train_loss= 0.52911 train_f1_mic= 0.43003 train_f1_mac= 0.14563 val_loss= 0.55012 val_f1_mic= 0.40121 val_f1_mac= 0.12703 time= 0.15071
Epoch: 0007
Iter: 0001 train_loss= 0.52224 train_f1_mic= 0.41326 train_f1_mac= 0.12869 val_loss= 0.54930 val_f1_mic= 0.40373 val_f1_mac= 0.13223 time= 0.15038
Iter: 0006 train_loss= 0.52464 train_f1_mic= 0.42054 train_f1_mac= 0.14058 val_loss= 0.54930 val_f1_mic= 0.40373 val_f1_mac= 0.13223 time= 0.14977
Iter: 0011 train_loss= 0.50413 train_f1_mic= 0.44550 train_f1_mac= 0.16064 val_loss= 0.54930 val_f1_mic= 0.40373 val_f1_mac= 0.13223 time= 0.14929
Iter: 0016 train_loss= 0.52621 train_f1_mic= 0.45395 train_f1_mac= 0.17614 val_loss= 0.54930 val_f1_mic= 0.40373 val_f1_mac= 0.13223 time= 0.14882
Epoch: 0008
Iter: 0002 train_loss= 0.51240 train_f1_mic= 0.42951 train_f1_mac= 0.15178 val_loss= 0.54804 val_f1_mic= 0.43797 val_f1_mac= 0.16766 time= 0.14876
Iter: 0007 train_loss= 0.51727 train_f1_mic= 0.44575 train_f1_mac= 0.16679 val_loss= 0.54804 val_f1_mic= 0.43797 val_f1_mac= 0.16766 time= 0.14832
Iter: 0012 train_loss= 0.51567 train_f1_mic= 0.45295 train_f1_mac= 0.18927 val_loss= 0.54804 val_f1_mic= 0.43797 val_f1_mac= 0.16766 time= 0.14790
Iter: 0017 train_loss= 0.51652 train_f1_mic= 0.45863 train_f1_mac= 0.18949 val_loss= 0.54804 val_f1_mic= 0.43797 val_f1_mac= 0.16766 time= 0.14755
Epoch: 0009
Iter: 0003 train_loss= 0.50805 train_f1_mic= 0.46572 train_f1_mac= 0.19167 val_loss= 0.53831 val_f1_mic= 0.47740 val_f1_mac= 0.21553 time= 0.14749
Iter: 0008 train_loss= 0.50512 train_f1_mic= 0.46785 train_f1_mac= 0.20194 val_loss= 0.53831 val_f1_mic= 0.47740 val_f1_mac= 0.21553 time= 0.14718
Iter: 0013 train_loss= 0.51936 train_f1_mic= 0.44754 train_f1_mac= 0.18352 val_loss= 0.53831 val_f1_mic= 0.47740 val_f1_mac= 0.21553 time= 0.14690
Iter: 0018 train_loss= 0.51540 train_f1_mic= 0.44457 train_f1_mac= 0.18536 val_loss= 0.53831 val_f1_mic= 0.47740 val_f1_mac= 0.21553 time= 0.14661
Epoch: 0010
Iter: 0004 train_loss= 0.51633 train_f1_mic= 0.45228 train_f1_mac= 0.18613 val_loss= 0.52626 val_f1_mic= 0.45628 val_f1_mac= 0.19910 time= 0.14667
Iter: 0009 train_loss= 0.51237 train_f1_mic= 0.46412 train_f1_mac= 0.20939 val_loss= 0.52626 val_f1_mic= 0.45628 val_f1_mac= 0.19910 time= 0.14645
Iter: 0014 train_loss= 0.51211 train_f1_mic= 0.47146 train_f1_mac= 0.21180 val_loss= 0.52626 val_f1_mic= 0.45628 val_f1_mac= 0.19910 time= 0.14621
Optimization Finished!
Full validation stats: loss= 0.52563 f1_micro= 0.46893 f1_macro= 0.22134 time= 0.31117
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4574591037428534
Rewards :  0.00799764739691361 Accuracy :  0.4638572216603843
Total reward :  1.2310312788976976
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'relu', 1, 'sigmoid']
Training RNN (Reward ip) :  [0.00799765]
Trial 311: Controller loss : 4308.449707

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [3, 'linear', 1, 'linear']
2018-08-31 01:03:47.913445: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:03:47.913715: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:03:47.913959: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:03:47.914136: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:03:47.914363: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69419 train_f1_mic= 0.38137 train_f1_mac= 0.32060 val_loss= 0.67536 val_f1_mic= 0.42581 val_f1_mac= 0.18495 time= 1.07396
Iter: 0005 train_loss= 0.59272 train_f1_mic= 0.37260 train_f1_mac= 0.08888 val_loss= 0.67536 val_f1_mic= 0.42581 val_f1_mac= 0.18495 time= 0.24299
Iter: 0010 train_loss= 0.55057 train_f1_mic= 0.37103 train_f1_mac= 0.09111 val_loss= 0.67536 val_f1_mic= 0.42581 val_f1_mac= 0.18495 time= 0.16618
Iter: 0015 train_loss= 0.56392 train_f1_mic= 0.37067 train_f1_mac= 0.09603 val_loss= 0.67536 val_f1_mic= 0.42581 val_f1_mac= 0.18495 time= 0.13694
Epoch: 0002
Iter: 0001 train_loss= 0.53954 train_f1_mic= 0.39728 train_f1_mac= 0.10966 val_loss= 0.55644 val_f1_mic= 0.39232 val_f1_mac= 0.11260 time= 0.12285
Iter: 0006 train_loss= 0.53943 train_f1_mic= 0.39638 train_f1_mac= 0.10725 val_loss= 0.55644 val_f1_mic= 0.39232 val_f1_mac= 0.11260 time= 0.11323
Iter: 0011 train_loss= 0.53291 train_f1_mic= 0.39891 train_f1_mac= 0.11229 val_loss= 0.55644 val_f1_mic= 0.39232 val_f1_mac= 0.11260 time= 0.10674
Iter: 0016 train_loss= 0.54323 train_f1_mic= 0.41443 train_f1_mac= 0.12216 val_loss= 0.55644 val_f1_mic= 0.39232 val_f1_mac= 0.11260 time= 0.10244
Epoch: 0003
Iter: 0002 train_loss= 0.53938 train_f1_mic= 0.40630 train_f1_mac= 0.12266 val_loss= 0.56243 val_f1_mic= 0.40906 val_f1_mac= 0.13093 time= 0.09951
Iter: 0007 train_loss= 0.53241 train_f1_mic= 0.39246 train_f1_mac= 0.11228 val_loss= 0.56243 val_f1_mic= 0.40906 val_f1_mac= 0.13093 time= 0.09684
Iter: 0012 train_loss= 0.52356 train_f1_mic= 0.41540 train_f1_mac= 0.12491 val_loss= 0.56243 val_f1_mic= 0.40906 val_f1_mac= 0.13093 time= 0.09456
Iter: 0017 train_loss= 0.53656 train_f1_mic= 0.40970 train_f1_mac= 0.12596 val_loss= 0.56243 val_f1_mic= 0.40906 val_f1_mac= 0.13093 time= 0.09308
Epoch: 0004
Iter: 0003 train_loss= 0.52787 train_f1_mic= 0.41375 train_f1_mac= 0.12801 val_loss= 0.54498 val_f1_mic= 0.40012 val_f1_mac= 0.12621 time= 0.09224
Iter: 0008 train_loss= 0.52304 train_f1_mic= 0.43207 train_f1_mac= 0.14224 val_loss= 0.54498 val_f1_mic= 0.40012 val_f1_mac= 0.12621 time= 0.09117
Iter: 0013 train_loss= 0.52021 train_f1_mic= 0.42037 train_f1_mac= 0.13693 val_loss= 0.54498 val_f1_mic= 0.40012 val_f1_mac= 0.12621 time= 0.08997
Iter: 0018 train_loss= 0.52092 train_f1_mic= 0.43122 train_f1_mac= 0.14603 val_loss= 0.54498 val_f1_mic= 0.40012 val_f1_mac= 0.12621 time= 0.08886
Epoch: 0005
Iter: 0004 train_loss= 0.52678 train_f1_mic= 0.42277 train_f1_mac= 0.14229 val_loss= 0.54312 val_f1_mic= 0.43030 val_f1_mac= 0.14813 time= 0.08844
Iter: 0009 train_loss= 0.51674 train_f1_mic= 0.45572 train_f1_mac= 0.17487 val_loss= 0.54312 val_f1_mic= 0.43030 val_f1_mac= 0.14813 time= 0.08762
Iter: 0014 train_loss= 0.51855 train_f1_mic= 0.43935 train_f1_mac= 0.15792 val_loss= 0.54312 val_f1_mic= 0.43030 val_f1_mac= 0.14813 time= 0.08705
Epoch: 0006
Iter: 0000 train_loss= 0.52953 train_f1_mic= 0.44345 train_f1_mac= 0.17014 val_loss= 0.55509 val_f1_mic= 0.44177 val_f1_mac= 0.17915 time= 0.08671
Iter: 0005 train_loss= 0.51728 train_f1_mic= 0.42342 train_f1_mac= 0.16229 val_loss= 0.55509 val_f1_mic= 0.44177 val_f1_mac= 0.17915 time= 0.08601
Iter: 0010 train_loss= 0.51309 train_f1_mic= 0.47915 train_f1_mac= 0.21178 val_loss= 0.55509 val_f1_mic= 0.44177 val_f1_mac= 0.17915 time= 0.08537
Iter: 0015 train_loss= 0.51691 train_f1_mic= 0.44202 train_f1_mac= 0.18036 val_loss= 0.55509 val_f1_mic= 0.44177 val_f1_mac= 0.17915 time= 0.08481
Epoch: 0007
Iter: 0001 train_loss= 0.51401 train_f1_mic= 0.46040 train_f1_mac= 0.17689 val_loss= 0.56039 val_f1_mic= 0.43948 val_f1_mac= 0.17051 time= 0.08482
Iter: 0006 train_loss= 0.52254 train_f1_mic= 0.43997 train_f1_mac= 0.16796 val_loss= 0.56039 val_f1_mic= 0.43948 val_f1_mac= 0.17051 time= 0.08444
Iter: 0011 train_loss= 0.52343 train_f1_mic= 0.43117 train_f1_mac= 0.16811 val_loss= 0.56039 val_f1_mic= 0.43948 val_f1_mac= 0.17051 time= 0.08403
Iter: 0016 train_loss= 0.50650 train_f1_mic= 0.46469 train_f1_mac= 0.20832 val_loss= 0.56039 val_f1_mic= 0.43948 val_f1_mac= 0.17051 time= 0.08381
Epoch: 0008
Iter: 0002 train_loss= 0.52151 train_f1_mic= 0.46785 train_f1_mac= 0.19596 val_loss= 0.52614 val_f1_mic= 0.46000 val_f1_mac= 0.19804 time= 0.08361
Iter: 0007 train_loss= 0.52208 train_f1_mic= 0.42630 train_f1_mac= 0.17089 val_loss= 0.52614 val_f1_mic= 0.46000 val_f1_mac= 0.19804 time= 0.08324
Iter: 0012 train_loss= 0.51652 train_f1_mic= 0.45131 train_f1_mac= 0.17430 val_loss= 0.52614 val_f1_mic= 0.46000 val_f1_mac= 0.19804 time= 0.08306
Iter: 0017 train_loss= 0.50708 train_f1_mic= 0.46136 train_f1_mac= 0.18251 val_loss= 0.52614 val_f1_mic= 0.46000 val_f1_mac= 0.19804 time= 0.08288
Epoch: 0009
Iter: 0003 train_loss= 0.52496 train_f1_mic= 0.44753 train_f1_mac= 0.19373 val_loss= 0.52855 val_f1_mic= 0.45248 val_f1_mac= 0.18619 time= 0.08292
Iter: 0008 train_loss= 0.51187 train_f1_mic= 0.46421 train_f1_mac= 0.20062 val_loss= 0.52855 val_f1_mic= 0.45248 val_f1_mac= 0.18619 time= 0.08275
Iter: 0013 train_loss= 0.50922 train_f1_mic= 0.47371 train_f1_mac= 0.22245 val_loss= 0.52855 val_f1_mic= 0.45248 val_f1_mac= 0.18619 time= 0.08252
Iter: 0018 train_loss= 0.50568 train_f1_mic= 0.45633 train_f1_mac= 0.19348 val_loss= 0.52855 val_f1_mic= 0.45248 val_f1_mac= 0.18619 time= 0.08230
Epoch: 0010
Iter: 0004 train_loss= 0.52258 train_f1_mic= 0.44267 train_f1_mac= 0.18966 val_loss= 0.53805 val_f1_mic= 0.47100 val_f1_mac= 0.23598 time= 0.08228
Iter: 0009 train_loss= 0.51694 train_f1_mic= 0.45556 train_f1_mac= 0.19536 val_loss= 0.53805 val_f1_mic= 0.47100 val_f1_mac= 0.23598 time= 0.08207
Iter: 0014 train_loss= 0.50400 train_f1_mic= 0.48551 train_f1_mac= 0.25431 val_loss= 0.53805 val_f1_mic= 0.47100 val_f1_mac= 0.23598 time= 0.08196
Optimization Finished!
Full validation stats: loss= 0.52743 f1_micro= 0.49089 f1_macro= 0.23770 time= 0.14465
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46329956845283715
Rewards :  0.02920232354991842 Accuracy :  0.48666142729277184
Total reward :  1.260233602447616
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 1, 'linear']
Training RNN (Reward ip) :  [0.02920232]
Trial 312: Controller loss : 14472.403320

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [4, 'tanh', 1, 'linear']
2018-08-31 01:04:09.747403: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:04:09.748204: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:04:09.749017: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:04:09.750202: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:04:09.751179: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69365 train_f1_mic= 0.37475 train_f1_mac= 0.35058 val_loss= 0.68319 val_f1_mic= 0.42954 val_f1_mac= 0.36167 time= 0.96944
Iter: 0005 train_loss= 0.61245 train_f1_mic= 0.39029 train_f1_mac= 0.14294 val_loss= 0.68319 val_f1_mic= 0.42954 val_f1_mac= 0.36167 time= 0.18152
Iter: 0010 train_loss= 0.55181 train_f1_mic= 0.38885 train_f1_mac= 0.09983 val_loss= 0.68319 val_f1_mic= 0.42954 val_f1_mac= 0.36167 time= 0.10980
Iter: 0015 train_loss= 0.53680 train_f1_mic= 0.38657 train_f1_mac= 0.09787 val_loss= 0.68319 val_f1_mic= 0.42954 val_f1_mac= 0.36167 time= 0.08290
Epoch: 0002
Iter: 0001 train_loss= 0.54444 train_f1_mic= 0.38691 train_f1_mac= 0.10390 val_loss= 0.56874 val_f1_mic= 0.38189 val_f1_mac= 0.10885 time= 0.06995
Iter: 0006 train_loss= 0.53890 train_f1_mic= 0.41442 train_f1_mac= 0.13140 val_loss= 0.56874 val_f1_mic= 0.38189 val_f1_mac= 0.10885 time= 0.06114
Iter: 0011 train_loss= 0.55605 train_f1_mic= 0.39531 train_f1_mac= 0.11867 val_loss= 0.56874 val_f1_mic= 0.38189 val_f1_mac= 0.10885 time= 0.05514
Iter: 0016 train_loss= 0.54985 train_f1_mic= 0.39524 train_f1_mac= 0.12220 val_loss= 0.56874 val_f1_mic= 0.38189 val_f1_mac= 0.10885 time= 0.05080
Epoch: 0003
Iter: 0002 train_loss= 0.53125 train_f1_mic= 0.39944 train_f1_mac= 0.12272 val_loss= 0.54771 val_f1_mic= 0.40608 val_f1_mac= 0.13251 time= 0.04806
Iter: 0007 train_loss= 0.53157 train_f1_mic= 0.41004 train_f1_mac= 0.13522 val_loss= 0.54771 val_f1_mic= 0.40608 val_f1_mac= 0.13251 time= 0.04546
Iter: 0012 train_loss= 0.53026 train_f1_mic= 0.41914 train_f1_mac= 0.14014 val_loss= 0.54771 val_f1_mic= 0.40608 val_f1_mac= 0.13251 time= 0.04335
Iter: 0017 train_loss= 0.53075 train_f1_mic= 0.41488 train_f1_mac= 0.13566 val_loss= 0.54771 val_f1_mic= 0.40608 val_f1_mac= 0.13251 time= 0.04165
Epoch: 0004
Iter: 0003 train_loss= 0.53509 train_f1_mic= 0.40030 train_f1_mac= 0.12515 val_loss= 0.54643 val_f1_mic= 0.41673 val_f1_mac= 0.14164 time= 0.04056
Iter: 0008 train_loss= 0.53849 train_f1_mic= 0.40754 train_f1_mac= 0.13553 val_loss= 0.54643 val_f1_mic= 0.41673 val_f1_mac= 0.14164 time= 0.03934
Iter: 0013 train_loss= 0.53258 train_f1_mic= 0.41646 train_f1_mac= 0.13821 val_loss= 0.54643 val_f1_mic= 0.41673 val_f1_mac= 0.14164 time= 0.03827
Iter: 0018 train_loss= 0.53260 train_f1_mic= 0.41382 train_f1_mac= 0.14084 val_loss= 0.54643 val_f1_mic= 0.41673 val_f1_mac= 0.14164 time= 0.03758
Epoch: 0005
Iter: 0004 train_loss= 0.52719 train_f1_mic= 0.42987 train_f1_mac= 0.13989 val_loss= 0.55863 val_f1_mic= 0.40644 val_f1_mac= 0.14005 time= 0.03701
Iter: 0009 train_loss= 0.51273 train_f1_mic= 0.43009 train_f1_mac= 0.14126 val_loss= 0.55863 val_f1_mic= 0.40644 val_f1_mac= 0.14005 time= 0.03633
Iter: 0014 train_loss= 0.53946 train_f1_mic= 0.42052 train_f1_mac= 0.14975 val_loss= 0.55863 val_f1_mic= 0.40644 val_f1_mac= 0.14005 time= 0.03567
Epoch: 0006
Iter: 0000 train_loss= 0.52060 train_f1_mic= 0.40893 train_f1_mac= 0.13108 val_loss= 0.56280 val_f1_mic= 0.39587 val_f1_mac= 0.13956 time= 0.03539
Iter: 0005 train_loss= 0.53646 train_f1_mic= 0.42311 train_f1_mac= 0.15381 val_loss= 0.56280 val_f1_mic= 0.39587 val_f1_mac= 0.13956 time= 0.03482
Iter: 0010 train_loss= 0.52692 train_f1_mic= 0.40915 train_f1_mac= 0.13838 val_loss= 0.56280 val_f1_mic= 0.39587 val_f1_mac= 0.13956 time= 0.03444
Iter: 0015 train_loss= 0.53067 train_f1_mic= 0.42740 train_f1_mac= 0.16158 val_loss= 0.56280 val_f1_mic= 0.39587 val_f1_mac= 0.13956 time= 0.03410
Epoch: 0007
Iter: 0001 train_loss= 0.52921 train_f1_mic= 0.43138 train_f1_mac= 0.15898 val_loss= 0.55430 val_f1_mic= 0.42486 val_f1_mac= 0.16357 time= 0.03388
Iter: 0006 train_loss= 0.52274 train_f1_mic= 0.43209 train_f1_mac= 0.15573 val_loss= 0.55430 val_f1_mic= 0.42486 val_f1_mac= 0.16357 time= 0.03349
Iter: 0011 train_loss= 0.52795 train_f1_mic= 0.41293 train_f1_mac= 0.14690 val_loss= 0.55430 val_f1_mic= 0.42486 val_f1_mac= 0.16357 time= 0.03311
Iter: 0016 train_loss= 0.53483 train_f1_mic= 0.43687 train_f1_mac= 0.17078 val_loss= 0.55430 val_f1_mic= 0.42486 val_f1_mac= 0.16357 time= 0.03277
Epoch: 0008
Iter: 0002 train_loss= 0.52626 train_f1_mic= 0.41749 train_f1_mac= 0.13583 val_loss= 0.55439 val_f1_mic= 0.41000 val_f1_mac= 0.14420 time= 0.03289
Iter: 0007 train_loss= 0.51978 train_f1_mic= 0.44286 train_f1_mac= 0.17047 val_loss= 0.55439 val_f1_mic= 0.41000 val_f1_mac= 0.14420 time= 0.03266
Iter: 0012 train_loss= 0.53160 train_f1_mic= 0.42351 train_f1_mac= 0.15744 val_loss= 0.55439 val_f1_mic= 0.41000 val_f1_mac= 0.14420 time= 0.03244
Iter: 0017 train_loss= 0.52053 train_f1_mic= 0.44862 train_f1_mac= 0.16779 val_loss= 0.55439 val_f1_mic= 0.41000 val_f1_mac= 0.14420 time= 0.03237
Epoch: 0009
Iter: 0003 train_loss= 0.52490 train_f1_mic= 0.43227 train_f1_mac= 0.16588 val_loss= 0.54791 val_f1_mic= 0.42553 val_f1_mac= 0.16137 time= 0.03225
Iter: 0008 train_loss= 0.52697 train_f1_mic= 0.44895 train_f1_mac= 0.18892 val_loss= 0.54791 val_f1_mic= 0.42553 val_f1_mac= 0.16137 time= 0.03200
Iter: 0013 train_loss= 0.52085 train_f1_mic= 0.44681 train_f1_mac= 0.18016 val_loss= 0.54791 val_f1_mic= 0.42553 val_f1_mac= 0.16137 time= 0.03175
Iter: 0018 train_loss= 0.51783 train_f1_mic= 0.42914 train_f1_mac= 0.15923 val_loss= 0.54791 val_f1_mic= 0.42553 val_f1_mac= 0.16137 time= 0.03152
Epoch: 0010
Iter: 0004 train_loss= 0.52304 train_f1_mic= 0.44558 train_f1_mac= 0.18556 val_loss= 0.52427 val_f1_mic= 0.45591 val_f1_mac= 0.19505 time= 0.03148
Iter: 0009 train_loss= 0.52020 train_f1_mic= 0.43314 train_f1_mac= 0.17919 val_loss= 0.52427 val_f1_mic= 0.45591 val_f1_mac= 0.19505 time= 0.03127
Iter: 0014 train_loss= 0.51425 train_f1_mic= 0.45726 train_f1_mac= 0.20514 val_loss= 0.52427 val_f1_mic= 0.45591 val_f1_mac= 0.19505 time= 0.03106
Optimization Finished!
Full validation stats: loss= 0.53942 f1_micro= 0.45341 f1_macro= 0.19774 time= 0.10176
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4619198663712472
Rewards :  -0.006898510407949698 Accuracy :  0.45640105804488745
Total reward :  1.2533350920396662
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'tanh', 1, 'linear']
Training RNN (Reward ip) :  [-0.00689851]
Trial 313: Controller loss : 11560.647461

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'relu', 4, 'linear']
2018-08-31 01:04:21.419881: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:04:21.420118: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:04:21.420346: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:04:21.420513: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:04:21.421068: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69488 train_f1_mic= 0.36024 train_f1_mac= 0.28790 val_loss= 0.66668 val_f1_mic= 0.34487 val_f1_mac= 0.09886 time= 0.81977
Iter: 0005 train_loss= 0.58372 train_f1_mic= 0.36644 train_f1_mac= 0.08853 val_loss= 0.66668 val_f1_mic= 0.34487 val_f1_mac= 0.09886 time= 0.17269
Iter: 0010 train_loss= 0.54330 train_f1_mic= 0.38192 train_f1_mac= 0.09216 val_loss= 0.66668 val_f1_mic= 0.34487 val_f1_mac= 0.09886 time= 0.11322
Iter: 0015 train_loss= 0.53984 train_f1_mic= 0.36985 train_f1_mac= 0.08658 val_loss= 0.66668 val_f1_mic= 0.34487 val_f1_mac= 0.09886 time= 0.09062
Epoch: 0002
Iter: 0001 train_loss= 0.55145 train_f1_mic= 0.39774 train_f1_mac= 0.10325 val_loss= 0.56009 val_f1_mic= 0.39840 val_f1_mac= 0.10551 time= 0.08007
Iter: 0006 train_loss= 0.55565 train_f1_mic= 0.36524 train_f1_mac= 0.09051 val_loss= 0.56009 val_f1_mic= 0.39840 val_f1_mac= 0.10551 time= 0.07326
Iter: 0011 train_loss= 0.52886 train_f1_mic= 0.37948 train_f1_mac= 0.08712 val_loss= 0.56009 val_f1_mic= 0.39840 val_f1_mac= 0.10551 time= 0.06852
Iter: 0016 train_loss= 0.54123 train_f1_mic= 0.36634 train_f1_mac= 0.08668 val_loss= 0.56009 val_f1_mic= 0.39840 val_f1_mac= 0.10551 time= 0.06477
Epoch: 0003
Iter: 0002 train_loss= 0.54053 train_f1_mic= 0.40560 train_f1_mac= 0.10333 val_loss= 0.55900 val_f1_mic= 0.39239 val_f1_mac= 0.10450 time= 0.06239
Iter: 0007 train_loss= 0.54330 train_f1_mic= 0.36198 train_f1_mac= 0.08619 val_loss= 0.55900 val_f1_mic= 0.39239 val_f1_mac= 0.10450 time= 0.06053
Iter: 0012 train_loss= 0.53413 train_f1_mic= 0.38042 train_f1_mac= 0.09132 val_loss= 0.55900 val_f1_mic= 0.39239 val_f1_mac= 0.10450 time= 0.05905
Iter: 0017 train_loss= 0.54144 train_f1_mic= 0.39765 train_f1_mac= 0.10172 val_loss= 0.55900 val_f1_mic= 0.39239 val_f1_mac= 0.10450 time= 0.05745
Epoch: 0004
Iter: 0003 train_loss= 0.53831 train_f1_mic= 0.36548 train_f1_mac= 0.08661 val_loss= 0.56291 val_f1_mic= 0.35956 val_f1_mac= 0.09223 time= 0.05709
Iter: 0008 train_loss= 0.54946 train_f1_mic= 0.36205 train_f1_mac= 0.08792 val_loss= 0.56291 val_f1_mic= 0.35956 val_f1_mac= 0.09223 time= 0.05592
Iter: 0013 train_loss= 0.54806 train_f1_mic= 0.37939 train_f1_mac= 0.10104 val_loss= 0.56291 val_f1_mic= 0.35956 val_f1_mac= 0.09223 time= 0.05513
Iter: 0018 train_loss= 0.53829 train_f1_mic= 0.42313 train_f1_mac= 0.12570 val_loss= 0.56291 val_f1_mic= 0.35956 val_f1_mac= 0.09223 time= 0.05426
Epoch: 0005
Iter: 0004 train_loss= 0.53351 train_f1_mic= 0.42293 train_f1_mac= 0.12427 val_loss= 0.55125 val_f1_mic= 0.39697 val_f1_mac= 0.11339 time= 0.05423
Iter: 0009 train_loss= 0.53512 train_f1_mic= 0.38044 train_f1_mac= 0.10693 val_loss= 0.55125 val_f1_mic= 0.39697 val_f1_mac= 0.11339 time= 0.05353
Iter: 0014 train_loss= 0.52404 train_f1_mic= 0.38493 train_f1_mac= 0.10763 val_loss= 0.55125 val_f1_mic= 0.39697 val_f1_mac= 0.11339 time= 0.05297
Epoch: 0006
Iter: 0000 train_loss= 0.53511 train_f1_mic= 0.43277 train_f1_mac= 0.14234 val_loss= 0.54989 val_f1_mic= 0.43706 val_f1_mac= 0.14513 time= 0.05262
Iter: 0005 train_loss= 0.53042 train_f1_mic= 0.42086 train_f1_mac= 0.13333 val_loss= 0.54989 val_f1_mic= 0.43706 val_f1_mac= 0.14513 time= 0.05206
Iter: 0010 train_loss= 0.54297 train_f1_mic= 0.40193 train_f1_mac= 0.12940 val_loss= 0.54989 val_f1_mic= 0.43706 val_f1_mac= 0.14513 time= 0.05161
Iter: 0015 train_loss= 0.54422 train_f1_mic= 0.36462 train_f1_mac= 0.10049 val_loss= 0.54989 val_f1_mic= 0.43706 val_f1_mac= 0.14513 time= 0.05121
Epoch: 0007
Iter: 0001 train_loss= 0.53005 train_f1_mic= 0.43197 train_f1_mac= 0.14088 val_loss= 0.55847 val_f1_mic= 0.42208 val_f1_mac= 0.13483 time= 0.05097
Iter: 0006 train_loss= 0.52933 train_f1_mic= 0.42894 train_f1_mac= 0.13712 val_loss= 0.55847 val_f1_mic= 0.42208 val_f1_mac= 0.13483 time= 0.05068
Iter: 0011 train_loss= 0.53055 train_f1_mic= 0.38175 train_f1_mac= 0.11227 val_loss= 0.55847 val_f1_mic= 0.42208 val_f1_mac= 0.13483 time= 0.05032
Iter: 0016 train_loss= 0.53566 train_f1_mic= 0.43176 train_f1_mac= 0.16479 val_loss= 0.55847 val_f1_mic= 0.42208 val_f1_mac= 0.13483 time= 0.05001
Epoch: 0008
Iter: 0002 train_loss= 0.51854 train_f1_mic= 0.43828 train_f1_mac= 0.15505 val_loss= 0.56552 val_f1_mic= 0.42065 val_f1_mac= 0.16105 time= 0.04994
Iter: 0007 train_loss= 0.52149 train_f1_mic= 0.43237 train_f1_mac= 0.14219 val_loss= 0.56552 val_f1_mic= 0.42065 val_f1_mac= 0.16105 time= 0.04965
Iter: 0012 train_loss= 0.52079 train_f1_mic= 0.43330 train_f1_mac= 0.16019 val_loss= 0.56552 val_f1_mic= 0.42065 val_f1_mac= 0.16105 time= 0.04941
Iter: 0017 train_loss= 0.53136 train_f1_mic= 0.43667 train_f1_mac= 0.17195 val_loss= 0.56552 val_f1_mic= 0.42065 val_f1_mac= 0.16105 time= 0.04911
Epoch: 0009
Iter: 0003 train_loss= 0.53568 train_f1_mic= 0.46093 train_f1_mac= 0.20561 val_loss= 0.57587 val_f1_mic= 0.39597 val_f1_mac= 0.14547 time= 0.04903
Iter: 0008 train_loss= 0.52921 train_f1_mic= 0.42501 train_f1_mac= 0.14911 val_loss= 0.57587 val_f1_mic= 0.39597 val_f1_mac= 0.14547 time= 0.04880
Iter: 0013 train_loss= 0.51185 train_f1_mic= 0.43190 train_f1_mac= 0.14889 val_loss= 0.57587 val_f1_mic= 0.39597 val_f1_mac= 0.14547 time= 0.04855
Iter: 0018 train_loss= 0.53686 train_f1_mic= 0.41392 train_f1_mac= 0.15143 val_loss= 0.57587 val_f1_mic= 0.39597 val_f1_mac= 0.14547 time= 0.04836
Epoch: 0010
Iter: 0004 train_loss= 0.51758 train_f1_mic= 0.44693 train_f1_mac= 0.17208 val_loss= 0.53607 val_f1_mic= 0.42048 val_f1_mac= 0.17015 time= 0.04829
Iter: 0009 train_loss= 0.52531 train_f1_mic= 0.43984 train_f1_mac= 0.18070 val_loss= 0.53607 val_f1_mic= 0.42048 val_f1_mac= 0.17015 time= 0.04808
Iter: 0014 train_loss= 0.51955 train_f1_mic= 0.46884 train_f1_mac= 0.20269 val_loss= 0.53607 val_f1_mic= 0.42048 val_f1_mac= 0.17015 time= 0.04791
Optimization Finished!
Full validation stats: loss= 0.54016 f1_micro= 0.46953 f1_macro= 0.21339 time= 0.11968
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4613577373226021
Rewards :  -0.0028106452432256623 Accuracy :  0.45910922112802155
Total reward :  1.2505244467964405
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'relu', 4, 'linear']
Training RNN (Reward ip) :  [-0.00281065]
Trial 314: Controller loss : 12581.770508

Prediction action from Controller
State input to Controller for Action :  [0. 0. 3. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:04:36.405841: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:04:36.406149: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:04:36.406454: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:04:36.406678: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:04:36.406953: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69296 train_f1_mic= 0.35645 train_f1_mac= 0.27999 val_loss= 0.66687 val_f1_mic= 0.37823 val_f1_mac= 0.11951 time= 0.78653
Iter: 0005 train_loss= 0.58865 train_f1_mic= 0.38031 train_f1_mac= 0.09340 val_loss= 0.66687 val_f1_mic= 0.37823 val_f1_mac= 0.11951 time= 0.14488
Iter: 0010 train_loss= 0.54895 train_f1_mic= 0.37710 train_f1_mac= 0.09430 val_loss= 0.66687 val_f1_mic= 0.37823 val_f1_mac= 0.11951 time= 0.08673
Iter: 0015 train_loss= 0.54998 train_f1_mic= 0.42069 train_f1_mac= 0.11499 val_loss= 0.66687 val_f1_mic= 0.37823 val_f1_mac= 0.11951 time= 0.06449
Epoch: 0002
Iter: 0001 train_loss= 0.54052 train_f1_mic= 0.40260 train_f1_mac= 0.10427 val_loss= 0.56030 val_f1_mic= 0.39782 val_f1_mac= 0.10808 time= 0.05417
Iter: 0006 train_loss= 0.53913 train_f1_mic= 0.37024 train_f1_mac= 0.08903 val_loss= 0.56030 val_f1_mic= 0.39782 val_f1_mac= 0.10808 time= 0.04693
Iter: 0011 train_loss= 0.53536 train_f1_mic= 0.37379 train_f1_mac= 0.09308 val_loss= 0.56030 val_f1_mic= 0.39782 val_f1_mac= 0.10808 time= 0.04197
Iter: 0016 train_loss= 0.52930 train_f1_mic= 0.39068 train_f1_mac= 0.10259 val_loss= 0.56030 val_f1_mic= 0.39782 val_f1_mac= 0.10808 time= 0.03822
Epoch: 0003
Iter: 0002 train_loss= 0.52485 train_f1_mic= 0.41119 train_f1_mac= 0.11391 val_loss= 0.55787 val_f1_mic= 0.39212 val_f1_mac= 0.11455 time= 0.03570
Iter: 0007 train_loss= 0.53095 train_f1_mic= 0.39714 train_f1_mac= 0.11615 val_loss= 0.55787 val_f1_mic= 0.39212 val_f1_mac= 0.11455 time= 0.03336
Iter: 0012 train_loss= 0.51821 train_f1_mic= 0.42117 train_f1_mac= 0.12992 val_loss= 0.55787 val_f1_mic= 0.39212 val_f1_mac= 0.11455 time= 0.03146
Iter: 0017 train_loss= 0.51964 train_f1_mic= 0.41320 train_f1_mac= 0.12750 val_loss= 0.55787 val_f1_mic= 0.39212 val_f1_mac= 0.11455 time= 0.03007
Epoch: 0004
Iter: 0003 train_loss= 0.52399 train_f1_mic= 0.40795 train_f1_mac= 0.12576 val_loss= 0.54515 val_f1_mic= 0.42027 val_f1_mac= 0.13934 time= 0.02959
Iter: 0008 train_loss= 0.53243 train_f1_mic= 0.42659 train_f1_mac= 0.14633 val_loss= 0.54515 val_f1_mic= 0.42027 val_f1_mac= 0.13934 time= 0.02848
Iter: 0013 train_loss= 0.52479 train_f1_mic= 0.42118 train_f1_mac= 0.13876 val_loss= 0.54515 val_f1_mic= 0.42027 val_f1_mac= 0.13934 time= 0.02749
Iter: 0018 train_loss= 0.53621 train_f1_mic= 0.42649 train_f1_mac= 0.14763 val_loss= 0.54515 val_f1_mic= 0.42027 val_f1_mac= 0.13934 time= 0.02670
Epoch: 0005
Iter: 0004 train_loss= 0.52291 train_f1_mic= 0.40941 train_f1_mac= 0.13308 val_loss= 0.54008 val_f1_mic= 0.43790 val_f1_mac= 0.15718 time= 0.02636
Iter: 0009 train_loss= 0.52295 train_f1_mic= 0.44756 train_f1_mac= 0.16992 val_loss= 0.54008 val_f1_mic= 0.43790 val_f1_mac= 0.15718 time= 0.02567
Iter: 0014 train_loss= 0.51753 train_f1_mic= 0.45470 train_f1_mac= 0.17346 val_loss= 0.54008 val_f1_mic= 0.43790 val_f1_mac= 0.15718 time= 0.02512
Epoch: 0006
Iter: 0000 train_loss= 0.52528 train_f1_mic= 0.41127 train_f1_mac= 0.14197 val_loss= 0.53205 val_f1_mic= 0.41721 val_f1_mac= 0.15436 time= 0.02501
Iter: 0005 train_loss= 0.51684 train_f1_mic= 0.43979 train_f1_mac= 0.17131 val_loss= 0.53205 val_f1_mic= 0.41721 val_f1_mac= 0.15436 time= 0.02451
Iter: 0010 train_loss= 0.50864 train_f1_mic= 0.47304 train_f1_mac= 0.19967 val_loss= 0.53205 val_f1_mic= 0.41721 val_f1_mac= 0.15436 time= 0.02412
Iter: 0015 train_loss= 0.50349 train_f1_mic= 0.46026 train_f1_mac= 0.18366 val_loss= 0.53205 val_f1_mic= 0.41721 val_f1_mac= 0.15436 time= 0.02372
Epoch: 0007
Iter: 0001 train_loss= 0.51080 train_f1_mic= 0.46825 train_f1_mac= 0.19794 val_loss= 0.52481 val_f1_mic= 0.47822 val_f1_mac= 0.21183 time= 0.02350
Iter: 0006 train_loss= 0.50396 train_f1_mic= 0.43180 train_f1_mac= 0.17615 val_loss= 0.52481 val_f1_mic= 0.47822 val_f1_mac= 0.21183 time= 0.02311
Iter: 0011 train_loss= 0.51010 train_f1_mic= 0.48409 train_f1_mac= 0.21954 val_loss= 0.52481 val_f1_mic= 0.47822 val_f1_mac= 0.21183 time= 0.02284
Iter: 0016 train_loss= 0.50931 train_f1_mic= 0.47339 train_f1_mac= 0.21306 val_loss= 0.52481 val_f1_mic= 0.47822 val_f1_mac= 0.21183 time= 0.02253
Epoch: 0008
Iter: 0002 train_loss= 0.49956 train_f1_mic= 0.48532 train_f1_mac= 0.22281 val_loss= 0.53535 val_f1_mic= 0.46327 val_f1_mac= 0.21571 time= 0.02248
Iter: 0007 train_loss= 0.50293 train_f1_mic= 0.48179 train_f1_mac= 0.23146 val_loss= 0.53535 val_f1_mic= 0.46327 val_f1_mac= 0.21571 time= 0.02221
Iter: 0012 train_loss= 0.50405 train_f1_mic= 0.48187 train_f1_mac= 0.22802 val_loss= 0.53535 val_f1_mic= 0.46327 val_f1_mac= 0.21571 time= 0.02194
Iter: 0017 train_loss= 0.49287 train_f1_mic= 0.46310 train_f1_mac= 0.21269 val_loss= 0.53535 val_f1_mic= 0.46327 val_f1_mac= 0.21571 time= 0.02167
Epoch: 0009
Iter: 0003 train_loss= 0.50161 train_f1_mic= 0.50959 train_f1_mac= 0.25219 val_loss= 0.51547 val_f1_mic= 0.46624 val_f1_mac= 0.21102 time= 0.02167
Iter: 0008 train_loss= 0.50991 train_f1_mic= 0.50756 train_f1_mac= 0.25898 val_loss= 0.51547 val_f1_mic= 0.46624 val_f1_mac= 0.21102 time= 0.02147
Iter: 0013 train_loss= 0.48945 train_f1_mic= 0.48364 train_f1_mac= 0.23896 val_loss= 0.51547 val_f1_mic= 0.46624 val_f1_mac= 0.21102 time= 0.02129
Iter: 0018 train_loss= 0.50079 train_f1_mic= 0.47567 train_f1_mac= 0.23858 val_loss= 0.51547 val_f1_mic= 0.46624 val_f1_mac= 0.21102 time= 0.02110
Epoch: 0010
Iter: 0004 train_loss= 0.50422 train_f1_mic= 0.46376 train_f1_mac= 0.21972 val_loss= 0.51806 val_f1_mic= 0.52021 val_f1_mac= 0.30189 time= 0.02105
Iter: 0009 train_loss= 0.48344 train_f1_mic= 0.49746 train_f1_mac= 0.26566 val_loss= 0.51806 val_f1_mic= 0.52021 val_f1_mac= 0.30189 time= 0.02090
Iter: 0014 train_loss= 0.50399 train_f1_mic= 0.52420 train_f1_mac= 0.28962 val_loss= 0.51806 val_f1_mic= 0.52021 val_f1_mac= 0.30189 time= 0.02075
Optimization Finished!
Full validation stats: loss= 0.51692 f1_micro= 0.48253 f1_macro= 0.25620 time= 0.13662
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4649200920196289
Rewards :  0.01781177348513402 Accuracy :  0.4791695108077361
Total reward :  1.2683362202815744
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.01781177]
Trial 315: Controller loss : 132.297104

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'relu', 3, 'sigmoid']
2018-08-31 01:04:45.810327: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:04:45.810566: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:04:45.810938: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:04:45.811294: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:04:45.811747: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69181 train_f1_mic= 0.39799 train_f1_mac= 0.25446 val_loss= 0.65526 val_f1_mic= 0.37901 val_f1_mac= 0.10013 time= 0.84075
Iter: 0005 train_loss= 0.57116 train_f1_mic= 0.38597 train_f1_mac= 0.09285 val_loss= 0.65526 val_f1_mic= 0.37901 val_f1_mac= 0.10013 time= 0.19248
Iter: 0010 train_loss= 0.54733 train_f1_mic= 0.38140 train_f1_mac= 0.09295 val_loss= 0.65526 val_f1_mic= 0.37901 val_f1_mac= 0.10013 time= 0.13364
Iter: 0015 train_loss= 0.54662 train_f1_mic= 0.36262 train_f1_mac= 0.08598 val_loss= 0.65526 val_f1_mic= 0.37901 val_f1_mac= 0.10013 time= 0.11151
Epoch: 0002
Iter: 0001 train_loss= 0.54806 train_f1_mic= 0.38217 train_f1_mac= 0.09318 val_loss= 0.57979 val_f1_mic= 0.36663 val_f1_mac= 0.09460 time= 0.10092
Iter: 0006 train_loss= 0.54169 train_f1_mic= 0.38995 train_f1_mac= 0.09713 val_loss= 0.57979 val_f1_mic= 0.36663 val_f1_mac= 0.09460 time= 0.09375
Iter: 0011 train_loss= 0.54483 train_f1_mic= 0.38705 train_f1_mac= 0.09740 val_loss= 0.57979 val_f1_mic= 0.36663 val_f1_mac= 0.09460 time= 0.08870
Iter: 0016 train_loss= 0.53924 train_f1_mic= 0.39422 train_f1_mac= 0.10034 val_loss= 0.57979 val_f1_mic= 0.36663 val_f1_mac= 0.09460 time= 0.08525
Epoch: 0003
Iter: 0002 train_loss= 0.52950 train_f1_mic= 0.40047 train_f1_mac= 0.10128 val_loss= 0.55933 val_f1_mic= 0.38293 val_f1_mac= 0.10349 time= 0.08310
Iter: 0007 train_loss= 0.53611 train_f1_mic= 0.40500 train_f1_mac= 0.10817 val_loss= 0.55933 val_f1_mic= 0.38293 val_f1_mac= 0.10349 time= 0.08094
Iter: 0012 train_loss= 0.53441 train_f1_mic= 0.38903 train_f1_mac= 0.10352 val_loss= 0.55933 val_f1_mic= 0.38293 val_f1_mac= 0.10349 time= 0.07918
Iter: 0017 train_loss= 0.52877 train_f1_mic= 0.42004 train_f1_mac= 0.11653 val_loss= 0.55933 val_f1_mic= 0.38293 val_f1_mac= 0.10349 time= 0.07772
Epoch: 0004
Iter: 0003 train_loss= 0.53028 train_f1_mic= 0.41185 train_f1_mac= 0.12123 val_loss= 0.55525 val_f1_mic= 0.40420 val_f1_mac= 0.12359 time= 0.07686
Iter: 0008 train_loss= 0.53186 train_f1_mic= 0.42563 train_f1_mac= 0.12943 val_loss= 0.55525 val_f1_mic= 0.40420 val_f1_mac= 0.12359 time= 0.07581
Iter: 0013 train_loss= 0.53451 train_f1_mic= 0.42152 train_f1_mac= 0.12974 val_loss= 0.55525 val_f1_mic= 0.40420 val_f1_mac= 0.12359 time= 0.07493
Iter: 0018 train_loss= 0.52103 train_f1_mic= 0.43215 train_f1_mac= 0.13549 val_loss= 0.55525 val_f1_mic= 0.40420 val_f1_mac= 0.12359 time= 0.07416
Epoch: 0005
Iter: 0004 train_loss= 0.52228 train_f1_mic= 0.42005 train_f1_mac= 0.13156 val_loss= 0.54778 val_f1_mic= 0.39960 val_f1_mac= 0.13072 time= 0.07376
Iter: 0009 train_loss= 0.53555 train_f1_mic= 0.40632 train_f1_mac= 0.12605 val_loss= 0.54778 val_f1_mic= 0.39960 val_f1_mac= 0.13072 time= 0.07312
Iter: 0014 train_loss= 0.52238 train_f1_mic= 0.43568 train_f1_mac= 0.14256 val_loss= 0.54778 val_f1_mic= 0.39960 val_f1_mac= 0.13072 time= 0.07256
Epoch: 0006
Iter: 0000 train_loss= 0.52593 train_f1_mic= 0.41802 train_f1_mac= 0.13081 val_loss= 0.54489 val_f1_mic= 0.43243 val_f1_mac= 0.13938 time= 0.07229
Iter: 0005 train_loss= 0.51437 train_f1_mic= 0.41909 train_f1_mac= 0.12873 val_loss= 0.54489 val_f1_mic= 0.43243 val_f1_mac= 0.13938 time= 0.07182
Iter: 0010 train_loss= 0.53160 train_f1_mic= 0.43264 train_f1_mac= 0.14652 val_loss= 0.54489 val_f1_mic= 0.43243 val_f1_mac= 0.13938 time= 0.07139
Iter: 0015 train_loss= 0.53206 train_f1_mic= 0.41834 train_f1_mac= 0.14347 val_loss= 0.54489 val_f1_mic= 0.43243 val_f1_mac= 0.13938 time= 0.07101
Epoch: 0007
Iter: 0001 train_loss= 0.53040 train_f1_mic= 0.41425 train_f1_mac= 0.13142 val_loss= 0.54769 val_f1_mic= 0.41162 val_f1_mac= 0.13633 time= 0.07099
Iter: 0006 train_loss= 0.51109 train_f1_mic= 0.44389 train_f1_mac= 0.15651 val_loss= 0.54769 val_f1_mic= 0.41162 val_f1_mac= 0.13633 time= 0.07064
Iter: 0011 train_loss= 0.51454 train_f1_mic= 0.44996 train_f1_mac= 0.16890 val_loss= 0.54769 val_f1_mic= 0.41162 val_f1_mac= 0.13633 time= 0.07033
Iter: 0016 train_loss= 0.51432 train_f1_mic= 0.46840 train_f1_mac= 0.18529 val_loss= 0.54769 val_f1_mic= 0.41162 val_f1_mac= 0.13633 time= 0.07005
Epoch: 0008
Iter: 0002 train_loss= 0.52452 train_f1_mic= 0.44532 train_f1_mac= 0.17876 val_loss= 0.55380 val_f1_mic= 0.44971 val_f1_mac= 0.18922 time= 0.06994
Iter: 0007 train_loss= 0.51864 train_f1_mic= 0.42569 train_f1_mac= 0.15183 val_loss= 0.55380 val_f1_mic= 0.44971 val_f1_mac= 0.18922 time= 0.06969
Iter: 0012 train_loss= 0.51949 train_f1_mic= 0.46241 train_f1_mac= 0.20212 val_loss= 0.55380 val_f1_mic= 0.44971 val_f1_mac= 0.18922 time= 0.06946
Iter: 0017 train_loss= 0.50721 train_f1_mic= 0.48974 train_f1_mac= 0.21786 val_loss= 0.55380 val_f1_mic= 0.44971 val_f1_mac= 0.18922 time= 0.06925
Epoch: 0009
Iter: 0003 train_loss= 0.53676 train_f1_mic= 0.47153 train_f1_mac= 0.21114 val_loss= 0.54118 val_f1_mic= 0.44241 val_f1_mac= 0.18685 time= 0.06936
Iter: 0008 train_loss= 0.51497 train_f1_mic= 0.42465 train_f1_mac= 0.14573 val_loss= 0.54118 val_f1_mic= 0.44241 val_f1_mac= 0.18685 time= 0.06916
Iter: 0013 train_loss= 0.51731 train_f1_mic= 0.44577 train_f1_mac= 0.18588 val_loss= 0.54118 val_f1_mic= 0.44241 val_f1_mac= 0.18685 time= 0.06898
Iter: 0018 train_loss= 0.51494 train_f1_mic= 0.49702 train_f1_mac= 0.23716 val_loss= 0.54118 val_f1_mic= 0.44241 val_f1_mac= 0.18685 time= 0.06880
Epoch: 0010
Iter: 0004 train_loss= 0.50636 train_f1_mic= 0.48554 train_f1_mac= 0.22231 val_loss= 0.52757 val_f1_mic= 0.48419 val_f1_mac= 0.22227 time= 0.06876
Iter: 0009 train_loss= 0.52047 train_f1_mic= 0.44738 train_f1_mac= 0.19238 val_loss= 0.52757 val_f1_mic= 0.48419 val_f1_mac= 0.22227 time= 0.06863
Iter: 0014 train_loss= 0.49766 train_f1_mic= 0.46355 train_f1_mac= 0.20148 val_loss= 0.52757 val_f1_mic= 0.48419 val_f1_mac= 0.22227 time= 0.06847
Optimization Finished!
Full validation stats: loss= 0.52682 f1_micro= 0.49298 f1_macro= 0.23592 time= 0.12064
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4688229175937902
Rewards :  0.01951412787080653 Accuracy :  0.48443421989043545
Total reward :  1.2878503481523809
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'relu', 3, 'sigmoid']
Training RNN (Reward ip) :  [0.01951413]
Trial 316: Controller loss : 3892.373535

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'relu', 3, 'relu']
2018-08-31 01:05:04.219042: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:05:04.219619: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:05:04.220171: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:05:04.220594: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:05:04.221093: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69336 train_f1_mic= 0.34906 train_f1_mac= 0.28890 val_loss= 0.66307 val_f1_mic= 0.39359 val_f1_mac= 0.11185 time= 0.74501
Iter: 0005 train_loss= 0.59514 train_f1_mic= 0.35845 train_f1_mac= 0.08821 val_loss= 0.66307 val_f1_mic= 0.39359 val_f1_mac= 0.11185 time= 0.13579
Iter: 0010 train_loss= 0.54006 train_f1_mic= 0.39702 train_f1_mac= 0.09798 val_loss= 0.66307 val_f1_mic= 0.39359 val_f1_mac= 0.11185 time= 0.08141
Iter: 0015 train_loss= 0.54099 train_f1_mic= 0.39870 train_f1_mac= 0.10523 val_loss= 0.66307 val_f1_mic= 0.39359 val_f1_mac= 0.11185 time= 0.06083
Epoch: 0002
Iter: 0001 train_loss= 0.53433 train_f1_mic= 0.39633 train_f1_mac= 0.10430 val_loss= 0.55995 val_f1_mic= 0.38395 val_f1_mac= 0.10833 time= 0.05062
Iter: 0006 train_loss= 0.53832 train_f1_mic= 0.37504 train_f1_mac= 0.09587 val_loss= 0.55995 val_f1_mic= 0.38395 val_f1_mac= 0.10833 time= 0.04399
Iter: 0011 train_loss= 0.53810 train_f1_mic= 0.38617 train_f1_mac= 0.10258 val_loss= 0.55995 val_f1_mic= 0.38395 val_f1_mac= 0.10833 time= 0.03947
Iter: 0016 train_loss= 0.53468 train_f1_mic= 0.39795 train_f1_mac= 0.11487 val_loss= 0.55995 val_f1_mic= 0.38395 val_f1_mac= 0.10833 time= 0.03623
Epoch: 0003
Iter: 0002 train_loss= 0.52233 train_f1_mic= 0.41039 train_f1_mac= 0.12208 val_loss= 0.56790 val_f1_mic= 0.38840 val_f1_mac= 0.12265 time= 0.03442
Iter: 0007 train_loss= 0.52876 train_f1_mic= 0.42006 train_f1_mac= 0.12902 val_loss= 0.56790 val_f1_mic= 0.38840 val_f1_mac= 0.12265 time= 0.03219
Iter: 0012 train_loss= 0.53446 train_f1_mic= 0.40934 train_f1_mac= 0.12952 val_loss= 0.56790 val_f1_mic= 0.38840 val_f1_mac= 0.12265 time= 0.03040
Iter: 0017 train_loss= 0.53171 train_f1_mic= 0.42244 train_f1_mac= 0.13339 val_loss= 0.56790 val_f1_mic= 0.38840 val_f1_mac= 0.12265 time= 0.02894
Epoch: 0004
Iter: 0003 train_loss= 0.52862 train_f1_mic= 0.42178 train_f1_mac= 0.13847 val_loss= 0.55652 val_f1_mic= 0.42007 val_f1_mac= 0.14543 time= 0.02800
Iter: 0008 train_loss= 0.52922 train_f1_mic= 0.41405 train_f1_mac= 0.13287 val_loss= 0.55652 val_f1_mic= 0.42007 val_f1_mac= 0.14543 time= 0.02694
Iter: 0013 train_loss= 0.52136 train_f1_mic= 0.44729 train_f1_mac= 0.15516 val_loss= 0.55652 val_f1_mic= 0.42007 val_f1_mac= 0.14543 time= 0.02605
Iter: 0018 train_loss= 0.53181 train_f1_mic= 0.40643 train_f1_mac= 0.13488 val_loss= 0.55652 val_f1_mic= 0.42007 val_f1_mac= 0.14543 time= 0.02540
Epoch: 0005
Iter: 0004 train_loss= 0.52664 train_f1_mic= 0.45148 train_f1_mac= 0.17260 val_loss= 0.54389 val_f1_mic= 0.43643 val_f1_mac= 0.15963 time= 0.02497
Iter: 0009 train_loss= 0.52296 train_f1_mic= 0.42039 train_f1_mac= 0.14836 val_loss= 0.54389 val_f1_mic= 0.43643 val_f1_mac= 0.15963 time= 0.02436
Iter: 0014 train_loss= 0.50615 train_f1_mic= 0.43881 train_f1_mac= 0.15489 val_loss= 0.54389 val_f1_mic= 0.43643 val_f1_mac= 0.15963 time= 0.02382
Epoch: 0006
Iter: 0000 train_loss= 0.50931 train_f1_mic= 0.43763 train_f1_mac= 0.15823 val_loss= 0.54054 val_f1_mic= 0.44161 val_f1_mac= 0.17394 time= 0.02369
Iter: 0005 train_loss= 0.52095 train_f1_mic= 0.45165 train_f1_mac= 0.17812 val_loss= 0.54054 val_f1_mic= 0.44161 val_f1_mac= 0.17394 time= 0.02329
Iter: 0010 train_loss= 0.51776 train_f1_mic= 0.43734 train_f1_mac= 0.16890 val_loss= 0.54054 val_f1_mic= 0.44161 val_f1_mac= 0.17394 time= 0.02293
Iter: 0015 train_loss= 0.51173 train_f1_mic= 0.45062 train_f1_mac= 0.17609 val_loss= 0.54054 val_f1_mic= 0.44161 val_f1_mac= 0.17394 time= 0.02258
Epoch: 0007
Iter: 0001 train_loss= 0.50854 train_f1_mic= 0.45778 train_f1_mac= 0.19208 val_loss= 0.52770 val_f1_mic= 0.47279 val_f1_mac= 0.21258 time= 0.02252
Iter: 0006 train_loss= 0.50877 train_f1_mic= 0.45098 train_f1_mac= 0.18684 val_loss= 0.52770 val_f1_mic= 0.47279 val_f1_mac= 0.21258 time= 0.02225
Iter: 0011 train_loss= 0.51646 train_f1_mic= 0.46105 train_f1_mac= 0.19889 val_loss= 0.52770 val_f1_mic= 0.47279 val_f1_mac= 0.21258 time= 0.02195
Iter: 0016 train_loss= 0.51661 train_f1_mic= 0.44070 train_f1_mac= 0.17705 val_loss= 0.52770 val_f1_mic= 0.47279 val_f1_mac= 0.21258 time= 0.02173
Epoch: 0008
Iter: 0002 train_loss= 0.51186 train_f1_mic= 0.49204 train_f1_mac= 0.22364 val_loss= 0.52769 val_f1_mic= 0.49767 val_f1_mac= 0.23891 time= 0.02176
Iter: 0007 train_loss= 0.51180 train_f1_mic= 0.44146 train_f1_mac= 0.19010 val_loss= 0.52769 val_f1_mic= 0.49767 val_f1_mac= 0.23891 time= 0.02152
Iter: 0012 train_loss= 0.51304 train_f1_mic= 0.46868 train_f1_mac= 0.20966 val_loss= 0.52769 val_f1_mic= 0.49767 val_f1_mac= 0.23891 time= 0.02126
Iter: 0017 train_loss= 0.51092 train_f1_mic= 0.47571 train_f1_mac= 0.21700 val_loss= 0.52769 val_f1_mic= 0.49767 val_f1_mac= 0.23891 time= 0.02104
Epoch: 0009
Iter: 0003 train_loss= 0.51173 train_f1_mic= 0.43519 train_f1_mac= 0.17572 val_loss= 0.52724 val_f1_mic= 0.46896 val_f1_mac= 0.21447 time= 0.02097
Iter: 0008 train_loss= 0.50579 train_f1_mic= 0.46938 train_f1_mac= 0.22158 val_loss= 0.52724 val_f1_mic= 0.46896 val_f1_mac= 0.21447 time= 0.02075
Iter: 0013 train_loss= 0.51472 train_f1_mic= 0.50020 train_f1_mac= 0.24754 val_loss= 0.52724 val_f1_mic= 0.46896 val_f1_mac= 0.21447 time= 0.02057
Iter: 0018 train_loss= 0.50504 train_f1_mic= 0.45384 train_f1_mac= 0.19687 val_loss= 0.52724 val_f1_mic= 0.46896 val_f1_mac= 0.21447 time= 0.02038
Epoch: 0010
Iter: 0004 train_loss= 0.51147 train_f1_mic= 0.45888 train_f1_mac= 0.20882 val_loss= 0.53229 val_f1_mic= 0.49929 val_f1_mac= 0.25507 time= 0.02031
Iter: 0009 train_loss= 0.51071 train_f1_mic= 0.47955 train_f1_mac= 0.22848 val_loss= 0.53229 val_f1_mic= 0.49929 val_f1_mac= 0.25507 time= 0.02017
Iter: 0014 train_loss= 0.50001 train_f1_mic= 0.48073 train_f1_mac= 0.23980 val_loss= 0.53229 val_f1_mic= 0.49929 val_f1_mac= 0.25507 time= 0.02004
Optimization Finished!
Full validation stats: loss= 0.52795 f1_micro= 0.47632 f1_macro= 0.23911 time= 0.15359
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47040614387153035
Rewards :  0.007916131388700565 Accuracy :  0.47673904898249075
Total reward :  1.2957664795410815
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.00791613]
Trial 317: Controller loss : 3563.009277

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 0. 5.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:05:13.386386: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:05:13.387090: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:05:13.387767: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:05:13.388269: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:05:13.388879: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69237 train_f1_mic= 0.37584 train_f1_mac= 0.28955 val_loss= 0.66281 val_f1_mic= 0.37230 val_f1_mac= 0.10546 time= 0.77137
Iter: 0005 train_loss= 0.59248 train_f1_mic= 0.38067 train_f1_mac= 0.09331 val_loss= 0.66281 val_f1_mic= 0.37230 val_f1_mac= 0.10546 time= 0.14021
Iter: 0010 train_loss= 0.54975 train_f1_mic= 0.37203 train_f1_mac= 0.08780 val_loss= 0.66281 val_f1_mic= 0.37230 val_f1_mac= 0.10546 time= 0.08373
Iter: 0015 train_loss= 0.54895 train_f1_mic= 0.39666 train_f1_mac= 0.10295 val_loss= 0.66281 val_f1_mic= 0.37230 val_f1_mac= 0.10546 time= 0.06224
Epoch: 0002
Iter: 0001 train_loss= 0.53790 train_f1_mic= 0.40002 train_f1_mac= 0.10231 val_loss= 0.56782 val_f1_mic= 0.39518 val_f1_mac= 0.10770 time= 0.05222
Iter: 0006 train_loss= 0.53735 train_f1_mic= 0.37332 train_f1_mac= 0.08991 val_loss= 0.56782 val_f1_mic= 0.39518 val_f1_mac= 0.10770 time= 0.04517
Iter: 0011 train_loss= 0.54476 train_f1_mic= 0.37285 train_f1_mac= 0.09532 val_loss= 0.56782 val_f1_mic= 0.39518 val_f1_mac= 0.10770 time= 0.04036
Iter: 0016 train_loss= 0.54036 train_f1_mic= 0.39583 train_f1_mac= 0.10724 val_loss= 0.56782 val_f1_mic= 0.39518 val_f1_mac= 0.10770 time= 0.03686
Epoch: 0003
Iter: 0002 train_loss= 0.54639 train_f1_mic= 0.39430 train_f1_mac= 0.11257 val_loss= 0.56286 val_f1_mic= 0.38846 val_f1_mac= 0.11254 time= 0.03460
Iter: 0007 train_loss= 0.53629 train_f1_mic= 0.39821 train_f1_mac= 0.11866 val_loss= 0.56286 val_f1_mic= 0.38846 val_f1_mac= 0.11254 time= 0.03249
Iter: 0012 train_loss= 0.51975 train_f1_mic= 0.39527 train_f1_mac= 0.11354 val_loss= 0.56286 val_f1_mic= 0.38846 val_f1_mac= 0.11254 time= 0.03067
Iter: 0017 train_loss= 0.52235 train_f1_mic= 0.43957 train_f1_mac= 0.13797 val_loss= 0.56286 val_f1_mic= 0.38846 val_f1_mac= 0.11254 time= 0.02922
Epoch: 0004
Iter: 0003 train_loss= 0.52694 train_f1_mic= 0.40165 train_f1_mac= 0.12955 val_loss= 0.54521 val_f1_mic= 0.43362 val_f1_mac= 0.14676 time= 0.02852
Iter: 0008 train_loss= 0.52415 train_f1_mic= 0.43017 train_f1_mac= 0.14058 val_loss= 0.54521 val_f1_mic= 0.43362 val_f1_mac= 0.14676 time= 0.02749
Iter: 0013 train_loss= 0.52634 train_f1_mic= 0.40827 train_f1_mac= 0.13345 val_loss= 0.54521 val_f1_mic= 0.43362 val_f1_mac= 0.14676 time= 0.02658
Iter: 0018 train_loss= 0.52008 train_f1_mic= 0.43982 train_f1_mac= 0.15494 val_loss= 0.54521 val_f1_mic= 0.43362 val_f1_mac= 0.14676 time= 0.02586
Epoch: 0005
Iter: 0004 train_loss= 0.51238 train_f1_mic= 0.43985 train_f1_mac= 0.15629 val_loss= 0.54182 val_f1_mic= 0.42680 val_f1_mac= 0.15039 time= 0.02542
Iter: 0009 train_loss= 0.52279 train_f1_mic= 0.44993 train_f1_mac= 0.17406 val_loss= 0.54182 val_f1_mic= 0.42680 val_f1_mac= 0.15039 time= 0.02489
Iter: 0014 train_loss= 0.52220 train_f1_mic= 0.42984 train_f1_mac= 0.16024 val_loss= 0.54182 val_f1_mic= 0.42680 val_f1_mac= 0.15039 time= 0.02432
Epoch: 0006
Iter: 0000 train_loss= 0.51764 train_f1_mic= 0.42708 train_f1_mac= 0.15515 val_loss= 0.56225 val_f1_mic= 0.40376 val_f1_mac= 0.14923 time= 0.02410
Iter: 0005 train_loss= 0.51653 train_f1_mic= 0.44603 train_f1_mac= 0.17588 val_loss= 0.56225 val_f1_mic= 0.40376 val_f1_mac= 0.14923 time= 0.02364
Iter: 0010 train_loss= 0.52001 train_f1_mic= 0.46894 train_f1_mac= 0.19620 val_loss= 0.56225 val_f1_mic= 0.40376 val_f1_mac= 0.14923 time= 0.02317
Iter: 0015 train_loss= 0.51775 train_f1_mic= 0.42928 train_f1_mac= 0.16544 val_loss= 0.56225 val_f1_mic= 0.40376 val_f1_mac= 0.14923 time= 0.02277
Epoch: 0007
Iter: 0001 train_loss= 0.50206 train_f1_mic= 0.43227 train_f1_mac= 0.16949 val_loss= 0.54741 val_f1_mic= 0.42009 val_f1_mac= 0.16273 time= 0.02254
Iter: 0006 train_loss= 0.51689 train_f1_mic= 0.46940 train_f1_mac= 0.19710 val_loss= 0.54741 val_f1_mic= 0.42009 val_f1_mac= 0.16273 time= 0.02224
Iter: 0011 train_loss= 0.50917 train_f1_mic= 0.45373 train_f1_mac= 0.19073 val_loss= 0.54741 val_f1_mic= 0.42009 val_f1_mac= 0.16273 time= 0.02201
Iter: 0016 train_loss= 0.51519 train_f1_mic= 0.46890 train_f1_mac= 0.20318 val_loss= 0.54741 val_f1_mic= 0.42009 val_f1_mac= 0.16273 time= 0.02174
Epoch: 0008
Iter: 0002 train_loss= 0.50531 train_f1_mic= 0.48041 train_f1_mac= 0.22231 val_loss= 0.53343 val_f1_mic= 0.47545 val_f1_mac= 0.21001 time= 0.02171
Iter: 0007 train_loss= 0.50899 train_f1_mic= 0.46633 train_f1_mac= 0.21555 val_loss= 0.53343 val_f1_mic= 0.47545 val_f1_mac= 0.21001 time= 0.02151
Iter: 0012 train_loss= 0.49825 train_f1_mic= 0.46898 train_f1_mac= 0.21282 val_loss= 0.53343 val_f1_mic= 0.47545 val_f1_mac= 0.21001 time= 0.02131
Iter: 0017 train_loss= 0.50639 train_f1_mic= 0.49358 train_f1_mac= 0.24452 val_loss= 0.53343 val_f1_mic= 0.47545 val_f1_mac= 0.21001 time= 0.02109
Epoch: 0009
Iter: 0003 train_loss= 0.50932 train_f1_mic= 0.49181 train_f1_mac= 0.23978 val_loss= 0.53474 val_f1_mic= 0.49060 val_f1_mac= 0.26359 time= 0.02097
Iter: 0008 train_loss= 0.50505 train_f1_mic= 0.47341 train_f1_mac= 0.22185 val_loss= 0.53474 val_f1_mic= 0.49060 val_f1_mac= 0.26359 time= 0.02082
Iter: 0013 train_loss= 0.51225 train_f1_mic= 0.47150 train_f1_mac= 0.22569 val_loss= 0.53474 val_f1_mic= 0.49060 val_f1_mac= 0.26359 time= 0.02064
Iter: 0018 train_loss= 0.50562 train_f1_mic= 0.47245 train_f1_mac= 0.22738 val_loss= 0.53474 val_f1_mic= 0.49060 val_f1_mac= 0.26359 time= 0.02050
Epoch: 0010
Iter: 0004 train_loss= 0.49144 train_f1_mic= 0.49219 train_f1_mac= 0.24408 val_loss= 0.52104 val_f1_mic= 0.47971 val_f1_mac= 0.25005 time= 0.02042
Iter: 0009 train_loss= 0.50478 train_f1_mic= 0.49141 train_f1_mac= 0.25838 val_loss= 0.52104 val_f1_mic= 0.47971 val_f1_mac= 0.25005 time= 0.02029
Iter: 0014 train_loss= 0.49572 train_f1_mic= 0.49285 train_f1_mac= 0.25760 val_loss= 0.52104 val_f1_mic= 0.47971 val_f1_mac= 0.25005 time= 0.02018
Optimization Finished!
Full validation stats: loss= 0.51066 f1_micro= 0.52036 f1_macro= 0.28806 time= 0.08477
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47988770050937524
Rewards :  0.04740778318922434 Accuracy :  0.5178139270607547
Total reward :  1.3431742627303058
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.04740778]
Trial 318: Controller loss : 132.302628
2018-08-31 01:05:22.691326: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:05:22.691728: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:05:22.692107: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:05:22.692708: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'relu', 1, 'sigmoid']
2018-08-31 01:05:22.693210: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69101 train_f1_mic= 0.36331 train_f1_mac= 0.21863 val_loss= 0.65667 val_f1_mic= 0.36983 val_f1_mac= 0.09668 time= 1.53689
Iter: 0005 train_loss= 0.55884 train_f1_mic= 0.40082 train_f1_mac= 0.09712 val_loss= 0.65667 val_f1_mic= 0.36983 val_f1_mac= 0.09668 time= 0.37050
Iter: 0010 train_loss= 0.54477 train_f1_mic= 0.38771 train_f1_mac= 0.09408 val_loss= 0.65667 val_f1_mic= 0.36983 val_f1_mac= 0.09668 time= 0.26247
Iter: 0015 train_loss= 0.53563 train_f1_mic= 0.37521 train_f1_mac= 0.08778 val_loss= 0.65667 val_f1_mic= 0.36983 val_f1_mac= 0.09668 time= 0.22308
Epoch: 0002
Iter: 0001 train_loss= 0.53489 train_f1_mic= 0.38005 train_f1_mac= 0.09144 val_loss= 0.57248 val_f1_mic= 0.37073 val_f1_mac= 0.09609 time= 0.20440
Iter: 0006 train_loss= 0.54920 train_f1_mic= 0.37740 train_f1_mac= 0.09407 val_loss= 0.57248 val_f1_mic= 0.37073 val_f1_mac= 0.09609 time= 0.19049
Iter: 0011 train_loss= 0.54733 train_f1_mic= 0.38607 train_f1_mac= 0.10128 val_loss= 0.57248 val_f1_mic= 0.37073 val_f1_mac= 0.09609 time= 0.18132
Iter: 0016 train_loss= 0.54510 train_f1_mic= 0.38980 train_f1_mac= 0.10358 val_loss= 0.57248 val_f1_mic= 0.37073 val_f1_mac= 0.09609 time= 0.17487
Epoch: 0003
Iter: 0002 train_loss= 0.52999 train_f1_mic= 0.40943 train_f1_mac= 0.10903 val_loss= 0.56074 val_f1_mic= 0.39931 val_f1_mac= 0.11098 time= 0.17079
Iter: 0007 train_loss= 0.53904 train_f1_mic= 0.38075 train_f1_mac= 0.09868 val_loss= 0.56074 val_f1_mic= 0.39931 val_f1_mac= 0.11098 time= 0.16651
Iter: 0012 train_loss= 0.55096 train_f1_mic= 0.37497 train_f1_mac= 0.09692 val_loss= 0.56074 val_f1_mic= 0.39931 val_f1_mac= 0.11098 time= 0.16325
Iter: 0017 train_loss= 0.53797 train_f1_mic= 0.40965 train_f1_mac= 0.11679 val_loss= 0.56074 val_f1_mic= 0.39931 val_f1_mac= 0.11098 time= 0.16061
Epoch: 0004
Iter: 0003 train_loss= 0.53342 train_f1_mic= 0.40074 train_f1_mac= 0.10409 val_loss= 0.55720 val_f1_mic= 0.40556 val_f1_mac= 0.11473 time= 0.15916
Iter: 0008 train_loss= 0.53368 train_f1_mic= 0.39125 train_f1_mac= 0.09871 val_loss= 0.55720 val_f1_mic= 0.40556 val_f1_mac= 0.11473 time= 0.15714
Iter: 0013 train_loss= 0.53671 train_f1_mic= 0.38177 train_f1_mac= 0.09953 val_loss= 0.55720 val_f1_mic= 0.40556 val_f1_mac= 0.11473 time= 0.15557
Iter: 0018 train_loss= 0.54958 train_f1_mic= 0.40649 train_f1_mac= 0.12317 val_loss= 0.55720 val_f1_mic= 0.40556 val_f1_mac= 0.11473 time= 0.15407
Epoch: 0005
Iter: 0004 train_loss= 0.52886 train_f1_mic= 0.39586 train_f1_mac= 0.11611 val_loss= 0.53438 val_f1_mic= 0.40630 val_f1_mac= 0.12205 time= 0.15342
Iter: 0009 train_loss= 0.53098 train_f1_mic= 0.42291 train_f1_mac= 0.13083 val_loss= 0.53438 val_f1_mic= 0.40630 val_f1_mac= 0.12205 time= 0.15226
Iter: 0014 train_loss= 0.53537 train_f1_mic= 0.39818 train_f1_mac= 0.11860 val_loss= 0.53438 val_f1_mic= 0.40630 val_f1_mac= 0.12205 time= 0.15125
Epoch: 0006
Iter: 0000 train_loss= 0.52149 train_f1_mic= 0.39693 train_f1_mac= 0.11637 val_loss= 0.54098 val_f1_mic= 0.39275 val_f1_mac= 0.11901 time= 0.15103
Iter: 0005 train_loss= 0.52569 train_f1_mic= 0.44158 train_f1_mac= 0.13489 val_loss= 0.54098 val_f1_mic= 0.39275 val_f1_mac= 0.11901 time= 0.15029
Iter: 0010 train_loss= 0.52622 train_f1_mic= 0.41649 train_f1_mac= 0.12701 val_loss= 0.54098 val_f1_mic= 0.39275 val_f1_mac= 0.11901 time= 0.14941
Iter: 0015 train_loss= 0.52411 train_f1_mic= 0.41219 train_f1_mac= 0.12736 val_loss= 0.54098 val_f1_mic= 0.39275 val_f1_mac= 0.11901 time= 0.14888
Epoch: 0007
Iter: 0001 train_loss= 0.51758 train_f1_mic= 0.43038 train_f1_mac= 0.14095 val_loss= 0.55270 val_f1_mic= 0.42207 val_f1_mac= 0.14562 time= 0.14866
Iter: 0006 train_loss= 0.52545 train_f1_mic= 0.42748 train_f1_mac= 0.14385 val_loss= 0.55270 val_f1_mic= 0.42207 val_f1_mac= 0.14562 time= 0.14807
Iter: 0011 train_loss= 0.50688 train_f1_mic= 0.43162 train_f1_mac= 0.14660 val_loss= 0.55270 val_f1_mic= 0.42207 val_f1_mac= 0.14562 time= 0.14753
Iter: 0016 train_loss= 0.54355 train_f1_mic= 0.42300 train_f1_mac= 0.15674 val_loss= 0.55270 val_f1_mic= 0.42207 val_f1_mac= 0.14562 time= 0.14707
Epoch: 0008
Iter: 0002 train_loss= 0.51938 train_f1_mic= 0.43386 train_f1_mac= 0.15007 val_loss= 0.55547 val_f1_mic= 0.40054 val_f1_mac= 0.13512 time= 0.14702
Iter: 0007 train_loss= 0.52612 train_f1_mic= 0.44336 train_f1_mac= 0.17156 val_loss= 0.55547 val_f1_mic= 0.40054 val_f1_mac= 0.13512 time= 0.14654
Iter: 0012 train_loss= 0.51661 train_f1_mic= 0.41377 train_f1_mac= 0.14329 val_loss= 0.55547 val_f1_mic= 0.40054 val_f1_mac= 0.13512 time= 0.14622
Iter: 0017 train_loss= 0.52747 train_f1_mic= 0.43784 train_f1_mac= 0.16541 val_loss= 0.55547 val_f1_mic= 0.40054 val_f1_mac= 0.13512 time= 0.14589
Epoch: 0009
Iter: 0003 train_loss= 0.52106 train_f1_mic= 0.44708 train_f1_mac= 0.17139 val_loss= 0.55300 val_f1_mic= 0.40189 val_f1_mac= 0.13604 time= 0.14589
Iter: 0008 train_loss= 0.52867 train_f1_mic= 0.43230 train_f1_mac= 0.16398 val_loss= 0.55300 val_f1_mic= 0.40189 val_f1_mac= 0.13604 time= 0.14561
Iter: 0013 train_loss= 0.52464 train_f1_mic= 0.44239 train_f1_mac= 0.17408 val_loss= 0.55300 val_f1_mic= 0.40189 val_f1_mac= 0.13604 time= 0.14529
Iter: 0018 train_loss= 0.50972 train_f1_mic= 0.46062 train_f1_mac= 0.18762 val_loss= 0.55300 val_f1_mic= 0.40189 val_f1_mac= 0.13604 time= 0.14500
Epoch: 0010
Iter: 0004 train_loss= 0.52336 train_f1_mic= 0.47028 train_f1_mac= 0.20346 val_loss= 0.54548 val_f1_mic= 0.41257 val_f1_mac= 0.15581 time= 0.14505
Iter: 0009 train_loss= 0.51315 train_f1_mic= 0.42800 train_f1_mac= 0.16461 val_loss= 0.54548 val_f1_mic= 0.41257 val_f1_mac= 0.15581 time= 0.14478
Iter: 0014 train_loss= 0.52067 train_f1_mic= 0.48501 train_f1_mac= 0.21756 val_loss= 0.54548 val_f1_mic= 0.41257 val_f1_mac= 0.15581 time= 0.14461
Optimization Finished!
Full validation stats: loss= 0.53313 f1_micro= 0.43746 f1_macro= 0.18167 time= 0.26928
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47267385441602155
Rewards :  -0.03606923046676841 Accuracy :  0.4438184700426068
Total reward :  1.3071050322635374
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'relu', 1, 'sigmoid']
Training RNN (Reward ip) :  [-0.03606923]
Trial 319: Controller loss : 4299.028809
2018-08-31 01:05:58.077548: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:05:58.078097: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:05:58.078624: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:05:58.079007: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:05:58.079479: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeFo
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'relu', 0, 'relu']
rce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69361 train_f1_mic= 0.36876 train_f1_mac= 0.30503 val_loss= 0.66180 val_f1_mic= 0.37276 val_f1_mac= 0.11474 time= 0.73403
Iter: 0005 train_loss= 0.58249 train_f1_mic= 0.38232 train_f1_mac= 0.09353 val_loss= 0.66180 val_f1_mic= 0.37276 val_f1_mac= 0.11474 time= 0.13215
Iter: 0010 train_loss= 0.54262 train_f1_mic= 0.38677 train_f1_mac= 0.09521 val_loss= 0.66180 val_f1_mic= 0.37276 val_f1_mac= 0.11474 time= 0.07706
Iter: 0015 train_loss= 0.54668 train_f1_mic= 0.39447 train_f1_mac= 0.10457 val_loss= 0.66180 val_f1_mic= 0.37276 val_f1_mac= 0.11474 time= 0.05690
Epoch: 0002
Iter: 0001 train_loss= 0.55131 train_f1_mic= 0.39312 train_f1_mac= 0.10313 val_loss= 0.55868 val_f1_mic= 0.39294 val_f1_mac= 0.10403 time= 0.04767
Iter: 0006 train_loss= 0.54183 train_f1_mic= 0.39794 train_f1_mac= 0.10237 val_loss= 0.55868 val_f1_mic= 0.39294 val_f1_mac= 0.10403 time= 0.04103
Iter: 0011 train_loss= 0.53610 train_f1_mic= 0.37432 train_f1_mac= 0.09309 val_loss= 0.55868 val_f1_mic= 0.39294 val_f1_mac= 0.10403 time= 0.03654
Iter: 0016 train_loss= 0.54721 train_f1_mic= 0.38418 train_f1_mac= 0.10399 val_loss= 0.55868 val_f1_mic= 0.39294 val_f1_mac= 0.10403 time= 0.03326
Epoch: 0003
Iter: 0002 train_loss= 0.53706 train_f1_mic= 0.41309 train_f1_mac= 0.12080 val_loss= 0.55554 val_f1_mic= 0.40342 val_f1_mac= 0.11905 time= 0.03127
Iter: 0007 train_loss= 0.53774 train_f1_mic= 0.40908 train_f1_mac= 0.12638 val_loss= 0.55554 val_f1_mic= 0.40342 val_f1_mac= 0.11905 time= 0.02930
Iter: 0012 train_loss= 0.53865 train_f1_mic= 0.40401 train_f1_mac= 0.12343 val_loss= 0.55554 val_f1_mic= 0.40342 val_f1_mac= 0.11905 time= 0.02764
Iter: 0017 train_loss= 0.52773 train_f1_mic= 0.41078 train_f1_mac= 0.12387 val_loss= 0.55554 val_f1_mic= 0.40342 val_f1_mac= 0.11905 time= 0.02636
Epoch: 0004
Iter: 0003 train_loss= 0.52387 train_f1_mic= 0.40816 train_f1_mac= 0.12432 val_loss= 0.55689 val_f1_mic= 0.40925 val_f1_mac= 0.12762 time= 0.02566
Iter: 0008 train_loss= 0.52025 train_f1_mic= 0.42824 train_f1_mac= 0.13811 val_loss= 0.55689 val_f1_mic= 0.40925 val_f1_mac= 0.12762 time= 0.02462
Iter: 0013 train_loss= 0.53824 train_f1_mic= 0.41169 train_f1_mac= 0.13253 val_loss= 0.55689 val_f1_mic= 0.40925 val_f1_mac= 0.12762 time= 0.02372
Iter: 0018 train_loss= 0.52274 train_f1_mic= 0.43569 train_f1_mac= 0.14772 val_loss= 0.55689 val_f1_mic= 0.40925 val_f1_mac= 0.12762 time= 0.02293
Epoch: 0005
Iter: 0004 train_loss= 0.52686 train_f1_mic= 0.41461 train_f1_mac= 0.13410 val_loss= 0.56394 val_f1_mic= 0.42719 val_f1_mac= 0.15592 time= 0.02250
Iter: 0009 train_loss= 0.52581 train_f1_mic= 0.43186 train_f1_mac= 0.15964 val_loss= 0.56394 val_f1_mic= 0.42719 val_f1_mac= 0.15592 time= 0.02189
Iter: 0014 train_loss= 0.52519 train_f1_mic= 0.44211 train_f1_mac= 0.16878 val_loss= 0.56394 val_f1_mic= 0.42719 val_f1_mac= 0.15592 time= 0.02132
Epoch: 0006
Iter: 0000 train_loss= 0.52693 train_f1_mic= 0.44544 train_f1_mac= 0.17403 val_loss= 0.53889 val_f1_mic= 0.44569 val_f1_mac= 0.18342 time= 0.02114
Iter: 0005 train_loss= 0.51976 train_f1_mic= 0.45309 train_f1_mac= 0.18608 val_loss= 0.53889 val_f1_mic= 0.44569 val_f1_mac= 0.18342 time= 0.02071
Iter: 0010 train_loss= 0.51953 train_f1_mic= 0.42174 train_f1_mac= 0.15431 val_loss= 0.53889 val_f1_mic= 0.44569 val_f1_mac= 0.18342 time= 0.02033
Iter: 0015 train_loss= 0.51130 train_f1_mic= 0.46893 train_f1_mac= 0.19888 val_loss= 0.53889 val_f1_mic= 0.44569 val_f1_mac= 0.18342 time= 0.01994
Epoch: 0007
Iter: 0001 train_loss= 0.52061 train_f1_mic= 0.43756 train_f1_mac= 0.17057 val_loss= 0.53410 val_f1_mic= 0.44508 val_f1_mac= 0.18326 time= 0.01989
Iter: 0006 train_loss= 0.52152 train_f1_mic= 0.45238 train_f1_mac= 0.18609 val_loss= 0.53410 val_f1_mic= 0.44508 val_f1_mac= 0.18326 time= 0.01963
Iter: 0011 train_loss= 0.51755 train_f1_mic= 0.44529 train_f1_mac= 0.18415 val_loss= 0.53410 val_f1_mic= 0.44508 val_f1_mac= 0.18326 time= 0.01938
Iter: 0016 train_loss= 0.51496 train_f1_mic= 0.44263 train_f1_mac= 0.17805 val_loss= 0.53410 val_f1_mic= 0.44508 val_f1_mac= 0.18326 time= 0.01915
Epoch: 0008
Iter: 0002 train_loss= 0.51173 train_f1_mic= 0.46065 train_f1_mac= 0.21016 val_loss= 0.53382 val_f1_mic= 0.46521 val_f1_mac= 0.21168 time= 0.01914
Iter: 0007 train_loss= 0.51593 train_f1_mic= 0.43362 train_f1_mac= 0.17805 val_loss= 0.53382 val_f1_mic= 0.46521 val_f1_mac= 0.21168 time= 0.01890
Iter: 0012 train_loss= 0.52149 train_f1_mic= 0.47127 train_f1_mac= 0.21572 val_loss= 0.53382 val_f1_mic= 0.46521 val_f1_mac= 0.21168 time= 0.01874
Iter: 0017 train_loss= 0.50562 train_f1_mic= 0.46382 train_f1_mac= 0.20437 val_loss= 0.53382 val_f1_mic= 0.46521 val_f1_mac= 0.21168 time= 0.01856
Epoch: 0009
Iter: 0003 train_loss= 0.50419 train_f1_mic= 0.47706 train_f1_mac= 0.22323 val_loss= 0.52780 val_f1_mic= 0.48983 val_f1_mac= 0.24787 time= 0.01853
Iter: 0008 train_loss= 0.51418 train_f1_mic= 0.43156 train_f1_mac= 0.17925 val_loss= 0.52780 val_f1_mic= 0.48983 val_f1_mac= 0.24787 time= 0.01833
Iter: 0013 train_loss= 0.52059 train_f1_mic= 0.47252 train_f1_mac= 0.21543 val_loss= 0.52780 val_f1_mic= 0.48983 val_f1_mac= 0.24787 time= 0.01821
Iter: 0018 train_loss= 0.50697 train_f1_mic= 0.46748 train_f1_mac= 0.22021 val_loss= 0.52780 val_f1_mic= 0.48983 val_f1_mac= 0.24787 time= 0.01805
Epoch: 0010
Iter: 0004 train_loss= 0.53180 train_f1_mic= 0.44579 train_f1_mac= 0.21553 val_loss= 0.56022 val_f1_mic= 0.46385 val_f1_mac= 0.22887 time= 0.01798
Iter: 0009 train_loss= 0.51847 train_f1_mic= 0.45340 train_f1_mac= 0.19588 val_loss= 0.56022 val_f1_mic= 0.46385 val_f1_mac= 0.22887 time= 0.01784
Iter: 0014 train_loss= 0.50714 train_f1_mic= 0.48365 train_f1_mac= 0.22255 val_loss= 0.56022 val_f1_mic= 0.46385 val_f1_mac= 0.22887 time= 0.01767
Optimization Finished!
Full validation stats: loss= 0.53074 f1_micro= 0.46134 f1_macro= 0.21884 time= 0.09176
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4690956052719477
Rewards :  -0.017891245720369375 Accuracy :  0.4547826086956522
Total reward :  1.289213786543168
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'relu', 0, 'relu']
Training RNN (Reward ip) :  [-0.01789124]
Trial 320: Controller loss : 4446.166504

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [1, 'sigmoid', 4, 'relu']
2018-08-31 01:06:06.687288: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:06:06.687512: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:06:06.687754: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:06:06.687921: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:06:06.688299: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69167 train_f1_mic= 0.36498 train_f1_mac= 0.20742 val_loss= 0.66118 val_f1_mic= 0.39446 val_f1_mac= 0.10437 time= 1.30750
Iter: 0005 train_loss= 0.59453 train_f1_mic= 0.38360 train_f1_mac= 0.09303 val_loss= 0.66118 val_f1_mic= 0.39446 val_f1_mac= 0.10437 time= 0.32015
Iter: 0010 train_loss= 0.55629 train_f1_mic= 0.38525 train_f1_mac= 0.09667 val_loss= 0.66118 val_f1_mic= 0.39446 val_f1_mac= 0.10437 time= 0.22894
Iter: 0015 train_loss= 0.54749 train_f1_mic= 0.36527 train_f1_mac= 0.08702 val_loss= 0.66118 val_f1_mic= 0.39446 val_f1_mac= 0.10437 time= 0.19492
Epoch: 0002
Iter: 0001 train_loss= 0.55079 train_f1_mic= 0.38928 train_f1_mac= 0.09807 val_loss= 0.58131 val_f1_mic= 0.37737 val_f1_mac= 0.10053 time= 0.17904
Iter: 0006 train_loss= 0.53296 train_f1_mic= 0.39620 train_f1_mac= 0.09725 val_loss= 0.58131 val_f1_mic= 0.37737 val_f1_mac= 0.10053 time= 0.16763
Iter: 0011 train_loss= 0.53876 train_f1_mic= 0.37090 train_f1_mac= 0.08705 val_loss= 0.58131 val_f1_mic= 0.37737 val_f1_mac= 0.10053 time= 0.15995
Iter: 0016 train_loss= 0.54027 train_f1_mic= 0.38506 train_f1_mac= 0.09320 val_loss= 0.58131 val_f1_mic= 0.37737 val_f1_mac= 0.10053 time= 0.15450
Epoch: 0003
Iter: 0002 train_loss= 0.54078 train_f1_mic= 0.38265 train_f1_mac= 0.09290 val_loss= 0.56267 val_f1_mic= 0.37591 val_f1_mac= 0.09512 time= 0.15118
Iter: 0007 train_loss= 0.54837 train_f1_mic= 0.37747 train_f1_mac= 0.09269 val_loss= 0.56267 val_f1_mic= 0.37591 val_f1_mac= 0.09512 time= 0.14773
Iter: 0012 train_loss= 0.53717 train_f1_mic= 0.38115 train_f1_mac= 0.09153 val_loss= 0.56267 val_f1_mic= 0.37591 val_f1_mac= 0.09512 time= 0.14496
Iter: 0017 train_loss= 0.54774 train_f1_mic= 0.38758 train_f1_mac= 0.09782 val_loss= 0.56267 val_f1_mic= 0.37591 val_f1_mac= 0.09512 time= 0.14274
Epoch: 0004
Iter: 0003 train_loss= 0.54503 train_f1_mic= 0.38661 train_f1_mac= 0.09760 val_loss= 0.56516 val_f1_mic= 0.38510 val_f1_mac= 0.10069 time= 0.14155
Iter: 0008 train_loss= 0.52990 train_f1_mic= 0.40788 train_f1_mac= 0.10198 val_loss= 0.56516 val_f1_mic= 0.38510 val_f1_mac= 0.10069 time= 0.14004
Iter: 0013 train_loss= 0.53793 train_f1_mic= 0.37223 train_f1_mac= 0.08718 val_loss= 0.56516 val_f1_mic= 0.38510 val_f1_mac= 0.10069 time= 0.13875
Iter: 0018 train_loss= 0.53281 train_f1_mic= 0.37732 train_f1_mac= 0.08911 val_loss= 0.56516 val_f1_mic= 0.38510 val_f1_mac= 0.10069 time= 0.13760
Epoch: 0005
Iter: 0004 train_loss= 0.53590 train_f1_mic= 0.39236 train_f1_mac= 0.09773 val_loss= 0.56224 val_f1_mic= 0.37379 val_f1_mac= 0.09616 time= 0.13721
Iter: 0009 train_loss= 0.54421 train_f1_mic= 0.38030 train_f1_mac= 0.09814 val_loss= 0.56224 val_f1_mic= 0.37379 val_f1_mac= 0.09616 time= 0.13622
Iter: 0014 train_loss= 0.53634 train_f1_mic= 0.37840 train_f1_mac= 0.09427 val_loss= 0.56224 val_f1_mic= 0.37379 val_f1_mac= 0.09616 time= 0.13541
Epoch: 0006
Iter: 0000 train_loss= 0.53571 train_f1_mic= 0.38890 train_f1_mac= 0.10262 val_loss= 0.56669 val_f1_mic= 0.38442 val_f1_mac= 0.10798 time= 0.13512
Iter: 0005 train_loss= 0.53606 train_f1_mic= 0.37754 train_f1_mac= 0.10109 val_loss= 0.56669 val_f1_mic= 0.38442 val_f1_mac= 0.10798 time= 0.13440
Iter: 0010 train_loss= 0.53609 train_f1_mic= 0.40750 train_f1_mac= 0.11661 val_loss= 0.56669 val_f1_mic= 0.38442 val_f1_mac= 0.10798 time= 0.13377
Iter: 0015 train_loss= 0.53643 train_f1_mic= 0.42704 train_f1_mac= 0.12576 val_loss= 0.56669 val_f1_mic= 0.38442 val_f1_mac= 0.10798 time= 0.13334
Epoch: 0007
Iter: 0001 train_loss= 0.54753 train_f1_mic= 0.37794 train_f1_mac= 0.10562 val_loss= 0.57280 val_f1_mic= 0.37411 val_f1_mac= 0.10796 time= 0.13320
Iter: 0006 train_loss= 0.54273 train_f1_mic= 0.41740 train_f1_mac= 0.12714 val_loss= 0.57280 val_f1_mic= 0.37411 val_f1_mac= 0.10796 time= 0.13272
Iter: 0011 train_loss= 0.53721 train_f1_mic= 0.39736 train_f1_mac= 0.11424 val_loss= 0.57280 val_f1_mic= 0.37411 val_f1_mac= 0.10796 time= 0.13227
Iter: 0016 train_loss= 0.53729 train_f1_mic= 0.39700 train_f1_mac= 0.10974 val_loss= 0.57280 val_f1_mic= 0.37411 val_f1_mac= 0.10796 time= 0.13191
Epoch: 0008
Iter: 0002 train_loss= 0.53601 train_f1_mic= 0.39507 train_f1_mac= 0.10849 val_loss= 0.56390 val_f1_mic= 0.38992 val_f1_mac= 0.11323 time= 0.13182
Iter: 0007 train_loss= 0.53453 train_f1_mic= 0.38374 train_f1_mac= 0.09841 val_loss= 0.56390 val_f1_mic= 0.38992 val_f1_mac= 0.11323 time= 0.13147
Iter: 0012 train_loss= 0.53958 train_f1_mic= 0.38300 train_f1_mac= 0.10622 val_loss= 0.56390 val_f1_mic= 0.38992 val_f1_mac= 0.11323 time= 0.13114
Iter: 0017 train_loss= 0.53738 train_f1_mic= 0.41317 train_f1_mac= 0.11770 val_loss= 0.56390 val_f1_mic= 0.38992 val_f1_mac= 0.11323 time= 0.13085
Epoch: 0009
Iter: 0003 train_loss= 0.53871 train_f1_mic= 0.40533 train_f1_mac= 0.11172 val_loss= 0.55141 val_f1_mic= 0.39556 val_f1_mac= 0.11385 time= 0.13086
Iter: 0008 train_loss= 0.53578 train_f1_mic= 0.39472 train_f1_mac= 0.10706 val_loss= 0.55141 val_f1_mic= 0.39556 val_f1_mac= 0.11385 time= 0.13061
Iter: 0013 train_loss= 0.53107 train_f1_mic= 0.40000 train_f1_mac= 0.11165 val_loss= 0.55141 val_f1_mic= 0.39556 val_f1_mac= 0.11385 time= 0.13034
Iter: 0018 train_loss= 0.53344 train_f1_mic= 0.39827 train_f1_mac= 0.11058 val_loss= 0.55141 val_f1_mic= 0.39556 val_f1_mac= 0.11385 time= 0.13012
Epoch: 0010
Iter: 0004 train_loss= 0.53316 train_f1_mic= 0.40725 train_f1_mac= 0.11430 val_loss= 0.56788 val_f1_mic= 0.38711 val_f1_mac= 0.11628 time= 0.13014
Iter: 0009 train_loss= 0.53255 train_f1_mic= 0.39681 train_f1_mac= 0.11140 val_loss= 0.56788 val_f1_mic= 0.38711 val_f1_mac= 0.11628 time= 0.12994
Iter: 0014 train_loss= 0.53898 train_f1_mic= 0.37884 train_f1_mac= 0.10361 val_loss= 0.56788 val_f1_mic= 0.38711 val_f1_mac= 0.11628 time= 0.12973
Optimization Finished!
Full validation stats: loss= 0.55361 f1_micro= 0.41924 f1_macro= 0.13272 time= 0.24335
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46064483426059244
Rewards :  -0.042253855056776424 Accuracy :  0.4268417502151713
Total reward :  1.2469599314863917
Saved buffers to file `buffers.txt` !
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'sigmoid', 4, 'relu']
Training RNN (Reward ip) :  [-0.04225386]
Trial 321: Controller loss : 9062.448242
2018-08-31 01:06:38.234807: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:06:38.235300: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:06:38.235788: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:06:38.236459: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:06:38.236869: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'tanh', 4, 'sigmoid']
Epoch: 0001
Iter: 0000 train_loss= 0.69319 train_f1_mic= 0.36703 train_f1_mac= 0.22191 val_loss= 0.65638 val_f1_mic= 0.37431 val_f1_mac= 0.09909 time= 0.84189
Iter: 0005 train_loss= 0.56573 train_f1_mic= 0.37320 train_f1_mac= 0.08738 val_loss= 0.65638 val_f1_mic= 0.37431 val_f1_mac= 0.09909 time= 0.17719
Iter: 0010 train_loss= 0.55259 train_f1_mic= 0.39542 train_f1_mac= 0.10021 val_loss= 0.65638 val_f1_mic= 0.37431 val_f1_mac= 0.09909 time= 0.11569
Iter: 0015 train_loss= 0.55231 train_f1_mic= 0.38265 train_f1_mac= 0.09532 val_loss= 0.65638 val_f1_mic= 0.37431 val_f1_mac= 0.09909 time= 0.09237
Epoch: 0002
Iter: 0001 train_loss= 0.54560 train_f1_mic= 0.36394 train_f1_mac= 0.08672 val_loss= 0.57409 val_f1_mic= 0.35328 val_f1_mac= 0.08938 time= 0.08282
Iter: 0006 train_loss= 0.54027 train_f1_mic= 0.39213 train_f1_mac= 0.09751 val_loss= 0.57409 val_f1_mic= 0.35328 val_f1_mac= 0.08938 time= 0.07530
Iter: 0011 train_loss= 0.53481 train_f1_mic= 0.39767 train_f1_mac= 0.10122 val_loss= 0.57409 val_f1_mic= 0.35328 val_f1_mac= 0.08938 time= 0.07000
Iter: 0016 train_loss= 0.53955 train_f1_mic= 0.37307 train_f1_mac= 0.09083 val_loss= 0.57409 val_f1_mic= 0.35328 val_f1_mac= 0.08938 time= 0.06613
Epoch: 0003
Iter: 0002 train_loss= 0.54003 train_f1_mic= 0.37515 train_f1_mac= 0.09436 val_loss= 0.54540 val_f1_mic= 0.36834 val_f1_mac= 0.09232 time= 0.06453
Iter: 0007 train_loss= 0.54228 train_f1_mic= 0.38285 train_f1_mac= 0.10225 val_loss= 0.54540 val_f1_mic= 0.36834 val_f1_mac= 0.09232 time= 0.06248
Iter: 0012 train_loss= 0.53063 train_f1_mic= 0.42050 train_f1_mac= 0.11675 val_loss= 0.54540 val_f1_mic= 0.36834 val_f1_mac= 0.09232 time= 0.06058
Iter: 0017 train_loss= 0.53932 train_f1_mic= 0.39523 train_f1_mac= 0.11120 val_loss= 0.54540 val_f1_mic= 0.36834 val_f1_mac= 0.09232 time= 0.05905
Epoch: 0004
Iter: 0003 train_loss= 0.51798 train_f1_mic= 0.41941 train_f1_mac= 0.12336 val_loss= 0.53607 val_f1_mic= 0.41526 val_f1_mac= 0.12243 time= 0.05800
Iter: 0008 train_loss= 0.55033 train_f1_mic= 0.41227 train_f1_mac= 0.12855 val_loss= 0.53607 val_f1_mic= 0.41526 val_f1_mac= 0.12243 time= 0.05681
Iter: 0013 train_loss= 0.52056 train_f1_mic= 0.43122 train_f1_mac= 0.13552 val_loss= 0.53607 val_f1_mic= 0.41526 val_f1_mac= 0.12243 time= 0.05582
Iter: 0018 train_loss= 0.53063 train_f1_mic= 0.42846 train_f1_mac= 0.13919 val_loss= 0.53607 val_f1_mic= 0.41526 val_f1_mac= 0.12243 time= 0.05486
Epoch: 0005
Iter: 0004 train_loss= 0.52040 train_f1_mic= 0.38686 train_f1_mac= 0.10986 val_loss= 0.53888 val_f1_mic= 0.40186 val_f1_mac= 0.12644 time= 0.05449
Iter: 0009 train_loss= 0.53704 train_f1_mic= 0.43902 train_f1_mac= 0.14413 val_loss= 0.53888 val_f1_mic= 0.40186 val_f1_mac= 0.12644 time= 0.05383
Iter: 0014 train_loss= 0.51692 train_f1_mic= 0.41692 train_f1_mac= 0.13335 val_loss= 0.53888 val_f1_mic= 0.40186 val_f1_mac= 0.12644 time= 0.05326
Epoch: 0006
Iter: 0000 train_loss= 0.52069 train_f1_mic= 0.44758 train_f1_mac= 0.14837 val_loss= 0.55384 val_f1_mic= 0.42688 val_f1_mac= 0.15099 time= 0.05307
Iter: 0005 train_loss= 0.52928 train_f1_mic= 0.41680 train_f1_mac= 0.13670 val_loss= 0.55384 val_f1_mic= 0.42688 val_f1_mac= 0.15099 time= 0.05259
Iter: 0010 train_loss= 0.52634 train_f1_mic= 0.43657 train_f1_mac= 0.14505 val_loss= 0.55384 val_f1_mic= 0.42688 val_f1_mac= 0.15099 time= 0.05214
Iter: 0015 train_loss= 0.51986 train_f1_mic= 0.42781 train_f1_mac= 0.13956 val_loss= 0.55384 val_f1_mic= 0.42688 val_f1_mac= 0.15099 time= 0.05166
Epoch: 0007
Iter: 0001 train_loss= 0.52357 train_f1_mic= 0.43348 train_f1_mac= 0.14937 val_loss= 0.54304 val_f1_mic= 0.42882 val_f1_mac= 0.14631 time= 0.05167
Iter: 0006 train_loss= 0.51044 train_f1_mic= 0.42080 train_f1_mac= 0.14195 val_loss= 0.54304 val_f1_mic= 0.42882 val_f1_mac= 0.14631 time= 0.05128
Iter: 0011 train_loss= 0.50387 train_f1_mic= 0.42128 train_f1_mac= 0.13559 val_loss= 0.54304 val_f1_mic= 0.42882 val_f1_mac= 0.14631 time= 0.05102
Iter: 0016 train_loss= 0.52535 train_f1_mic= 0.45601 train_f1_mac= 0.17265 val_loss= 0.54304 val_f1_mic= 0.42882 val_f1_mac= 0.14631 time= 0.05067
Epoch: 0008
Iter: 0002 train_loss= 0.52688 train_f1_mic= 0.44758 train_f1_mac= 0.16709 val_loss= 0.53365 val_f1_mic= 0.43704 val_f1_mac= 0.16437 time= 0.05066
Iter: 0007 train_loss= 0.53314 train_f1_mic= 0.44083 train_f1_mac= 0.16854 val_loss= 0.53365 val_f1_mic= 0.43704 val_f1_mac= 0.16437 time= 0.05043
Iter: 0012 train_loss= 0.50813 train_f1_mic= 0.43667 train_f1_mac= 0.15954 val_loss= 0.53365 val_f1_mic= 0.43704 val_f1_mac= 0.16437 time= 0.05016
Iter: 0017 train_loss= 0.51675 train_f1_mic= 0.45826 train_f1_mac= 0.18219 val_loss= 0.53365 val_f1_mic= 0.43704 val_f1_mac= 0.16437 time= 0.04994
Epoch: 0009
Iter: 0003 train_loss= 0.51301 train_f1_mic= 0.46612 train_f1_mac= 0.19472 val_loss= 0.54730 val_f1_mic= 0.39641 val_f1_mac= 0.14482 time= 0.04989
Iter: 0008 train_loss= 0.52538 train_f1_mic= 0.44409 train_f1_mac= 0.17885 val_loss= 0.54730 val_f1_mic= 0.39641 val_f1_mac= 0.14482 time= 0.04963
Iter: 0013 train_loss= 0.51852 train_f1_mic= 0.45275 train_f1_mac= 0.18209 val_loss= 0.54730 val_f1_mic= 0.39641 val_f1_mac= 0.14482 time= 0.04945
Iter: 0018 train_loss= 0.50702 train_f1_mic= 0.47049 train_f1_mac= 0.20484 val_loss= 0.54730 val_f1_mic= 0.39641 val_f1_mac= 0.14482 time= 0.04927
Epoch: 0010
Iter: 0004 train_loss= 0.51424 train_f1_mic= 0.46317 train_f1_mac= 0.19181 val_loss= 0.51683 val_f1_mic= 0.47185 val_f1_mac= 0.20826 time= 0.04918
Iter: 0009 train_loss= 0.51350 train_f1_mic= 0.45004 train_f1_mac= 0.18985 val_loss= 0.51683 val_f1_mic= 0.47185 val_f1_mac= 0.20826 time= 0.04899
Iter: 0014 train_loss= 0.49384 train_f1_mic= 0.45966 train_f1_mac= 0.18564 val_loss= 0.51683 val_f1_mic= 0.47185 val_f1_mac= 0.20826 time= 0.04881
Optimization Finished!
Full validation stats: loss= 0.53320 f1_micro= 0.45454 f1_macro= 0.20413 time= 0.15059
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4593995808273986
Rewards :  -0.006226267165968968 Accuracy :  0.45441856709462347
Total reward :  1.2407336643204228
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'tanh', 4, 'sigmoid']
Training RNN (Reward ip) :  [-0.00622627]
Trial 322: Controller loss : 11325.917969

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'sigmoid', 1, 'tanh']
2018-08-31 01:06:53.639936: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:06:53.640180: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:06:53.640547: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:06:53.640908: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:06:53.641368: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69562 train_f1_mic= 0.38220 train_f1_mac= 0.26679 val_loss= 0.66592 val_f1_mic= 0.37955 val_f1_mac= 0.11088 time= 1.08211
Iter: 0005 train_loss= 0.58480 train_f1_mic= 0.36326 train_f1_mac= 0.08745 val_loss= 0.66592 val_f1_mic= 0.37955 val_f1_mac= 0.11088 time= 0.24450
Iter: 0010 train_loss= 0.54658 train_f1_mic= 0.38744 train_f1_mac= 0.09658 val_loss= 0.66592 val_f1_mic= 0.37955 val_f1_mac= 0.11088 time= 0.16682
Iter: 0015 train_loss= 0.54204 train_f1_mic= 0.37712 train_f1_mac= 0.09128 val_loss= 0.66592 val_f1_mic= 0.37955 val_f1_mac= 0.11088 time= 0.13844
Epoch: 0002
Iter: 0001 train_loss= 0.54897 train_f1_mic= 0.37193 train_f1_mac= 0.08843 val_loss= 0.56626 val_f1_mic= 0.36375 val_f1_mac= 0.08984 time= 0.12428
Iter: 0006 train_loss= 0.54054 train_f1_mic= 0.37909 train_f1_mac= 0.09172 val_loss= 0.56626 val_f1_mic= 0.36375 val_f1_mac= 0.08984 time= 0.11477
Iter: 0011 train_loss= 0.54611 train_f1_mic= 0.38071 train_f1_mac= 0.09341 val_loss= 0.56626 val_f1_mic= 0.36375 val_f1_mac= 0.08984 time= 0.10841
Iter: 0016 train_loss= 0.54068 train_f1_mic= 0.37999 train_f1_mac= 0.09235 val_loss= 0.56626 val_f1_mic= 0.36375 val_f1_mac= 0.08984 time= 0.10394
Epoch: 0003
Iter: 0002 train_loss= 0.55578 train_f1_mic= 0.37232 train_f1_mac= 0.09311 val_loss= 0.58064 val_f1_mic= 0.35896 val_f1_mac= 0.09494 time= 0.10080
Iter: 0007 train_loss= 0.53961 train_f1_mic= 0.38791 train_f1_mac= 0.09646 val_loss= 0.58064 val_f1_mic= 0.35896 val_f1_mac= 0.09494 time= 0.09795
Iter: 0012 train_loss= 0.54028 train_f1_mic= 0.36714 train_f1_mac= 0.08674 val_loss= 0.58064 val_f1_mic= 0.35896 val_f1_mac= 0.09494 time= 0.09570
Iter: 0017 train_loss= 0.54521 train_f1_mic= 0.37023 train_f1_mac= 0.08801 val_loss= 0.58064 val_f1_mic= 0.35896 val_f1_mac= 0.09494 time= 0.09389
Epoch: 0004
Iter: 0003 train_loss= 0.54000 train_f1_mic= 0.39485 train_f1_mac= 0.09837 val_loss= 0.56548 val_f1_mic= 0.38447 val_f1_mac= 0.10067 time= 0.09265
Iter: 0008 train_loss= 0.54939 train_f1_mic= 0.37819 train_f1_mac= 0.09330 val_loss= 0.56548 val_f1_mic= 0.38447 val_f1_mac= 0.10067 time= 0.09124
Iter: 0013 train_loss= 0.54639 train_f1_mic= 0.36009 train_f1_mac= 0.08647 val_loss= 0.56548 val_f1_mic= 0.38447 val_f1_mac= 0.10067 time= 0.09028
Iter: 0018 train_loss= 0.54034 train_f1_mic= 0.40911 train_f1_mac= 0.10783 val_loss= 0.56548 val_f1_mic= 0.38447 val_f1_mac= 0.10067 time= 0.08918
Epoch: 0005
Iter: 0004 train_loss= 0.55326 train_f1_mic= 0.37229 train_f1_mac= 0.09595 val_loss= 0.55766 val_f1_mic= 0.39269 val_f1_mac= 0.10654 time= 0.08907
Iter: 0009 train_loss= 0.55380 train_f1_mic= 0.36779 train_f1_mac= 0.09474 val_loss= 0.55766 val_f1_mic= 0.39269 val_f1_mac= 0.10654 time= 0.08834
Iter: 0014 train_loss= 0.53414 train_f1_mic= 0.40013 train_f1_mac= 0.10442 val_loss= 0.55766 val_f1_mic= 0.39269 val_f1_mac= 0.10654 time= 0.08762
Epoch: 0006
Iter: 0000 train_loss= 0.53711 train_f1_mic= 0.39590 train_f1_mac= 0.10706 val_loss= 0.57087 val_f1_mic= 0.38073 val_f1_mac= 0.10984 time= 0.08716
Iter: 0005 train_loss= 0.54281 train_f1_mic= 0.38346 train_f1_mac= 0.10114 val_loss= 0.57087 val_f1_mic= 0.38073 val_f1_mac= 0.10984 time= 0.08645
Iter: 0010 train_loss= 0.53068 train_f1_mic= 0.40949 train_f1_mac= 0.10997 val_loss= 0.57087 val_f1_mic= 0.38073 val_f1_mac= 0.10984 time= 0.08595
Iter: 0015 train_loss= 0.54813 train_f1_mic= 0.38649 train_f1_mac= 0.10605 val_loss= 0.57087 val_f1_mic= 0.38073 val_f1_mac= 0.10984 time= 0.08552
Epoch: 0007
Iter: 0001 train_loss= 0.54474 train_f1_mic= 0.39329 train_f1_mac= 0.10912 val_loss= 0.54410 val_f1_mic= 0.38288 val_f1_mac= 0.10555 time= 0.08530
Iter: 0006 train_loss= 0.53293 train_f1_mic= 0.39914 train_f1_mac= 0.11546 val_loss= 0.54410 val_f1_mic= 0.38288 val_f1_mac= 0.10555 time= 0.08493
Iter: 0011 train_loss= 0.52985 train_f1_mic= 0.42024 train_f1_mac= 0.12471 val_loss= 0.54410 val_f1_mic= 0.38288 val_f1_mac= 0.10555 time= 0.08463
Iter: 0016 train_loss= 0.53006 train_f1_mic= 0.40940 train_f1_mac= 0.11969 val_loss= 0.54410 val_f1_mic= 0.38288 val_f1_mac= 0.10555 time= 0.08420
Epoch: 0008
Iter: 0002 train_loss= 0.53829 train_f1_mic= 0.40733 train_f1_mac= 0.11545 val_loss= 0.55292 val_f1_mic= 0.39781 val_f1_mac= 0.11616 time= 0.08402
Iter: 0007 train_loss= 0.52692 train_f1_mic= 0.44284 train_f1_mac= 0.13726 val_loss= 0.55292 val_f1_mic= 0.39781 val_f1_mac= 0.11616 time= 0.08370
Iter: 0012 train_loss= 0.52474 train_f1_mic= 0.42072 train_f1_mac= 0.12774 val_loss= 0.55292 val_f1_mic= 0.39781 val_f1_mac= 0.11616 time= 0.08348
Iter: 0017 train_loss= 0.52209 train_f1_mic= 0.39268 train_f1_mac= 0.10811 val_loss= 0.55292 val_f1_mic= 0.39781 val_f1_mac= 0.11616 time= 0.08323
Epoch: 0009
Iter: 0003 train_loss= 0.52404 train_f1_mic= 0.43835 train_f1_mac= 0.13429 val_loss= 0.56748 val_f1_mic= 0.39092 val_f1_mac= 0.12127 time= 0.08309
Iter: 0008 train_loss= 0.53715 train_f1_mic= 0.42637 train_f1_mac= 0.13454 val_loss= 0.56748 val_f1_mic= 0.39092 val_f1_mac= 0.12127 time= 0.08294
Iter: 0013 train_loss= 0.53117 train_f1_mic= 0.40603 train_f1_mac= 0.12589 val_loss= 0.56748 val_f1_mic= 0.39092 val_f1_mac= 0.12127 time= 0.08278
Iter: 0018 train_loss= 0.53704 train_f1_mic= 0.42267 train_f1_mac= 0.13266 val_loss= 0.56748 val_f1_mic= 0.39092 val_f1_mac= 0.12127 time= 0.08264
Epoch: 0010
Iter: 0004 train_loss= 0.53880 train_f1_mic= 0.41281 train_f1_mac= 0.12936 val_loss= 0.54465 val_f1_mic= 0.41967 val_f1_mac= 0.13440 time= 0.08257
Iter: 0009 train_loss= 0.52188 train_f1_mic= 0.40874 train_f1_mac= 0.12431 val_loss= 0.54465 val_f1_mic= 0.41967 val_f1_mac= 0.13440 time= 0.08240
Iter: 0014 train_loss= 0.52822 train_f1_mic= 0.42145 train_f1_mac= 0.13189 val_loss= 0.54465 val_f1_mic= 0.41967 val_f1_mac= 0.13440 time= 0.08220
Optimization Finished!
Full validation stats: loss= 0.54650 f1_micro= 0.43992 f1_macro= 0.14550 time= 0.14857
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4558781260158041
Rewards :  -0.017607274057972744 Accuracy :  0.4417923067694259
Total reward :  1.22312639026245
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'sigmoid', 1, 'tanh']
Training RNN (Reward ip) :  [-0.01760727]
Trial 323: Controller loss : 9066.292969

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 4. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:07:15.349444: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:07:15.349976: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:07:15.350507: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:07:15.350886: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:07:15.351355: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69225 train_f1_mic= 0.38196 train_f1_mac= 0.29956 val_loss= 0.66559 val_f1_mic= 0.33179 val_f1_mac= 0.10111 time= 0.76728
Iter: 0005 train_loss= 0.58401 train_f1_mic= 0.38330 train_f1_mac= 0.09377 val_loss= 0.66559 val_f1_mic= 0.33179 val_f1_mac= 0.10111 time= 0.14118
Iter: 0010 train_loss= 0.53870 train_f1_mic= 0.38338 train_f1_mac= 0.09129 val_loss= 0.66559 val_f1_mic= 0.33179 val_f1_mac= 0.10111 time= 0.08372
Iter: 0015 train_loss= 0.54120 train_f1_mic= 0.42098 train_f1_mac= 0.11331 val_loss= 0.66559 val_f1_mic= 0.33179 val_f1_mac= 0.10111 time= 0.06254
Epoch: 0002
Iter: 0001 train_loss= 0.54632 train_f1_mic= 0.39340 train_f1_mac= 0.10102 val_loss= 0.57692 val_f1_mic= 0.37714 val_f1_mac= 0.10330 time= 0.05216
Iter: 0006 train_loss= 0.53334 train_f1_mic= 0.38043 train_f1_mac= 0.09311 val_loss= 0.57692 val_f1_mic= 0.37714 val_f1_mac= 0.10330 time= 0.04489
Iter: 0011 train_loss= 0.53696 train_f1_mic= 0.37441 train_f1_mac= 0.09295 val_loss= 0.57692 val_f1_mic= 0.37714 val_f1_mac= 0.10330 time= 0.03990
Iter: 0016 train_loss= 0.54266 train_f1_mic= 0.38980 train_f1_mac= 0.10568 val_loss= 0.57692 val_f1_mic= 0.37714 val_f1_mac= 0.10330 time= 0.03627
Epoch: 0003
Iter: 0002 train_loss= 0.53400 train_f1_mic= 0.39608 train_f1_mac= 0.10704 val_loss= 0.56254 val_f1_mic= 0.38880 val_f1_mac= 0.10862 time= 0.03390
Iter: 0007 train_loss= 0.55803 train_f1_mic= 0.37752 train_f1_mac= 0.10905 val_loss= 0.56254 val_f1_mic= 0.38880 val_f1_mac= 0.10862 time= 0.03182
Iter: 0012 train_loss= 0.53212 train_f1_mic= 0.40628 train_f1_mac= 0.11908 val_loss= 0.56254 val_f1_mic= 0.38880 val_f1_mac= 0.10862 time= 0.03010
Iter: 0017 train_loss= 0.53292 train_f1_mic= 0.40557 train_f1_mac= 0.12087 val_loss= 0.56254 val_f1_mic= 0.38880 val_f1_mac= 0.10862 time= 0.02889
Epoch: 0004
Iter: 0003 train_loss= 0.52474 train_f1_mic= 0.41831 train_f1_mac= 0.13179 val_loss= 0.55656 val_f1_mic= 0.41072 val_f1_mac= 0.13383 time= 0.02805
Iter: 0008 train_loss= 0.52677 train_f1_mic= 0.41180 train_f1_mac= 0.13280 val_loss= 0.55656 val_f1_mic= 0.41072 val_f1_mac= 0.13383 time= 0.02719
Iter: 0013 train_loss= 0.52405 train_f1_mic= 0.41701 train_f1_mac= 0.13726 val_loss= 0.55656 val_f1_mic= 0.41072 val_f1_mac= 0.13383 time= 0.02647
Iter: 0018 train_loss= 0.51157 train_f1_mic= 0.43765 train_f1_mac= 0.13757 val_loss= 0.55656 val_f1_mic= 0.41072 val_f1_mac= 0.13383 time= 0.02571
Epoch: 0005
Iter: 0004 train_loss= 0.52598 train_f1_mic= 0.43581 train_f1_mac= 0.15588 val_loss= 0.53954 val_f1_mic= 0.40803 val_f1_mac= 0.13575 time= 0.02525
Iter: 0009 train_loss= 0.53014 train_f1_mic= 0.43466 train_f1_mac= 0.16496 val_loss= 0.53954 val_f1_mic= 0.40803 val_f1_mac= 0.13575 time= 0.02461
Iter: 0014 train_loss= 0.51925 train_f1_mic= 0.44128 train_f1_mac= 0.16668 val_loss= 0.53954 val_f1_mic= 0.40803 val_f1_mac= 0.13575 time= 0.02403
Epoch: 0006
Iter: 0000 train_loss= 0.51203 train_f1_mic= 0.42420 train_f1_mac= 0.15954 val_loss= 0.54039 val_f1_mic= 0.45261 val_f1_mac= 0.18685 time= 0.02385
Iter: 0005 train_loss= 0.51555 train_f1_mic= 0.46542 train_f1_mac= 0.18555 val_loss= 0.54039 val_f1_mic= 0.45261 val_f1_mac= 0.18685 time= 0.02343
Iter: 0010 train_loss= 0.51797 train_f1_mic= 0.44625 train_f1_mac= 0.17859 val_loss= 0.54039 val_f1_mic= 0.45261 val_f1_mac= 0.18685 time= 0.02309
Iter: 0015 train_loss= 0.51153 train_f1_mic= 0.41814 train_f1_mac= 0.16114 val_loss= 0.54039 val_f1_mic= 0.45261 val_f1_mac= 0.18685 time= 0.02271
Epoch: 0007
Iter: 0001 train_loss= 0.50521 train_f1_mic= 0.48257 train_f1_mac= 0.21839 val_loss= 0.53742 val_f1_mic= 0.47692 val_f1_mac= 0.21984 time= 0.02249
Iter: 0006 train_loss= 0.51294 train_f1_mic= 0.45618 train_f1_mac= 0.18614 val_loss= 0.53742 val_f1_mic= 0.47692 val_f1_mac= 0.21984 time= 0.02219
Iter: 0011 train_loss= 0.51543 train_f1_mic= 0.42248 train_f1_mac= 0.16195 val_loss= 0.53742 val_f1_mic= 0.47692 val_f1_mac= 0.21984 time= 0.02195
Iter: 0016 train_loss= 0.50270 train_f1_mic= 0.47827 train_f1_mac= 0.21988 val_loss= 0.53742 val_f1_mic= 0.47692 val_f1_mac= 0.21984 time= 0.02167
Epoch: 0008
Iter: 0002 train_loss= 0.50979 train_f1_mic= 0.48836 train_f1_mac= 0.22932 val_loss= 0.53899 val_f1_mic= 0.44990 val_f1_mac= 0.20343 time= 0.02150
Iter: 0007 train_loss= 0.50353 train_f1_mic= 0.45898 train_f1_mac= 0.19610 val_loss= 0.53899 val_f1_mic= 0.44990 val_f1_mac= 0.20343 time= 0.02134
Iter: 0012 train_loss= 0.50220 train_f1_mic= 0.47534 train_f1_mac= 0.22414 val_loss= 0.53899 val_f1_mic= 0.44990 val_f1_mac= 0.20343 time= 0.02110
Iter: 0017 train_loss= 0.50480 train_f1_mic= 0.48397 train_f1_mac= 0.22821 val_loss= 0.53899 val_f1_mic= 0.44990 val_f1_mac= 0.20343 time= 0.02088
Epoch: 0009
Iter: 0003 train_loss= 0.51080 train_f1_mic= 0.46403 train_f1_mac= 0.21898 val_loss= 0.54096 val_f1_mic= 0.46745 val_f1_mac= 0.22824 time= 0.02079
Iter: 0008 train_loss= 0.50476 train_f1_mic= 0.46164 train_f1_mac= 0.21011 val_loss= 0.54096 val_f1_mic= 0.46745 val_f1_mac= 0.22824 time= 0.02059
Iter: 0013 train_loss= 0.50620 train_f1_mic= 0.48242 train_f1_mac= 0.23923 val_loss= 0.54096 val_f1_mic= 0.46745 val_f1_mac= 0.22824 time= 0.02039
Iter: 0018 train_loss= 0.51039 train_f1_mic= 0.49076 train_f1_mac= 0.24900 val_loss= 0.54096 val_f1_mic= 0.46745 val_f1_mac= 0.22824 time= 0.02023
Epoch: 0010
Iter: 0004 train_loss= 0.50033 train_f1_mic= 0.50173 train_f1_mac= 0.25827 val_loss= 0.51328 val_f1_mic= 0.50129 val_f1_mac= 0.26909 time= 0.02024
Iter: 0009 train_loss= 0.49316 train_f1_mic= 0.47145 train_f1_mac= 0.23015 val_loss= 0.51328 val_f1_mic= 0.50129 val_f1_mac= 0.26909 time= 0.02006
Iter: 0014 train_loss= 0.50521 train_f1_mic= 0.50480 train_f1_mac= 0.26667 val_loss= 0.51328 val_f1_mic= 0.50129 val_f1_mac= 0.26909 time= 0.01992
Optimization Finished!
Full validation stats: loss= 0.51561 f1_micro= 0.50091 f1_macro= 0.27135 time= 0.11971
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46357075097029166
Rewards :  0.03846312477243813 Accuracy :  0.4943412507882422
Total reward :  1.2615895150348881
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03846312]
Trial 324: Controller loss : 135.373596

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:07:24.522263: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:07:24.522956: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:07:24.523628: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:07:24.524120: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:07:24.524720: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69241 train_f1_mic= 0.33624 train_f1_mac= 0.26762 val_loss= 0.66201 val_f1_mic= 0.34732 val_f1_mac= 0.08917 time= 0.75359
Iter: 0005 train_loss= 0.58907 train_f1_mic= 0.38136 train_f1_mac= 0.09083 val_loss= 0.66201 val_f1_mic= 0.34732 val_f1_mac= 0.08917 time= 0.13873
Iter: 0010 train_loss= 0.55482 train_f1_mic= 0.37162 train_f1_mac= 0.09111 val_loss= 0.66201 val_f1_mic= 0.34732 val_f1_mac= 0.08917 time= 0.08292
Iter: 0015 train_loss= 0.54618 train_f1_mic= 0.39007 train_f1_mac= 0.09850 val_loss= 0.66201 val_f1_mic= 0.34732 val_f1_mac= 0.08917 time= 0.06150
Epoch: 0002
Iter: 0001 train_loss= 0.54151 train_f1_mic= 0.41042 train_f1_mac= 0.10977 val_loss= 0.56670 val_f1_mic= 0.39930 val_f1_mac= 0.11153 time= 0.05137
Iter: 0006 train_loss= 0.54070 train_f1_mic= 0.39877 train_f1_mac= 0.10526 val_loss= 0.56670 val_f1_mic= 0.39930 val_f1_mac= 0.11153 time= 0.04460
Iter: 0011 train_loss= 0.54617 train_f1_mic= 0.37438 train_f1_mac= 0.09712 val_loss= 0.56670 val_f1_mic= 0.39930 val_f1_mac= 0.11153 time= 0.03982
Iter: 0016 train_loss= 0.54907 train_f1_mic= 0.37395 train_f1_mac= 0.09737 val_loss= 0.56670 val_f1_mic= 0.39930 val_f1_mac= 0.11153 time= 0.03626
Epoch: 0003
Iter: 0002 train_loss= 0.53781 train_f1_mic= 0.38239 train_f1_mac= 0.10477 val_loss= 0.56244 val_f1_mic= 0.37864 val_f1_mac= 0.10547 time= 0.03408
Iter: 0007 train_loss= 0.52539 train_f1_mic= 0.42552 train_f1_mac= 0.12728 val_loss= 0.56244 val_f1_mic= 0.37864 val_f1_mac= 0.10547 time= 0.03189
Iter: 0012 train_loss= 0.53009 train_f1_mic= 0.38767 train_f1_mac= 0.11117 val_loss= 0.56244 val_f1_mic= 0.37864 val_f1_mac= 0.10547 time= 0.03017
Iter: 0017 train_loss= 0.53132 train_f1_mic= 0.42086 train_f1_mac= 0.13075 val_loss= 0.56244 val_f1_mic= 0.37864 val_f1_mac= 0.10547 time= 0.02887
Epoch: 0004
Iter: 0003 train_loss= 0.52867 train_f1_mic= 0.40198 train_f1_mac= 0.12476 val_loss= 0.55448 val_f1_mic= 0.40779 val_f1_mac= 0.13615 time= 0.02833
Iter: 0008 train_loss= 0.51364 train_f1_mic= 0.44967 train_f1_mac= 0.14620 val_loss= 0.55448 val_f1_mic= 0.40779 val_f1_mac= 0.13615 time= 0.02741
Iter: 0013 train_loss= 0.52487 train_f1_mic= 0.39714 train_f1_mac= 0.12538 val_loss= 0.55448 val_f1_mic= 0.40779 val_f1_mac= 0.13615 time= 0.02652
Iter: 0018 train_loss= 0.52616 train_f1_mic= 0.41375 train_f1_mac= 0.13416 val_loss= 0.55448 val_f1_mic= 0.40779 val_f1_mac= 0.13615 time= 0.02577
Epoch: 0005
Iter: 0004 train_loss= 0.51751 train_f1_mic= 0.43114 train_f1_mac= 0.15114 val_loss= 0.53709 val_f1_mic= 0.42178 val_f1_mac= 0.14362 time= 0.02534
Iter: 0009 train_loss= 0.52367 train_f1_mic= 0.42678 train_f1_mac= 0.15537 val_loss= 0.53709 val_f1_mic= 0.42178 val_f1_mac= 0.14362 time= 0.02477
Iter: 0014 train_loss= 0.53326 train_f1_mic= 0.42664 train_f1_mac= 0.14862 val_loss= 0.53709 val_f1_mic= 0.42178 val_f1_mac= 0.14362 time= 0.02421
Epoch: 0006
Iter: 0000 train_loss= 0.52204 train_f1_mic= 0.43830 train_f1_mac= 0.16512 val_loss= 0.53904 val_f1_mic= 0.45133 val_f1_mac= 0.18514 time= 0.02397
Iter: 0005 train_loss= 0.51359 train_f1_mic= 0.47870 train_f1_mac= 0.20038 val_loss= 0.53904 val_f1_mic= 0.45133 val_f1_mac= 0.18514 time= 0.02360
Iter: 0010 train_loss= 0.52463 train_f1_mic= 0.40806 train_f1_mac= 0.14973 val_loss= 0.53904 val_f1_mic= 0.45133 val_f1_mac= 0.18514 time= 0.02326
Iter: 0015 train_loss= 0.51186 train_f1_mic= 0.43634 train_f1_mac= 0.17444 val_loss= 0.53904 val_f1_mic= 0.45133 val_f1_mac= 0.18514 time= 0.02288
Epoch: 0007
Iter: 0001 train_loss= 0.51422 train_f1_mic= 0.48568 train_f1_mac= 0.21401 val_loss= 0.53643 val_f1_mic= 0.48210 val_f1_mac= 0.21423 time= 0.02263
Iter: 0006 train_loss= 0.51411 train_f1_mic= 0.46365 train_f1_mac= 0.20653 val_loss= 0.53643 val_f1_mic= 0.48210 val_f1_mac= 0.21423 time= 0.02231
Iter: 0011 train_loss= 0.50491 train_f1_mic= 0.43573 train_f1_mac= 0.17644 val_loss= 0.53643 val_f1_mic= 0.48210 val_f1_mac= 0.21423 time= 0.02204
Iter: 0016 train_loss= 0.50568 train_f1_mic= 0.50134 train_f1_mac= 0.23249 val_loss= 0.53643 val_f1_mic= 0.48210 val_f1_mac= 0.21423 time= 0.02179
Epoch: 0008
Iter: 0002 train_loss= 0.51213 train_f1_mic= 0.43535 train_f1_mac= 0.17849 val_loss= 0.52393 val_f1_mic= 0.43161 val_f1_mac= 0.18620 time= 0.02187
Iter: 0007 train_loss= 0.50352 train_f1_mic= 0.45238 train_f1_mac= 0.19882 val_loss= 0.52393 val_f1_mic= 0.43161 val_f1_mac= 0.18620 time= 0.02160
Iter: 0012 train_loss= 0.51301 train_f1_mic= 0.51542 train_f1_mac= 0.25544 val_loss= 0.52393 val_f1_mic= 0.43161 val_f1_mac= 0.18620 time= 0.02134
Iter: 0017 train_loss= 0.49435 train_f1_mic= 0.47149 train_f1_mac= 0.22307 val_loss= 0.52393 val_f1_mic= 0.43161 val_f1_mac= 0.18620 time= 0.02114
Epoch: 0009
Iter: 0003 train_loss= 0.49783 train_f1_mic= 0.47973 train_f1_mac= 0.22922 val_loss= 0.52233 val_f1_mic= 0.49206 val_f1_mac= 0.24986 time= 0.02112
Iter: 0008 train_loss= 0.49964 train_f1_mic= 0.48401 train_f1_mac= 0.24273 val_loss= 0.52233 val_f1_mic= 0.49206 val_f1_mac= 0.24986 time= 0.02094
Iter: 0013 train_loss= 0.50348 train_f1_mic= 0.48821 train_f1_mac= 0.24194 val_loss= 0.52233 val_f1_mic= 0.49206 val_f1_mac= 0.24986 time= 0.02076
Iter: 0018 train_loss= 0.50428 train_f1_mic= 0.47988 train_f1_mac= 0.22798 val_loss= 0.52233 val_f1_mic= 0.49206 val_f1_mac= 0.24986 time= 0.02056
Epoch: 0010
Iter: 0004 train_loss= 0.50062 train_f1_mic= 0.50509 train_f1_mac= 0.26358 val_loss= 0.51670 val_f1_mic= 0.48471 val_f1_mac= 0.25151 time= 0.02052
Iter: 0009 train_loss= 0.50135 train_f1_mic= 0.50559 train_f1_mac= 0.27344 val_loss= 0.51670 val_f1_mic= 0.48471 val_f1_mac= 0.25151 time= 0.02036
Iter: 0014 train_loss= 0.50754 train_f1_mic= 0.48242 train_f1_mac= 0.24639 val_loss= 0.51670 val_f1_mic= 0.48471 val_f1_mac= 0.25151 time= 0.02019
Optimization Finished!
Full validation stats: loss= 0.51367 f1_micro= 0.51521 f1_macro= 0.28561 time= 0.09478
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4717684812921872
Rewards :  0.04098865160947751 Accuracy :  0.5045594025797692
Total reward :  1.3025781666443657
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.04098865]
Trial 325: Controller loss : 135.516235
2018-08-31 01:07:33.835025: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:07:33.835276: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:07:33.835506: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:07:33.835675: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:07:33.835886: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [0, 'tanh', 4, 'relu']
Epoch: 0001
Iter: 0000 train_loss= 0.69391 train_f1_mic= 0.38790 train_f1_mac= 0.33764 val_loss= 0.66823 val_f1_mic= 0.39316 val_f1_mac= 0.17226 time= 0.75498
Iter: 0005 train_loss= 0.58071 train_f1_mic= 0.37661 train_f1_mac= 0.09244 val_loss= 0.66823 val_f1_mic= 0.39316 val_f1_mac= 0.17226 time= 0.13614
Iter: 0010 train_loss= 0.55852 train_f1_mic= 0.39494 train_f1_mac= 0.10536 val_loss= 0.66823 val_f1_mic= 0.39316 val_f1_mac= 0.17226 time= 0.08015
Iter: 0015 train_loss= 0.54053 train_f1_mic= 0.42646 train_f1_mac= 0.12574 val_loss= 0.66823 val_f1_mic= 0.39316 val_f1_mac= 0.17226 time= 0.05946
Epoch: 0002
Iter: 0001 train_loss= 0.53786 train_f1_mic= 0.41630 train_f1_mac= 0.12278 val_loss= 0.54051 val_f1_mic= 0.41702 val_f1_mac= 0.12316 time= 0.04915
Iter: 0006 train_loss= 0.53691 train_f1_mic= 0.38462 train_f1_mac= 0.10370 val_loss= 0.54051 val_f1_mic= 0.41702 val_f1_mac= 0.12316 time= 0.04193
Iter: 0011 train_loss= 0.53114 train_f1_mic= 0.40123 train_f1_mac= 0.11312 val_loss= 0.54051 val_f1_mic= 0.41702 val_f1_mac= 0.12316 time= 0.03726
Iter: 0016 train_loss= 0.53283 train_f1_mic= 0.40765 train_f1_mac= 0.12425 val_loss= 0.54051 val_f1_mic= 0.41702 val_f1_mac= 0.12316 time= 0.03366
Epoch: 0003
Iter: 0002 train_loss= 0.52890 train_f1_mic= 0.44201 train_f1_mac= 0.15235 val_loss= 0.55509 val_f1_mic= 0.44088 val_f1_mac= 0.15601 time= 0.03133
Iter: 0007 train_loss= 0.51836 train_f1_mic= 0.43425 train_f1_mac= 0.14599 val_loss= 0.55509 val_f1_mic= 0.44088 val_f1_mac= 0.15601 time= 0.02921
Iter: 0012 train_loss= 0.53738 train_f1_mic= 0.42067 train_f1_mac= 0.15169 val_loss= 0.55509 val_f1_mic= 0.44088 val_f1_mac= 0.15601 time= 0.02766
Iter: 0017 train_loss= 0.53338 train_f1_mic= 0.44119 train_f1_mac= 0.16190 val_loss= 0.55509 val_f1_mic= 0.44088 val_f1_mac= 0.15601 time= 0.02615
Epoch: 0004
Iter: 0003 train_loss= 0.51350 train_f1_mic= 0.43955 train_f1_mac= 0.14814 val_loss= 0.54492 val_f1_mic= 0.44290 val_f1_mac= 0.16463 time= 0.02541
Iter: 0008 train_loss= 0.52808 train_f1_mic= 0.41549 train_f1_mac= 0.13863 val_loss= 0.54492 val_f1_mic= 0.44290 val_f1_mac= 0.16463 time= 0.02447
Iter: 0013 train_loss= 0.50843 train_f1_mic= 0.44321 train_f1_mac= 0.15963 val_loss= 0.54492 val_f1_mic= 0.44290 val_f1_mac= 0.16463 time= 0.02364
Iter: 0018 train_loss= 0.50995 train_f1_mic= 0.44074 train_f1_mac= 0.16518 val_loss= 0.54492 val_f1_mic= 0.44290 val_f1_mac= 0.16463 time= 0.02286
Epoch: 0005
Iter: 0004 train_loss= 0.51825 train_f1_mic= 0.43884 train_f1_mac= 0.16698 val_loss= 0.52585 val_f1_mic= 0.44865 val_f1_mac= 0.18272 time= 0.02237
Iter: 0009 train_loss= 0.51784 train_f1_mic= 0.45195 train_f1_mac= 0.18386 val_loss= 0.52585 val_f1_mic= 0.44865 val_f1_mac= 0.18272 time= 0.02184
Iter: 0014 train_loss= 0.52031 train_f1_mic= 0.47131 train_f1_mac= 0.20498 val_loss= 0.52585 val_f1_mic= 0.44865 val_f1_mac= 0.18272 time= 0.02127
Epoch: 0006
Iter: 0000 train_loss= 0.51506 train_f1_mic= 0.43791 train_f1_mac= 0.17412 val_loss= 0.53048 val_f1_mic= 0.44507 val_f1_mac= 0.19228 time= 0.02105
Iter: 0005 train_loss= 0.52665 train_f1_mic= 0.44391 train_f1_mac= 0.18591 val_loss= 0.53048 val_f1_mic= 0.44507 val_f1_mac= 0.19228 time= 0.02060
Iter: 0010 train_loss= 0.50923 train_f1_mic= 0.46764 train_f1_mac= 0.20150 val_loss= 0.53048 val_f1_mic= 0.44507 val_f1_mac= 0.19228 time= 0.02015
Iter: 0015 train_loss= 0.50179 train_f1_mic= 0.45331 train_f1_mac= 0.18522 val_loss= 0.53048 val_f1_mic= 0.44507 val_f1_mac= 0.19228 time= 0.01977
Epoch: 0007
Iter: 0001 train_loss= 0.49989 train_f1_mic= 0.47390 train_f1_mac= 0.20730 val_loss= 0.52722 val_f1_mic= 0.47358 val_f1_mac= 0.22241 time= 0.01963
Iter: 0006 train_loss= 0.51773 train_f1_mic= 0.45563 train_f1_mac= 0.19643 val_loss= 0.52722 val_f1_mic= 0.47358 val_f1_mac= 0.22241 time= 0.01929
Iter: 0011 train_loss= 0.50902 train_f1_mic= 0.46531 train_f1_mac= 0.20324 val_loss= 0.52722 val_f1_mic= 0.47358 val_f1_mac= 0.22241 time= 0.01896
Iter: 0016 train_loss= 0.51204 train_f1_mic= 0.46905 train_f1_mac= 0.21682 val_loss= 0.52722 val_f1_mic= 0.47358 val_f1_mac= 0.22241 time= 0.01876
Epoch: 0008
Iter: 0002 train_loss= 0.51396 train_f1_mic= 0.44207 train_f1_mac= 0.18356 val_loss= 0.53585 val_f1_mic= 0.42961 val_f1_mac= 0.18641 time= 0.01865
Iter: 0007 train_loss= 0.51162 train_f1_mic= 0.47936 train_f1_mac= 0.22052 val_loss= 0.53585 val_f1_mic= 0.42961 val_f1_mac= 0.18641 time= 0.01845
Iter: 0012 train_loss= 0.49988 train_f1_mic= 0.46012 train_f1_mac= 0.21705 val_loss= 0.53585 val_f1_mic= 0.42961 val_f1_mac= 0.18641 time= 0.01825
Iter: 0017 train_loss= 0.51035 train_f1_mic= 0.47714 train_f1_mac= 0.23913 val_loss= 0.53585 val_f1_mic= 0.42961 val_f1_mac= 0.18641 time= 0.01811
Epoch: 0009
Iter: 0003 train_loss= 0.49365 train_f1_mic= 0.46952 train_f1_mac= 0.20030 val_loss= 0.52204 val_f1_mic= 0.46651 val_f1_mac= 0.23142 time= 0.01808
Iter: 0008 train_loss= 0.51095 train_f1_mic= 0.46858 train_f1_mac= 0.22470 val_loss= 0.52204 val_f1_mic= 0.46651 val_f1_mac= 0.23142 time= 0.01786
Iter: 0013 train_loss= 0.50450 train_f1_mic= 0.48952 train_f1_mac= 0.24830 val_loss= 0.52204 val_f1_mic= 0.46651 val_f1_mac= 0.23142 time= 0.01772
Iter: 0018 train_loss= 0.48767 train_f1_mic= 0.48621 train_f1_mac= 0.24899 val_loss= 0.52204 val_f1_mic= 0.46651 val_f1_mac= 0.23142 time= 0.01754
Epoch: 0010
Iter: 0004 train_loss= 0.50362 train_f1_mic= 0.49890 train_f1_mac= 0.25992 val_loss= 0.53543 val_f1_mic= 0.46690 val_f1_mac= 0.23474 time= 0.01754
Iter: 0009 train_loss= 0.48920 train_f1_mic= 0.47189 train_f1_mac= 0.22195 val_loss= 0.53543 val_f1_mic= 0.46690 val_f1_mac= 0.23474 time= 0.01739
Iter: 0014 train_loss= 0.50459 train_f1_mic= 0.50465 train_f1_mac= 0.27114 val_loss= 0.53543 val_f1_mic= 0.46690 val_f1_mac= 0.23474 time= 0.01724
Optimization Finished!
Full validation stats: loss= 0.52065 f1_micro= 0.47348 f1_macro= 0.24447 time= 0.09878
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47160251998941305
Rewards :  -0.0008298065138704902 Accuracy :  0.4709386747783167
Total reward :  1.301748360130495
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'tanh', 4, 'relu']
Training RNN (Reward ip) :  [-0.00082981]
Trial 326: Controller loss : 8234.371094

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'tanh', 3, 'sigmoid']
2018-08-31 01:07:42.166136: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:07:42.166598: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:07:42.167090: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:07:42.167447: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:07:42.167894: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69474 train_f1_mic= 0.35576 train_f1_mac= 0.23291 val_loss= 0.65389 val_f1_mic= 0.38095 val_f1_mac= 0.09420 time= 0.84474
Iter: 0005 train_loss= 0.56861 train_f1_mic= 0.37329 train_f1_mac= 0.08748 val_loss= 0.65389 val_f1_mic= 0.38095 val_f1_mac= 0.09420 time= 0.19315
Iter: 0010 train_loss= 0.53547 train_f1_mic= 0.38635 train_f1_mac= 0.09482 val_loss= 0.65389 val_f1_mic= 0.38095 val_f1_mac= 0.09420 time= 0.13391
Iter: 0015 train_loss= 0.53636 train_f1_mic= 0.39864 train_f1_mac= 0.09823 val_loss= 0.65389 val_f1_mic= 0.38095 val_f1_mac= 0.09420 time= 0.11182
Epoch: 0002
Iter: 0001 train_loss= 0.54420 train_f1_mic= 0.38038 train_f1_mac= 0.09604 val_loss= 0.58560 val_f1_mic= 0.35909 val_f1_mac= 0.09861 time= 0.10120
Iter: 0006 train_loss= 0.53158 train_f1_mic= 0.37145 train_f1_mac= 0.09055 val_loss= 0.58560 val_f1_mic= 0.35909 val_f1_mac= 0.09861 time= 0.09383
Iter: 0011 train_loss= 0.53056 train_f1_mic= 0.40697 train_f1_mac= 0.11029 val_loss= 0.58560 val_f1_mic= 0.35909 val_f1_mac= 0.09861 time= 0.08882
Iter: 0016 train_loss= 0.53208 train_f1_mic= 0.41461 train_f1_mac= 0.11925 val_loss= 0.58560 val_f1_mic= 0.35909 val_f1_mac= 0.09861 time= 0.08535
Epoch: 0003
Iter: 0002 train_loss= 0.52654 train_f1_mic= 0.42101 train_f1_mac= 0.13043 val_loss= 0.55583 val_f1_mic= 0.41696 val_f1_mac= 0.13494 time= 0.08309
Iter: 0007 train_loss= 0.53444 train_f1_mic= 0.43490 train_f1_mac= 0.14052 val_loss= 0.55583 val_f1_mic= 0.41696 val_f1_mac= 0.13494 time= 0.08091
Iter: 0012 train_loss= 0.52738 train_f1_mic= 0.41676 train_f1_mac= 0.12787 val_loss= 0.55583 val_f1_mic= 0.41696 val_f1_mac= 0.13494 time= 0.07918
Iter: 0017 train_loss= 0.52442 train_f1_mic= 0.42808 train_f1_mac= 0.13520 val_loss= 0.55583 val_f1_mic= 0.41696 val_f1_mac= 0.13494 time= 0.07770
Epoch: 0004
Iter: 0003 train_loss= 0.52891 train_f1_mic= 0.44381 train_f1_mac= 0.14811 val_loss= 0.53886 val_f1_mic= 0.42919 val_f1_mac= 0.14039 time= 0.07679
Iter: 0008 train_loss= 0.51014 train_f1_mic= 0.44086 train_f1_mac= 0.14601 val_loss= 0.53886 val_f1_mic= 0.42919 val_f1_mac= 0.14039 time= 0.07572
Iter: 0013 train_loss= 0.52525 train_f1_mic= 0.43028 train_f1_mac= 0.15168 val_loss= 0.53886 val_f1_mic= 0.42919 val_f1_mac= 0.14039 time= 0.07480
Iter: 0018 train_loss= 0.53130 train_f1_mic= 0.43823 train_f1_mac= 0.15668 val_loss= 0.53886 val_f1_mic= 0.42919 val_f1_mac= 0.14039 time= 0.07400
Epoch: 0005
Iter: 0004 train_loss= 0.52752 train_f1_mic= 0.41582 train_f1_mac= 0.14244 val_loss= 0.55964 val_f1_mic= 0.45701 val_f1_mac= 0.18259 time= 0.07359
Iter: 0009 train_loss= 0.53214 train_f1_mic= 0.45182 train_f1_mac= 0.18103 val_loss= 0.55964 val_f1_mic= 0.45701 val_f1_mac= 0.18259 time= 0.07295
Iter: 0014 train_loss= 0.52234 train_f1_mic= 0.42952 train_f1_mac= 0.15885 val_loss= 0.55964 val_f1_mic= 0.45701 val_f1_mac= 0.18259 time= 0.07241
Epoch: 0006
Iter: 0000 train_loss= 0.51730 train_f1_mic= 0.43784 train_f1_mac= 0.15299 val_loss= 0.54274 val_f1_mic= 0.42298 val_f1_mac= 0.14691 time= 0.07213
Iter: 0005 train_loss= 0.51541 train_f1_mic= 0.42875 train_f1_mac= 0.14753 val_loss= 0.54274 val_f1_mic= 0.42298 val_f1_mac= 0.14691 time= 0.07168
Iter: 0010 train_loss= 0.52055 train_f1_mic= 0.45816 train_f1_mac= 0.18920 val_loss= 0.54274 val_f1_mic= 0.42298 val_f1_mac= 0.14691 time= 0.07128
Iter: 0015 train_loss= 0.51574 train_f1_mic= 0.44923 train_f1_mac= 0.18175 val_loss= 0.54274 val_f1_mic= 0.42298 val_f1_mac= 0.14691 time= 0.07089
Epoch: 0007
Iter: 0001 train_loss= 0.51849 train_f1_mic= 0.43279 train_f1_mac= 0.16201 val_loss= 0.54458 val_f1_mic= 0.42968 val_f1_mac= 0.17335 time= 0.07076
Iter: 0006 train_loss= 0.51631 train_f1_mic= 0.46500 train_f1_mac= 0.19691 val_loss= 0.54458 val_f1_mic= 0.42968 val_f1_mac= 0.17335 time= 0.07042
Iter: 0011 train_loss= 0.52861 train_f1_mic= 0.44664 train_f1_mac= 0.18221 val_loss= 0.54458 val_f1_mic= 0.42968 val_f1_mac= 0.17335 time= 0.07013
Iter: 0016 train_loss= 0.52730 train_f1_mic= 0.43825 train_f1_mac= 0.18535 val_loss= 0.54458 val_f1_mic= 0.42968 val_f1_mac= 0.17335 time= 0.06986
Epoch: 0008
Iter: 0002 train_loss= 0.52707 train_f1_mic= 0.44766 train_f1_mac= 0.18913 val_loss= 0.55585 val_f1_mic= 0.45633 val_f1_mac= 0.19932 time= 0.06975
Iter: 0007 train_loss= 0.49403 train_f1_mic= 0.44439 train_f1_mac= 0.17497 val_loss= 0.55585 val_f1_mic= 0.45633 val_f1_mac= 0.19932 time= 0.06951
Iter: 0012 train_loss= 0.50128 train_f1_mic= 0.48302 train_f1_mac= 0.22259 val_loss= 0.55585 val_f1_mic= 0.45633 val_f1_mac= 0.19932 time= 0.06929
Iter: 0017 train_loss= 0.51217 train_f1_mic= 0.45689 train_f1_mac= 0.19555 val_loss= 0.55585 val_f1_mic= 0.45633 val_f1_mac= 0.19932 time= 0.06909
Epoch: 0009
Iter: 0003 train_loss= 0.51552 train_f1_mic= 0.43472 train_f1_mac= 0.17635 val_loss= 0.53210 val_f1_mic= 0.47801 val_f1_mac= 0.21489 time= 0.06902
Iter: 0008 train_loss= 0.50848 train_f1_mic= 0.45308 train_f1_mac= 0.19149 val_loss= 0.53210 val_f1_mic= 0.47801 val_f1_mac= 0.21489 time= 0.06886
Iter: 0013 train_loss= 0.50799 train_f1_mic= 0.44169 train_f1_mac= 0.18124 val_loss= 0.53210 val_f1_mic= 0.47801 val_f1_mac= 0.21489 time= 0.06868
Iter: 0018 train_loss= 0.51154 train_f1_mic= 0.47951 train_f1_mac= 0.22481 val_loss= 0.53210 val_f1_mic= 0.47801 val_f1_mac= 0.21489 time= 0.06852
Epoch: 0010
Iter: 0004 train_loss= 0.50728 train_f1_mic= 0.48226 train_f1_mac= 0.22178 val_loss= 0.53902 val_f1_mic= 0.48560 val_f1_mac= 0.23571 time= 0.06849
Iter: 0009 train_loss= 0.51502 train_f1_mic= 0.46217 train_f1_mac= 0.21290 val_loss= 0.53902 val_f1_mic= 0.48560 val_f1_mac= 0.23571 time= 0.06834
Iter: 0014 train_loss= 0.51086 train_f1_mic= 0.46313 train_f1_mac= 0.20372 val_loss= 0.53902 val_f1_mic= 0.48560 val_f1_mac= 0.23571 time= 0.06819
Optimization Finished!
Full validation stats: loss= 0.52695 f1_micro= 0.48771 f1_macro= 0.24249 time= 0.11771
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4748456130720145
Rewards :  0.016215465413007446 Accuracy :  0.4878179854024205
Total reward :  1.3179638255435027
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'tanh', 3, 'sigmoid']
Training RNN (Reward ip) :  [0.01621547]
Trial 327: Controller loss : 5846.687988
2018-08-31 01:08:00.454733: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:08:00.455208: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\g
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [4, 'relu', 3, 'relu']
pu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:08:00.455863: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:08:00.456163: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:08:00.456596: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69479 train_f1_mic= 0.40153 train_f1_mac= 0.33758 val_loss= 0.66078 val_f1_mic= 0.37720 val_f1_mac= 0.11713 time= 0.75607
Iter: 0005 train_loss= 0.58619 train_f1_mic= 0.37877 train_f1_mac= 0.09659 val_loss= 0.66078 val_f1_mic= 0.37720 val_f1_mac= 0.11713 time= 0.13830
Iter: 0010 train_loss= 0.55319 train_f1_mic= 0.38278 train_f1_mac= 0.09767 val_loss= 0.66078 val_f1_mic= 0.37720 val_f1_mac= 0.11713 time= 0.08206
Iter: 0015 train_loss= 0.54008 train_f1_mic= 0.39207 train_f1_mac= 0.10397 val_loss= 0.66078 val_f1_mic= 0.37720 val_f1_mac= 0.11713 time= 0.06184
Epoch: 0002
Iter: 0001 train_loss= 0.54299 train_f1_mic= 0.37852 train_f1_mac= 0.09646 val_loss= 0.55669 val_f1_mic= 0.37032 val_f1_mac= 0.09744 time= 0.05206
Iter: 0006 train_loss= 0.54448 train_f1_mic= 0.38968 train_f1_mac= 0.10159 val_loss= 0.55669 val_f1_mic= 0.37032 val_f1_mac= 0.09744 time= 0.04496
Iter: 0011 train_loss= 0.54820 train_f1_mic= 0.37977 train_f1_mac= 0.10250 val_loss= 0.55669 val_f1_mic= 0.37032 val_f1_mac= 0.09744 time= 0.04012
Iter: 0016 train_loss= 0.52940 train_f1_mic= 0.39442 train_f1_mac= 0.10671 val_loss= 0.55669 val_f1_mic= 0.37032 val_f1_mac= 0.09744 time= 0.03663
Epoch: 0003
Iter: 0002 train_loss= 0.52635 train_f1_mic= 0.39235 train_f1_mac= 0.10930 val_loss= 0.55489 val_f1_mic= 0.38662 val_f1_mac= 0.11715 time= 0.03449
Iter: 0007 train_loss= 0.53505 train_f1_mic= 0.39260 train_f1_mac= 0.11694 val_loss= 0.55489 val_f1_mic= 0.38662 val_f1_mac= 0.11715 time= 0.03237
Iter: 0012 train_loss= 0.52752 train_f1_mic= 0.43181 train_f1_mac= 0.13560 val_loss= 0.55489 val_f1_mic= 0.38662 val_f1_mac= 0.11715 time= 0.03072
Iter: 0017 train_loss= 0.53360 train_f1_mic= 0.42270 train_f1_mac= 0.13578 val_loss= 0.55489 val_f1_mic= 0.38662 val_f1_mac= 0.11715 time= 0.02946
Epoch: 0004
Iter: 0003 train_loss= 0.51914 train_f1_mic= 0.43454 train_f1_mac= 0.13978 val_loss= 0.54768 val_f1_mic= 0.43247 val_f1_mac= 0.14362 time= 0.02881
Iter: 0008 train_loss= 0.52150 train_f1_mic= 0.42868 train_f1_mac= 0.13868 val_loss= 0.54768 val_f1_mic= 0.43247 val_f1_mac= 0.14362 time= 0.02785
Iter: 0013 train_loss= 0.52199 train_f1_mic= 0.42975 train_f1_mac= 0.14016 val_loss= 0.54768 val_f1_mic= 0.43247 val_f1_mac= 0.14362 time= 0.02705
Iter: 0018 train_loss= 0.52227 train_f1_mic= 0.42815 train_f1_mac= 0.13982 val_loss= 0.54768 val_f1_mic= 0.43247 val_f1_mac= 0.14362 time= 0.02631
Epoch: 0005
Iter: 0004 train_loss= 0.50985 train_f1_mic= 0.41561 train_f1_mac= 0.13507 val_loss= 0.55494 val_f1_mic= 0.41095 val_f1_mac= 0.13523 time= 0.02577
Iter: 0009 train_loss= 0.52118 train_f1_mic= 0.45537 train_f1_mac= 0.17041 val_loss= 0.55494 val_f1_mic= 0.41095 val_f1_mac= 0.13523 time= 0.02519
Iter: 0014 train_loss= 0.51801 train_f1_mic= 0.43940 train_f1_mac= 0.15545 val_loss= 0.55494 val_f1_mic= 0.41095 val_f1_mac= 0.13523 time= 0.02482
Epoch: 0006
Iter: 0000 train_loss= 0.51987 train_f1_mic= 0.45587 train_f1_mac= 0.17336 val_loss= 0.53254 val_f1_mic= 0.42767 val_f1_mac= 0.16199 time= 0.02465
Iter: 0005 train_loss= 0.51513 train_f1_mic= 0.43950 train_f1_mac= 0.16563 val_loss= 0.53254 val_f1_mic= 0.42767 val_f1_mac= 0.16199 time= 0.02424
Iter: 0010 train_loss= 0.51300 train_f1_mic= 0.45612 train_f1_mac= 0.18402 val_loss= 0.53254 val_f1_mic= 0.42767 val_f1_mac= 0.16199 time= 0.02379
Iter: 0015 train_loss= 0.51040 train_f1_mic= 0.44101 train_f1_mac= 0.16734 val_loss= 0.53254 val_f1_mic= 0.42767 val_f1_mac= 0.16199 time= 0.02338
Epoch: 0007
Iter: 0001 train_loss= 0.50858 train_f1_mic= 0.45527 train_f1_mac= 0.18813 val_loss= 0.53529 val_f1_mic= 0.46149 val_f1_mac= 0.20496 time= 0.02315
Iter: 0006 train_loss= 0.50451 train_f1_mic= 0.46592 train_f1_mac= 0.19420 val_loss= 0.53529 val_f1_mic= 0.46149 val_f1_mac= 0.20496 time= 0.02285
Iter: 0011 train_loss= 0.51014 train_f1_mic= 0.46543 train_f1_mac= 0.19430 val_loss= 0.53529 val_f1_mic= 0.46149 val_f1_mac= 0.20496 time= 0.02251
Iter: 0016 train_loss= 0.52051 train_f1_mic= 0.44227 train_f1_mac= 0.17902 val_loss= 0.53529 val_f1_mic= 0.46149 val_f1_mac= 0.20496 time= 0.02223
Epoch: 0008
Iter: 0002 train_loss= 0.51783 train_f1_mic= 0.47387 train_f1_mac= 0.21609 val_loss= 0.52222 val_f1_mic= 0.47273 val_f1_mac= 0.20852 time= 0.02209
Iter: 0007 train_loss= 0.50348 train_f1_mic= 0.47058 train_f1_mac= 0.21302 val_loss= 0.52222 val_f1_mic= 0.47273 val_f1_mac= 0.20852 time= 0.02189
Iter: 0012 train_loss= 0.51018 train_f1_mic= 0.45706 train_f1_mac= 0.19082 val_loss= 0.52222 val_f1_mic= 0.47273 val_f1_mac= 0.20852 time= 0.02167
Iter: 0017 train_loss= 0.50642 train_f1_mic= 0.47075 train_f1_mac= 0.21350 val_loss= 0.52222 val_f1_mic= 0.47273 val_f1_mac= 0.20852 time= 0.02148
Epoch: 0009
Iter: 0003 train_loss= 0.51586 train_f1_mic= 0.48072 train_f1_mac= 0.22610 val_loss= 0.53251 val_f1_mic= 0.46862 val_f1_mac= 0.22107 time= 0.02150
Iter: 0008 train_loss= 0.51474 train_f1_mic= 0.44381 train_f1_mac= 0.19007 val_loss= 0.53251 val_f1_mic= 0.46862 val_f1_mac= 0.22107 time= 0.02127
Iter: 0013 train_loss= 0.52000 train_f1_mic= 0.47683 train_f1_mac= 0.21895 val_loss= 0.53251 val_f1_mic= 0.46862 val_f1_mac= 0.22107 time= 0.02105
Iter: 0018 train_loss= 0.50716 train_f1_mic= 0.45970 train_f1_mac= 0.20777 val_loss= 0.53251 val_f1_mic= 0.46862 val_f1_mac= 0.22107 time= 0.02091
Epoch: 0010
Iter: 0004 train_loss= 0.50899 train_f1_mic= 0.48983 train_f1_mac= 0.24407 val_loss= 0.51996 val_f1_mic= 0.46744 val_f1_mac= 0.23820 time= 0.02084
Iter: 0009 train_loss= 0.48603 train_f1_mic= 0.48372 train_f1_mac= 0.22719 val_loss= 0.51996 val_f1_mic= 0.46744 val_f1_mac= 0.23820 time= 0.02071
Iter: 0014 train_loss= 0.50936 train_f1_mic= 0.49444 train_f1_mac= 0.25137 val_loss= 0.51996 val_f1_mic= 0.46744 val_f1_mac= 0.23820 time= 0.02058
Optimization Finished!
Full validation stats: loss= 0.52811 f1_micro= 0.46482 f1_macro= 0.23140 time= 0.12067
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4736131165793146
Rewards :  -0.00616248246349943 Accuracy :  0.4686831306085151
Total reward :  1.3118013430800033
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [-0.00616248]
Trial 328: Controller loss : 3310.146973
2018-08-31 01:08:09.871853: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:08:09.872324: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:08:09.872790: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:08:09.873130: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [0, 'linear', 3, 'tanh']
2018-08-31 01:08:09.873998: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69382 train_f1_mic= 0.38029 train_f1_mac= 0.32959 val_loss= 0.67312 val_f1_mic= 0.43490 val_f1_mac= 0.20931 time= 0.75002
Iter: 0005 train_loss= 0.60073 train_f1_mic= 0.37200 train_f1_mac= 0.09471 val_loss= 0.67312 val_f1_mic= 0.43490 val_f1_mac= 0.20931 time= 0.13763
Iter: 0010 train_loss= 0.56252 train_f1_mic= 0.38713 train_f1_mac= 0.10359 val_loss= 0.67312 val_f1_mic= 0.43490 val_f1_mac= 0.20931 time= 0.08195
Iter: 0015 train_loss= 0.53360 train_f1_mic= 0.40820 train_f1_mac= 0.11697 val_loss= 0.67312 val_f1_mic= 0.43490 val_f1_mac= 0.20931 time= 0.06158
Epoch: 0002
Iter: 0001 train_loss= 0.54177 train_f1_mic= 0.41042 train_f1_mac= 0.12676 val_loss= 0.53736 val_f1_mic= 0.40929 val_f1_mac= 0.12482 time= 0.05138
Iter: 0006 train_loss= 0.53161 train_f1_mic= 0.40980 train_f1_mac= 0.12693 val_loss= 0.53736 val_f1_mic= 0.40929 val_f1_mac= 0.12482 time= 0.04464
Iter: 0011 train_loss= 0.53826 train_f1_mic= 0.41104 train_f1_mac= 0.13509 val_loss= 0.53736 val_f1_mic= 0.40929 val_f1_mac= 0.12482 time= 0.03979
Iter: 0016 train_loss= 0.54154 train_f1_mic= 0.40356 train_f1_mac= 0.13550 val_loss= 0.53736 val_f1_mic= 0.40929 val_f1_mac= 0.12482 time= 0.03626
Epoch: 0003
Iter: 0002 train_loss= 0.52236 train_f1_mic= 0.43445 train_f1_mac= 0.15052 val_loss= 0.55235 val_f1_mic= 0.41788 val_f1_mac= 0.14856 time= 0.03391
Iter: 0007 train_loss= 0.52436 train_f1_mic= 0.43493 train_f1_mac= 0.15295 val_loss= 0.55235 val_f1_mic= 0.41788 val_f1_mac= 0.14856 time= 0.03180
Iter: 0012 train_loss= 0.53201 train_f1_mic= 0.42408 train_f1_mac= 0.14667 val_loss= 0.55235 val_f1_mic= 0.41788 val_f1_mac= 0.14856 time= 0.03015
Iter: 0017 train_loss= 0.51576 train_f1_mic= 0.42366 train_f1_mac= 0.14173 val_loss= 0.55235 val_f1_mic= 0.41788 val_f1_mac= 0.14856 time= 0.02878
Epoch: 0004
Iter: 0003 train_loss= 0.52092 train_f1_mic= 0.41922 train_f1_mac= 0.14343 val_loss= 0.56352 val_f1_mic= 0.41248 val_f1_mac= 0.15143 time= 0.02796
Iter: 0008 train_loss= 0.52669 train_f1_mic= 0.43138 train_f1_mac= 0.15357 val_loss= 0.56352 val_f1_mic= 0.41248 val_f1_mac= 0.15143 time= 0.02694
Iter: 0013 train_loss= 0.51760 train_f1_mic= 0.43102 train_f1_mac= 0.15269 val_loss= 0.56352 val_f1_mic= 0.41248 val_f1_mac= 0.15143 time= 0.02605
Iter: 0018 train_loss= 0.53483 train_f1_mic= 0.43151 train_f1_mac= 0.16378 val_loss= 0.56352 val_f1_mic= 0.41248 val_f1_mac= 0.15143 time= 0.02536
Epoch: 0005
Iter: 0004 train_loss= 0.51629 train_f1_mic= 0.44181 train_f1_mac= 0.16886 val_loss= 0.55219 val_f1_mic= 0.43568 val_f1_mac= 0.17409 time= 0.02487
Iter: 0009 train_loss= 0.52625 train_f1_mic= 0.42811 train_f1_mac= 0.15851 val_loss= 0.55219 val_f1_mic= 0.43568 val_f1_mac= 0.17409 time= 0.02425
Iter: 0014 train_loss= 0.52418 train_f1_mic= 0.42731 train_f1_mac= 0.16222 val_loss= 0.55219 val_f1_mic= 0.43568 val_f1_mac= 0.17409 time= 0.02371
Epoch: 0006
Iter: 0000 train_loss= 0.53109 train_f1_mic= 0.43300 train_f1_mac= 0.16317 val_loss= 0.56818 val_f1_mic= 0.42082 val_f1_mac= 0.16377 time= 0.02366
Iter: 0005 train_loss= 0.52365 train_f1_mic= 0.43748 train_f1_mac= 0.16774 val_loss= 0.56818 val_f1_mic= 0.42082 val_f1_mac= 0.16377 time= 0.02320
Iter: 0010 train_loss= 0.51701 train_f1_mic= 0.44850 train_f1_mac= 0.18023 val_loss= 0.56818 val_f1_mic= 0.42082 val_f1_mac= 0.16377 time= 0.02282
Iter: 0015 train_loss= 0.52605 train_f1_mic= 0.42777 train_f1_mac= 0.16490 val_loss= 0.56818 val_f1_mic= 0.42082 val_f1_mac= 0.16377 time= 0.02249
Epoch: 0007
Iter: 0001 train_loss= 0.50721 train_f1_mic= 0.44991 train_f1_mac= 0.17878 val_loss= 0.53198 val_f1_mic= 0.43972 val_f1_mac= 0.17986 time= 0.02226
Iter: 0006 train_loss= 0.51359 train_f1_mic= 0.45354 train_f1_mac= 0.17588 val_loss= 0.53198 val_f1_mic= 0.43972 val_f1_mac= 0.17986 time= 0.02195
Iter: 0011 train_loss= 0.52214 train_f1_mic= 0.44202 train_f1_mac= 0.17258 val_loss= 0.53198 val_f1_mic= 0.43972 val_f1_mac= 0.17986 time= 0.02164
Iter: 0016 train_loss= 0.51247 train_f1_mic= 0.43357 train_f1_mac= 0.16598 val_loss= 0.53198 val_f1_mic= 0.43972 val_f1_mac= 0.17986 time= 0.02140
Epoch: 0008
Iter: 0002 train_loss= 0.50910 train_f1_mic= 0.44062 train_f1_mac= 0.17506 val_loss= 0.54269 val_f1_mic= 0.43721 val_f1_mac= 0.17726 time= 0.02129
Iter: 0007 train_loss= 0.50072 train_f1_mic= 0.46188 train_f1_mac= 0.19070 val_loss= 0.54269 val_f1_mic= 0.43721 val_f1_mac= 0.17726 time= 0.02107
Iter: 0012 train_loss= 0.50861 train_f1_mic= 0.44261 train_f1_mac= 0.17168 val_loss= 0.54269 val_f1_mic= 0.43721 val_f1_mac= 0.17726 time= 0.02086
Iter: 0017 train_loss= 0.52736 train_f1_mic= 0.44594 train_f1_mac= 0.18016 val_loss= 0.54269 val_f1_mic= 0.43721 val_f1_mac= 0.17726 time= 0.02068
Epoch: 0009
Iter: 0003 train_loss= 0.50886 train_f1_mic= 0.44312 train_f1_mac= 0.17267 val_loss= 0.51468 val_f1_mic= 0.44335 val_f1_mac= 0.18894 time= 0.02073
Iter: 0008 train_loss= 0.51070 train_f1_mic= 0.45221 train_f1_mac= 0.19033 val_loss= 0.51468 val_f1_mic= 0.44335 val_f1_mac= 0.18894 time= 0.02053
Iter: 0013 train_loss= 0.51728 train_f1_mic= 0.46314 train_f1_mac= 0.20158 val_loss= 0.51468 val_f1_mic= 0.44335 val_f1_mac= 0.18894 time= 0.02036
Iter: 0018 train_loss= 0.51300 train_f1_mic= 0.45108 train_f1_mac= 0.18099 val_loss= 0.51468 val_f1_mic= 0.44335 val_f1_mac= 0.18894 time= 0.02021
Epoch: 0010
Iter: 0004 train_loss= 0.50702 train_f1_mic= 0.46061 train_f1_mac= 0.20033 val_loss= 0.55514 val_f1_mic= 0.44544 val_f1_mac= 0.20186 time= 0.02020
Iter: 0009 train_loss= 0.51146 train_f1_mic= 0.45706 train_f1_mac= 0.19528 val_loss= 0.55514 val_f1_mic= 0.44544 val_f1_mac= 0.20186 time= 0.02004
Iter: 0014 train_loss= 0.51414 train_f1_mic= 0.45231 train_f1_mac= 0.19201 val_loss= 0.55514 val_f1_mic= 0.44544 val_f1_mac= 0.20186 time= 0.01988
Optimization Finished!
Full validation stats: loss= 0.53094 f1_micro= 0.44799 f1_macro= 0.19432 time= 0.07580
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4687908235472619
Rewards :  -0.0241114651602633 Accuracy :  0.4495016514190513
Total reward :  1.2876898779197399
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'linear', 3, 'tanh']
Training RNN (Reward ip) :  [-0.02411146]
Trial 329: Controller loss : 7810.392090

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:08:19.050999: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:08:19.051525: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:08:19.052039: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:08:19.052889: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:08:19.053433: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69058 train_f1_mic= 0.37538 train_f1_mac= 0.29068 val_loss= 0.66369 val_f1_mic= 0.37620 val_f1_mac= 0.10690 time= 0.76991
Iter: 0005 train_loss= 0.59536 train_f1_mic= 0.38361 train_f1_mac= 0.09655 val_loss= 0.66369 val_f1_mic= 0.37620 val_f1_mac= 0.10690 time= 0.14012
Iter: 0010 train_loss= 0.56353 train_f1_mic= 0.35690 train_f1_mac= 0.08722 val_loss= 0.66369 val_f1_mic= 0.37620 val_f1_mac= 0.10690 time= 0.08323
Iter: 0015 train_loss= 0.54181 train_f1_mic= 0.38980 train_f1_mac= 0.09999 val_loss= 0.66369 val_f1_mic= 0.37620 val_f1_mac= 0.10690 time= 0.06215
Epoch: 0002
Iter: 0001 train_loss= 0.54610 train_f1_mic= 0.39933 train_f1_mac= 0.10696 val_loss= 0.57115 val_f1_mic= 0.39590 val_f1_mac= 0.11130 time= 0.05229
Iter: 0006 train_loss= 0.54073 train_f1_mic= 0.37665 train_f1_mac= 0.09347 val_loss= 0.57115 val_f1_mic= 0.39590 val_f1_mac= 0.11130 time= 0.04508
Iter: 0011 train_loss= 0.54796 train_f1_mic= 0.36854 train_f1_mac= 0.09377 val_loss= 0.57115 val_f1_mic= 0.39590 val_f1_mac= 0.11130 time= 0.04029
Iter: 0016 train_loss= 0.53052 train_f1_mic= 0.39443 train_f1_mac= 0.10462 val_loss= 0.57115 val_f1_mic= 0.39590 val_f1_mac= 0.11130 time= 0.03663
Epoch: 0003
Iter: 0002 train_loss= 0.53856 train_f1_mic= 0.39977 train_f1_mac= 0.11374 val_loss= 0.56827 val_f1_mic= 0.39304 val_f1_mac= 0.11621 time= 0.03462
Iter: 0007 train_loss= 0.53554 train_f1_mic= 0.37944 train_f1_mac= 0.10861 val_loss= 0.56827 val_f1_mic= 0.39304 val_f1_mac= 0.11621 time= 0.03270
Iter: 0012 train_loss= 0.52766 train_f1_mic= 0.40557 train_f1_mac= 0.12145 val_loss= 0.56827 val_f1_mic= 0.39304 val_f1_mac= 0.11621 time= 0.03110
Iter: 0017 train_loss= 0.51606 train_f1_mic= 0.40839 train_f1_mac= 0.12269 val_loss= 0.56827 val_f1_mic= 0.39304 val_f1_mac= 0.11621 time= 0.02967
Epoch: 0004
Iter: 0003 train_loss= 0.53555 train_f1_mic= 0.41061 train_f1_mac= 0.12818 val_loss= 0.55028 val_f1_mic= 0.40513 val_f1_mac= 0.13234 time= 0.02910
Iter: 0008 train_loss= 0.52875 train_f1_mic= 0.43009 train_f1_mac= 0.13732 val_loss= 0.55028 val_f1_mic= 0.40513 val_f1_mac= 0.13234 time= 0.02802
Iter: 0013 train_loss= 0.51754 train_f1_mic= 0.40077 train_f1_mac= 0.12390 val_loss= 0.55028 val_f1_mic= 0.40513 val_f1_mac= 0.13234 time= 0.02711
Iter: 0018 train_loss= 0.51646 train_f1_mic= 0.43353 train_f1_mac= 0.14664 val_loss= 0.55028 val_f1_mic= 0.40513 val_f1_mac= 0.13234 time= 0.02627
Epoch: 0005
Iter: 0004 train_loss= 0.51189 train_f1_mic= 0.43832 train_f1_mac= 0.15475 val_loss= 0.53625 val_f1_mic= 0.42466 val_f1_mac= 0.14873 time= 0.02581
Iter: 0009 train_loss= 0.51525 train_f1_mic= 0.41555 train_f1_mac= 0.14077 val_loss= 0.53625 val_f1_mic= 0.42466 val_f1_mac= 0.14873 time= 0.02514
Iter: 0014 train_loss= 0.50652 train_f1_mic= 0.44826 train_f1_mac= 0.16526 val_loss= 0.53625 val_f1_mic= 0.42466 val_f1_mac= 0.14873 time= 0.02470
Epoch: 0006
Iter: 0000 train_loss= 0.52419 train_f1_mic= 0.46078 train_f1_mac= 0.19085 val_loss= 0.54050 val_f1_mic= 0.47053 val_f1_mac= 0.19520 time= 0.02440
Iter: 0005 train_loss= 0.52094 train_f1_mic= 0.43787 train_f1_mac= 0.16304 val_loss= 0.54050 val_f1_mic= 0.47053 val_f1_mac= 0.19520 time= 0.02403
Iter: 0010 train_loss= 0.52366 train_f1_mic= 0.45625 train_f1_mac= 0.19046 val_loss= 0.54050 val_f1_mic= 0.47053 val_f1_mac= 0.19520 time= 0.02368
Iter: 0015 train_loss= 0.51638 train_f1_mic= 0.45337 train_f1_mac= 0.18193 val_loss= 0.54050 val_f1_mic= 0.47053 val_f1_mac= 0.19520 time= 0.02328
Epoch: 0007
Iter: 0001 train_loss= 0.50512 train_f1_mic= 0.45366 train_f1_mac= 0.18638 val_loss= 0.54066 val_f1_mic= 0.43520 val_f1_mac= 0.18276 time= 0.02312
Iter: 0006 train_loss= 0.50794 train_f1_mic= 0.45982 train_f1_mac= 0.20138 val_loss= 0.54066 val_f1_mic= 0.43520 val_f1_mac= 0.18276 time= 0.02281
Iter: 0011 train_loss= 0.50594 train_f1_mic= 0.45518 train_f1_mac= 0.19749 val_loss= 0.54066 val_f1_mic= 0.43520 val_f1_mac= 0.18276 time= 0.02253
Iter: 0016 train_loss= 0.52035 train_f1_mic= 0.43673 train_f1_mac= 0.17478 val_loss= 0.54066 val_f1_mic= 0.43520 val_f1_mac= 0.18276 time= 0.02231
Epoch: 0008
Iter: 0002 train_loss= 0.50298 train_f1_mic= 0.46835 train_f1_mac= 0.20870 val_loss= 0.54148 val_f1_mic= 0.48036 val_f1_mac= 0.23530 time= 0.02220
Iter: 0007 train_loss= 0.50368 train_f1_mic= 0.45999 train_f1_mac= 0.20441 val_loss= 0.54148 val_f1_mic= 0.48036 val_f1_mac= 0.23530 time= 0.02194
Iter: 0012 train_loss= 0.50281 train_f1_mic= 0.49647 train_f1_mac= 0.25516 val_loss= 0.54148 val_f1_mic= 0.48036 val_f1_mac= 0.23530 time= 0.02167
Iter: 0017 train_loss= 0.51432 train_f1_mic= 0.48611 train_f1_mac= 0.24676 val_loss= 0.54148 val_f1_mic= 0.48036 val_f1_mac= 0.23530 time= 0.02142
Epoch: 0009
Iter: 0003 train_loss= 0.50694 train_f1_mic= 0.47601 train_f1_mac= 0.23279 val_loss= 0.53091 val_f1_mic= 0.51611 val_f1_mac= 0.29132 time= 0.02149
Iter: 0008 train_loss= 0.50518 train_f1_mic= 0.48562 train_f1_mac= 0.24401 val_loss= 0.53091 val_f1_mic= 0.51611 val_f1_mac= 0.29132 time= 0.02131
Iter: 0013 train_loss= 0.49821 train_f1_mic= 0.48099 train_f1_mac= 0.24592 val_loss= 0.53091 val_f1_mic= 0.51611 val_f1_mac= 0.29132 time= 0.02118
Iter: 0018 train_loss= 0.50534 train_f1_mic= 0.49190 train_f1_mac= 0.26408 val_loss= 0.53091 val_f1_mic= 0.51611 val_f1_mac= 0.29132 time= 0.02097
Epoch: 0010
Iter: 0004 train_loss= 0.49239 train_f1_mic= 0.49109 train_f1_mac= 0.24990 val_loss= 0.53138 val_f1_mic= 0.48791 val_f1_mac= 0.26127 time= 0.02095
Iter: 0009 train_loss= 0.50667 train_f1_mic= 0.46515 train_f1_mac= 0.23397 val_loss= 0.53138 val_f1_mic= 0.48791 val_f1_mac= 0.26127 time= 0.02078
Iter: 0014 train_loss= 0.50290 train_f1_mic= 0.48639 train_f1_mac= 0.25115 val_loss= 0.53138 val_f1_mic= 0.48791 val_f1_mac= 0.26127 time= 0.02061
Optimization Finished!
Full validation stats: loss= 0.51462 f1_micro= 0.50346 f1_macro= 0.28378 time= 0.12569
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4757572407463517
Rewards :  0.03483208599544879 Accuracy :  0.5036229095427107
Total reward :  1.3225219639151886
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03483209]
Trial 330: Controller loss : 136.231949

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 1, 'relu']
2018-08-31 01:08:28.561822: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:08:28.562388: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:08:28.562940: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:08:28.563343: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:08:28.563844: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69253 train_f1_mic= 0.36926 train_f1_mac= 0.30599 val_loss= 0.66908 val_f1_mic= 0.35988 val_f1_mac= 0.11774 time= 1.06512
Iter: 0005 train_loss= 0.58944 train_f1_mic= 0.37278 train_f1_mac= 0.08838 val_loss= 0.66908 val_f1_mic= 0.35988 val_f1_mac= 0.11774 time= 0.23852
Iter: 0010 train_loss= 0.55577 train_f1_mic= 0.39547 train_f1_mac= 0.10378 val_loss= 0.66908 val_f1_mic= 0.35988 val_f1_mac= 0.11774 time= 0.16582
Iter: 0015 train_loss= 0.53424 train_f1_mic= 0.42867 train_f1_mac= 0.11991 val_loss= 0.66908 val_f1_mic= 0.35988 val_f1_mac= 0.11774 time= 0.13737
Epoch: 0002
Iter: 0001 train_loss= 0.54404 train_f1_mic= 0.38961 train_f1_mac= 0.10572 val_loss= 0.55277 val_f1_mic= 0.39015 val_f1_mac= 0.10673 time= 0.12442
Iter: 0006 train_loss= 0.53825 train_f1_mic= 0.37985 train_f1_mac= 0.09978 val_loss= 0.55277 val_f1_mic= 0.39015 val_f1_mac= 0.10673 time= 0.11541
Iter: 0011 train_loss= 0.53981 train_f1_mic= 0.37267 train_f1_mac= 0.09838 val_loss= 0.55277 val_f1_mic= 0.39015 val_f1_mac= 0.10673 time= 0.10860
Iter: 0016 train_loss= 0.53328 train_f1_mic= 0.40283 train_f1_mac= 0.11398 val_loss= 0.55277 val_f1_mic= 0.39015 val_f1_mac= 0.10673 time= 0.10388
Epoch: 0003
Iter: 0002 train_loss= 0.53412 train_f1_mic= 0.39851 train_f1_mac= 0.11324 val_loss= 0.55728 val_f1_mic= 0.38623 val_f1_mac= 0.11695 time= 0.10067
Iter: 0007 train_loss= 0.53254 train_f1_mic= 0.40422 train_f1_mac= 0.12437 val_loss= 0.55728 val_f1_mic= 0.38623 val_f1_mac= 0.11695 time= 0.09782
Iter: 0012 train_loss= 0.52772 train_f1_mic= 0.40588 train_f1_mac= 0.12274 val_loss= 0.55728 val_f1_mic= 0.38623 val_f1_mac= 0.11695 time= 0.09586
Iter: 0017 train_loss= 0.52283 train_f1_mic= 0.43155 train_f1_mac= 0.13323 val_loss= 0.55728 val_f1_mic= 0.38623 val_f1_mac= 0.11695 time= 0.09417
Epoch: 0004
Iter: 0003 train_loss= 0.51766 train_f1_mic= 0.41027 train_f1_mac= 0.12293 val_loss= 0.56040 val_f1_mic= 0.39058 val_f1_mac= 0.12182 time= 0.09286
Iter: 0008 train_loss= 0.52692 train_f1_mic= 0.41619 train_f1_mac= 0.12711 val_loss= 0.56040 val_f1_mic= 0.39058 val_f1_mac= 0.12182 time= 0.09142
Iter: 0013 train_loss= 0.52891 train_f1_mic= 0.43898 train_f1_mac= 0.14404 val_loss= 0.56040 val_f1_mic= 0.39058 val_f1_mac= 0.12182 time= 0.09008
Iter: 0018 train_loss= 0.50639 train_f1_mic= 0.42897 train_f1_mac= 0.13759 val_loss= 0.56040 val_f1_mic= 0.39058 val_f1_mac= 0.12182 time= 0.08901
Epoch: 0005
Iter: 0004 train_loss= 0.51847 train_f1_mic= 0.42976 train_f1_mac= 0.14473 val_loss= 0.53392 val_f1_mic= 0.42857 val_f1_mac= 0.14666 time= 0.08857
Iter: 0009 train_loss= 0.52768 train_f1_mic= 0.42758 train_f1_mac= 0.14774 val_loss= 0.53392 val_f1_mic= 0.42857 val_f1_mac= 0.14666 time= 0.08787
Iter: 0014 train_loss= 0.51164 train_f1_mic= 0.42505 train_f1_mac= 0.13492 val_loss= 0.53392 val_f1_mic= 0.42857 val_f1_mac= 0.14666 time= 0.08714
Epoch: 0006
Iter: 0000 train_loss= 0.51115 train_f1_mic= 0.44916 train_f1_mac= 0.15835 val_loss= 0.52772 val_f1_mic= 0.42882 val_f1_mac= 0.15395 time= 0.08669
Iter: 0005 train_loss= 0.52806 train_f1_mic= 0.43478 train_f1_mac= 0.16439 val_loss= 0.52772 val_f1_mic= 0.42882 val_f1_mac= 0.15395 time= 0.08618
Iter: 0010 train_loss= 0.52338 train_f1_mic= 0.43175 train_f1_mac= 0.15564 val_loss= 0.52772 val_f1_mic= 0.42882 val_f1_mac= 0.15395 time= 0.08570
Iter: 0015 train_loss= 0.52270 train_f1_mic= 0.44473 train_f1_mac= 0.17051 val_loss= 0.52772 val_f1_mic= 0.42882 val_f1_mac= 0.15395 time= 0.08527
Epoch: 0007
Iter: 0001 train_loss= 0.51268 train_f1_mic= 0.44808 train_f1_mac= 0.16637 val_loss= 0.52870 val_f1_mic= 0.45361 val_f1_mac= 0.17216 time= 0.08517
Iter: 0006 train_loss= 0.52925 train_f1_mic= 0.43637 train_f1_mac= 0.16243 val_loss= 0.52870 val_f1_mic= 0.45361 val_f1_mac= 0.17216 time= 0.08472
Iter: 0011 train_loss= 0.51626 train_f1_mic= 0.45161 train_f1_mac= 0.18214 val_loss= 0.52870 val_f1_mic= 0.45361 val_f1_mac= 0.17216 time= 0.08434
Iter: 0016 train_loss= 0.51512 train_f1_mic= 0.43929 train_f1_mac= 0.16907 val_loss= 0.52870 val_f1_mic= 0.45361 val_f1_mac= 0.17216 time= 0.08397
Epoch: 0008
Iter: 0002 train_loss= 0.51191 train_f1_mic= 0.45486 train_f1_mac= 0.18867 val_loss= 0.55403 val_f1_mic= 0.44526 val_f1_mac= 0.18884 time= 0.08377
Iter: 0007 train_loss= 0.52785 train_f1_mic= 0.46541 train_f1_mac= 0.19258 val_loss= 0.55403 val_f1_mic= 0.44526 val_f1_mac= 0.18884 time= 0.08338
Iter: 0012 train_loss= 0.52097 train_f1_mic= 0.43822 train_f1_mac= 0.17587 val_loss= 0.55403 val_f1_mic= 0.44526 val_f1_mac= 0.18884 time= 0.08305
Iter: 0017 train_loss= 0.51666 train_f1_mic= 0.43709 train_f1_mac= 0.18058 val_loss= 0.55403 val_f1_mic= 0.44526 val_f1_mac= 0.18884 time= 0.08272
Epoch: 0009
Iter: 0003 train_loss= 0.51819 train_f1_mic= 0.46328 train_f1_mac= 0.20413 val_loss= 0.51353 val_f1_mic= 0.45313 val_f1_mac= 0.19750 time= 0.08273
Iter: 0008 train_loss= 0.51411 train_f1_mic= 0.44827 train_f1_mac= 0.18327 val_loss= 0.51353 val_f1_mic= 0.45313 val_f1_mac= 0.19750 time= 0.08252
Iter: 0013 train_loss= 0.51868 train_f1_mic= 0.44871 train_f1_mac= 0.17715 val_loss= 0.51353 val_f1_mic= 0.45313 val_f1_mac= 0.19750 time= 0.08228
Iter: 0018 train_loss= 0.52344 train_f1_mic= 0.45782 train_f1_mac= 0.19223 val_loss= 0.51353 val_f1_mic= 0.45313 val_f1_mac= 0.19750 time= 0.08208
Epoch: 0010
Iter: 0004 train_loss= 0.51809 train_f1_mic= 0.43385 train_f1_mac= 0.17252 val_loss= 0.52326 val_f1_mic= 0.49207 val_f1_mac= 0.22810 time= 0.08213
Iter: 0009 train_loss= 0.50839 train_f1_mic= 0.46029 train_f1_mac= 0.20498 val_loss= 0.52326 val_f1_mic= 0.49207 val_f1_mac= 0.22810 time= 0.08189
Iter: 0014 train_loss= 0.50493 train_f1_mic= 0.48164 train_f1_mac= 0.22357 val_loss= 0.52326 val_f1_mic= 0.49207 val_f1_mac= 0.22810 time= 0.08172
Optimization Finished!
Full validation stats: loss= 0.52737 f1_micro= 0.50587 f1_macro= 0.24877 time= 0.14960
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.480762399724822
Rewards :  0.025025794892351405 Accuracy :  0.5007830356387031
Total reward :  1.34754775880754
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 1, 'relu']
Training RNN (Reward ip) :  [0.02502579]
Trial 331: Controller loss : 9451.981445

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 4. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:08:50.389448: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:08:50.389977: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:08:50.390498: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:08:50.390890: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:08:50.391360: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69278 train_f1_mic= 0.34940 train_f1_mac= 0.27776 val_loss= 0.66503 val_f1_mic= 0.36976 val_f1_mac= 0.10281 time= 0.76580
Iter: 0005 train_loss= 0.58654 train_f1_mic= 0.38092 train_f1_mac= 0.09189 val_loss= 0.66503 val_f1_mic= 0.36976 val_f1_mac= 0.10281 time= 0.14125
Iter: 0010 train_loss= 0.55537 train_f1_mic= 0.36668 train_f1_mac= 0.08822 val_loss= 0.66503 val_f1_mic= 0.36976 val_f1_mac= 0.10281 time= 0.08375
Iter: 0015 train_loss= 0.53169 train_f1_mic= 0.41624 train_f1_mac= 0.10839 val_loss= 0.66503 val_f1_mic= 0.36976 val_f1_mac= 0.10281 time= 0.06244
Epoch: 0002
Iter: 0001 train_loss= 0.53046 train_f1_mic= 0.39518 train_f1_mac= 0.09973 val_loss= 0.56884 val_f1_mic= 0.37970 val_f1_mac= 0.10321 time= 0.05270
Iter: 0006 train_loss= 0.53766 train_f1_mic= 0.37134 train_f1_mac= 0.09024 val_loss= 0.56884 val_f1_mic= 0.37970 val_f1_mac= 0.10321 time= 0.04540
Iter: 0011 train_loss= 0.53594 train_f1_mic= 0.37832 train_f1_mac= 0.09494 val_loss= 0.56884 val_f1_mic= 0.37970 val_f1_mac= 0.10321 time= 0.04062
Iter: 0016 train_loss= 0.56213 train_f1_mic= 0.37677 train_f1_mac= 0.10380 val_loss= 0.56884 val_f1_mic= 0.37970 val_f1_mac= 0.10321 time= 0.03703
Epoch: 0003
Iter: 0002 train_loss= 0.53076 train_f1_mic= 0.41243 train_f1_mac= 0.11726 val_loss= 0.56283 val_f1_mic= 0.40161 val_f1_mac= 0.12191 time= 0.03468
Iter: 0007 train_loss= 0.52501 train_f1_mic= 0.39059 train_f1_mac= 0.11127 val_loss= 0.56283 val_f1_mic= 0.40161 val_f1_mac= 0.12191 time= 0.03247
Iter: 0012 train_loss= 0.52909 train_f1_mic= 0.40191 train_f1_mac= 0.11825 val_loss= 0.56283 val_f1_mic= 0.40161 val_f1_mac= 0.12191 time= 0.03067
Iter: 0017 train_loss= 0.52303 train_f1_mic= 0.39822 train_f1_mac= 0.11644 val_loss= 0.56283 val_f1_mic= 0.40161 val_f1_mac= 0.12191 time= 0.02922
Epoch: 0004
Iter: 0003 train_loss= 0.51918 train_f1_mic= 0.42985 train_f1_mac= 0.13478 val_loss= 0.57422 val_f1_mic= 0.40577 val_f1_mac= 0.13560 time= 0.02854
Iter: 0008 train_loss= 0.51729 train_f1_mic= 0.44260 train_f1_mac= 0.14463 val_loss= 0.57422 val_f1_mic= 0.40577 val_f1_mac= 0.13560 time= 0.02743
Iter: 0013 train_loss= 0.51752 train_f1_mic= 0.42215 train_f1_mac= 0.14051 val_loss= 0.57422 val_f1_mic= 0.40577 val_f1_mac= 0.13560 time= 0.02668
Iter: 0018 train_loss= 0.52468 train_f1_mic= 0.42126 train_f1_mac= 0.14120 val_loss= 0.57422 val_f1_mic= 0.40577 val_f1_mac= 0.13560 time= 0.02586
Epoch: 0005
Iter: 0004 train_loss= 0.51973 train_f1_mic= 0.44572 train_f1_mac= 0.16372 val_loss= 0.53093 val_f1_mic= 0.42303 val_f1_mac= 0.15204 time= 0.02532
Iter: 0009 train_loss= 0.51513 train_f1_mic= 0.43701 train_f1_mac= 0.15560 val_loss= 0.53093 val_f1_mic= 0.42303 val_f1_mac= 0.15204 time= 0.02474
Iter: 0014 train_loss= 0.52642 train_f1_mic= 0.44479 train_f1_mac= 0.17269 val_loss= 0.53093 val_f1_mic= 0.42303 val_f1_mac= 0.15204 time= 0.02422
Epoch: 0006
Iter: 0000 train_loss= 0.51335 train_f1_mic= 0.46010 train_f1_mac= 0.18472 val_loss= 0.52989 val_f1_mic= 0.45817 val_f1_mac= 0.19319 time= 0.02414
Iter: 0005 train_loss= 0.50828 train_f1_mic= 0.43096 train_f1_mac= 0.16468 val_loss= 0.52989 val_f1_mic= 0.45817 val_f1_mac= 0.19319 time= 0.02368
Iter: 0010 train_loss= 0.51818 train_f1_mic= 0.46604 train_f1_mac= 0.19693 val_loss= 0.52989 val_f1_mic= 0.45817 val_f1_mac= 0.19319 time= 0.02330
Iter: 0015 train_loss= 0.50244 train_f1_mic= 0.45029 train_f1_mac= 0.18238 val_loss= 0.52989 val_f1_mic= 0.45817 val_f1_mac= 0.19319 time= 0.02296
Epoch: 0007
Iter: 0001 train_loss= 0.51323 train_f1_mic= 0.41945 train_f1_mac= 0.16728 val_loss= 0.53876 val_f1_mic= 0.41827 val_f1_mac= 0.17165 time= 0.02287
Iter: 0006 train_loss= 0.50764 train_f1_mic= 0.46835 train_f1_mac= 0.20946 val_loss= 0.53876 val_f1_mic= 0.41827 val_f1_mac= 0.17165 time= 0.02254
Iter: 0011 train_loss= 0.50974 train_f1_mic= 0.47915 train_f1_mac= 0.22199 val_loss= 0.53876 val_f1_mic= 0.41827 val_f1_mac= 0.17165 time= 0.02228
Iter: 0016 train_loss= 0.50072 train_f1_mic= 0.46839 train_f1_mac= 0.20810 val_loss= 0.53876 val_f1_mic= 0.41827 val_f1_mac= 0.17165 time= 0.02201
Epoch: 0008
Iter: 0002 train_loss= 0.50090 train_f1_mic= 0.45531 train_f1_mac= 0.20194 val_loss= 0.53623 val_f1_mic= 0.49237 val_f1_mac= 0.25481 time= 0.02188
Iter: 0007 train_loss= 0.49805 train_f1_mic= 0.48140 train_f1_mac= 0.23807 val_loss= 0.53623 val_f1_mic= 0.49237 val_f1_mac= 0.25481 time= 0.02162
Iter: 0012 train_loss= 0.51741 train_f1_mic= 0.48954 train_f1_mac= 0.24347 val_loss= 0.53623 val_f1_mic= 0.49237 val_f1_mac= 0.25481 time= 0.02142
Iter: 0017 train_loss= 0.52064 train_f1_mic= 0.46201 train_f1_mac= 0.21911 val_loss= 0.53623 val_f1_mic= 0.49237 val_f1_mac= 0.25481 time= 0.02118
Epoch: 0009
Iter: 0003 train_loss= 0.48738 train_f1_mic= 0.48108 train_f1_mac= 0.24452 val_loss= 0.50937 val_f1_mic= 0.50134 val_f1_mac= 0.26468 time= 0.02123
Iter: 0008 train_loss= 0.50707 train_f1_mic= 0.47392 train_f1_mac= 0.24290 val_loss= 0.50937 val_f1_mic= 0.50134 val_f1_mac= 0.26468 time= 0.02104
Iter: 0013 train_loss= 0.50691 train_f1_mic= 0.47991 train_f1_mac= 0.25101 val_loss= 0.50937 val_f1_mic= 0.50134 val_f1_mac= 0.26468 time= 0.02083
Iter: 0018 train_loss= 0.50514 train_f1_mic= 0.48369 train_f1_mac= 0.24919 val_loss= 0.50937 val_f1_mic= 0.50134 val_f1_mac= 0.26468 time= 0.02062
Epoch: 0010
Iter: 0004 train_loss= 0.49921 train_f1_mic= 0.46833 train_f1_mac= 0.23224 val_loss= 0.53109 val_f1_mic= 0.50378 val_f1_mac= 0.26681 time= 0.02056
Iter: 0009 train_loss= 0.50018 train_f1_mic= 0.47564 train_f1_mac= 0.24191 val_loss= 0.53109 val_f1_mic= 0.50378 val_f1_mac= 0.26681 time= 0.02046
Iter: 0014 train_loss= 0.49593 train_f1_mic= 0.50331 train_f1_mac= 0.27285 val_loss= 0.53109 val_f1_mic= 0.50378 val_f1_mac= 0.26681 time= 0.02031
Optimization Finished!
Full validation stats: loss= 0.51315 f1_micro= 0.51606 f1_macro= 0.28970 time= 0.13262
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.48686383534317423
Rewards :  0.030507178091761455 Accuracy :  0.5112695778165834
Total reward :  1.3780549368993014
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03050718]
Trial 332: Controller loss : 135.956757
2018-08-31 01:08:59.833286: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:08:59.833841: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'sigmoid', 1, 'linear']
core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:08:59.834626: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:08:59.834987: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:08:59.835491: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69417 train_f1_mic= 0.37054 train_f1_mac= 0.24877 val_loss= 0.66328 val_f1_mic= 0.37342 val_f1_mac= 0.10283 time= 1.04623
Iter: 0005 train_loss= 0.58749 train_f1_mic= 0.39597 train_f1_mac= 0.10136 val_loss= 0.66328 val_f1_mic= 0.37342 val_f1_mac= 0.10283 time= 0.21841
Iter: 0010 train_loss= 0.54498 train_f1_mic= 0.37870 train_f1_mac= 0.09178 val_loss= 0.66328 val_f1_mic= 0.37342 val_f1_mac= 0.10283 time= 0.14316
Iter: 0015 train_loss= 0.52885 train_f1_mic= 0.37604 train_f1_mac= 0.08642 val_loss= 0.66328 val_f1_mic= 0.37342 val_f1_mac= 0.10283 time= 0.11606
Epoch: 0002
Iter: 0001 train_loss= 0.54124 train_f1_mic= 0.39780 train_f1_mac= 0.09856 val_loss= 0.58094 val_f1_mic= 0.37847 val_f1_mac= 0.10083 time= 0.10296
Iter: 0006 train_loss= 0.54912 train_f1_mic= 0.38507 train_f1_mac= 0.09487 val_loss= 0.58094 val_f1_mic= 0.37847 val_f1_mac= 0.10083 time= 0.09378
Iter: 0011 train_loss= 0.53477 train_f1_mic= 0.37898 train_f1_mac= 0.08813 val_loss= 0.58094 val_f1_mic= 0.37847 val_f1_mac= 0.10083 time= 0.08740
Iter: 0016 train_loss= 0.54910 train_f1_mic= 0.38125 train_f1_mac= 0.09410 val_loss= 0.58094 val_f1_mic= 0.37847 val_f1_mac= 0.10083 time= 0.08274
Epoch: 0003
Iter: 0002 train_loss= 0.53349 train_f1_mic= 0.40832 train_f1_mac= 0.10333 val_loss= 0.55791 val_f1_mic= 0.38744 val_f1_mac= 0.09802 time= 0.08034
Iter: 0007 train_loss= 0.53796 train_f1_mic= 0.39477 train_f1_mac= 0.09817 val_loss= 0.55791 val_f1_mic= 0.38744 val_f1_mac= 0.09802 time= 0.07742
Iter: 0012 train_loss= 0.54929 train_f1_mic= 0.36469 train_f1_mac= 0.08923 val_loss= 0.55791 val_f1_mic= 0.38744 val_f1_mac= 0.09802 time= 0.07507
Iter: 0017 train_loss= 0.54542 train_f1_mic= 0.37482 train_f1_mac= 0.09313 val_loss= 0.55791 val_f1_mic= 0.38744 val_f1_mac= 0.09802 time= 0.07310
Epoch: 0004
Iter: 0003 train_loss= 0.53486 train_f1_mic= 0.39015 train_f1_mac= 0.10244 val_loss= 0.56181 val_f1_mic= 0.38379 val_f1_mac= 0.10182 time= 0.07215
Iter: 0008 train_loss= 0.54025 train_f1_mic= 0.40079 train_f1_mac= 0.12015 val_loss= 0.56181 val_f1_mic= 0.38379 val_f1_mac= 0.10182 time= 0.07073
Iter: 0013 train_loss= 0.53751 train_f1_mic= 0.43375 train_f1_mac= 0.13943 val_loss= 0.56181 val_f1_mic= 0.38379 val_f1_mac= 0.10182 time= 0.06992
Iter: 0018 train_loss= 0.53923 train_f1_mic= 0.39178 train_f1_mac= 0.11285 val_loss= 0.56181 val_f1_mic= 0.38379 val_f1_mac= 0.10182 time= 0.06921
Epoch: 0005
Iter: 0004 train_loss= 0.53353 train_f1_mic= 0.41409 train_f1_mac= 0.12957 val_loss= 0.52773 val_f1_mic= 0.39916 val_f1_mac= 0.11781 time= 0.06907
Iter: 0009 train_loss= 0.52841 train_f1_mic= 0.41789 train_f1_mac= 0.12801 val_loss= 0.52773 val_f1_mic= 0.39916 val_f1_mac= 0.11781 time= 0.06823
Iter: 0014 train_loss= 0.53499 train_f1_mic= 0.41065 train_f1_mac= 0.13072 val_loss= 0.52773 val_f1_mic= 0.39916 val_f1_mac= 0.11781 time= 0.06749
Epoch: 0006
Iter: 0000 train_loss= 0.54315 train_f1_mic= 0.40727 train_f1_mac= 0.12862 val_loss= 0.55727 val_f1_mic= 0.41479 val_f1_mac= 0.13939 time= 0.06727
Iter: 0005 train_loss= 0.53234 train_f1_mic= 0.41533 train_f1_mac= 0.13658 val_loss= 0.55727 val_f1_mic= 0.41479 val_f1_mac= 0.13939 time= 0.06660
Iter: 0010 train_loss= 0.52729 train_f1_mic= 0.41912 train_f1_mac= 0.14410 val_loss= 0.55727 val_f1_mic= 0.41479 val_f1_mac= 0.13939 time= 0.06596
Iter: 0015 train_loss= 0.52109 train_f1_mic= 0.40273 train_f1_mac= 0.12364 val_loss= 0.55727 val_f1_mic= 0.41479 val_f1_mac= 0.13939 time= 0.06547
Epoch: 0007
Iter: 0001 train_loss= 0.54011 train_f1_mic= 0.42442 train_f1_mac= 0.14672 val_loss= 0.57812 val_f1_mic= 0.41350 val_f1_mac= 0.15368 time= 0.06526
Iter: 0006 train_loss= 0.52848 train_f1_mic= 0.39974 train_f1_mac= 0.12763 val_loss= 0.57812 val_f1_mic= 0.41350 val_f1_mac= 0.15368 time= 0.06508
Iter: 0011 train_loss= 0.51533 train_f1_mic= 0.43645 train_f1_mac= 0.15424 val_loss= 0.57812 val_f1_mic= 0.41350 val_f1_mac= 0.15368 time= 0.06467
Iter: 0016 train_loss= 0.52554 train_f1_mic= 0.43731 train_f1_mac= 0.16088 val_loss= 0.57812 val_f1_mic= 0.41350 val_f1_mac= 0.15368 time= 0.06425
Epoch: 0008
Iter: 0002 train_loss= 0.51856 train_f1_mic= 0.43031 train_f1_mac= 0.15341 val_loss= 0.58088 val_f1_mic= 0.40859 val_f1_mac= 0.15269 time= 0.06421
Iter: 0007 train_loss= 0.53844 train_f1_mic= 0.41373 train_f1_mac= 0.15251 val_loss= 0.58088 val_f1_mic= 0.40859 val_f1_mac= 0.15269 time= 0.06393
Iter: 0012 train_loss= 0.52573 train_f1_mic= 0.43876 train_f1_mac= 0.16075 val_loss= 0.58088 val_f1_mic= 0.40859 val_f1_mac= 0.15269 time= 0.06357
Iter: 0017 train_loss= 0.50826 train_f1_mic= 0.45232 train_f1_mac= 0.17195 val_loss= 0.58088 val_f1_mic= 0.40859 val_f1_mac= 0.15269 time= 0.06335
Epoch: 0009
Iter: 0003 train_loss= 0.53015 train_f1_mic= 0.44520 train_f1_mac= 0.18435 val_loss= 0.56984 val_f1_mic= 0.37865 val_f1_mac= 0.12772 time= 0.06327
Iter: 0008 train_loss= 0.53250 train_f1_mic= 0.40584 train_f1_mac= 0.13830 val_loss= 0.56984 val_f1_mic= 0.37865 val_f1_mac= 0.12772 time= 0.06296
Iter: 0013 train_loss= 0.51827 train_f1_mic= 0.46226 train_f1_mac= 0.18221 val_loss= 0.56984 val_f1_mic= 0.37865 val_f1_mac= 0.12772 time= 0.06274
Iter: 0018 train_loss= 0.52410 train_f1_mic= 0.42104 train_f1_mac= 0.14962 val_loss= 0.56984 val_f1_mic= 0.37865 val_f1_mac= 0.12772 time= 0.06257
Epoch: 0010
Iter: 0004 train_loss= 0.52153 train_f1_mic= 0.42028 train_f1_mac= 0.15233 val_loss= 0.54820 val_f1_mic= 0.45353 val_f1_mac= 0.19416 time= 0.06250
Iter: 0009 train_loss= 0.52389 train_f1_mic= 0.45752 train_f1_mac= 0.19175 val_loss= 0.54820 val_f1_mic= 0.45353 val_f1_mac= 0.19416 time= 0.06224
Iter: 0014 train_loss= 0.52755 train_f1_mic= 0.41339 train_f1_mac= 0.15253 val_loss= 0.54820 val_f1_mic= 0.45353 val_f1_mac= 0.19416 time= 0.06203
Optimization Finished!
Full validation stats: loss= 0.53944 f1_micro= 0.46958 f1_macro= 0.21978 time= 0.14362
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4833093915579473
Rewards :  -0.017772218926134786 Accuracy :  0.46909161641703945
Total reward :  1.3602827179731665
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'sigmoid', 1, 'linear']
Training RNN (Reward ip) :  [-0.01777222]
Trial 333: Controller loss : 9015.251953
2018-08-31 01:09:17.847670: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:09:17.847910: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:09:17.848137: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:09:17.848307: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:09:17.848518: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 0, 'tanh']
Epoch: 0001
Iter: 0000 train_loss= 0.69620 train_f1_mic= 0.37417 train_f1_mac= 0.30407 val_loss= 0.67438 val_f1_mic= 0.35282 val_f1_mac= 0.12621 time= 0.85990
Iter: 0005 train_loss= 0.58652 train_f1_mic= 0.40275 train_f1_mac= 0.10423 val_loss= 0.67438 val_f1_mic= 0.35282 val_f1_mac= 0.12621 time= 0.19383
Iter: 0010 train_loss= 0.53887 train_f1_mic= 0.37088 train_f1_mac= 0.08605 val_loss= 0.67438 val_f1_mic= 0.35282 val_f1_mac= 0.12621 time= 0.13338
Iter: 0015 train_loss= 0.54975 train_f1_mic= 0.35423 train_f1_mac= 0.08199 val_loss= 0.67438 val_f1_mic= 0.35282 val_f1_mac= 0.12621 time= 0.11046
Epoch: 0002
Iter: 0001 train_loss= 0.55583 train_f1_mic= 0.40467 train_f1_mac= 0.10454 val_loss= 0.57183 val_f1_mic= 0.39899 val_f1_mac= 0.10585 time= 0.09983
Iter: 0006 train_loss= 0.56846 train_f1_mic= 0.37802 train_f1_mac= 0.09498 val_loss= 0.57183 val_f1_mic= 0.39899 val_f1_mac= 0.10585 time= 0.09221
Iter: 0011 train_loss= 0.54451 train_f1_mic= 0.37923 train_f1_mac= 0.09237 val_loss= 0.57183 val_f1_mic= 0.39899 val_f1_mac= 0.10585 time= 0.08702
Iter: 0016 train_loss= 0.53983 train_f1_mic= 0.38335 train_f1_mac= 0.09264 val_loss= 0.57183 val_f1_mic= 0.39899 val_f1_mac= 0.10585 time= 0.08336
Epoch: 0003
Iter: 0002 train_loss= 0.54758 train_f1_mic= 0.39165 train_f1_mac= 0.09884 val_loss= 0.55997 val_f1_mic= 0.38561 val_f1_mac= 0.09955 time= 0.08112
Iter: 0007 train_loss= 0.54986 train_f1_mic= 0.36699 train_f1_mac= 0.08793 val_loss= 0.55997 val_f1_mic= 0.38561 val_f1_mac= 0.09955 time= 0.07885
Iter: 0012 train_loss= 0.54248 train_f1_mic= 0.37572 train_f1_mac= 0.09158 val_loss= 0.55997 val_f1_mic= 0.38561 val_f1_mac= 0.09955 time= 0.07705
Iter: 0017 train_loss= 0.55371 train_f1_mic= 0.36913 train_f1_mac= 0.08936 val_loss= 0.55997 val_f1_mic= 0.38561 val_f1_mac= 0.09955 time= 0.07549
Epoch: 0004
Iter: 0003 train_loss= 0.54994 train_f1_mic= 0.38479 train_f1_mac= 0.09770 val_loss= 0.56768 val_f1_mic= 0.37241 val_f1_mac= 0.09507 time= 0.07454
Iter: 0008 train_loss= 0.54396 train_f1_mic= 0.38026 train_f1_mac= 0.09283 val_loss= 0.56768 val_f1_mic= 0.37241 val_f1_mac= 0.09507 time= 0.07344
Iter: 0013 train_loss= 0.53771 train_f1_mic= 0.37440 train_f1_mac= 0.08791 val_loss= 0.56768 val_f1_mic= 0.37241 val_f1_mac= 0.09507 time= 0.07249
Iter: 0018 train_loss= 0.53895 train_f1_mic= 0.37835 train_f1_mac= 0.09147 val_loss= 0.56768 val_f1_mic= 0.37241 val_f1_mac= 0.09507 time= 0.07169
Epoch: 0005
Iter: 0004 train_loss= 0.53977 train_f1_mic= 0.36598 train_f1_mac= 0.08625 val_loss= 0.55365 val_f1_mic= 0.36069 val_f1_mac= 0.08753 time= 0.07132
Iter: 0009 train_loss= 0.55008 train_f1_mic= 0.38823 train_f1_mac= 0.09854 val_loss= 0.55365 val_f1_mic= 0.36069 val_f1_mac= 0.08753 time= 0.07067
Iter: 0014 train_loss= 0.54428 train_f1_mic= 0.38130 train_f1_mac= 0.09318 val_loss= 0.55365 val_f1_mic= 0.36069 val_f1_mac= 0.08753 time= 0.07008
Epoch: 0006
Iter: 0000 train_loss= 0.56629 train_f1_mic= 0.35642 train_f1_mac= 0.08907 val_loss= 0.57387 val_f1_mic= 0.36901 val_f1_mac= 0.09620 time= 0.06975
Iter: 0005 train_loss= 0.53568 train_f1_mic= 0.41594 train_f1_mac= 0.10460 val_loss= 0.57387 val_f1_mic= 0.36901 val_f1_mac= 0.09620 time= 0.06929
Iter: 0010 train_loss= 0.53764 train_f1_mic= 0.39516 train_f1_mac= 0.09756 val_loss= 0.57387 val_f1_mic= 0.36901 val_f1_mac= 0.09620 time= 0.06884
Iter: 0015 train_loss= 0.54643 train_f1_mic= 0.36706 train_f1_mac= 0.08735 val_loss= 0.57387 val_f1_mic= 0.36901 val_f1_mac= 0.09620 time= 0.06845
Epoch: 0007
Iter: 0001 train_loss= 0.55370 train_f1_mic= 0.38945 train_f1_mac= 0.09948 val_loss= 0.56320 val_f1_mic= 0.37725 val_f1_mac= 0.09846 time= 0.06825
Iter: 0006 train_loss= 0.53047 train_f1_mic= 0.40395 train_f1_mac= 0.09816 val_loss= 0.56320 val_f1_mic= 0.37725 val_f1_mac= 0.09846 time= 0.06792
Iter: 0011 train_loss= 0.53677 train_f1_mic= 0.37276 train_f1_mac= 0.08724 val_loss= 0.56320 val_f1_mic= 0.37725 val_f1_mac= 0.09846 time= 0.06763
Iter: 0016 train_loss= 0.54317 train_f1_mic= 0.37858 train_f1_mac= 0.09240 val_loss= 0.56320 val_f1_mic= 0.37725 val_f1_mac= 0.09846 time= 0.06733
Epoch: 0008
Iter: 0002 train_loss= 0.54186 train_f1_mic= 0.39227 train_f1_mac= 0.09768 val_loss= 0.56825 val_f1_mic= 0.39103 val_f1_mac= 0.10299 time= 0.06721
Iter: 0007 train_loss= 0.54468 train_f1_mic= 0.37901 train_f1_mac= 0.09266 val_loss= 0.56825 val_f1_mic= 0.39103 val_f1_mac= 0.10299 time= 0.06694
Iter: 0012 train_loss= 0.55100 train_f1_mic= 0.38089 train_f1_mac= 0.09405 val_loss= 0.56825 val_f1_mic= 0.39103 val_f1_mac= 0.10299 time= 0.06672
Iter: 0017 train_loss= 0.53654 train_f1_mic= 0.39591 train_f1_mac= 0.09761 val_loss= 0.56825 val_f1_mic= 0.39103 val_f1_mac= 0.10299 time= 0.06651
Epoch: 0009
Iter: 0003 train_loss= 0.53516 train_f1_mic= 0.37385 train_f1_mac= 0.08703 val_loss= 0.56149 val_f1_mic= 0.36012 val_f1_mac= 0.08898 time= 0.06643
Iter: 0008 train_loss= 0.54255 train_f1_mic= 0.37889 train_f1_mac= 0.09208 val_loss= 0.56149 val_f1_mic= 0.36012 val_f1_mac= 0.08898 time= 0.06624
Iter: 0013 train_loss= 0.55629 train_f1_mic= 0.38735 train_f1_mac= 0.09969 val_loss= 0.56149 val_f1_mic= 0.36012 val_f1_mac= 0.08898 time= 0.06605
Iter: 0018 train_loss= 0.53887 train_f1_mic= 0.38732 train_f1_mac= 0.09330 val_loss= 0.56149 val_f1_mic= 0.36012 val_f1_mac= 0.08898 time= 0.06588
Epoch: 0010
Iter: 0004 train_loss= 0.53524 train_f1_mic= 0.38564 train_f1_mac= 0.09229 val_loss= 0.56153 val_f1_mic= 0.38116 val_f1_mac= 0.09643 time= 0.06589
Iter: 0009 train_loss= 0.54376 train_f1_mic= 0.37969 train_f1_mac= 0.09244 val_loss= 0.56153 val_f1_mic= 0.38116 val_f1_mac= 0.09643 time= 0.06574
Iter: 0014 train_loss= 0.53704 train_f1_mic= 0.38496 train_f1_mac= 0.09235 val_loss= 0.56153 val_f1_mic= 0.38116 val_f1_mac= 0.09643 time= 0.06558
Optimization Finished!
Full validation stats: loss= 0.56519 f1_micro= 0.35928 f1_macro= 0.08948 time= 0.11171
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46032702218575366
Rewards :  -0.1 Accuracy :  0.3683975446969794
Total reward :  1.2602827179731664
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 0, 'tanh']
Training RNN (Reward ip) :  [-0.1]
Trial 334: Controller loss : 10901.326172

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [4, 'relu', 1, 'tanh']
2018-08-31 01:09:35.555428: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:09:35.555740: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:09:35.556039: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:09:35.556263: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:09:35.556538: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69258 train_f1_mic= 0.37371 train_f1_mac= 0.32482 val_loss= 0.66286 val_f1_mic= 0.41962 val_f1_mac= 0.14296 time= 0.96152
Iter: 0005 train_loss= 0.57778 train_f1_mic= 0.37697 train_f1_mac= 0.09218 val_loss= 0.66286 val_f1_mic= 0.41962 val_f1_mac= 0.14296 time= 0.18635
Iter: 0010 train_loss= 0.54259 train_f1_mic= 0.39020 train_f1_mac= 0.09728 val_loss= 0.66286 val_f1_mic= 0.41962 val_f1_mac= 0.14296 time= 0.11398
Iter: 0015 train_loss= 0.54762 train_f1_mic= 0.36870 train_f1_mac= 0.08832 val_loss= 0.66286 val_f1_mic= 0.41962 val_f1_mac= 0.14296 time= 0.08678
Epoch: 0002
Iter: 0001 train_loss= 0.54141 train_f1_mic= 0.36591 train_f1_mac= 0.08637 val_loss= 0.55768 val_f1_mic= 0.35921 val_f1_mac= 0.08760 time= 0.07410
Iter: 0006 train_loss= 0.53938 train_f1_mic= 0.39347 train_f1_mac= 0.09788 val_loss= 0.55768 val_f1_mic= 0.35921 val_f1_mac= 0.08760 time= 0.06579
Iter: 0011 train_loss= 0.55073 train_f1_mic= 0.38699 train_f1_mac= 0.10039 val_loss= 0.55768 val_f1_mic= 0.35921 val_f1_mac= 0.08760 time= 0.06020
Iter: 0016 train_loss= 0.53210 train_f1_mic= 0.38317 train_f1_mac= 0.10132 val_loss= 0.55768 val_f1_mic= 0.35921 val_f1_mac= 0.08760 time= 0.05558
Epoch: 0003
Iter: 0002 train_loss= 0.53311 train_f1_mic= 0.40063 train_f1_mac= 0.11140 val_loss= 0.53772 val_f1_mic= 0.39358 val_f1_mac= 0.11076 time= 0.05311
Iter: 0007 train_loss= 0.53763 train_f1_mic= 0.42415 train_f1_mac= 0.13139 val_loss= 0.53772 val_f1_mic= 0.39358 val_f1_mac= 0.11076 time= 0.05061
Iter: 0012 train_loss= 0.52807 train_f1_mic= 0.41010 train_f1_mac= 0.12495 val_loss= 0.53772 val_f1_mic= 0.39358 val_f1_mac= 0.11076 time= 0.04872
Iter: 0017 train_loss= 0.53239 train_f1_mic= 0.40935 train_f1_mac= 0.12414 val_loss= 0.53772 val_f1_mic= 0.39358 val_f1_mac= 0.11076 time= 0.04686
Epoch: 0004
Iter: 0003 train_loss= 0.53890 train_f1_mic= 0.40795 train_f1_mac= 0.12567 val_loss= 0.54262 val_f1_mic= 0.41435 val_f1_mac= 0.13877 time= 0.04544
Iter: 0008 train_loss= 0.54328 train_f1_mic= 0.41795 train_f1_mac= 0.13851 val_loss= 0.54262 val_f1_mic= 0.41435 val_f1_mac= 0.13877 time= 0.04385
Iter: 0013 train_loss= 0.53639 train_f1_mic= 0.41726 train_f1_mac= 0.13662 val_loss= 0.54262 val_f1_mic= 0.41435 val_f1_mac= 0.13877 time= 0.04246
Iter: 0018 train_loss= 0.53262 train_f1_mic= 0.42282 train_f1_mac= 0.14885 val_loss= 0.54262 val_f1_mic= 0.41435 val_f1_mac= 0.13877 time= 0.04125
Epoch: 0005
Iter: 0004 train_loss= 0.53179 train_f1_mic= 0.42482 train_f1_mac= 0.15296 val_loss= 0.54987 val_f1_mic= 0.42861 val_f1_mac= 0.17027 time= 0.04081
Iter: 0009 train_loss= 0.53509 train_f1_mic= 0.42777 train_f1_mac= 0.15285 val_loss= 0.54987 val_f1_mic= 0.42861 val_f1_mac= 0.17027 time= 0.03986
Iter: 0014 train_loss= 0.52595 train_f1_mic= 0.42999 train_f1_mac= 0.16015 val_loss= 0.54987 val_f1_mic= 0.42861 val_f1_mac= 0.17027 time= 0.03907
Epoch: 0006
Iter: 0000 train_loss= 0.52084 train_f1_mic= 0.43554 train_f1_mac= 0.15844 val_loss= 0.57254 val_f1_mic= 0.41515 val_f1_mac= 0.15781 time= 0.03876
Iter: 0005 train_loss= 0.52263 train_f1_mic= 0.42784 train_f1_mac= 0.16408 val_loss= 0.57254 val_f1_mic= 0.41515 val_f1_mac= 0.15781 time= 0.03808
Iter: 0010 train_loss= 0.52307 train_f1_mic= 0.44405 train_f1_mac= 0.17104 val_loss= 0.57254 val_f1_mic= 0.41515 val_f1_mac= 0.15781 time= 0.03745
Iter: 0015 train_loss= 0.51970 train_f1_mic= 0.44354 train_f1_mac= 0.17333 val_loss= 0.57254 val_f1_mic= 0.41515 val_f1_mac= 0.15781 time= 0.03697
Epoch: 0007
Iter: 0001 train_loss= 0.51454 train_f1_mic= 0.44729 train_f1_mac= 0.17950 val_loss= 0.51897 val_f1_mic= 0.46077 val_f1_mac= 0.19776 time= 0.03670
Iter: 0006 train_loss= 0.51812 train_f1_mic= 0.44525 train_f1_mac= 0.18514 val_loss= 0.51897 val_f1_mic= 0.46077 val_f1_mac= 0.19776 time= 0.03647
Iter: 0011 train_loss= 0.51982 train_f1_mic= 0.43964 train_f1_mac= 0.17222 val_loss= 0.51897 val_f1_mic= 0.46077 val_f1_mac= 0.19776 time= 0.03614
Iter: 0016 train_loss= 0.52187 train_f1_mic= 0.46704 train_f1_mac= 0.19240 val_loss= 0.51897 val_f1_mic= 0.46077 val_f1_mac= 0.19776 time= 0.03578
Epoch: 0008
Iter: 0002 train_loss= 0.51651 train_f1_mic= 0.44960 train_f1_mac= 0.20100 val_loss= 0.55198 val_f1_mic= 0.43496 val_f1_mac= 0.18983 time= 0.03583
Iter: 0007 train_loss= 0.50845 train_f1_mic= 0.45276 train_f1_mac= 0.19801 val_loss= 0.55198 val_f1_mic= 0.43496 val_f1_mac= 0.18983 time= 0.03543
Iter: 0012 train_loss= 0.52739 train_f1_mic= 0.48749 train_f1_mac= 0.23251 val_loss= 0.55198 val_f1_mic= 0.43496 val_f1_mac= 0.18983 time= 0.03504
Iter: 0017 train_loss= 0.52823 train_f1_mic= 0.39484 train_f1_mac= 0.13375 val_loss= 0.55198 val_f1_mic= 0.43496 val_f1_mac= 0.18983 time= 0.03484
Epoch: 0009
Iter: 0003 train_loss= 0.52835 train_f1_mic= 0.46098 train_f1_mac= 0.20204 val_loss= 0.53566 val_f1_mic= 0.46552 val_f1_mac= 0.20171 time= 0.03463
Iter: 0008 train_loss= 0.51236 train_f1_mic= 0.44534 train_f1_mac= 0.18597 val_loss= 0.53566 val_f1_mic= 0.46552 val_f1_mac= 0.20171 time= 0.03431
Iter: 0013 train_loss= 0.51880 train_f1_mic= 0.47127 train_f1_mac= 0.21373 val_loss= 0.53566 val_f1_mic= 0.46552 val_f1_mac= 0.20171 time= 0.03399
Iter: 0018 train_loss= 0.51134 train_f1_mic= 0.45656 train_f1_mac= 0.20138 val_loss= 0.53566 val_f1_mic= 0.46552 val_f1_mac= 0.20171 time= 0.03388
Epoch: 0010
Iter: 0004 train_loss= 0.50504 train_f1_mic= 0.44903 train_f1_mac= 0.19672 val_loss= 0.53027 val_f1_mic= 0.46844 val_f1_mac= 0.22418 time= 0.03374
Iter: 0009 train_loss= 0.51353 train_f1_mic= 0.47120 train_f1_mac= 0.22841 val_loss= 0.53027 val_f1_mic= 0.46844 val_f1_mac= 0.22418 time= 0.03348
Iter: 0014 train_loss= 0.50480 train_f1_mic= 0.45638 train_f1_mac= 0.20492 val_loss= 0.53027 val_f1_mic= 0.46844 val_f1_mac= 0.22418 time= 0.03327
Optimization Finished!
Full validation stats: loss= 0.53157 f1_micro= 0.47084 f1_macro= 0.23515 time= 0.10073
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46097644388561754
Rewards :  0.0032471084993193067 Accuracy :  0.46357413068507297
Total reward :  1.2635298264724857
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'relu', 1, 'tanh']
Training RNN (Reward ip) :  [0.00324711]
Trial 335: Controller loss : 7770.389160

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'tanh', 1, 'sigmoid']
2018-08-31 01:09:47.716108: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:09:47.716449: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:09:47.716645: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:09:47.716811: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:09:47.717023: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69476 train_f1_mic= 0.39642 train_f1_mac= 0.26192 val_loss= 0.65775 val_f1_mic= 0.37273 val_f1_mac= 0.09931 time= 1.07120
Iter: 0005 train_loss= 0.57195 train_f1_mic= 0.38248 train_f1_mac= 0.09375 val_loss= 0.65775 val_f1_mic= 0.37273 val_f1_mac= 0.09931 time= 0.24335
Iter: 0010 train_loss= 0.55331 train_f1_mic= 0.37857 train_f1_mac= 0.09352 val_loss= 0.65775 val_f1_mic= 0.37273 val_f1_mac= 0.09931 time= 0.16792
Iter: 0015 train_loss= 0.54820 train_f1_mic= 0.37061 train_f1_mac= 0.08952 val_loss= 0.65775 val_f1_mic= 0.37273 val_f1_mac= 0.09931 time= 0.13925
Epoch: 0002
Iter: 0001 train_loss= 0.53606 train_f1_mic= 0.41101 train_f1_mac= 0.10385 val_loss= 0.54714 val_f1_mic= 0.39979 val_f1_mac= 0.10298 time= 0.12471
Iter: 0006 train_loss= 0.54015 train_f1_mic= 0.37504 train_f1_mac= 0.08975 val_loss= 0.54714 val_f1_mic= 0.39979 val_f1_mac= 0.10298 time= 0.11481
Iter: 0011 train_loss= 0.54482 train_f1_mic= 0.37131 train_f1_mac= 0.09074 val_loss= 0.54714 val_f1_mic= 0.39979 val_f1_mac= 0.10298 time= 0.10830
Iter: 0016 train_loss= 0.53677 train_f1_mic= 0.39026 train_f1_mac= 0.10172 val_loss= 0.54714 val_f1_mic= 0.39979 val_f1_mac= 0.10298 time= 0.10381
Epoch: 0003
Iter: 0002 train_loss= 0.53746 train_f1_mic= 0.42142 train_f1_mac= 0.12948 val_loss= 0.55755 val_f1_mic= 0.41884 val_f1_mac= 0.12961 time= 0.10117
Iter: 0007 train_loss= 0.53729 train_f1_mic= 0.39374 train_f1_mac= 0.11133 val_loss= 0.55755 val_f1_mic= 0.41884 val_f1_mac= 0.12961 time= 0.09865
Iter: 0012 train_loss= 0.54249 train_f1_mic= 0.40347 train_f1_mac= 0.11877 val_loss= 0.55755 val_f1_mic= 0.41884 val_f1_mac= 0.12961 time= 0.09623
Iter: 0017 train_loss= 0.54174 train_f1_mic= 0.41616 train_f1_mac= 0.12568 val_loss= 0.55755 val_f1_mic= 0.41884 val_f1_mac= 0.12961 time= 0.09448
Epoch: 0004
Iter: 0003 train_loss= 0.53475 train_f1_mic= 0.40771 train_f1_mac= 0.12469 val_loss= 0.57177 val_f1_mic= 0.40433 val_f1_mac= 0.12910 time= 0.09339
Iter: 0008 train_loss= 0.52496 train_f1_mic= 0.39223 train_f1_mac= 0.11241 val_loss= 0.57177 val_f1_mic= 0.40433 val_f1_mac= 0.12910 time= 0.09187
Iter: 0013 train_loss= 0.54067 train_f1_mic= 0.40701 train_f1_mac= 0.12060 val_loss= 0.57177 val_f1_mic= 0.40433 val_f1_mac= 0.12910 time= 0.09095
Iter: 0018 train_loss= 0.53220 train_f1_mic= 0.41725 train_f1_mac= 0.12485 val_loss= 0.57177 val_f1_mic= 0.40433 val_f1_mac= 0.12910 time= 0.08994
Epoch: 0005
Iter: 0004 train_loss= 0.51999 train_f1_mic= 0.41401 train_f1_mac= 0.12789 val_loss= 0.55461 val_f1_mic= 0.39860 val_f1_mac= 0.12667 time= 0.08967
Iter: 0009 train_loss= 0.53049 train_f1_mic= 0.40493 train_f1_mac= 0.12411 val_loss= 0.55461 val_f1_mic= 0.39860 val_f1_mac= 0.12667 time= 0.08875
Iter: 0014 train_loss= 0.53263 train_f1_mic= 0.41385 train_f1_mac= 0.12865 val_loss= 0.55461 val_f1_mic= 0.39860 val_f1_mac= 0.12667 time= 0.08788
Epoch: 0006
Iter: 0000 train_loss= 0.52786 train_f1_mic= 0.40863 train_f1_mac= 0.12582 val_loss= 0.54996 val_f1_mic= 0.41969 val_f1_mac= 0.13881 time= 0.08760
Iter: 0005 train_loss= 0.52528 train_f1_mic= 0.43287 train_f1_mac= 0.14711 val_loss= 0.54996 val_f1_mic= 0.41969 val_f1_mac= 0.13881 time= 0.08719
Iter: 0010 train_loss= 0.52552 train_f1_mic= 0.42235 train_f1_mac= 0.14169 val_loss= 0.54996 val_f1_mic= 0.41969 val_f1_mac= 0.13881 time= 0.08671
Iter: 0015 train_loss= 0.54117 train_f1_mic= 0.41592 train_f1_mac= 0.13818 val_loss= 0.54996 val_f1_mic= 0.41969 val_f1_mac= 0.13881 time= 0.08626
Epoch: 0007
Iter: 0001 train_loss= 0.51450 train_f1_mic= 0.43280 train_f1_mac= 0.14426 val_loss= 0.55630 val_f1_mic= 0.42059 val_f1_mac= 0.14712 time= 0.08592
Iter: 0006 train_loss= 0.51383 train_f1_mic= 0.44341 train_f1_mac= 0.15979 val_loss= 0.55630 val_f1_mic= 0.42059 val_f1_mac= 0.14712 time= 0.08546
Iter: 0011 train_loss= 0.51775 train_f1_mic= 0.41822 train_f1_mac= 0.15103 val_loss= 0.55630 val_f1_mic= 0.42059 val_f1_mac= 0.14712 time= 0.08514
Iter: 0016 train_loss= 0.52619 train_f1_mic= 0.44472 train_f1_mac= 0.16178 val_loss= 0.55630 val_f1_mic= 0.42059 val_f1_mac= 0.14712 time= 0.08469
Epoch: 0008
Iter: 0002 train_loss= 0.52282 train_f1_mic= 0.45139 train_f1_mac= 0.17772 val_loss= 0.57716 val_f1_mic= 0.40849 val_f1_mac= 0.15247 time= 0.08470
Iter: 0007 train_loss= 0.52227 train_f1_mic= 0.42119 train_f1_mac= 0.15795 val_loss= 0.57716 val_f1_mic= 0.40849 val_f1_mac= 0.15247 time= 0.08434
Iter: 0012 train_loss= 0.51769 train_f1_mic= 0.44503 train_f1_mac= 0.17992 val_loss= 0.57716 val_f1_mic= 0.40849 val_f1_mac= 0.15247 time= 0.08401
Iter: 0017 train_loss= 0.52386 train_f1_mic= 0.42550 train_f1_mac= 0.16405 val_loss= 0.57716 val_f1_mic= 0.40849 val_f1_mac= 0.15247 time= 0.08381
Epoch: 0009
Iter: 0003 train_loss= 0.51797 train_f1_mic= 0.44914 train_f1_mac= 0.18540 val_loss= 0.53442 val_f1_mic= 0.44976 val_f1_mac= 0.19306 time= 0.08363
Iter: 0008 train_loss= 0.52148 train_f1_mic= 0.43289 train_f1_mac= 0.17064 val_loss= 0.53442 val_f1_mic= 0.44976 val_f1_mac= 0.19306 time= 0.08336
Iter: 0013 train_loss= 0.51885 train_f1_mic= 0.47141 train_f1_mac= 0.19934 val_loss= 0.53442 val_f1_mic= 0.44976 val_f1_mac= 0.19306 time= 0.08318
Iter: 0018 train_loss= 0.52879 train_f1_mic= 0.43028 train_f1_mac= 0.17386 val_loss= 0.53442 val_f1_mic= 0.44976 val_f1_mac= 0.19306 time= 0.08306
Epoch: 0010
Iter: 0004 train_loss= 0.51182 train_f1_mic= 0.46289 train_f1_mac= 0.20426 val_loss= 0.52688 val_f1_mic= 0.46128 val_f1_mac= 0.20723 time= 0.08303
Iter: 0009 train_loss= 0.52059 train_f1_mic= 0.45015 train_f1_mac= 0.19446 val_loss= 0.52688 val_f1_mic= 0.46128 val_f1_mac= 0.20723 time= 0.08289
Iter: 0014 train_loss= 0.52222 train_f1_mic= 0.42693 train_f1_mac= 0.16299 val_loss= 0.52688 val_f1_mic= 0.46128 val_f1_mac= 0.20723 time= 0.08261
Optimization Finished!
Full validation stats: loss= 0.52949 f1_micro= 0.47903 f1_macro= 0.22414 time= 0.14561
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46447164647561984
Rewards :  0.017476012950011444 Accuracy :  0.478452456835629
Total reward :  1.2810058394224972
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'tanh', 1, 'sigmoid']
Training RNN (Reward ip) :  [0.01747601]
Trial 336: Controller loss : 7084.734375

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'tanh', 3, 'tanh']
2018-08-31 01:10:09.630837: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:10:09.631077: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:10:09.631439: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:10:09.631570: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:10:09.631771: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69398 train_f1_mic= 0.35442 train_f1_mac= 0.30262 val_loss= 0.67113 val_f1_mic= 0.39426 val_f1_mac= 0.15631 time= 0.85770
Iter: 0005 train_loss= 0.58784 train_f1_mic= 0.36581 train_f1_mac= 0.09032 val_loss= 0.67113 val_f1_mic= 0.39426 val_f1_mac= 0.15631 time= 0.18084
Iter: 0010 train_loss= 0.54375 train_f1_mic= 0.38289 train_f1_mac= 0.09300 val_loss= 0.67113 val_f1_mic= 0.39426 val_f1_mac= 0.15631 time= 0.11931
Iter: 0015 train_loss= 0.54852 train_f1_mic= 0.37868 train_f1_mac= 0.09365 val_loss= 0.67113 val_f1_mic= 0.39426 val_f1_mac= 0.15631 time= 0.09618
Epoch: 0002
Iter: 0001 train_loss= 0.53896 train_f1_mic= 0.37253 train_f1_mac= 0.08742 val_loss= 0.57665 val_f1_mic= 0.35427 val_f1_mac= 0.08895 time= 0.08477
Iter: 0006 train_loss= 0.55372 train_f1_mic= 0.38231 train_f1_mac= 0.09442 val_loss= 0.57665 val_f1_mic= 0.35427 val_f1_mac= 0.08895 time= 0.07698
Iter: 0011 train_loss= 0.53674 train_f1_mic= 0.39952 train_f1_mac= 0.10139 val_loss= 0.57665 val_f1_mic= 0.35427 val_f1_mac= 0.08895 time= 0.07193
Iter: 0016 train_loss= 0.54581 train_f1_mic= 0.38489 train_f1_mac= 0.09407 val_loss= 0.57665 val_f1_mic= 0.35427 val_f1_mac= 0.08895 time= 0.06795
Epoch: 0003
Iter: 0002 train_loss= 0.53734 train_f1_mic= 0.37320 train_f1_mac= 0.08877 val_loss= 0.56150 val_f1_mic= 0.35841 val_f1_mac= 0.08846 time= 0.06543
Iter: 0007 train_loss= 0.54354 train_f1_mic= 0.39235 train_f1_mac= 0.10142 val_loss= 0.56150 val_f1_mic= 0.35841 val_f1_mac= 0.08846 time= 0.06318
Iter: 0012 train_loss= 0.55519 train_f1_mic= 0.37566 train_f1_mac= 0.09412 val_loss= 0.56150 val_f1_mic= 0.35841 val_f1_mac= 0.08846 time= 0.06130
Iter: 0017 train_loss= 0.54080 train_f1_mic= 0.37479 train_f1_mac= 0.08863 val_loss= 0.56150 val_f1_mic= 0.35841 val_f1_mac= 0.08846 time= 0.05991
Epoch: 0004
Iter: 0003 train_loss= 0.53989 train_f1_mic= 0.40376 train_f1_mac= 0.10671 val_loss= 0.55828 val_f1_mic= 0.40399 val_f1_mac= 0.10929 time= 0.05915
Iter: 0008 train_loss= 0.53881 train_f1_mic= 0.39276 train_f1_mac= 0.10091 val_loss= 0.55828 val_f1_mic= 0.40399 val_f1_mac= 0.10929 time= 0.05813
Iter: 0013 train_loss= 0.54058 train_f1_mic= 0.37453 train_f1_mac= 0.09466 val_loss= 0.55828 val_f1_mic= 0.40399 val_f1_mac= 0.10929 time= 0.05713
Iter: 0018 train_loss= 0.53814 train_f1_mic= 0.39697 train_f1_mac= 0.10560 val_loss= 0.55828 val_f1_mic= 0.40399 val_f1_mac= 0.10929 time= 0.05627
Epoch: 0005
Iter: 0004 train_loss= 0.53568 train_f1_mic= 0.41024 train_f1_mac= 0.11878 val_loss= 0.57390 val_f1_mic= 0.38950 val_f1_mac= 0.11359 time= 0.05584
Iter: 0009 train_loss= 0.55158 train_f1_mic= 0.38951 train_f1_mac= 0.11353 val_loss= 0.57390 val_f1_mic= 0.38950 val_f1_mac= 0.11359 time= 0.05514
Iter: 0014 train_loss= 0.52645 train_f1_mic= 0.40315 train_f1_mac= 0.11691 val_loss= 0.57390 val_f1_mic= 0.38950 val_f1_mac= 0.11359 time= 0.05460
Epoch: 0006
Iter: 0000 train_loss= 0.54506 train_f1_mic= 0.40534 train_f1_mac= 0.12125 val_loss= 0.55609 val_f1_mic= 0.40198 val_f1_mac= 0.12512 time= 0.05442
Iter: 0005 train_loss= 0.52638 train_f1_mic= 0.40459 train_f1_mac= 0.11664 val_loss= 0.55609 val_f1_mic= 0.40198 val_f1_mac= 0.12512 time= 0.05411
Iter: 0010 train_loss= 0.53070 train_f1_mic= 0.37750 train_f1_mac= 0.10401 val_loss= 0.55609 val_f1_mic= 0.40198 val_f1_mac= 0.12512 time= 0.05371
Iter: 0015 train_loss= 0.53886 train_f1_mic= 0.43708 train_f1_mac= 0.13606 val_loss= 0.55609 val_f1_mic= 0.40198 val_f1_mac= 0.12512 time= 0.05337
Epoch: 0007
Iter: 0001 train_loss= 0.54673 train_f1_mic= 0.40551 train_f1_mac= 0.12555 val_loss= 0.53122 val_f1_mic= 0.42322 val_f1_mac= 0.12712 time= 0.05331
Iter: 0006 train_loss= 0.52765 train_f1_mic= 0.40590 train_f1_mac= 0.12065 val_loss= 0.53122 val_f1_mic= 0.42322 val_f1_mac= 0.12712 time= 0.05299
Iter: 0011 train_loss= 0.53272 train_f1_mic= 0.40312 train_f1_mac= 0.12395 val_loss= 0.53122 val_f1_mic= 0.42322 val_f1_mac= 0.12712 time= 0.05275
Iter: 0016 train_loss= 0.54181 train_f1_mic= 0.41921 train_f1_mac= 0.13227 val_loss= 0.53122 val_f1_mic= 0.42322 val_f1_mac= 0.12712 time= 0.05249
Epoch: 0008
Iter: 0002 train_loss= 0.52724 train_f1_mic= 0.41459 train_f1_mac= 0.13199 val_loss= 0.55770 val_f1_mic= 0.40546 val_f1_mac= 0.13539 time= 0.05239
Iter: 0007 train_loss= 0.53875 train_f1_mic= 0.39488 train_f1_mac= 0.12180 val_loss= 0.55770 val_f1_mic= 0.40546 val_f1_mac= 0.13539 time= 0.05215
Iter: 0012 train_loss= 0.52300 train_f1_mic= 0.43362 train_f1_mac= 0.14137 val_loss= 0.55770 val_f1_mic= 0.40546 val_f1_mac= 0.13539 time= 0.05194
Iter: 0017 train_loss= 0.52829 train_f1_mic= 0.40955 train_f1_mac= 0.12545 val_loss= 0.55770 val_f1_mic= 0.40546 val_f1_mac= 0.13539 time= 0.05168
Epoch: 0009
Iter: 0003 train_loss= 0.52399 train_f1_mic= 0.42938 train_f1_mac= 0.14297 val_loss= 0.53491 val_f1_mic= 0.42466 val_f1_mac= 0.14386 time= 0.05161
Iter: 0008 train_loss= 0.52198 train_f1_mic= 0.45451 train_f1_mac= 0.16944 val_loss= 0.53491 val_f1_mic= 0.42466 val_f1_mac= 0.14386 time= 0.05147
Iter: 0013 train_loss= 0.53012 train_f1_mic= 0.41621 train_f1_mac= 0.14491 val_loss= 0.53491 val_f1_mic= 0.42466 val_f1_mac= 0.14386 time= 0.05132
Iter: 0018 train_loss= 0.52529 train_f1_mic= 0.40147 train_f1_mac= 0.12903 val_loss= 0.53491 val_f1_mic= 0.42466 val_f1_mac= 0.14386 time= 0.05110
Epoch: 0010
Iter: 0004 train_loss= 0.53159 train_f1_mic= 0.43226 train_f1_mac= 0.16156 val_loss= 0.55027 val_f1_mic= 0.41598 val_f1_mac= 0.14609 time= 0.05103
Iter: 0009 train_loss= 0.53228 train_f1_mic= 0.41923 train_f1_mac= 0.15592 val_loss= 0.55027 val_f1_mic= 0.41598 val_f1_mac= 0.14609 time= 0.05092
Iter: 0014 train_loss= 0.52836 train_f1_mic= 0.42151 train_f1_mac= 0.15428 val_loss= 0.55027 val_f1_mic= 0.41598 val_f1_mac= 0.14609 time= 0.05072
Optimization Finished!
Full validation stats: loss= 0.54119 f1_micro= 0.45178 f1_macro= 0.18564 time= 0.13463
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46167039848065733
Rewards :  -0.014006239974812651 Accuracy :  0.4504654065008072
Total reward :  1.2669995994476846
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'tanh', 3, 'tanh']
Training RNN (Reward ip) :  [-0.01400624]
Trial 337: Controller loss : 6514.476562

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'linear', 3, 'sigmoid']
2018-08-31 01:10:25.331684: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:10:25.332243: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:10:25.332798: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:10:25.333199: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:10:25.333706: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69346 train_f1_mic= 0.36576 train_f1_mac= 0.25629 val_loss= 0.65852 val_f1_mic= 0.37003 val_f1_mac= 0.09778 time= 0.87965
Iter: 0005 train_loss= 0.57549 train_f1_mic= 0.37573 train_f1_mac= 0.09223 val_loss= 0.65852 val_f1_mic= 0.37003 val_f1_mac= 0.09778 time= 0.18650
Iter: 0010 train_loss= 0.54205 train_f1_mic= 0.40808 train_f1_mac= 0.10339 val_loss= 0.65852 val_f1_mic= 0.37003 val_f1_mac= 0.09778 time= 0.12230
Iter: 0015 train_loss= 0.53940 train_f1_mic= 0.37371 train_f1_mac= 0.08753 val_loss= 0.65852 val_f1_mic= 0.37003 val_f1_mac= 0.09778 time= 0.09847
Epoch: 0002
Iter: 0001 train_loss= 0.54615 train_f1_mic= 0.37456 train_f1_mac= 0.09392 val_loss= 0.55041 val_f1_mic= 0.37853 val_f1_mac= 0.09617 time= 0.08799
Iter: 0006 train_loss= 0.54203 train_f1_mic= 0.37787 train_f1_mac= 0.09813 val_loss= 0.55041 val_f1_mic= 0.37853 val_f1_mac= 0.09617 time= 0.08008
Iter: 0011 train_loss= 0.54457 train_f1_mic= 0.39441 train_f1_mac= 0.10910 val_loss= 0.55041 val_f1_mic= 0.37853 val_f1_mac= 0.09617 time= 0.07425
Iter: 0016 train_loss= 0.53157 train_f1_mic= 0.40797 train_f1_mac= 0.11582 val_loss= 0.55041 val_f1_mic= 0.37853 val_f1_mac= 0.09617 time= 0.07009
Epoch: 0003
Iter: 0002 train_loss= 0.53974 train_f1_mic= 0.41872 train_f1_mac= 0.12879 val_loss= 0.54558 val_f1_mic= 0.41183 val_f1_mac= 0.12593 time= 0.06740
Iter: 0007 train_loss= 0.54003 train_f1_mic= 0.40910 train_f1_mac= 0.12797 val_loss= 0.54558 val_f1_mic= 0.41183 val_f1_mac= 0.12593 time= 0.06509
Iter: 0012 train_loss= 0.52354 train_f1_mic= 0.44970 train_f1_mac= 0.14220 val_loss= 0.54558 val_f1_mic= 0.41183 val_f1_mac= 0.12593 time= 0.06324
Iter: 0017 train_loss= 0.52607 train_f1_mic= 0.41078 train_f1_mac= 0.12381 val_loss= 0.54558 val_f1_mic= 0.41183 val_f1_mac= 0.12593 time= 0.06181
Epoch: 0004
Iter: 0003 train_loss= 0.54257 train_f1_mic= 0.42724 train_f1_mac= 0.13671 val_loss= 0.54900 val_f1_mic= 0.41300 val_f1_mac= 0.13261 time= 0.06089
Iter: 0008 train_loss= 0.52488 train_f1_mic= 0.44428 train_f1_mac= 0.14434 val_loss= 0.54900 val_f1_mic= 0.41300 val_f1_mac= 0.13261 time= 0.05955
Iter: 0013 train_loss= 0.51462 train_f1_mic= 0.42396 train_f1_mac= 0.13257 val_loss= 0.54900 val_f1_mic= 0.41300 val_f1_mac= 0.13261 time= 0.05863
Iter: 0018 train_loss= 0.51873 train_f1_mic= 0.42694 train_f1_mac= 0.13330 val_loss= 0.54900 val_f1_mic= 0.41300 val_f1_mac= 0.13261 time= 0.05775
Epoch: 0005
Iter: 0004 train_loss= 0.52203 train_f1_mic= 0.42473 train_f1_mac= 0.13766 val_loss= 0.55938 val_f1_mic= 0.39399 val_f1_mac= 0.12884 time= 0.05710
Iter: 0009 train_loss= 0.51965 train_f1_mic= 0.43196 train_f1_mac= 0.14357 val_loss= 0.55938 val_f1_mic= 0.39399 val_f1_mac= 0.12884 time= 0.05651
Iter: 0014 train_loss= 0.53189 train_f1_mic= 0.39346 train_f1_mac= 0.12844 val_loss= 0.55938 val_f1_mic= 0.39399 val_f1_mac= 0.12884 time= 0.05589
Epoch: 0006
Iter: 0000 train_loss= 0.51412 train_f1_mic= 0.41224 train_f1_mac= 0.13071 val_loss= 0.54520 val_f1_mic= 0.39440 val_f1_mac= 0.12627 time= 0.05566
Iter: 0005 train_loss= 0.51829 train_f1_mic= 0.45137 train_f1_mac= 0.15306 val_loss= 0.54520 val_f1_mic= 0.39440 val_f1_mac= 0.12627 time= 0.05522
Iter: 0010 train_loss= 0.51405 train_f1_mic= 0.42286 train_f1_mac= 0.14528 val_loss= 0.54520 val_f1_mic= 0.39440 val_f1_mac= 0.12627 time= 0.05475
Iter: 0015 train_loss= 0.51151 train_f1_mic= 0.44280 train_f1_mac= 0.16907 val_loss= 0.54520 val_f1_mic= 0.39440 val_f1_mac= 0.12627 time= 0.05425
Epoch: 0007
Iter: 0001 train_loss= 0.52257 train_f1_mic= 0.47246 train_f1_mac= 0.19048 val_loss= 0.53748 val_f1_mic= 0.48269 val_f1_mac= 0.20344 time= 0.05426
Iter: 0006 train_loss= 0.52848 train_f1_mic= 0.41529 train_f1_mac= 0.14252 val_loss= 0.53748 val_f1_mic= 0.48269 val_f1_mac= 0.20344 time= 0.05389
Iter: 0011 train_loss= 0.51403 train_f1_mic= 0.42560 train_f1_mac= 0.15506 val_loss= 0.53748 val_f1_mic= 0.48269 val_f1_mac= 0.20344 time= 0.05354
Iter: 0016 train_loss= 0.50895 train_f1_mic= 0.46225 train_f1_mac= 0.18060 val_loss= 0.53748 val_f1_mic= 0.48269 val_f1_mac= 0.20344 time= 0.05318
Epoch: 0008
Iter: 0002 train_loss= 0.51800 train_f1_mic= 0.44207 train_f1_mac= 0.16749 val_loss= 0.56563 val_f1_mic= 0.41192 val_f1_mac= 0.15860 time= 0.05313
Iter: 0007 train_loss= 0.50920 train_f1_mic= 0.46934 train_f1_mac= 0.19522 val_loss= 0.56563 val_f1_mic= 0.41192 val_f1_mac= 0.15860 time= 0.05285
Iter: 0012 train_loss= 0.51342 train_f1_mic= 0.44368 train_f1_mac= 0.16783 val_loss= 0.56563 val_f1_mic= 0.41192 val_f1_mac= 0.15860 time= 0.05264
Iter: 0017 train_loss= 0.52169 train_f1_mic= 0.46751 train_f1_mac= 0.20486 val_loss= 0.56563 val_f1_mic= 0.41192 val_f1_mac= 0.15860 time= 0.05236
Epoch: 0009
Iter: 0003 train_loss= 0.50850 train_f1_mic= 0.45531 train_f1_mac= 0.17825 val_loss= 0.52545 val_f1_mic= 0.41828 val_f1_mac= 0.15844 time= 0.05224
Iter: 0008 train_loss= 0.51223 train_f1_mic= 0.43001 train_f1_mac= 0.16334 val_loss= 0.52545 val_f1_mic= 0.41828 val_f1_mac= 0.15844 time= 0.05198
Iter: 0013 train_loss= 0.51073 train_f1_mic= 0.44700 train_f1_mac= 0.17657 val_loss= 0.52545 val_f1_mic= 0.41828 val_f1_mac= 0.15844 time= 0.05178
Iter: 0018 train_loss= 0.50643 train_f1_mic= 0.46716 train_f1_mac= 0.19946 val_loss= 0.52545 val_f1_mic= 0.41828 val_f1_mac= 0.15844 time= 0.05154
Epoch: 0010
Iter: 0004 train_loss= 0.51476 train_f1_mic= 0.46275 train_f1_mac= 0.19390 val_loss= 0.53286 val_f1_mic= 0.41445 val_f1_mac= 0.16330 time= 0.05143
Iter: 0009 train_loss= 0.50984 train_f1_mic= 0.43324 train_f1_mac= 0.16885 val_loss= 0.53286 val_f1_mic= 0.41445 val_f1_mac= 0.16330 time= 0.05128
Iter: 0014 train_loss= 0.51312 train_f1_mic= 0.46773 train_f1_mac= 0.20760 val_loss= 0.53286 val_f1_mic= 0.41445 val_f1_mac= 0.16330 time= 0.05109
Optimization Finished!
Full validation stats: loss= 0.52948 f1_micro= 0.48166 f1_macro= 0.22265 time= 0.15758
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4651875936271499
Rewards :  0.01758597573246279 Accuracy :  0.4792563742131201
Total reward :  1.2845855751801474
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'linear', 3, 'sigmoid']
Training RNN (Reward ip) :  [0.01758598]
Trial 338: Controller loss : 8246.488281

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'tanh', 4, 'sigmoid']
2018-08-31 01:10:41.383161: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:10:41.383585: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:10:41.383982: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:10:41.384270: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:10:41.384625: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69268 train_f1_mic= 0.43319 train_f1_mac= 0.26090 val_loss= 0.65759 val_f1_mic= 0.37269 val_f1_mac= 0.09810 time= 1.27657
Iter: 0005 train_loss= 0.57561 train_f1_mic= 0.38006 train_f1_mac= 0.09683 val_loss= 0.65759 val_f1_mic= 0.37269 val_f1_mac= 0.09810 time= 0.31316
Iter: 0010 train_loss= 0.54435 train_f1_mic= 0.38442 train_f1_mac= 0.09324 val_loss= 0.65759 val_f1_mic= 0.37269 val_f1_mac= 0.09810 time= 0.22521
Iter: 0015 train_loss= 0.54274 train_f1_mic= 0.39186 train_f1_mac= 0.09845 val_loss= 0.65759 val_f1_mic= 0.37269 val_f1_mac= 0.09810 time= 0.19235
Epoch: 0002
Iter: 0001 train_loss= 0.54167 train_f1_mic= 0.37091 train_f1_mac= 0.09027 val_loss= 0.54361 val_f1_mic= 0.37480 val_f1_mac= 0.09217 time= 0.17714
Iter: 0006 train_loss= 0.54765 train_f1_mic= 0.38576 train_f1_mac= 0.10334 val_loss= 0.54361 val_f1_mic= 0.37480 val_f1_mac= 0.09217 time= 0.16617
Iter: 0011 train_loss= 0.53206 train_f1_mic= 0.40436 train_f1_mac= 0.10685 val_loss= 0.54361 val_f1_mic= 0.37480 val_f1_mac= 0.09217 time= 0.15870
Iter: 0016 train_loss= 0.55190 train_f1_mic= 0.36587 train_f1_mac= 0.09581 val_loss= 0.54361 val_f1_mic= 0.37480 val_f1_mac= 0.09217 time= 0.15331
Epoch: 0003
Iter: 0002 train_loss= 0.53230 train_f1_mic= 0.41656 train_f1_mac= 0.12048 val_loss= 0.54409 val_f1_mic= 0.39749 val_f1_mac= 0.11580 time= 0.15057
Iter: 0007 train_loss= 0.53729 train_f1_mic= 0.42065 train_f1_mac= 0.12827 val_loss= 0.54409 val_f1_mic= 0.39749 val_f1_mac= 0.11580 time= 0.14728
Iter: 0012 train_loss= 0.53236 train_f1_mic= 0.42221 train_f1_mac= 0.12989 val_loss= 0.54409 val_f1_mic= 0.39749 val_f1_mac= 0.11580 time= 0.14477
Iter: 0017 train_loss= 0.53491 train_f1_mic= 0.41080 train_f1_mac= 0.12711 val_loss= 0.54409 val_f1_mic= 0.39749 val_f1_mac= 0.11580 time= 0.14263
Epoch: 0004
Iter: 0003 train_loss= 0.53836 train_f1_mic= 0.42103 train_f1_mac= 0.13316 val_loss= 0.56101 val_f1_mic= 0.40416 val_f1_mac= 0.13301 time= 0.14147
Iter: 0008 train_loss= 0.53596 train_f1_mic= 0.39379 train_f1_mac= 0.11947 val_loss= 0.56101 val_f1_mic= 0.40416 val_f1_mac= 0.13301 time= 0.13993
Iter: 0013 train_loss= 0.52736 train_f1_mic= 0.44524 train_f1_mac= 0.14214 val_loss= 0.56101 val_f1_mic= 0.40416 val_f1_mac= 0.13301 time= 0.13891
Iter: 0018 train_loss= 0.53246 train_f1_mic= 0.40499 train_f1_mac= 0.12813 val_loss= 0.56101 val_f1_mic= 0.40416 val_f1_mac= 0.13301 time= 0.13784
Epoch: 0005
Iter: 0004 train_loss= 0.53108 train_f1_mic= 0.43008 train_f1_mac= 0.13963 val_loss= 0.55270 val_f1_mic= 0.40545 val_f1_mac= 0.13103 time= 0.13756
Iter: 0009 train_loss= 0.52044 train_f1_mic= 0.41501 train_f1_mac= 0.12826 val_loss= 0.55270 val_f1_mic= 0.40545 val_f1_mac= 0.13103 time= 0.13671
Iter: 0014 train_loss= 0.53570 train_f1_mic= 0.42543 train_f1_mac= 0.13328 val_loss= 0.55270 val_f1_mic= 0.40545 val_f1_mac= 0.13103 time= 0.13593
Epoch: 0006
Iter: 0000 train_loss= 0.54154 train_f1_mic= 0.42361 train_f1_mac= 0.13575 val_loss= 0.56556 val_f1_mic= 0.41273 val_f1_mac= 0.14135 time= 0.13567
Iter: 0005 train_loss= 0.52144 train_f1_mic= 0.42260 train_f1_mac= 0.13982 val_loss= 0.56556 val_f1_mic= 0.41273 val_f1_mac= 0.14135 time= 0.13502
Iter: 0010 train_loss= 0.51988 train_f1_mic= 0.42617 train_f1_mac= 0.13513 val_loss= 0.56556 val_f1_mic= 0.41273 val_f1_mac= 0.14135 time= 0.13440
Iter: 0015 train_loss= 0.51678 train_f1_mic= 0.41786 train_f1_mac= 0.12916 val_loss= 0.56556 val_f1_mic= 0.41273 val_f1_mac= 0.14135 time= 0.13387
Epoch: 0007
Iter: 0001 train_loss= 0.53400 train_f1_mic= 0.42411 train_f1_mac= 0.14234 val_loss= 0.54905 val_f1_mic= 0.42843 val_f1_mac= 0.14742 time= 0.13389
Iter: 0006 train_loss= 0.52179 train_f1_mic= 0.43771 train_f1_mac= 0.14967 val_loss= 0.54905 val_f1_mic= 0.42843 val_f1_mac= 0.14742 time= 0.13339
Iter: 0011 train_loss= 0.53623 train_f1_mic= 0.42073 train_f1_mac= 0.14657 val_loss= 0.54905 val_f1_mic= 0.42843 val_f1_mac= 0.14742 time= 0.13298
Iter: 0016 train_loss= 0.53089 train_f1_mic= 0.41291 train_f1_mac= 0.13369 val_loss= 0.54905 val_f1_mic= 0.42843 val_f1_mac= 0.14742 time= 0.13261
Epoch: 0008
Iter: 0002 train_loss= 0.52406 train_f1_mic= 0.42161 train_f1_mac= 0.13610 val_loss= 0.55715 val_f1_mic= 0.40017 val_f1_mac= 0.13785 time= 0.13258
Iter: 0007 train_loss= 0.52416 train_f1_mic= 0.42101 train_f1_mac= 0.14245 val_loss= 0.55715 val_f1_mic= 0.40017 val_f1_mac= 0.13785 time= 0.13235
Iter: 0012 train_loss= 0.51907 train_f1_mic= 0.43920 train_f1_mac= 0.15209 val_loss= 0.55715 val_f1_mic= 0.40017 val_f1_mac= 0.13785 time= 0.13214
Iter: 0017 train_loss= 0.52294 train_f1_mic= 0.43679 train_f1_mac= 0.15711 val_loss= 0.55715 val_f1_mic= 0.40017 val_f1_mac= 0.13785 time= 0.13192
Epoch: 0009
Iter: 0003 train_loss= 0.51081 train_f1_mic= 0.42789 train_f1_mac= 0.14704 val_loss= 0.53993 val_f1_mic= 0.41440 val_f1_mac= 0.15147 time= 0.13191
Iter: 0008 train_loss= 0.52380 train_f1_mic= 0.41786 train_f1_mac= 0.14857 val_loss= 0.53993 val_f1_mic= 0.41440 val_f1_mac= 0.15147 time= 0.13163
Iter: 0013 train_loss= 0.52510 train_f1_mic= 0.45597 train_f1_mac= 0.17457 val_loss= 0.53993 val_f1_mic= 0.41440 val_f1_mac= 0.15147 time= 0.13136
Iter: 0018 train_loss= 0.52358 train_f1_mic= 0.44151 train_f1_mac= 0.16164 val_loss= 0.53993 val_f1_mic= 0.41440 val_f1_mac= 0.15147 time= 0.13107
Epoch: 0010
Iter: 0004 train_loss= 0.51478 train_f1_mic= 0.40390 train_f1_mac= 0.12978 val_loss= 0.54758 val_f1_mic= 0.42578 val_f1_mac= 0.15736 time= 0.13112
Iter: 0009 train_loss= 0.53466 train_f1_mic= 0.43260 train_f1_mac= 0.15862 val_loss= 0.54758 val_f1_mic= 0.42578 val_f1_mac= 0.15736 time= 0.13090
Iter: 0014 train_loss= 0.51742 train_f1_mic= 0.44510 train_f1_mac= 0.16679 val_loss= 0.54758 val_f1_mic= 0.42578 val_f1_mac= 0.15736 time= 0.13067
Optimization Finished!
Full validation stats: loss= 0.53578 f1_micro= 0.45022 f1_macro= 0.18010 time= 0.28824
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4611359861761563
Rewards :  -0.02025803725496783 Accuracy :  0.44492955637218207
Total reward :  1.2643275379251795
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'tanh', 4, 'sigmoid']
Training RNN (Reward ip) :  [-0.02025804]
Trial 339: Controller loss : 9809.333008
2018-08-31 01:11:13.210929: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:11:13.211317: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:11:13.211694: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:11:13.211970: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:11:13.212310: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 4, 'tanh']
Epoch: 0001
Iter: 0000 train_loss= 0.69478 train_f1_mic= 0.34601 train_f1_mac= 0.24883 val_loss= 0.67484 val_f1_mic= 0.41174 val_f1_mac= 0.15188 time= 0.82456
Iter: 0005 train_loss= 0.59194 train_f1_mic= 0.39330 train_f1_mac= 0.09998 val_loss= 0.67484 val_f1_mic= 0.41174 val_f1_mac= 0.15188 time= 0.19077
Iter: 0010 train_loss= 0.54136 train_f1_mic= 0.41363 train_f1_mac= 0.10423 val_loss= 0.67484 val_f1_mic= 0.41174 val_f1_mac= 0.15188 time= 0.13135
Iter: 0015 train_loss= 0.55280 train_f1_mic= 0.36671 train_f1_mac= 0.08788 val_loss= 0.67484 val_f1_mic= 0.41174 val_f1_mac= 0.15188 time= 0.10907
Epoch: 0002
Iter: 0001 train_loss= 0.53761 train_f1_mic= 0.39798 train_f1_mac= 0.09745 val_loss= 0.56155 val_f1_mic= 0.39421 val_f1_mac= 0.10096 time= 0.09854
Iter: 0006 train_loss= 0.54907 train_f1_mic= 0.38383 train_f1_mac= 0.09392 val_loss= 0.56155 val_f1_mic= 0.39421 val_f1_mac= 0.10096 time= 0.09113
Iter: 0011 train_loss= 0.53950 train_f1_mic= 0.40423 train_f1_mac= 0.09956 val_loss= 0.56155 val_f1_mic= 0.39421 val_f1_mac= 0.10096 time= 0.08608
Iter: 0016 train_loss= 0.55578 train_f1_mic= 0.37485 train_f1_mac= 0.09355 val_loss= 0.56155 val_f1_mic= 0.39421 val_f1_mac= 0.10096 time= 0.08250
Epoch: 0003
Iter: 0002 train_loss= 0.54624 train_f1_mic= 0.36925 train_f1_mac= 0.08827 val_loss= 0.56758 val_f1_mic= 0.37820 val_f1_mac= 0.09735 time= 0.08032
Iter: 0007 train_loss= 0.53507 train_f1_mic= 0.39022 train_f1_mac= 0.09311 val_loss= 0.56758 val_f1_mic= 0.37820 val_f1_mac= 0.09735 time= 0.07809
Iter: 0012 train_loss= 0.54304 train_f1_mic= 0.37010 train_f1_mac= 0.08770 val_loss= 0.56758 val_f1_mic= 0.37820 val_f1_mac= 0.09735 time= 0.07632
Iter: 0017 train_loss= 0.55331 train_f1_mic= 0.37838 train_f1_mac= 0.09406 val_loss= 0.56758 val_f1_mic= 0.37820 val_f1_mac= 0.09735 time= 0.07520
Epoch: 0004
Iter: 0003 train_loss= 0.55579 train_f1_mic= 0.37751 train_f1_mac= 0.09405 val_loss= 0.55230 val_f1_mic= 0.39433 val_f1_mac= 0.10007 time= 0.07456
Iter: 0008 train_loss= 0.54312 train_f1_mic= 0.37070 train_f1_mac= 0.08757 val_loss= 0.55230 val_f1_mic= 0.39433 val_f1_mac= 0.10007 time= 0.07362
Iter: 0013 train_loss= 0.54030 train_f1_mic= 0.40984 train_f1_mac= 0.10436 val_loss= 0.55230 val_f1_mic= 0.39433 val_f1_mac= 0.10007 time= 0.07274
Iter: 0018 train_loss= 0.53461 train_f1_mic= 0.39519 train_f1_mac= 0.09715 val_loss= 0.55230 val_f1_mic= 0.39433 val_f1_mac= 0.10007 time= 0.07192
Epoch: 0005
Iter: 0004 train_loss= 0.53499 train_f1_mic= 0.37490 train_f1_mac= 0.08735 val_loss= 0.59661 val_f1_mic= 0.34210 val_f1_mac= 0.09083 time= 0.07147
Iter: 0009 train_loss= 0.54706 train_f1_mic= 0.39766 train_f1_mac= 0.10006 val_loss= 0.59661 val_f1_mic= 0.34210 val_f1_mac= 0.09083 time= 0.07086
Iter: 0014 train_loss= 0.54012 train_f1_mic= 0.38252 train_f1_mac= 0.09262 val_loss= 0.59661 val_f1_mic= 0.34210 val_f1_mac= 0.09083 time= 0.07034
Epoch: 0006
Iter: 0000 train_loss= 0.55260 train_f1_mic= 0.36816 train_f1_mac= 0.08892 val_loss= 0.55033 val_f1_mic= 0.36260 val_f1_mac= 0.08705 time= 0.07004
Iter: 0005 train_loss= 0.54642 train_f1_mic= 0.38023 train_f1_mac= 0.09329 val_loss= 0.55033 val_f1_mic= 0.36260 val_f1_mac= 0.08705 time= 0.06957
Iter: 0010 train_loss= 0.52843 train_f1_mic= 0.39427 train_f1_mac= 0.09514 val_loss= 0.55033 val_f1_mic= 0.36260 val_f1_mac= 0.08705 time= 0.06915
Iter: 0015 train_loss= 0.54741 train_f1_mic= 0.38118 train_f1_mac= 0.09346 val_loss= 0.55033 val_f1_mic= 0.36260 val_f1_mac= 0.08705 time= 0.06877
Epoch: 0007
Iter: 0001 train_loss= 0.54857 train_f1_mic= 0.36190 train_f1_mac= 0.08678 val_loss= 0.58945 val_f1_mic= 0.34473 val_f1_mac= 0.08985 time= 0.06860
Iter: 0006 train_loss= 0.53580 train_f1_mic= 0.37815 train_f1_mac= 0.08814 val_loss= 0.58945 val_f1_mic= 0.34473 val_f1_mac= 0.08985 time= 0.06827
Iter: 0011 train_loss= 0.53776 train_f1_mic= 0.39500 train_f1_mac= 0.09768 val_loss= 0.58945 val_f1_mic= 0.34473 val_f1_mac= 0.08985 time= 0.06796
Iter: 0016 train_loss= 0.54949 train_f1_mic= 0.38822 train_f1_mac= 0.09846 val_loss= 0.58945 val_f1_mic= 0.34473 val_f1_mac= 0.08985 time= 0.06781
Epoch: 0008
Iter: 0002 train_loss= 0.53673 train_f1_mic= 0.40154 train_f1_mac= 0.09892 val_loss= 0.56014 val_f1_mic= 0.39920 val_f1_mac= 0.10637 time= 0.06786
Iter: 0007 train_loss= 0.54492 train_f1_mic= 0.36492 train_f1_mac= 0.08681 val_loss= 0.56014 val_f1_mic= 0.39920 val_f1_mac= 0.10637 time= 0.06772
Iter: 0012 train_loss= 0.53414 train_f1_mic= 0.38089 train_f1_mac= 0.09093 val_loss= 0.56014 val_f1_mic= 0.39920 val_f1_mac= 0.10637 time= 0.06752
Iter: 0017 train_loss= 0.55437 train_f1_mic= 0.40378 train_f1_mac= 0.10577 val_loss= 0.56014 val_f1_mic= 0.39920 val_f1_mac= 0.10637 time= 0.06730
Epoch: 0009
Iter: 0003 train_loss= 0.54451 train_f1_mic= 0.39482 train_f1_mac= 0.09893 val_loss= 0.56656 val_f1_mic= 0.38532 val_f1_mac= 0.10123 time= 0.06722
Iter: 0008 train_loss= 0.54033 train_f1_mic= 0.37827 train_f1_mac= 0.09150 val_loss= 0.56656 val_f1_mic= 0.38532 val_f1_mac= 0.10123 time= 0.06704
Iter: 0013 train_loss= 0.53335 train_f1_mic= 0.37847 train_f1_mac= 0.08793 val_loss= 0.56656 val_f1_mic= 0.38532 val_f1_mac= 0.10123 time= 0.06685
Iter: 0018 train_loss= 0.54743 train_f1_mic= 0.36841 train_f1_mac= 0.08785 val_loss= 0.56656 val_f1_mic= 0.38532 val_f1_mac= 0.10123 time= 0.06669
Epoch: 0010
Iter: 0004 train_loss= 0.54855 train_f1_mic= 0.38370 train_f1_mac= 0.09484 val_loss= 0.57971 val_f1_mic= 0.35012 val_f1_mac= 0.08958 time= 0.06667
Iter: 0009 train_loss= 0.53420 train_f1_mic= 0.39767 train_f1_mac= 0.09683 val_loss= 0.57971 val_f1_mic= 0.35012 val_f1_mac= 0.08958 time= 0.06652
Iter: 0014 train_loss= 0.54480 train_f1_mic= 0.37187 train_f1_mac= 0.08820 val_loss= 0.57971 val_f1_mic= 0.35012 val_f1_mac= 0.08958 time= 0.06637
Optimization Finished!
Full validation stats: loss= 0.56470 f1_micro= 0.35927 f1_macro= 0.08946 time= 0.11267
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4425880962273075
Rewards :  -0.09273944974424397 Accuracy :  0.36839653643191234
Total reward :  1.1715880881809355
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 4, 'tanh']
Training RNN (Reward ip) :  [-0.09273945]
Trial 340: Controller loss : 16130.073242
2018-08-31 01:11:30.959737: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [1, 'tanh', 1, 'linear']
2018-08-31 01:11:30.960819: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:11:30.961603: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:11:30.962186: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:11:30.963539: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69363 train_f1_mic= 0.37514 train_f1_mac= 0.34975 val_loss= 0.68106 val_f1_mic= 0.41678 val_f1_mac= 0.34692 time= 1.53387
Iter: 0005 train_loss= 0.58012 train_f1_mic= 0.40663 train_f1_mac= 0.10410 val_loss= 0.68106 val_f1_mic= 0.41678 val_f1_mac= 0.34692 time= 0.36817
Iter: 0010 train_loss= 0.54009 train_f1_mic= 0.36959 train_f1_mac= 0.08618 val_loss= 0.68106 val_f1_mic= 0.41678 val_f1_mac= 0.34692 time= 0.26266
Iter: 0015 train_loss= 0.54077 train_f1_mic= 0.36360 train_f1_mac= 0.08523 val_loss= 0.68106 val_f1_mic= 0.41678 val_f1_mac= 0.34692 time= 0.22271
Epoch: 0002
Iter: 0001 train_loss= 0.54620 train_f1_mic= 0.40734 train_f1_mac= 0.10728 val_loss= 0.56341 val_f1_mic= 0.39863 val_f1_mac= 0.10817 time= 0.20359
Iter: 0006 train_loss= 0.53434 train_f1_mic= 0.38237 train_f1_mac= 0.09194 val_loss= 0.56341 val_f1_mic= 0.39863 val_f1_mac= 0.10817 time= 0.19068
Iter: 0011 train_loss= 0.54133 train_f1_mic= 0.37353 train_f1_mac= 0.09026 val_loss= 0.56341 val_f1_mic= 0.39863 val_f1_mac= 0.10817 time= 0.18126
Iter: 0016 train_loss= 0.52896 train_f1_mic= 0.41144 train_f1_mac= 0.11568 val_loss= 0.56341 val_f1_mic= 0.39863 val_f1_mac= 0.10817 time= 0.17495
Epoch: 0003
Iter: 0002 train_loss= 0.53377 train_f1_mic= 0.40400 train_f1_mac= 0.11165 val_loss= 0.55407 val_f1_mic= 0.41116 val_f1_mac= 0.11541 time= 0.17178
Iter: 0007 train_loss= 0.53628 train_f1_mic= 0.38473 train_f1_mac= 0.10227 val_loss= 0.55407 val_f1_mic= 0.41116 val_f1_mac= 0.11541 time= 0.16781
Iter: 0012 train_loss= 0.53261 train_f1_mic= 0.40618 train_f1_mac= 0.11616 val_loss= 0.55407 val_f1_mic= 0.41116 val_f1_mac= 0.11541 time= 0.16493
Iter: 0017 train_loss= 0.53628 train_f1_mic= 0.42301 train_f1_mac= 0.12692 val_loss= 0.55407 val_f1_mic= 0.41116 val_f1_mac= 0.11541 time= 0.16236
Epoch: 0004
Iter: 0003 train_loss= 0.52588 train_f1_mic= 0.40177 train_f1_mac= 0.11611 val_loss= 0.55937 val_f1_mic= 0.40750 val_f1_mac= 0.12482 time= 0.16163
Iter: 0008 train_loss= 0.53473 train_f1_mic= 0.41056 train_f1_mac= 0.13179 val_loss= 0.55937 val_f1_mic= 0.40750 val_f1_mac= 0.12482 time= 0.15983
Iter: 0013 train_loss= 0.54147 train_f1_mic= 0.42466 train_f1_mac= 0.14829 val_loss= 0.55937 val_f1_mic= 0.40750 val_f1_mac= 0.12482 time= 0.15821
Iter: 0018 train_loss= 0.53336 train_f1_mic= 0.40991 train_f1_mac= 0.13079 val_loss= 0.55937 val_f1_mic= 0.40750 val_f1_mac= 0.12482 time= 0.15688
Epoch: 0005
Iter: 0004 train_loss= 0.53149 train_f1_mic= 0.40852 train_f1_mac= 0.13534 val_loss= 0.56759 val_f1_mic= 0.38931 val_f1_mac= 0.13022 time= 0.15643
Iter: 0009 train_loss= 0.53628 train_f1_mic= 0.41096 train_f1_mac= 0.13442 val_loss= 0.56759 val_f1_mic= 0.38931 val_f1_mac= 0.13022 time= 0.15546
Iter: 0014 train_loss= 0.54123 train_f1_mic= 0.43001 train_f1_mac= 0.15411 val_loss= 0.56759 val_f1_mic= 0.38931 val_f1_mac= 0.13022 time= 0.15445
Epoch: 0006
Iter: 0000 train_loss= 0.52815 train_f1_mic= 0.41031 train_f1_mac= 0.13667 val_loss= 0.55658 val_f1_mic= 0.41276 val_f1_mac= 0.14364 time= 0.15395
Iter: 0005 train_loss= 0.52991 train_f1_mic= 0.44016 train_f1_mac= 0.16878 val_loss= 0.55658 val_f1_mic= 0.41276 val_f1_mac= 0.14364 time= 0.15312
Iter: 0010 train_loss= 0.53685 train_f1_mic= 0.41570 train_f1_mac= 0.14882 val_loss= 0.55658 val_f1_mic= 0.41276 val_f1_mac= 0.14364 time= 0.15242
Iter: 0015 train_loss= 0.54148 train_f1_mic= 0.43787 train_f1_mac= 0.17083 val_loss= 0.55658 val_f1_mic= 0.41276 val_f1_mac= 0.14364 time= 0.15180
Epoch: 0007
Iter: 0001 train_loss= 0.53343 train_f1_mic= 0.40989 train_f1_mac= 0.14855 val_loss= 0.54372 val_f1_mic= 0.41816 val_f1_mac= 0.16722 time= 0.15163
Iter: 0006 train_loss= 0.53310 train_f1_mic= 0.43710 train_f1_mac= 0.17464 val_loss= 0.54372 val_f1_mic= 0.41816 val_f1_mac= 0.16722 time= 0.15118
Iter: 0011 train_loss= 0.52861 train_f1_mic= 0.45591 train_f1_mac= 0.19981 val_loss= 0.54372 val_f1_mic= 0.41816 val_f1_mac= 0.16722 time= 0.15072
Iter: 0016 train_loss= 0.52931 train_f1_mic= 0.40883 train_f1_mac= 0.14631 val_loss= 0.54372 val_f1_mic= 0.41816 val_f1_mac= 0.16722 time= 0.15026
Epoch: 0008
Iter: 0002 train_loss= 0.54303 train_f1_mic= 0.43030 train_f1_mac= 0.18098 val_loss= 0.54573 val_f1_mic= 0.46266 val_f1_mac= 0.21593 time= 0.15007
Iter: 0007 train_loss= 0.52520 train_f1_mic= 0.43667 train_f1_mac= 0.18979 val_loss= 0.54573 val_f1_mic= 0.46266 val_f1_mac= 0.21593 time= 0.14965
Iter: 0012 train_loss= 0.53070 train_f1_mic= 0.42158 train_f1_mac= 0.17220 val_loss= 0.54573 val_f1_mic= 0.46266 val_f1_mac= 0.21593 time= 0.14931
Iter: 0017 train_loss= 0.52564 train_f1_mic= 0.46002 train_f1_mac= 0.20823 val_loss= 0.54573 val_f1_mic= 0.46266 val_f1_mac= 0.21593 time= 0.14887
Epoch: 0009
Iter: 0003 train_loss= 0.51304 train_f1_mic= 0.45343 train_f1_mac= 0.21418 val_loss= 0.54846 val_f1_mic= 0.43832 val_f1_mac= 0.20606 time= 0.14884
Iter: 0008 train_loss= 0.52628 train_f1_mic= 0.46885 train_f1_mac= 0.24161 val_loss= 0.54846 val_f1_mic= 0.43832 val_f1_mac= 0.20606 time= 0.14850
Iter: 0013 train_loss= 0.51526 train_f1_mic= 0.46378 train_f1_mac= 0.21848 val_loss= 0.54846 val_f1_mic= 0.43832 val_f1_mac= 0.20606 time= 0.14825
Iter: 0018 train_loss= 0.52085 train_f1_mic= 0.46312 train_f1_mac= 0.22618 val_loss= 0.54846 val_f1_mic= 0.43832 val_f1_mac= 0.20606 time= 0.14792
Epoch: 0010
Iter: 0004 train_loss= 0.52743 train_f1_mic= 0.45375 train_f1_mac= 0.21630 val_loss= 0.53060 val_f1_mic= 0.44061 val_f1_mac= 0.20087 time= 0.14792
Iter: 0009 train_loss= 0.51270 train_f1_mic= 0.45666 train_f1_mac= 0.22292 val_loss= 0.53060 val_f1_mic= 0.44061 val_f1_mac= 0.20087 time= 0.14765
Iter: 0014 train_loss= 0.50939 train_f1_mic= 0.45324 train_f1_mac= 0.21167 val_loss= 0.53060 val_f1_mic= 0.44061 val_f1_mac= 0.20087 time= 0.14751
Optimization Finished!
Full validation stats: loss= 0.52846 f1_micro= 0.46624 f1_macro= 0.23950 time= 0.30518
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4463437055056014
Rewards :  0.01877804639146935 Accuracy :  0.46136614261877684
Total reward :  1.1903661345724048
Saved buffers to file `buffers.txt` !
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'tanh', 1, 'linear']
Training RNN (Reward ip) :  [0.01877805]
Trial 341: Controller loss : 9066.357422

Prediction action from Controller
State input to Controller for Action :  [0. 2. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:12:06.980156: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:12:06.981008: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:12:06.981832: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:12:06.982432: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:12:06.983224: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69401 train_f1_mic= 0.34057 train_f1_mac= 0.26747 val_loss= 0.66358 val_f1_mic= 0.38551 val_f1_mac= 0.10739 time= 0.77799
Iter: 0005 train_loss= 0.59049 train_f1_mic= 0.38058 train_f1_mac= 0.09759 val_loss= 0.66358 val_f1_mic= 0.38551 val_f1_mac= 0.10739 time= 0.14163
Iter: 0010 train_loss= 0.54026 train_f1_mic= 0.38309 train_f1_mac= 0.09302 val_loss= 0.66358 val_f1_mic= 0.38551 val_f1_mac= 0.10739 time= 0.08414
Iter: 0015 train_loss= 0.54352 train_f1_mic= 0.41290 train_f1_mac= 0.10873 val_loss= 0.66358 val_f1_mic= 0.38551 val_f1_mac= 0.10739 time= 0.06265
Epoch: 0002
Iter: 0001 train_loss= 0.53375 train_f1_mic= 0.40072 train_f1_mac= 0.10445 val_loss= 0.55847 val_f1_mic= 0.38130 val_f1_mac= 0.10543 time= 0.05296
Iter: 0006 train_loss= 0.53228 train_f1_mic= 0.37248 train_f1_mac= 0.08907 val_loss= 0.55847 val_f1_mic= 0.38130 val_f1_mac= 0.10543 time= 0.04596
Iter: 0011 train_loss= 0.53308 train_f1_mic= 0.37525 train_f1_mac= 0.09343 val_loss= 0.55847 val_f1_mic= 0.38130 val_f1_mac= 0.10543 time= 0.04089
Iter: 0016 train_loss= 0.53985 train_f1_mic= 0.40330 train_f1_mac= 0.10866 val_loss= 0.55847 val_f1_mic= 0.38130 val_f1_mac= 0.10543 time= 0.03732
Epoch: 0003
Iter: 0002 train_loss= 0.54443 train_f1_mic= 0.40264 train_f1_mac= 0.11795 val_loss= 0.57070 val_f1_mic= 0.39262 val_f1_mac= 0.11853 time= 0.03506
Iter: 0007 train_loss= 0.53775 train_f1_mic= 0.40349 train_f1_mac= 0.11972 val_loss= 0.57070 val_f1_mic= 0.39262 val_f1_mac= 0.11853 time= 0.03285
Iter: 0012 train_loss= 0.53296 train_f1_mic= 0.39845 train_f1_mac= 0.12018 val_loss= 0.57070 val_f1_mic= 0.39262 val_f1_mac= 0.11853 time= 0.03094
Iter: 0017 train_loss= 0.53038 train_f1_mic= 0.41675 train_f1_mac= 0.12556 val_loss= 0.57070 val_f1_mic= 0.39262 val_f1_mac= 0.11853 time= 0.02940
Epoch: 0004
Iter: 0003 train_loss= 0.51626 train_f1_mic= 0.42689 train_f1_mac= 0.13255 val_loss= 0.54230 val_f1_mic= 0.43382 val_f1_mac= 0.13984 time= 0.02845
Iter: 0008 train_loss= 0.53732 train_f1_mic= 0.39362 train_f1_mac= 0.12772 val_loss= 0.54230 val_f1_mic= 0.43382 val_f1_mac= 0.13984 time= 0.02737
Iter: 0013 train_loss= 0.52554 train_f1_mic= 0.43257 train_f1_mac= 0.14680 val_loss= 0.54230 val_f1_mic= 0.43382 val_f1_mac= 0.13984 time= 0.02644
Iter: 0018 train_loss= 0.51892 train_f1_mic= 0.42708 train_f1_mac= 0.14583 val_loss= 0.54230 val_f1_mic= 0.43382 val_f1_mac= 0.13984 time= 0.02571
Epoch: 0005
Iter: 0004 train_loss= 0.51776 train_f1_mic= 0.44175 train_f1_mac= 0.16021 val_loss= 0.53924 val_f1_mic= 0.44707 val_f1_mac= 0.16331 time= 0.02521
Iter: 0009 train_loss= 0.50696 train_f1_mic= 0.43954 train_f1_mac= 0.16524 val_loss= 0.53924 val_f1_mic= 0.44707 val_f1_mac= 0.16331 time= 0.02460
Iter: 0014 train_loss= 0.52420 train_f1_mic= 0.43824 train_f1_mac= 0.16739 val_loss= 0.53924 val_f1_mic= 0.44707 val_f1_mac= 0.16331 time= 0.02405
Epoch: 0006
Iter: 0000 train_loss= 0.51096 train_f1_mic= 0.42448 train_f1_mac= 0.15251 val_loss= 0.53428 val_f1_mic= 0.44740 val_f1_mac= 0.18172 time= 0.02368
Iter: 0005 train_loss= 0.50794 train_f1_mic= 0.45675 train_f1_mac= 0.17951 val_loss= 0.53428 val_f1_mic= 0.44740 val_f1_mac= 0.18172 time= 0.02321
Iter: 0010 train_loss= 0.51413 train_f1_mic= 0.46952 train_f1_mac= 0.20368 val_loss= 0.53428 val_f1_mic= 0.44740 val_f1_mac= 0.18172 time= 0.02279
Iter: 0015 train_loss= 0.51988 train_f1_mic= 0.44669 train_f1_mac= 0.18750 val_loss= 0.53428 val_f1_mic= 0.44740 val_f1_mac= 0.18172 time= 0.02245
Epoch: 0007
Iter: 0001 train_loss= 0.51139 train_f1_mic= 0.44236 train_f1_mac= 0.18170 val_loss= 0.53283 val_f1_mic= 0.43509 val_f1_mac= 0.17696 time= 0.02237
Iter: 0006 train_loss= 0.51519 train_f1_mic= 0.47318 train_f1_mac= 0.21573 val_loss= 0.53283 val_f1_mic= 0.43509 val_f1_mac= 0.17696 time= 0.02205
Iter: 0011 train_loss= 0.51330 train_f1_mic= 0.46668 train_f1_mac= 0.21029 val_loss= 0.53283 val_f1_mic= 0.43509 val_f1_mac= 0.17696 time= 0.02180
Iter: 0016 train_loss= 0.51102 train_f1_mic= 0.45305 train_f1_mac= 0.19342 val_loss= 0.53283 val_f1_mic= 0.43509 val_f1_mac= 0.17696 time= 0.02157
Epoch: 0008
Iter: 0002 train_loss= 0.50857 train_f1_mic= 0.46851 train_f1_mac= 0.21769 val_loss= 0.52272 val_f1_mic= 0.50217 val_f1_mac= 0.24046 time= 0.02149
Iter: 0007 train_loss= 0.51439 train_f1_mic= 0.48239 train_f1_mac= 0.23048 val_loss= 0.52272 val_f1_mic= 0.50217 val_f1_mac= 0.24046 time= 0.02126
Iter: 0012 train_loss= 0.50530 train_f1_mic= 0.48656 train_f1_mac= 0.24097 val_loss= 0.52272 val_f1_mic= 0.50217 val_f1_mac= 0.24046 time= 0.02104
Iter: 0017 train_loss= 0.51241 train_f1_mic= 0.46331 train_f1_mac= 0.21616 val_loss= 0.52272 val_f1_mic= 0.50217 val_f1_mac= 0.24046 time= 0.02083
Epoch: 0009
Iter: 0003 train_loss= 0.49452 train_f1_mic= 0.47061 train_f1_mac= 0.22433 val_loss= 0.52221 val_f1_mic= 0.51400 val_f1_mac= 0.28187 time= 0.02088
Iter: 0008 train_loss= 0.49298 train_f1_mic= 0.49963 train_f1_mac= 0.24897 val_loss= 0.52221 val_f1_mic= 0.51400 val_f1_mac= 0.28187 time= 0.02069
Iter: 0013 train_loss= 0.50527 train_f1_mic= 0.50396 train_f1_mac= 0.26664 val_loss= 0.52221 val_f1_mic= 0.51400 val_f1_mac= 0.28187 time= 0.02049
Iter: 0018 train_loss= 0.49442 train_f1_mic= 0.48888 train_f1_mac= 0.24970 val_loss= 0.52221 val_f1_mic= 0.51400 val_f1_mac= 0.28187 time= 0.02036
Epoch: 0010
Iter: 0004 train_loss= 0.50041 train_f1_mic= 0.45510 train_f1_mac= 0.21978 val_loss= 0.51917 val_f1_mic= 0.52159 val_f1_mac= 0.28782 time= 0.02028
Iter: 0009 train_loss= 0.50058 train_f1_mic= 0.49405 train_f1_mac= 0.25855 val_loss= 0.51917 val_f1_mic= 0.52159 val_f1_mac= 0.28782 time= 0.02016
Iter: 0014 train_loss= 0.49984 train_f1_mic= 0.52027 train_f1_mac= 0.28527 val_loss= 0.51917 val_f1_mic= 0.52159 val_f1_mac= 0.28782 time= 0.02002
Optimization Finished!
Full validation stats: loss= 0.51436 f1_micro= 0.52932 f1_macro= 0.30671 time= 0.11171
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46182012769714553
Rewards :  0.0773821109577209 Accuracy :  0.5237258164633223
Total reward :  1.2677482455301257
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.07738211]
Trial 342: Controller loss : 141.619400
2018-08-31 01:12:16.104026: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:12:16.104276: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:12:16.104516: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:12:16.104685: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:12:16.104899: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'sigmoid', 0, 'tanh']
Epoch: 0001
Iter: 0000 train_loss= 0.69127 train_f1_mic= 0.41144 train_f1_mac= 0.26591 val_loss= 0.66692 val_f1_mic= 0.40250 val_f1_mac= 0.13344 time= 0.85406
Iter: 0005 train_loss= 0.58158 train_f1_mic= 0.39413 train_f1_mac= 0.09797 val_loss= 0.66692 val_f1_mic= 0.40250 val_f1_mac= 0.13344 time= 0.19287
Iter: 0010 train_loss= 0.54698 train_f1_mic= 0.36926 train_f1_mac= 0.08752 val_loss= 0.66692 val_f1_mic= 0.40250 val_f1_mac= 0.13344 time= 0.13267
Iter: 0015 train_loss= 0.54687 train_f1_mic= 0.38939 train_f1_mac= 0.09724 val_loss= 0.66692 val_f1_mic= 0.40250 val_f1_mac= 0.13344 time= 0.11010
Epoch: 0002
Iter: 0001 train_loss= 0.53274 train_f1_mic= 0.39790 train_f1_mac= 0.09701 val_loss= 0.58083 val_f1_mic= 0.38062 val_f1_mac= 0.10097 time= 0.09922
Iter: 0006 train_loss= 0.53442 train_f1_mic= 0.37065 train_f1_mac= 0.08589 val_loss= 0.58083 val_f1_mic= 0.38062 val_f1_mac= 0.10097 time= 0.09165
Iter: 0011 train_loss= 0.53260 train_f1_mic= 0.37094 train_f1_mac= 0.08558 val_loss= 0.58083 val_f1_mic= 0.38062 val_f1_mac= 0.10097 time= 0.08662
Iter: 0016 train_loss= 0.55089 train_f1_mic= 0.39684 train_f1_mac= 0.10094 val_loss= 0.58083 val_f1_mic= 0.38062 val_f1_mac= 0.10097 time= 0.08301
Epoch: 0003
Iter: 0002 train_loss= 0.53610 train_f1_mic= 0.41202 train_f1_mac= 0.10379 val_loss= 0.56851 val_f1_mic= 0.40053 val_f1_mac= 0.10803 time= 0.08108
Iter: 0007 train_loss= 0.54635 train_f1_mic= 0.37307 train_f1_mac= 0.08881 val_loss= 0.56851 val_f1_mic= 0.40053 val_f1_mac= 0.10803 time= 0.07882
Iter: 0012 train_loss= 0.54483 train_f1_mic= 0.36432 train_f1_mac= 0.08697 val_loss= 0.56851 val_f1_mic= 0.40053 val_f1_mac= 0.10803 time= 0.07700
Iter: 0017 train_loss= 0.53663 train_f1_mic= 0.40888 train_f1_mac= 0.10328 val_loss= 0.56851 val_f1_mic= 0.40053 val_f1_mac= 0.10803 time= 0.07548
Epoch: 0004
Iter: 0003 train_loss= 0.54898 train_f1_mic= 0.36972 train_f1_mac= 0.08887 val_loss= 0.56908 val_f1_mic= 0.38759 val_f1_mac= 0.10237 time= 0.07458
Iter: 0008 train_loss= 0.53866 train_f1_mic= 0.39126 train_f1_mac= 0.09709 val_loss= 0.56908 val_f1_mic= 0.38759 val_f1_mac= 0.10237 time= 0.07349
Iter: 0013 train_loss= 0.54602 train_f1_mic= 0.37385 train_f1_mac= 0.09163 val_loss= 0.56908 val_f1_mic= 0.38759 val_f1_mac= 0.10237 time= 0.07256
Iter: 0018 train_loss= 0.55077 train_f1_mic= 0.36475 train_f1_mac= 0.08778 val_loss= 0.56908 val_f1_mic= 0.38759 val_f1_mac= 0.10237 time= 0.07172
Epoch: 0005
Iter: 0004 train_loss= 0.53597 train_f1_mic= 0.38691 train_f1_mac= 0.09290 val_loss= 0.57557 val_f1_mic= 0.35419 val_f1_mac= 0.09020 time= 0.07130
Iter: 0009 train_loss= 0.53608 train_f1_mic= 0.40824 train_f1_mac= 0.10304 val_loss= 0.57557 val_f1_mic= 0.35419 val_f1_mac= 0.09020 time= 0.07064
Iter: 0014 train_loss= 0.53506 train_f1_mic= 0.37468 train_f1_mac= 0.08920 val_loss= 0.57557 val_f1_mic= 0.35419 val_f1_mac= 0.09020 time= 0.07006
Epoch: 0006
Iter: 0000 train_loss= 0.54543 train_f1_mic= 0.36776 train_f1_mac= 0.09053 val_loss= 0.57093 val_f1_mic= 0.37276 val_f1_mac= 0.09665 time= 0.06981
Iter: 0005 train_loss= 0.52913 train_f1_mic= 0.37967 train_f1_mac= 0.08967 val_loss= 0.57093 val_f1_mic= 0.37276 val_f1_mac= 0.09665 time= 0.06939
Iter: 0010 train_loss= 0.54491 train_f1_mic= 0.39189 train_f1_mac= 0.09825 val_loss= 0.57093 val_f1_mic= 0.37276 val_f1_mac= 0.09665 time= 0.06898
Iter: 0015 train_loss= 0.54076 train_f1_mic= 0.37728 train_f1_mac= 0.09406 val_loss= 0.57093 val_f1_mic= 0.37276 val_f1_mac= 0.09665 time= 0.06861
Epoch: 0007
Iter: 0001 train_loss= 0.53790 train_f1_mic= 0.38812 train_f1_mac= 0.09680 val_loss= 0.57121 val_f1_mic= 0.37364 val_f1_mac= 0.10008 time= 0.06846
Iter: 0006 train_loss= 0.55328 train_f1_mic= 0.37984 train_f1_mac= 0.09842 val_loss= 0.57121 val_f1_mic= 0.37364 val_f1_mac= 0.10008 time= 0.06818
Iter: 0011 train_loss= 0.54803 train_f1_mic= 0.37666 train_f1_mac= 0.09900 val_loss= 0.57121 val_f1_mic= 0.37364 val_f1_mac= 0.10008 time= 0.06791
Iter: 0016 train_loss= 0.53534 train_f1_mic= 0.38022 train_f1_mac= 0.09445 val_loss= 0.57121 val_f1_mic= 0.37364 val_f1_mac= 0.10008 time= 0.06768
Epoch: 0008
Iter: 0002 train_loss= 0.53446 train_f1_mic= 0.37141 train_f1_mac= 0.08980 val_loss= 0.56702 val_f1_mic= 0.36112 val_f1_mac= 0.09288 time= 0.06758
Iter: 0007 train_loss= 0.54905 train_f1_mic= 0.36975 train_f1_mac= 0.09258 val_loss= 0.56702 val_f1_mic= 0.36112 val_f1_mac= 0.09288 time= 0.06736
Iter: 0012 train_loss= 0.54336 train_f1_mic= 0.39765 train_f1_mac= 0.10327 val_loss= 0.56702 val_f1_mic= 0.36112 val_f1_mac= 0.09288 time= 0.06716
Iter: 0017 train_loss= 0.53948 train_f1_mic= 0.41018 train_f1_mac= 0.11569 val_loss= 0.56702 val_f1_mic= 0.36112 val_f1_mac= 0.09288 time= 0.06696
Epoch: 0009
Iter: 0003 train_loss= 0.53818 train_f1_mic= 0.38177 train_f1_mac= 0.10010 val_loss= 0.55443 val_f1_mic= 0.39889 val_f1_mac= 0.11572 time= 0.06691
Iter: 0008 train_loss= 0.53183 train_f1_mic= 0.40403 train_f1_mac= 0.11349 val_loss= 0.55443 val_f1_mic= 0.39889 val_f1_mac= 0.11572 time= 0.06674
Iter: 0013 train_loss= 0.53739 train_f1_mic= 0.40427 train_f1_mac= 0.11192 val_loss= 0.55443 val_f1_mic= 0.39889 val_f1_mac= 0.11572 time= 0.06658
Iter: 0018 train_loss= 0.53967 train_f1_mic= 0.38896 train_f1_mac= 0.11079 val_loss= 0.55443 val_f1_mic= 0.39889 val_f1_mac= 0.11572 time= 0.06642
Epoch: 0010
Iter: 0004 train_loss= 0.53470 train_f1_mic= 0.42219 train_f1_mac= 0.12991 val_loss= 0.55258 val_f1_mic= 0.41164 val_f1_mac= 0.12879 time= 0.06641
Iter: 0009 train_loss= 0.53251 train_f1_mic= 0.39305 train_f1_mac= 0.11407 val_loss= 0.55258 val_f1_mic= 0.41164 val_f1_mac= 0.12879 time= 0.06626
Iter: 0014 train_loss= 0.52790 train_f1_mic= 0.42806 train_f1_mac= 0.12484 val_loss= 0.55258 val_f1_mic= 0.41164 val_f1_mac= 0.12879 time= 0.06614
Optimization Finished!
Full validation stats: loss= 0.55042 f1_micro= 0.43079 f1_macro= 0.13985 time= 0.15561
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.45624175455764715
Rewards :  -0.027891865697492135 Accuracy :  0.4339282619996534
Total reward :  1.2398563798326334
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'sigmoid', 0, 'tanh']
Training RNN (Reward ip) :  [-0.02789187]
Trial 343: Controller loss : 7743.140625
2018-08-31 01:12:33.973686: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:12:33.974131: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:12:33.974556: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:12:33.974866: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:12:33.975254: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'tanh', 1, 'sigmoid']
Epoch: 0001
Iter: 0000 train_loss= 0.69443 train_f1_mic= 0.36516 train_f1_mac= 0.24353 val_loss= 0.65616 val_f1_mic= 0.38645 val_f1_mac= 0.10256 time= 1.07509
Iter: 0005 train_loss= 0.56969 train_f1_mic= 0.37149 train_f1_mac= 0.08771 val_loss= 0.65616 val_f1_mic= 0.38645 val_f1_mac= 0.10256 time= 0.24134
Iter: 0010 train_loss= 0.54888 train_f1_mic= 0.38668 train_f1_mac= 0.09715 val_loss= 0.65616 val_f1_mic= 0.38645 val_f1_mac= 0.10256 time= 0.16464
Iter: 0015 train_loss= 0.54125 train_f1_mic= 0.39661 train_f1_mac= 0.10115 val_loss= 0.65616 val_f1_mic= 0.38645 val_f1_mac= 0.10256 time= 0.13794
Epoch: 0002
Iter: 0001 train_loss= 0.54028 train_f1_mic= 0.37073 train_f1_mac= 0.08774 val_loss= 0.56101 val_f1_mic= 0.35582 val_f1_mac= 0.08795 time= 0.12447
Iter: 0006 train_loss= 0.53748 train_f1_mic= 0.38576 train_f1_mac= 0.09540 val_loss= 0.56101 val_f1_mic= 0.35582 val_f1_mac= 0.08795 time= 0.11484
Iter: 0011 train_loss= 0.54173 train_f1_mic= 0.38395 train_f1_mac= 0.09635 val_loss= 0.56101 val_f1_mic= 0.35582 val_f1_mac= 0.08795 time= 0.10829
Iter: 0016 train_loss= 0.54309 train_f1_mic= 0.38590 train_f1_mac= 0.10081 val_loss= 0.56101 val_f1_mic= 0.35582 val_f1_mac= 0.08795 time= 0.10388
Epoch: 0003
Iter: 0002 train_loss= 0.54852 train_f1_mic= 0.38994 train_f1_mac= 0.11188 val_loss= 0.54743 val_f1_mic= 0.39343 val_f1_mac= 0.11032 time= 0.10080
Iter: 0007 train_loss= 0.53232 train_f1_mic= 0.41190 train_f1_mac= 0.12113 val_loss= 0.54743 val_f1_mic= 0.39343 val_f1_mac= 0.11032 time= 0.09795
Iter: 0012 train_loss= 0.53783 train_f1_mic= 0.40406 train_f1_mac= 0.12110 val_loss= 0.54743 val_f1_mic= 0.39343 val_f1_mac= 0.11032 time= 0.09545
Iter: 0017 train_loss= 0.53205 train_f1_mic= 0.41064 train_f1_mac= 0.12081 val_loss= 0.54743 val_f1_mic= 0.39343 val_f1_mac= 0.11032 time= 0.09385
Epoch: 0004
Iter: 0003 train_loss= 0.54008 train_f1_mic= 0.40601 train_f1_mac= 0.12524 val_loss= 0.56087 val_f1_mic= 0.40139 val_f1_mac= 0.12455 time= 0.09276
Iter: 0008 train_loss= 0.53824 train_f1_mic= 0.39796 train_f1_mac= 0.12215 val_loss= 0.56087 val_f1_mic= 0.40139 val_f1_mac= 0.12455 time= 0.09133
Iter: 0013 train_loss= 0.52911 train_f1_mic= 0.42092 train_f1_mac= 0.12819 val_loss= 0.56087 val_f1_mic= 0.40139 val_f1_mac= 0.12455 time= 0.09015
Iter: 0018 train_loss= 0.53015 train_f1_mic= 0.41853 train_f1_mac= 0.13445 val_loss= 0.56087 val_f1_mic= 0.40139 val_f1_mac= 0.12455 time= 0.08932
Epoch: 0005
Iter: 0004 train_loss= 0.53664 train_f1_mic= 0.40829 train_f1_mac= 0.13131 val_loss= 0.54762 val_f1_mic= 0.42600 val_f1_mac= 0.14264 time= 0.08907
Iter: 0009 train_loss= 0.52592 train_f1_mic= 0.43332 train_f1_mac= 0.14294 val_loss= 0.54762 val_f1_mic= 0.42600 val_f1_mac= 0.14264 time= 0.08847
Iter: 0014 train_loss= 0.51697 train_f1_mic= 0.41849 train_f1_mac= 0.13066 val_loss= 0.54762 val_f1_mic= 0.42600 val_f1_mac= 0.14264 time= 0.08767
Epoch: 0006
Iter: 0000 train_loss= 0.52383 train_f1_mic= 0.43989 train_f1_mac= 0.14914 val_loss= 0.53677 val_f1_mic= 0.43820 val_f1_mac= 0.15543 time= 0.08729
Iter: 0005 train_loss= 0.52607 train_f1_mic= 0.42221 train_f1_mac= 0.14366 val_loss= 0.53677 val_f1_mic= 0.43820 val_f1_mac= 0.15543 time= 0.08683
Iter: 0010 train_loss= 0.52108 train_f1_mic= 0.42965 train_f1_mac= 0.14574 val_loss= 0.53677 val_f1_mic= 0.43820 val_f1_mac= 0.15543 time= 0.08636
Iter: 0015 train_loss= 0.53615 train_f1_mic= 0.43877 train_f1_mac= 0.16840 val_loss= 0.53677 val_f1_mic= 0.43820 val_f1_mac= 0.15543 time= 0.08603
Epoch: 0007
Iter: 0001 train_loss= 0.51559 train_f1_mic= 0.43651 train_f1_mac= 0.16062 val_loss= 0.55635 val_f1_mic= 0.43473 val_f1_mac= 0.17163 time= 0.08589
Iter: 0006 train_loss= 0.52263 train_f1_mic= 0.43632 train_f1_mac= 0.16993 val_loss= 0.55635 val_f1_mic= 0.43473 val_f1_mac= 0.17163 time= 0.08557
Iter: 0011 train_loss= 0.52473 train_f1_mic= 0.45047 train_f1_mac= 0.18438 val_loss= 0.55635 val_f1_mic= 0.43473 val_f1_mac= 0.17163 time= 0.08509
Iter: 0016 train_loss= 0.50988 train_f1_mic= 0.44604 train_f1_mac= 0.18145 val_loss= 0.55635 val_f1_mic= 0.43473 val_f1_mac= 0.17163 time= 0.08475
Epoch: 0008
Iter: 0002 train_loss= 0.51657 train_f1_mic= 0.48259 train_f1_mac= 0.21288 val_loss= 0.54832 val_f1_mic= 0.45616 val_f1_mac= 0.19391 time= 0.08463
Iter: 0007 train_loss= 0.50880 train_f1_mic= 0.43329 train_f1_mac= 0.16455 val_loss= 0.54832 val_f1_mic= 0.45616 val_f1_mac= 0.19391 time= 0.08437
Iter: 0012 train_loss= 0.52306 train_f1_mic= 0.45703 train_f1_mac= 0.19891 val_loss= 0.54832 val_f1_mic= 0.45616 val_f1_mac= 0.19391 time= 0.08418
Iter: 0017 train_loss= 0.51816 train_f1_mic= 0.44491 train_f1_mac= 0.17969 val_loss= 0.54832 val_f1_mic= 0.45616 val_f1_mac= 0.19391 time= 0.08389
Epoch: 0009
Iter: 0003 train_loss= 0.51982 train_f1_mic= 0.44689 train_f1_mac= 0.17677 val_loss= 0.52757 val_f1_mic= 0.46806 val_f1_mac= 0.20132 time= 0.08372
Iter: 0008 train_loss= 0.51497 train_f1_mic= 0.43180 train_f1_mac= 0.18184 val_loss= 0.52757 val_f1_mic= 0.46806 val_f1_mac= 0.20132 time= 0.08346
Iter: 0013 train_loss= 0.51180 train_f1_mic= 0.46417 train_f1_mac= 0.19815 val_loss= 0.52757 val_f1_mic= 0.46806 val_f1_mac= 0.20132 time= 0.08327
Iter: 0018 train_loss= 0.50992 train_f1_mic= 0.45025 train_f1_mac= 0.19026 val_loss= 0.52757 val_f1_mic= 0.46806 val_f1_mac= 0.20132 time= 0.08296
Epoch: 0010
Iter: 0004 train_loss= 0.50544 train_f1_mic= 0.47541 train_f1_mac= 0.20751 val_loss= 0.52665 val_f1_mic= 0.46661 val_f1_mac= 0.22111 time= 0.08298
Iter: 0009 train_loss= 0.51023 train_f1_mic= 0.46140 train_f1_mac= 0.21090 val_loss= 0.52665 val_f1_mic= 0.46661 val_f1_mac= 0.22111 time= 0.08278
Iter: 0014 train_loss= 0.51511 train_f1_mic= 0.45750 train_f1_mac= 0.19715 val_loss= 0.52665 val_f1_mic= 0.46661 val_f1_mac= 0.22111 time= 0.08252
Optimization Finished!
Full validation stats: loss= 0.52650 f1_micro= 0.47802 f1_macro= 0.23311 time= 0.16655
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.45975254914797525
Rewards :  0.017553972951640295 Accuracy :  0.47379572750928745
Total reward :  1.2574103527842737
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'tanh', 1, 'sigmoid']
Training RNN (Reward ip) :  [0.01755397]
Trial 344: Controller loss : 7281.798828

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 4. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:12:55.900355: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:12:55.900651: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:12:55.900953: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:12:55.901167: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:12:55.901436: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69397 train_f1_mic= 0.38024 train_f1_mac= 0.30791 val_loss= 0.66471 val_f1_mic= 0.37847 val_f1_mac= 0.11237 time= 0.76573
Iter: 0005 train_loss= 0.58895 train_f1_mic= 0.37431 train_f1_mac= 0.08825 val_loss= 0.66471 val_f1_mic= 0.37847 val_f1_mac= 0.11237 time= 0.14043
Iter: 0010 train_loss= 0.55650 train_f1_mic= 0.36266 train_f1_mac= 0.08855 val_loss= 0.66471 val_f1_mic= 0.37847 val_f1_mac= 0.11237 time= 0.08348
Iter: 0015 train_loss= 0.53530 train_f1_mic= 0.40917 train_f1_mac= 0.10756 val_loss= 0.66471 val_f1_mic= 0.37847 val_f1_mac= 0.11237 time= 0.06219
Epoch: 0002
Iter: 0001 train_loss= 0.53064 train_f1_mic= 0.40680 train_f1_mac= 0.10479 val_loss= 0.56226 val_f1_mic= 0.39100 val_f1_mac= 0.10764 time= 0.05209
Iter: 0006 train_loss= 0.53919 train_f1_mic= 0.37707 train_f1_mac= 0.08964 val_loss= 0.56226 val_f1_mic= 0.39100 val_f1_mac= 0.10764 time= 0.04502
Iter: 0011 train_loss= 0.54452 train_f1_mic= 0.37862 train_f1_mac= 0.09786 val_loss= 0.56226 val_f1_mic= 0.39100 val_f1_mac= 0.10764 time= 0.04027
Iter: 0016 train_loss= 0.55597 train_f1_mic= 0.38619 train_f1_mac= 0.10635 val_loss= 0.56226 val_f1_mic= 0.39100 val_f1_mac= 0.10764 time= 0.03687
Epoch: 0003
Iter: 0002 train_loss= 0.52939 train_f1_mic= 0.38463 train_f1_mac= 0.10192 val_loss= 0.55859 val_f1_mic= 0.38120 val_f1_mac= 0.10712 time= 0.03490
Iter: 0007 train_loss= 0.53152 train_f1_mic= 0.38596 train_f1_mac= 0.10799 val_loss= 0.55859 val_f1_mic= 0.38120 val_f1_mac= 0.10712 time= 0.03263
Iter: 0012 train_loss= 0.53391 train_f1_mic= 0.40485 train_f1_mac= 0.12185 val_loss= 0.55859 val_f1_mic= 0.38120 val_f1_mac= 0.10712 time= 0.03093
Iter: 0017 train_loss= 0.52168 train_f1_mic= 0.42476 train_f1_mac= 0.12793 val_loss= 0.55859 val_f1_mic= 0.38120 val_f1_mac= 0.10712 time= 0.02944
Epoch: 0004
Iter: 0003 train_loss= 0.52092 train_f1_mic= 0.40913 train_f1_mac= 0.12457 val_loss= 0.54886 val_f1_mic= 0.40445 val_f1_mac= 0.12935 time= 0.02869
Iter: 0008 train_loss= 0.52905 train_f1_mic= 0.40401 train_f1_mac= 0.12485 val_loss= 0.54886 val_f1_mic= 0.40445 val_f1_mac= 0.12935 time= 0.02758
Iter: 0013 train_loss= 0.51645 train_f1_mic= 0.43735 train_f1_mac= 0.14756 val_loss= 0.54886 val_f1_mic= 0.40445 val_f1_mac= 0.12935 time= 0.02681
Iter: 0018 train_loss= 0.52408 train_f1_mic= 0.43256 train_f1_mac= 0.15296 val_loss= 0.54886 val_f1_mic= 0.40445 val_f1_mac= 0.12935 time= 0.02607
Epoch: 0005
Iter: 0004 train_loss= 0.53063 train_f1_mic= 0.44332 train_f1_mac= 0.16191 val_loss= 0.54512 val_f1_mic= 0.45012 val_f1_mac= 0.17115 time= 0.02565
Iter: 0009 train_loss= 0.52098 train_f1_mic= 0.43637 train_f1_mac= 0.15691 val_loss= 0.54512 val_f1_mic= 0.45012 val_f1_mac= 0.17115 time= 0.02507
Iter: 0014 train_loss= 0.53512 train_f1_mic= 0.40982 train_f1_mac= 0.14622 val_loss= 0.54512 val_f1_mic= 0.45012 val_f1_mac= 0.17115 time= 0.02459
Epoch: 0006
Iter: 0000 train_loss= 0.52312 train_f1_mic= 0.43353 train_f1_mac= 0.17599 val_loss= 0.53003 val_f1_mic= 0.44018 val_f1_mac= 0.18049 time= 0.02420
Iter: 0005 train_loss= 0.51636 train_f1_mic= 0.44805 train_f1_mac= 0.18308 val_loss= 0.53003 val_f1_mic= 0.44018 val_f1_mac= 0.18049 time= 0.02386
Iter: 0010 train_loss= 0.51513 train_f1_mic= 0.44546 train_f1_mac= 0.17878 val_loss= 0.53003 val_f1_mic= 0.44018 val_f1_mac= 0.18049 time= 0.02338
Iter: 0015 train_loss= 0.51914 train_f1_mic= 0.45792 train_f1_mac= 0.18986 val_loss= 0.53003 val_f1_mic= 0.44018 val_f1_mac= 0.18049 time= 0.02298
Epoch: 0007
Iter: 0001 train_loss= 0.50114 train_f1_mic= 0.44408 train_f1_mac= 0.17893 val_loss= 0.54520 val_f1_mic= 0.43882 val_f1_mac= 0.18308 time= 0.02295
Iter: 0006 train_loss= 0.50855 train_f1_mic= 0.46376 train_f1_mac= 0.20021 val_loss= 0.54520 val_f1_mic= 0.43882 val_f1_mac= 0.18308 time= 0.02269
Iter: 0011 train_loss= 0.51008 train_f1_mic= 0.46568 train_f1_mac= 0.20240 val_loss= 0.54520 val_f1_mic= 0.43882 val_f1_mac= 0.18308 time= 0.02243
Iter: 0016 train_loss= 0.50635 train_f1_mic= 0.46318 train_f1_mac= 0.20566 val_loss= 0.54520 val_f1_mic= 0.43882 val_f1_mac= 0.18308 time= 0.02217
Epoch: 0008
Iter: 0002 train_loss= 0.49930 train_f1_mic= 0.49617 train_f1_mac= 0.24860 val_loss= 0.52237 val_f1_mic= 0.49524 val_f1_mac= 0.24437 time= 0.02199
Iter: 0007 train_loss= 0.50436 train_f1_mic= 0.49935 train_f1_mac= 0.24821 val_loss= 0.52237 val_f1_mic= 0.49524 val_f1_mac= 0.24437 time= 0.02171
Iter: 0012 train_loss= 0.50844 train_f1_mic= 0.45637 train_f1_mac= 0.22291 val_loss= 0.52237 val_f1_mic= 0.49524 val_f1_mac= 0.24437 time= 0.02152
Iter: 0017 train_loss= 0.50526 train_f1_mic= 0.50154 train_f1_mac= 0.25813 val_loss= 0.52237 val_f1_mic= 0.49524 val_f1_mac= 0.24437 time= 0.02129
Epoch: 0009
Iter: 0003 train_loss= 0.49756 train_f1_mic= 0.48933 train_f1_mac= 0.23922 val_loss= 0.52340 val_f1_mic= 0.44972 val_f1_mac= 0.20619 time= 0.02135
Iter: 0008 train_loss= 0.50517 train_f1_mic= 0.48336 train_f1_mac= 0.25207 val_loss= 0.52340 val_f1_mic= 0.44972 val_f1_mac= 0.20619 time= 0.02115
Iter: 0013 train_loss= 0.50021 train_f1_mic= 0.44793 train_f1_mac= 0.20608 val_loss= 0.52340 val_f1_mic= 0.44972 val_f1_mac= 0.20619 time= 0.02099
Iter: 0018 train_loss= 0.50735 train_f1_mic= 0.48817 train_f1_mac= 0.25231 val_loss= 0.52340 val_f1_mic= 0.44972 val_f1_mac= 0.20619 time= 0.02078
Epoch: 0010
Iter: 0004 train_loss= 0.50005 train_f1_mic= 0.49207 train_f1_mac= 0.24998 val_loss= 0.50511 val_f1_mic= 0.50623 val_f1_mac= 0.28275 time= 0.02086
Iter: 0009 train_loss= 0.49583 train_f1_mic= 0.49753 train_f1_mac= 0.25957 val_loss= 0.50511 val_f1_mic= 0.50623 val_f1_mac= 0.28275 time= 0.02075
Iter: 0014 train_loss= 0.48913 train_f1_mic= 0.48695 train_f1_mac= 0.25400 val_loss= 0.50511 val_f1_mic= 0.50623 val_f1_mac= 0.28275 time= 0.02063
Optimization Finished!
Full validation stats: loss= 0.50893 f1_micro= 0.51215 f1_macro= 0.28791 time= 0.10574
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46874700025417526
Rewards :  0.04497225553099993 Accuracy :  0.5047248046789752
Total reward :  1.3023826083152736
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.04497226]
Trial 345: Controller loss : 142.284531

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [0, 'tanh', 4, 'linear']
2018-08-31 01:13:05.436409: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:13:05.437221: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:13:05.438072: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:13:05.438706: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:13:05.439475: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69396 train_f1_mic= 0.37583 train_f1_mac= 0.34957 val_loss= 0.68326 val_f1_mic= 0.41057 val_f1_mac= 0.33661 time= 0.73238
Iter: 0005 train_loss= 0.59653 train_f1_mic= 0.39134 train_f1_mac= 0.16276 val_loss= 0.68326 val_f1_mic= 0.41057 val_f1_mac= 0.33661 time= 0.13187
Iter: 0010 train_loss= 0.56447 train_f1_mic= 0.39682 train_f1_mac= 0.13545 val_loss= 0.68326 val_f1_mic= 0.41057 val_f1_mac= 0.33661 time= 0.07772
Iter: 0015 train_loss= 0.56259 train_f1_mic= 0.39784 train_f1_mac= 0.14210 val_loss= 0.68326 val_f1_mic= 0.41057 val_f1_mac= 0.33661 time= 0.05748
Epoch: 0002
Iter: 0001 train_loss= 0.53657 train_f1_mic= 0.39375 train_f1_mac= 0.12280 val_loss= 0.57591 val_f1_mic= 0.37809 val_f1_mac= 0.12172 time= 0.04778
Iter: 0006 train_loss= 0.54180 train_f1_mic= 0.39896 train_f1_mac= 0.12071 val_loss= 0.57591 val_f1_mic= 0.37809 val_f1_mac= 0.12172 time= 0.04090
Iter: 0011 train_loss= 0.52952 train_f1_mic= 0.41428 train_f1_mac= 0.13307 val_loss= 0.57591 val_f1_mic= 0.37809 val_f1_mac= 0.12172 time= 0.03636
Iter: 0016 train_loss= 0.53591 train_f1_mic= 0.40494 train_f1_mac= 0.12549 val_loss= 0.57591 val_f1_mic= 0.37809 val_f1_mac= 0.12172 time= 0.03319
Epoch: 0003
Iter: 0002 train_loss= 0.53103 train_f1_mic= 0.43797 train_f1_mac= 0.15815 val_loss= 0.55085 val_f1_mic= 0.44645 val_f1_mac= 0.16940 time= 0.03146
Iter: 0007 train_loss= 0.52711 train_f1_mic= 0.42174 train_f1_mac= 0.14383 val_loss= 0.55085 val_f1_mic= 0.44645 val_f1_mac= 0.16940 time= 0.02938
Iter: 0012 train_loss= 0.52218 train_f1_mic= 0.42320 train_f1_mac= 0.15261 val_loss= 0.55085 val_f1_mic= 0.44645 val_f1_mac= 0.16940 time= 0.02756
Iter: 0017 train_loss= 0.53131 train_f1_mic= 0.42888 train_f1_mac= 0.15424 val_loss= 0.55085 val_f1_mic= 0.44645 val_f1_mac= 0.16940 time= 0.02625
Epoch: 0004
Iter: 0003 train_loss= 0.52423 train_f1_mic= 0.42778 train_f1_mac= 0.15239 val_loss= 0.55401 val_f1_mic= 0.41664 val_f1_mac= 0.16037 time= 0.02562
Iter: 0008 train_loss= 0.52534 train_f1_mic= 0.43483 train_f1_mac= 0.16453 val_loss= 0.55401 val_f1_mic= 0.41664 val_f1_mac= 0.16037 time= 0.02454
Iter: 0013 train_loss= 0.53430 train_f1_mic= 0.43102 train_f1_mac= 0.17076 val_loss= 0.55401 val_f1_mic= 0.41664 val_f1_mac= 0.16037 time= 0.02371
Iter: 0018 train_loss= 0.53917 train_f1_mic= 0.41723 train_f1_mac= 0.14704 val_loss= 0.55401 val_f1_mic= 0.41664 val_f1_mac= 0.16037 time= 0.02298
Epoch: 0005
Iter: 0004 train_loss= 0.53135 train_f1_mic= 0.43752 train_f1_mac= 0.17919 val_loss= 0.54283 val_f1_mic= 0.42806 val_f1_mac= 0.17140 time= 0.02242
Iter: 0009 train_loss= 0.52593 train_f1_mic= 0.43575 train_f1_mac= 0.16511 val_loss= 0.54283 val_f1_mic= 0.42806 val_f1_mac= 0.17140 time= 0.02177
Iter: 0014 train_loss= 0.51825 train_f1_mic= 0.43437 train_f1_mac= 0.16317 val_loss= 0.54283 val_f1_mic= 0.42806 val_f1_mac= 0.17140 time= 0.02132
Epoch: 0006
Iter: 0000 train_loss= 0.53075 train_f1_mic= 0.43030 train_f1_mac= 0.16412 val_loss= 0.55387 val_f1_mic= 0.44914 val_f1_mac= 0.18109 time= 0.02109
Iter: 0005 train_loss= 0.52511 train_f1_mic= 0.42842 train_f1_mac= 0.16005 val_loss= 0.55387 val_f1_mic= 0.44914 val_f1_mac= 0.18109 time= 0.02071
Iter: 0010 train_loss= 0.52649 train_f1_mic= 0.42879 train_f1_mac= 0.16591 val_loss= 0.55387 val_f1_mic= 0.44914 val_f1_mac= 0.18109 time= 0.02034
Iter: 0015 train_loss= 0.51742 train_f1_mic= 0.43021 train_f1_mac= 0.16857 val_loss= 0.55387 val_f1_mic= 0.44914 val_f1_mac= 0.18109 time= 0.02006
Epoch: 0007
Iter: 0001 train_loss= 0.51565 train_f1_mic= 0.44498 train_f1_mac= 0.17151 val_loss= 0.53838 val_f1_mic= 0.45229 val_f1_mac= 0.18192 time= 0.02000
Iter: 0006 train_loss= 0.52270 train_f1_mic= 0.45303 train_f1_mac= 0.19063 val_loss= 0.53838 val_f1_mic= 0.45229 val_f1_mac= 0.18192 time= 0.01976
Iter: 0011 train_loss= 0.51563 train_f1_mic= 0.44451 train_f1_mac= 0.19031 val_loss= 0.53838 val_f1_mic= 0.45229 val_f1_mac= 0.18192 time= 0.01942
Iter: 0016 train_loss= 0.52020 train_f1_mic= 0.42871 train_f1_mac= 0.16279 val_loss= 0.53838 val_f1_mic= 0.45229 val_f1_mac= 0.18192 time= 0.01936
Epoch: 0008
Iter: 0002 train_loss= 0.51462 train_f1_mic= 0.45241 train_f1_mac= 0.19352 val_loss= 0.54635 val_f1_mic= 0.47326 val_f1_mac= 0.23162 time= 0.01929
Iter: 0007 train_loss= 0.53012 train_f1_mic= 0.43345 train_f1_mac= 0.18163 val_loss= 0.54635 val_f1_mic= 0.47326 val_f1_mac= 0.23162 time= 0.01902
Iter: 0012 train_loss= 0.52273 train_f1_mic= 0.45592 train_f1_mac= 0.20722 val_loss= 0.54635 val_f1_mic= 0.47326 val_f1_mac= 0.23162 time= 0.01881
Iter: 0017 train_loss= 0.51010 train_f1_mic= 0.44620 train_f1_mac= 0.18583 val_loss= 0.54635 val_f1_mic= 0.47326 val_f1_mac= 0.23162 time= 0.01865
Epoch: 0009
Iter: 0003 train_loss= 0.50784 train_f1_mic= 0.44133 train_f1_mac= 0.18153 val_loss= 0.53722 val_f1_mic= 0.45482 val_f1_mac= 0.21785 time= 0.01863
Iter: 0008 train_loss= 0.50197 train_f1_mic= 0.46328 train_f1_mac= 0.21433 val_loss= 0.53722 val_f1_mic= 0.45482 val_f1_mac= 0.21785 time= 0.01846
Iter: 0013 train_loss= 0.53103 train_f1_mic= 0.45634 train_f1_mac= 0.20807 val_loss= 0.53722 val_f1_mic= 0.45482 val_f1_mac= 0.21785 time= 0.01824
Iter: 0018 train_loss= 0.51403 train_f1_mic= 0.45765 train_f1_mac= 0.20353 val_loss= 0.53722 val_f1_mic= 0.45482 val_f1_mac= 0.21785 time= 0.01808
Epoch: 0010
Iter: 0004 train_loss= 0.52359 train_f1_mic= 0.45171 train_f1_mac= 0.19384 val_loss= 0.52855 val_f1_mic= 0.44828 val_f1_mac= 0.20492 time= 0.01799
Iter: 0009 train_loss= 0.50990 train_f1_mic= 0.45973 train_f1_mac= 0.21301 val_loss= 0.52855 val_f1_mic= 0.44828 val_f1_mac= 0.20492 time= 0.01786
Iter: 0014 train_loss= 0.51339 train_f1_mic= 0.44866 train_f1_mac= 0.20620 val_loss= 0.52855 val_f1_mic= 0.44828 val_f1_mac= 0.20492 time= 0.01773
Optimization Finished!
Full validation stats: loss= 0.53260 f1_micro= 0.47813 f1_macro= 0.24164 time= 0.09874
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4691996997093388
Rewards :  0.002263497275817705 Accuracy :  0.47101049752999297
Total reward :  1.3046461055910914
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'tanh', 4, 'linear']
Training RNN (Reward ip) :  [0.0022635]
Trial 346: Controller loss : 12034.755859

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [0, 'linear', 2, 'tanh']
2018-08-31 01:13:14.146242: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:13:14.146984: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:13:14.147710: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:13:14.148255: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:13:14.148911: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69403 train_f1_mic= 0.36627 train_f1_mac= 0.33394 val_loss= 0.67640 val_f1_mic= 0.38608 val_f1_mac= 0.20131 time= 0.75897
Iter: 0005 train_loss= 0.59662 train_f1_mic= 0.38958 train_f1_mac= 0.09444 val_loss= 0.67640 val_f1_mic= 0.38608 val_f1_mac= 0.20131 time= 0.13829
Iter: 0010 train_loss= 0.55787 train_f1_mic= 0.38825 train_f1_mac= 0.09849 val_loss= 0.67640 val_f1_mic= 0.38608 val_f1_mac= 0.20131 time= 0.08168
Iter: 0015 train_loss= 0.55204 train_f1_mic= 0.40829 train_f1_mac= 0.11936 val_loss= 0.67640 val_f1_mic= 0.38608 val_f1_mac= 0.20131 time= 0.06095
Epoch: 0002
Iter: 0001 train_loss= 0.53434 train_f1_mic= 0.41493 train_f1_mac= 0.12548 val_loss= 0.56213 val_f1_mic= 0.40738 val_f1_mac= 0.13093 time= 0.05095
Iter: 0006 train_loss= 0.53539 train_f1_mic= 0.40404 train_f1_mac= 0.12342 val_loss= 0.56213 val_f1_mic= 0.40738 val_f1_mac= 0.13093 time= 0.04411
Iter: 0011 train_loss= 0.53641 train_f1_mic= 0.40776 train_f1_mac= 0.12812 val_loss= 0.56213 val_f1_mic= 0.40738 val_f1_mac= 0.13093 time= 0.03947
Iter: 0016 train_loss= 0.52296 train_f1_mic= 0.42113 train_f1_mac= 0.13749 val_loss= 0.56213 val_f1_mic= 0.40738 val_f1_mac= 0.13093 time= 0.03578
Epoch: 0003
Iter: 0002 train_loss= 0.53774 train_f1_mic= 0.41779 train_f1_mac= 0.14235 val_loss= 0.53520 val_f1_mic= 0.41399 val_f1_mac= 0.13926 time= 0.03363
Iter: 0007 train_loss= 0.53112 train_f1_mic= 0.42966 train_f1_mac= 0.15283 val_loss= 0.53520 val_f1_mic= 0.41399 val_f1_mac= 0.13926 time= 0.03167
Iter: 0012 train_loss= 0.53345 train_f1_mic= 0.41962 train_f1_mac= 0.14494 val_loss= 0.53520 val_f1_mic= 0.41399 val_f1_mac= 0.13926 time= 0.03003
Iter: 0017 train_loss= 0.52067 train_f1_mic= 0.43094 train_f1_mac= 0.14932 val_loss= 0.53520 val_f1_mic= 0.41399 val_f1_mac= 0.13926 time= 0.02870
Epoch: 0004
Iter: 0003 train_loss= 0.51366 train_f1_mic= 0.42352 train_f1_mac= 0.13935 val_loss= 0.53467 val_f1_mic= 0.41252 val_f1_mac= 0.14414 time= 0.02847
Iter: 0008 train_loss= 0.52133 train_f1_mic= 0.42047 train_f1_mac= 0.14440 val_loss= 0.53467 val_f1_mic= 0.41252 val_f1_mac= 0.14414 time= 0.02739
Iter: 0013 train_loss= 0.51849 train_f1_mic= 0.44165 train_f1_mac= 0.15902 val_loss= 0.53467 val_f1_mic= 0.41252 val_f1_mac= 0.14414 time= 0.02651
Iter: 0018 train_loss= 0.52907 train_f1_mic= 0.43762 train_f1_mac= 0.16786 val_loss= 0.53467 val_f1_mic= 0.41252 val_f1_mac= 0.14414 time= 0.02571
Epoch: 0005
Iter: 0004 train_loss= 0.51734 train_f1_mic= 0.45145 train_f1_mac= 0.17501 val_loss= 0.54612 val_f1_mic= 0.44232 val_f1_mac= 0.17850 time= 0.02521
Iter: 0009 train_loss= 0.52339 train_f1_mic= 0.43442 train_f1_mac= 0.16624 val_loss= 0.54612 val_f1_mic= 0.44232 val_f1_mac= 0.17850 time= 0.02461
Iter: 0014 train_loss= 0.53800 train_f1_mic= 0.42045 train_f1_mac= 0.16025 val_loss= 0.54612 val_f1_mic= 0.44232 val_f1_mac= 0.17850 time= 0.02402
Epoch: 0006
Iter: 0000 train_loss= 0.51360 train_f1_mic= 0.45190 train_f1_mac= 0.17907 val_loss= 0.53973 val_f1_mic= 0.45110 val_f1_mac= 0.18477 time= 0.02380
Iter: 0005 train_loss= 0.52326 train_f1_mic= 0.43702 train_f1_mac= 0.16778 val_loss= 0.53973 val_f1_mic= 0.45110 val_f1_mac= 0.18477 time= 0.02333
Iter: 0010 train_loss= 0.52145 train_f1_mic= 0.44608 train_f1_mac= 0.17597 val_loss= 0.53973 val_f1_mic= 0.45110 val_f1_mac= 0.18477 time= 0.02292
Iter: 0015 train_loss= 0.50407 train_f1_mic= 0.45273 train_f1_mac= 0.17641 val_loss= 0.53973 val_f1_mic= 0.45110 val_f1_mac= 0.18477 time= 0.02259
Epoch: 0007
Iter: 0001 train_loss= 0.51298 train_f1_mic= 0.44659 train_f1_mac= 0.17520 val_loss= 0.56281 val_f1_mic= 0.43316 val_f1_mac= 0.18434 time= 0.02267
Iter: 0006 train_loss= 0.51775 train_f1_mic= 0.45238 train_f1_mac= 0.17733 val_loss= 0.56281 val_f1_mic= 0.43316 val_f1_mac= 0.18434 time= 0.02229
Iter: 0011 train_loss= 0.51770 train_f1_mic= 0.44501 train_f1_mac= 0.17569 val_loss= 0.56281 val_f1_mic= 0.43316 val_f1_mac= 0.18434 time= 0.02201
Iter: 0016 train_loss= 0.50955 train_f1_mic= 0.45203 train_f1_mac= 0.18131 val_loss= 0.56281 val_f1_mic= 0.43316 val_f1_mac= 0.18434 time= 0.02177
Epoch: 0008
Iter: 0002 train_loss= 0.51374 train_f1_mic= 0.45088 train_f1_mac= 0.19321 val_loss= 0.53964 val_f1_mic= 0.44845 val_f1_mac= 0.19259 time= 0.02180
Iter: 0007 train_loss= 0.51604 train_f1_mic= 0.46048 train_f1_mac= 0.20428 val_loss= 0.53964 val_f1_mic= 0.44845 val_f1_mac= 0.19259 time= 0.02151
Iter: 0012 train_loss= 0.50663 train_f1_mic= 0.45843 train_f1_mac= 0.19491 val_loss= 0.53964 val_f1_mic= 0.44845 val_f1_mac= 0.19259 time= 0.02122
Iter: 0017 train_loss= 0.50161 train_f1_mic= 0.45734 train_f1_mac= 0.18546 val_loss= 0.53964 val_f1_mic= 0.44845 val_f1_mac= 0.19259 time= 0.02103
Epoch: 0009
Iter: 0003 train_loss= 0.50038 train_f1_mic= 0.46245 train_f1_mac= 0.20417 val_loss= 0.54429 val_f1_mic= 0.45365 val_f1_mac= 0.19977 time= 0.02095
Iter: 0008 train_loss= 0.50402 train_f1_mic= 0.46653 train_f1_mac= 0.20435 val_loss= 0.54429 val_f1_mic= 0.45365 val_f1_mac= 0.19977 time= 0.02075
Iter: 0013 train_loss= 0.50057 train_f1_mic= 0.44653 train_f1_mac= 0.18325 val_loss= 0.54429 val_f1_mic= 0.45365 val_f1_mac= 0.19977 time= 0.02056
Iter: 0018 train_loss= 0.51366 train_f1_mic= 0.45812 train_f1_mac= 0.19078 val_loss= 0.54429 val_f1_mic= 0.45365 val_f1_mac= 0.19977 time= 0.02035
Epoch: 0010
Iter: 0004 train_loss= 0.50459 train_f1_mic= 0.46434 train_f1_mac= 0.19350 val_loss= 0.53669 val_f1_mic= 0.45449 val_f1_mac= 0.19404 time= 0.02026
Iter: 0009 train_loss= 0.52387 train_f1_mic= 0.45923 train_f1_mac= 0.19777 val_loss= 0.53669 val_f1_mic= 0.45449 val_f1_mac= 0.19404 time= 0.02011
Iter: 0014 train_loss= 0.48849 train_f1_mic= 0.46794 train_f1_mac= 0.21892 val_loss= 0.53669 val_f1_mic= 0.45449 val_f1_mac= 0.19404 time= 0.01995
Optimization Finished!
Full validation stats: loss= 0.52923 f1_micro= 0.46015 f1_macro= 0.21752 time= 0.12270
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46777266850865507
Rewards :  -0.007135156003418741 Accuracy :  0.46206454370592004
Total reward :  1.2975109495876727
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'linear', 2, 'tanh']
Training RNN (Reward ip) :  [-0.00713516]
Trial 347: Controller loss : 10563.897461
2018-08-31 01:13:23.706998: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:13:23.707441: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952]
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'sigmoid', 2, 'sigmoid']
Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:13:23.708081: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:13:23.708356: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:13:23.708737: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69360 train_f1_mic= 0.38296 train_f1_mac= 0.23040 val_loss= 0.65151 val_f1_mic= 0.36783 val_f1_mac= 0.09092 time= 0.84787
Iter: 0005 train_loss= 0.57240 train_f1_mic= 0.38540 train_f1_mac= 0.09349 val_loss= 0.65151 val_f1_mic= 0.36783 val_f1_mac= 0.09092 time= 0.17671
Iter: 0010 train_loss= 0.55537 train_f1_mic= 0.40203 train_f1_mac= 0.10461 val_loss= 0.65151 val_f1_mic= 0.36783 val_f1_mac= 0.09092 time= 0.11588
Iter: 0015 train_loss= 0.54348 train_f1_mic= 0.36996 train_f1_mac= 0.08746 val_loss= 0.65151 val_f1_mic= 0.36783 val_f1_mac= 0.09092 time= 0.09375
Epoch: 0002
Iter: 0001 train_loss= 0.55917 train_f1_mic= 0.36230 train_f1_mac= 0.08776 val_loss= 0.59723 val_f1_mic= 0.34833 val_f1_mac= 0.09047 time= 0.08254
Iter: 0006 train_loss= 0.54737 train_f1_mic= 0.41108 train_f1_mac= 0.10570 val_loss= 0.59723 val_f1_mic= 0.34833 val_f1_mac= 0.09047 time= 0.07499
Iter: 0011 train_loss= 0.54313 train_f1_mic= 0.37582 train_f1_mac= 0.09145 val_loss= 0.59723 val_f1_mic= 0.34833 val_f1_mac= 0.09047 time= 0.06997
Iter: 0016 train_loss= 0.53439 train_f1_mic= 0.37347 train_f1_mac= 0.08652 val_loss= 0.59723 val_f1_mic= 0.34833 val_f1_mac= 0.09047 time= 0.06618
Epoch: 0003
Iter: 0002 train_loss= 0.54155 train_f1_mic= 0.38431 train_f1_mac= 0.09300 val_loss= 0.56057 val_f1_mic= 0.37270 val_f1_mac= 0.09405 time= 0.06419
Iter: 0007 train_loss= 0.53000 train_f1_mic= 0.37830 train_f1_mac= 0.08941 val_loss= 0.56057 val_f1_mic= 0.37270 val_f1_mac= 0.09405 time= 0.06205
Iter: 0012 train_loss= 0.54431 train_f1_mic= 0.36633 train_f1_mac= 0.08688 val_loss= 0.56057 val_f1_mic= 0.37270 val_f1_mac= 0.09405 time= 0.06042
Iter: 0017 train_loss= 0.53294 train_f1_mic= 0.39957 train_f1_mac= 0.09787 val_loss= 0.56057 val_f1_mic= 0.37270 val_f1_mac= 0.09405 time= 0.05897
Epoch: 0004
Iter: 0003 train_loss= 0.54167 train_f1_mic= 0.39143 train_f1_mac= 0.09773 val_loss= 0.56042 val_f1_mic= 0.39662 val_f1_mac= 0.10540 time= 0.05838
Iter: 0008 train_loss= 0.53930 train_f1_mic= 0.37410 train_f1_mac= 0.08787 val_loss= 0.56042 val_f1_mic= 0.39662 val_f1_mac= 0.10540 time= 0.05730
Iter: 0013 train_loss= 0.53840 train_f1_mic= 0.38602 train_f1_mac= 0.09322 val_loss= 0.56042 val_f1_mic= 0.39662 val_f1_mac= 0.10540 time= 0.05631
Iter: 0018 train_loss= 0.54973 train_f1_mic= 0.40669 train_f1_mac= 0.10556 val_loss= 0.56042 val_f1_mic= 0.39662 val_f1_mac= 0.10540 time= 0.05572
Epoch: 0005
Iter: 0004 train_loss= 0.53449 train_f1_mic= 0.40851 train_f1_mac= 0.10278 val_loss= 0.56009 val_f1_mic= 0.40291 val_f1_mac= 0.10663 time= 0.05574
Iter: 0009 train_loss= 0.53874 train_f1_mic= 0.38107 train_f1_mac= 0.09199 val_loss= 0.56009 val_f1_mic= 0.40291 val_f1_mac= 0.10663 time= 0.05505
Iter: 0014 train_loss= 0.53580 train_f1_mic= 0.38705 train_f1_mac= 0.09261 val_loss= 0.56009 val_f1_mic= 0.40291 val_f1_mac= 0.10663 time= 0.05444
Epoch: 0006
Iter: 0000 train_loss= 0.53122 train_f1_mic= 0.39292 train_f1_mac= 0.09305 val_loss= 0.57198 val_f1_mic= 0.37689 val_f1_mac= 0.09716 time= 0.05426
Iter: 0005 train_loss= 0.54105 train_f1_mic= 0.37204 train_f1_mac= 0.09043 val_loss= 0.57198 val_f1_mic= 0.37689 val_f1_mac= 0.09716 time= 0.05378
Iter: 0010 train_loss= 0.54354 train_f1_mic= 0.37520 train_f1_mac= 0.09173 val_loss= 0.57198 val_f1_mic= 0.37689 val_f1_mac= 0.09716 time= 0.05338
Iter: 0015 train_loss= 0.54017 train_f1_mic= 0.38590 train_f1_mac= 0.09418 val_loss= 0.57198 val_f1_mic= 0.37689 val_f1_mac= 0.09716 time= 0.05294
Epoch: 0007
Iter: 0001 train_loss= 0.52219 train_f1_mic= 0.38823 train_f1_mac= 0.09177 val_loss= 0.56577 val_f1_mic= 0.36673 val_f1_mac= 0.09587 time= 0.05287
Iter: 0006 train_loss= 0.54072 train_f1_mic= 0.37758 train_f1_mac= 0.09208 val_loss= 0.56577 val_f1_mic= 0.36673 val_f1_mac= 0.09587 time= 0.05259
Iter: 0011 train_loss= 0.53971 train_f1_mic= 0.39045 train_f1_mac= 0.10159 val_loss= 0.56577 val_f1_mic= 0.36673 val_f1_mac= 0.09587 time= 0.05237
Iter: 0016 train_loss= 0.53452 train_f1_mic= 0.38236 train_f1_mac= 0.09445 val_loss= 0.56577 val_f1_mic= 0.36673 val_f1_mac= 0.09587 time= 0.05206
Epoch: 0008
Iter: 0002 train_loss= 0.53369 train_f1_mic= 0.37561 train_f1_mac= 0.09114 val_loss= 0.56177 val_f1_mic= 0.36881 val_f1_mac= 0.09508 time= 0.05209
Iter: 0007 train_loss= 0.53772 train_f1_mic= 0.40494 train_f1_mac= 0.11486 val_loss= 0.56177 val_f1_mic= 0.36881 val_f1_mac= 0.09508 time= 0.05181
Iter: 0012 train_loss= 0.53128 train_f1_mic= 0.39898 train_f1_mac= 0.10660 val_loss= 0.56177 val_f1_mic= 0.36881 val_f1_mac= 0.09508 time= 0.05150
Iter: 0017 train_loss= 0.54188 train_f1_mic= 0.40295 train_f1_mac= 0.11648 val_loss= 0.56177 val_f1_mic= 0.36881 val_f1_mac= 0.09508 time= 0.05128
Epoch: 0009
Iter: 0003 train_loss= 0.53476 train_f1_mic= 0.40892 train_f1_mac= 0.12362 val_loss= 0.55717 val_f1_mic= 0.43929 val_f1_mac= 0.13929 time= 0.05118
Iter: 0008 train_loss= 0.54423 train_f1_mic= 0.40474 train_f1_mac= 0.12638 val_loss= 0.55717 val_f1_mic= 0.43929 val_f1_mac= 0.13929 time= 0.05095
Iter: 0013 train_loss= 0.53336 train_f1_mic= 0.39280 train_f1_mac= 0.11309 val_loss= 0.55717 val_f1_mic= 0.43929 val_f1_mac= 0.13929 time= 0.05071
Iter: 0018 train_loss= 0.53962 train_f1_mic= 0.42416 train_f1_mac= 0.13096 val_loss= 0.55717 val_f1_mic= 0.43929 val_f1_mac= 0.13929 time= 0.05055
Epoch: 0010
Iter: 0004 train_loss= 0.53630 train_f1_mic= 0.39240 train_f1_mac= 0.11651 val_loss= 0.55866 val_f1_mic= 0.42820 val_f1_mac= 0.13902 time= 0.05048
Iter: 0009 train_loss= 0.52836 train_f1_mic= 0.42970 train_f1_mac= 0.13042 val_loss= 0.55866 val_f1_mic= 0.42820 val_f1_mac= 0.13902 time= 0.05027
Iter: 0014 train_loss= 0.53474 train_f1_mic= 0.40974 train_f1_mac= 0.12345 val_loss= 0.55866 val_f1_mic= 0.42820 val_f1_mac= 0.13902 time= 0.05011
Optimization Finished!
Full validation stats: loss= 0.55354 f1_micro= 0.41022 f1_macro= 0.13126 time= 0.12865
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4573777278319105
Rewards :  -0.05197470338372279 Accuracy :  0.4157979651249323
Total reward :  1.2455362462039499
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'sigmoid', 2, 'sigmoid']
Training RNN (Reward ip) :  [-0.0519747]
Trial 348: Controller loss : 7086.891113

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]

Predicted actions :  [0, 'tanh', 1, 'relu']
2018-08-31 01:13:39.258168: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:13:39.258686: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:13:39.259185: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:13:39.259546: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:13:39.260001: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69343 train_f1_mic= 0.35827 train_f1_mac= 0.31506 val_loss= 0.67027 val_f1_mic= 0.37654 val_f1_mac= 0.18685 time= 0.97038
Iter: 0005 train_loss= 0.58394 train_f1_mic= 0.38883 train_f1_mac= 0.09871 val_loss= 0.67027 val_f1_mic= 0.37654 val_f1_mac= 0.18685 time= 0.18334
Iter: 0010 train_loss= 0.54042 train_f1_mic= 0.36890 train_f1_mac= 0.08806 val_loss= 0.67027 val_f1_mic= 0.37654 val_f1_mac= 0.18685 time= 0.11142
Iter: 0015 train_loss= 0.53338 train_f1_mic= 0.40568 train_f1_mac= 0.10983 val_loss= 0.67027 val_f1_mic= 0.37654 val_f1_mac= 0.18685 time= 0.08421
Epoch: 0002
Iter: 0001 train_loss= 0.54804 train_f1_mic= 0.39262 train_f1_mac= 0.10961 val_loss= 0.55061 val_f1_mic= 0.38786 val_f1_mac= 0.10744 time= 0.07100
Iter: 0006 train_loss= 0.54161 train_f1_mic= 0.39980 train_f1_mac= 0.11440 val_loss= 0.55061 val_f1_mic= 0.38786 val_f1_mac= 0.10744 time= 0.06199
Iter: 0011 train_loss= 0.53363 train_f1_mic= 0.40723 train_f1_mac= 0.12080 val_loss= 0.55061 val_f1_mic= 0.38786 val_f1_mac= 0.10744 time= 0.05588
Iter: 0016 train_loss= 0.52271 train_f1_mic= 0.41146 train_f1_mac= 0.12583 val_loss= 0.55061 val_f1_mic= 0.38786 val_f1_mac= 0.10744 time= 0.05144
Epoch: 0003
Iter: 0002 train_loss= 0.53257 train_f1_mic= 0.41413 train_f1_mac= 0.13476 val_loss= 0.55006 val_f1_mic= 0.40661 val_f1_mac= 0.13507 time= 0.04962
Iter: 0007 train_loss= 0.52186 train_f1_mic= 0.42653 train_f1_mac= 0.13967 val_loss= 0.55006 val_f1_mic= 0.40661 val_f1_mac= 0.13507 time= 0.04683
Iter: 0012 train_loss= 0.52682 train_f1_mic= 0.43958 train_f1_mac= 0.15130 val_loss= 0.55006 val_f1_mic= 0.40661 val_f1_mac= 0.13507 time= 0.04462
Iter: 0017 train_loss= 0.52297 train_f1_mic= 0.44935 train_f1_mac= 0.17372 val_loss= 0.55006 val_f1_mic= 0.40661 val_f1_mac= 0.13507 time= 0.04308
Epoch: 0004
Iter: 0003 train_loss= 0.52411 train_f1_mic= 0.42761 train_f1_mac= 0.16122 val_loss= 0.53745 val_f1_mic= 0.43205 val_f1_mac= 0.16656 time= 0.04190
Iter: 0008 train_loss= 0.51153 train_f1_mic= 0.45969 train_f1_mac= 0.18976 val_loss= 0.53745 val_f1_mic= 0.43205 val_f1_mac= 0.16656 time= 0.04054
Iter: 0013 train_loss= 0.52058 train_f1_mic= 0.41842 train_f1_mac= 0.14790 val_loss= 0.53745 val_f1_mic= 0.43205 val_f1_mac= 0.16656 time= 0.03967
Iter: 0018 train_loss= 0.51660 train_f1_mic= 0.44867 train_f1_mac= 0.17759 val_loss= 0.53745 val_f1_mic= 0.43205 val_f1_mac= 0.16656 time= 0.03870
Epoch: 0005
Iter: 0004 train_loss= 0.51836 train_f1_mic= 0.44919 train_f1_mac= 0.18010 val_loss= 0.54182 val_f1_mic= 0.44852 val_f1_mac= 0.19285 time= 0.03819
Iter: 0009 train_loss= 0.52535 train_f1_mic= 0.45369 train_f1_mac= 0.19639 val_loss= 0.54182 val_f1_mic= 0.44852 val_f1_mac= 0.19285 time= 0.03775
Iter: 0014 train_loss= 0.50920 train_f1_mic= 0.47008 train_f1_mac= 0.20494 val_loss= 0.54182 val_f1_mic= 0.44852 val_f1_mac= 0.19285 time= 0.03703
Epoch: 0006
Iter: 0000 train_loss= 0.50951 train_f1_mic= 0.46543 train_f1_mac= 0.19636 val_loss= 0.52677 val_f1_mic= 0.46349 val_f1_mac= 0.20308 time= 0.03660
Iter: 0005 train_loss= 0.49640 train_f1_mic= 0.48972 train_f1_mac= 0.23087 val_loss= 0.52677 val_f1_mic= 0.46349 val_f1_mac= 0.20308 time= 0.03613
Iter: 0010 train_loss= 0.50835 train_f1_mic= 0.44991 train_f1_mac= 0.19695 val_loss= 0.52677 val_f1_mic= 0.46349 val_f1_mac= 0.20308 time= 0.03567
Iter: 0015 train_loss= 0.50446 train_f1_mic= 0.48698 train_f1_mac= 0.22390 val_loss= 0.52677 val_f1_mic= 0.46349 val_f1_mac= 0.20308 time= 0.03525
Epoch: 0007
Iter: 0001 train_loss= 0.49295 train_f1_mic= 0.47492 train_f1_mac= 0.21466 val_loss= 0.50358 val_f1_mic= 0.47433 val_f1_mac= 0.22006 time= 0.03517
Iter: 0006 train_loss= 0.49618 train_f1_mic= 0.48046 train_f1_mac= 0.22656 val_loss= 0.50358 val_f1_mic= 0.47433 val_f1_mac= 0.22006 time= 0.03480
Iter: 0011 train_loss= 0.51285 train_f1_mic= 0.45185 train_f1_mac= 0.20277 val_loss= 0.50358 val_f1_mic= 0.47433 val_f1_mac= 0.22006 time= 0.03438
Iter: 0016 train_loss= 0.50518 train_f1_mic= 0.48921 train_f1_mac= 0.24387 val_loss= 0.50358 val_f1_mic= 0.47433 val_f1_mac= 0.22006 time= 0.03399
Epoch: 0008
Iter: 0002 train_loss= 0.48816 train_f1_mic= 0.47646 train_f1_mac= 0.22786 val_loss= 0.51828 val_f1_mic= 0.49313 val_f1_mac= 0.26140 time= 0.03378
Iter: 0007 train_loss= 0.50192 train_f1_mic= 0.49596 train_f1_mac= 0.24358 val_loss= 0.51828 val_f1_mic= 0.49313 val_f1_mac= 0.26140 time= 0.03344
Iter: 0012 train_loss= 0.48974 train_f1_mic= 0.49026 train_f1_mac= 0.24356 val_loss= 0.51828 val_f1_mic= 0.49313 val_f1_mac= 0.26140 time= 0.03313
Iter: 0017 train_loss= 0.50178 train_f1_mic= 0.50248 train_f1_mac= 0.27296 val_loss= 0.51828 val_f1_mic= 0.49313 val_f1_mac= 0.26140 time= 0.03283
Epoch: 0009
Iter: 0003 train_loss= 0.49452 train_f1_mic= 0.47885 train_f1_mac= 0.23797 val_loss= 0.50071 val_f1_mic= 0.52859 val_f1_mac= 0.29987 time= 0.03269
Iter: 0008 train_loss= 0.49565 train_f1_mic= 0.51869 train_f1_mac= 0.28503 val_loss= 0.50071 val_f1_mic= 0.52859 val_f1_mac= 0.29987 time= 0.03252
Iter: 0013 train_loss= 0.48906 train_f1_mic= 0.47696 train_f1_mac= 0.24185 val_loss= 0.50071 val_f1_mic= 0.52859 val_f1_mac= 0.29987 time= 0.03233
Iter: 0018 train_loss= 0.49488 train_f1_mic= 0.50273 train_f1_mac= 0.26660 val_loss= 0.50071 val_f1_mic= 0.52859 val_f1_mac= 0.29987 time= 0.03222
Epoch: 0010
Iter: 0004 train_loss= 0.48858 train_f1_mic= 0.48964 train_f1_mac= 0.25823 val_loss= 0.50000 val_f1_mic= 0.52811 val_f1_mac= 0.30647 time= 0.03211
Iter: 0009 train_loss= 0.48743 train_f1_mic= 0.50314 train_f1_mac= 0.27873 val_loss= 0.50000 val_f1_mic= 0.52811 val_f1_mac= 0.30647 time= 0.03189
Iter: 0014 train_loss= 0.47972 train_f1_mic= 0.51297 train_f1_mac= 0.28644 val_loss= 0.50000 val_f1_mic= 0.52811 val_f1_mac= 0.30647 time= 0.03168
Optimization Finished!
Full validation stats: loss= 0.50338 f1_micro= 0.52141 f1_macro= 0.30079 time= 0.11666
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46932563295681246
Rewards :  0.05973952562450996 Accuracy :  0.5171172534564205
Total reward :  1.3052757718284598
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'tanh', 1, 'relu']
Training RNN (Reward ip) :  [0.05973953]
Trial 349: Controller loss : 3695.729980

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
2018-08-31 01:13:51.303548: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:13:51.304114: I C:\users\nwani\_bActions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
azel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:13:51.304834: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:13:51.305237: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:13:51.305746: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69562 train_f1_mic= 0.35962 train_f1_mac= 0.28803 val_loss= 0.66311 val_f1_mic= 0.36868 val_f1_mac= 0.10342 time= 0.79437
Iter: 0005 train_loss= 0.59302 train_f1_mic= 0.37036 train_f1_mac= 0.09159 val_loss= 0.66311 val_f1_mic= 0.36868 val_f1_mac= 0.10342 time= 0.14570
Iter: 0010 train_loss= 0.54780 train_f1_mic= 0.35882 train_f1_mac= 0.08223 val_loss= 0.66311 val_f1_mic= 0.36868 val_f1_mac= 0.10342 time= 0.08591
Iter: 0015 train_loss= 0.54148 train_f1_mic= 0.42233 train_f1_mac= 0.11338 val_loss= 0.66311 val_f1_mic= 0.36868 val_f1_mac= 0.10342 time= 0.06386
Epoch: 0002
Iter: 0001 train_loss= 0.53930 train_f1_mic= 0.39395 train_f1_mac= 0.10273 val_loss= 0.56196 val_f1_mic= 0.38324 val_f1_mac= 0.10461 time= 0.05359
Iter: 0006 train_loss= 0.54238 train_f1_mic= 0.37137 train_f1_mac= 0.09163 val_loss= 0.56196 val_f1_mic= 0.38324 val_f1_mac= 0.10461 time= 0.04628
Iter: 0011 train_loss= 0.53753 train_f1_mic= 0.38671 train_f1_mac= 0.09745 val_loss= 0.56196 val_f1_mic= 0.38324 val_f1_mac= 0.10461 time= 0.04119
Iter: 0016 train_loss= 0.53584 train_f1_mic= 0.38236 train_f1_mac= 0.10072 val_loss= 0.56196 val_f1_mic= 0.38324 val_f1_mac= 0.10461 time= 0.03744
Epoch: 0003
Iter: 0002 train_loss= 0.53128 train_f1_mic= 0.39165 train_f1_mac= 0.10835 val_loss= 0.55353 val_f1_mic= 0.38772 val_f1_mac= 0.11318 time= 0.03543
Iter: 0007 train_loss= 0.53348 train_f1_mic= 0.39678 train_f1_mac= 0.11728 val_loss= 0.55353 val_f1_mic= 0.38772 val_f1_mac= 0.11318 time= 0.03344
Iter: 0012 train_loss= 0.53592 train_f1_mic= 0.41167 train_f1_mac= 0.12770 val_loss= 0.55353 val_f1_mic= 0.38772 val_f1_mac= 0.11318 time= 0.03181
Iter: 0017 train_loss= 0.52864 train_f1_mic= 0.40509 train_f1_mac= 0.12377 val_loss= 0.55353 val_f1_mic= 0.38772 val_f1_mac= 0.11318 time= 0.03067
Epoch: 0004
Iter: 0003 train_loss= 0.52271 train_f1_mic= 0.42332 train_f1_mac= 0.13224 val_loss= 0.55566 val_f1_mic= 0.40989 val_f1_mac= 0.13308 time= 0.02971
Iter: 0008 train_loss= 0.53120 train_f1_mic= 0.41937 train_f1_mac= 0.13808 val_loss= 0.55566 val_f1_mic= 0.40989 val_f1_mac= 0.13308 time= 0.02864
Iter: 0013 train_loss= 0.52345 train_f1_mic= 0.42592 train_f1_mac= 0.14116 val_loss= 0.55566 val_f1_mic= 0.40989 val_f1_mac= 0.13308 time= 0.02769
Iter: 0018 train_loss= 0.52789 train_f1_mic= 0.43827 train_f1_mac= 0.15452 val_loss= 0.55566 val_f1_mic= 0.40989 val_f1_mac= 0.13308 time= 0.02692
Epoch: 0005
Iter: 0004 train_loss= 0.52778 train_f1_mic= 0.42260 train_f1_mac= 0.15061 val_loss= 0.54092 val_f1_mic= 0.45369 val_f1_mac= 0.17565 time= 0.02648
Iter: 0009 train_loss= 0.52022 train_f1_mic= 0.40601 train_f1_mac= 0.13574 val_loss= 0.54092 val_f1_mic= 0.45369 val_f1_mac= 0.17565 time= 0.02585
Iter: 0014 train_loss= 0.52797 train_f1_mic= 0.44477 train_f1_mac= 0.17059 val_loss= 0.54092 val_f1_mic= 0.45369 val_f1_mac= 0.17565 time= 0.02524
Epoch: 0006
Iter: 0000 train_loss= 0.52089 train_f1_mic= 0.43912 train_f1_mac= 0.16065 val_loss= 0.54002 val_f1_mic= 0.43651 val_f1_mac= 0.17384 time= 0.02497
Iter: 0005 train_loss= 0.50932 train_f1_mic= 0.45201 train_f1_mac= 0.18006 val_loss= 0.54002 val_f1_mic= 0.43651 val_f1_mac= 0.17384 time= 0.02446
Iter: 0010 train_loss= 0.51625 train_f1_mic= 0.47561 train_f1_mac= 0.20766 val_loss= 0.54002 val_f1_mic= 0.43651 val_f1_mac= 0.17384 time= 0.02396
Iter: 0015 train_loss= 0.50969 train_f1_mic= 0.43714 train_f1_mac= 0.16745 val_loss= 0.54002 val_f1_mic= 0.43651 val_f1_mac= 0.17384 time= 0.02353
Epoch: 0007
Iter: 0001 train_loss= 0.50998 train_f1_mic= 0.45739 train_f1_mac= 0.19424 val_loss= 0.53622 val_f1_mic= 0.44916 val_f1_mac= 0.18684 time= 0.02337
Iter: 0006 train_loss= 0.50566 train_f1_mic= 0.46123 train_f1_mac= 0.19351 val_loss= 0.53622 val_f1_mic= 0.44916 val_f1_mac= 0.18684 time= 0.02305
Iter: 0011 train_loss= 0.52263 train_f1_mic= 0.45583 train_f1_mac= 0.19409 val_loss= 0.53622 val_f1_mic= 0.44916 val_f1_mac= 0.18684 time= 0.02269
Iter: 0016 train_loss= 0.52197 train_f1_mic= 0.43371 train_f1_mac= 0.17765 val_loss= 0.53622 val_f1_mic= 0.44916 val_f1_mac= 0.18684 time= 0.02237
Epoch: 0008
Iter: 0002 train_loss= 0.50878 train_f1_mic= 0.48829 train_f1_mac= 0.23247 val_loss= 0.53005 val_f1_mic= 0.51774 val_f1_mac= 0.26683 time= 0.02219
Iter: 0007 train_loss= 0.50470 train_f1_mic= 0.46287 train_f1_mac= 0.21393 val_loss= 0.53005 val_f1_mic= 0.51774 val_f1_mac= 0.26683 time= 0.02193
Iter: 0012 train_loss= 0.50541 train_f1_mic= 0.48299 train_f1_mac= 0.22818 val_loss= 0.53005 val_f1_mic= 0.51774 val_f1_mac= 0.26683 time= 0.02171
Iter: 0017 train_loss= 0.49674 train_f1_mic= 0.47041 train_f1_mac= 0.21752 val_loss= 0.53005 val_f1_mic= 0.51774 val_f1_mac= 0.26683 time= 0.02148
Epoch: 0009
Iter: 0003 train_loss= 0.50928 train_f1_mic= 0.49211 train_f1_mac= 0.24580 val_loss= 0.51629 val_f1_mic= 0.50565 val_f1_mac= 0.27082 time= 0.02144
Iter: 0008 train_loss= 0.50389 train_f1_mic= 0.48677 train_f1_mac= 0.23961 val_loss= 0.51629 val_f1_mic= 0.50565 val_f1_mac= 0.27082 time= 0.02126
Iter: 0013 train_loss= 0.51419 train_f1_mic= 0.49616 train_f1_mac= 0.25307 val_loss= 0.51629 val_f1_mic= 0.50565 val_f1_mac= 0.27082 time= 0.02105
Iter: 0018 train_loss= 0.51056 train_f1_mic= 0.47117 train_f1_mac= 0.21795 val_loss= 0.51629 val_f1_mic= 0.50565 val_f1_mac= 0.27082 time= 0.02083
Epoch: 0010
Iter: 0004 train_loss= 0.49232 train_f1_mic= 0.47186 train_f1_mac= 0.22862 val_loss= 0.51650 val_f1_mic= 0.50016 val_f1_mac= 0.26130 time= 0.02072
Iter: 0009 train_loss= 0.49595 train_f1_mic= 0.51779 train_f1_mac= 0.26896 val_loss= 0.51650 val_f1_mic= 0.50016 val_f1_mac= 0.26130 time= 0.02058
Iter: 0014 train_loss= 0.50413 train_f1_mic= 0.48806 train_f1_mac= 0.25893 val_loss= 0.51650 val_f1_mic= 0.50016 val_f1_mac= 0.26130 time= 0.02047
Optimization Finished!
Full validation stats: loss= 0.51604 f1_micro= 0.49195 f1_macro= 0.26662 time= 0.12264
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4746499037048115
Rewards :  0.02662135373999558 Accuracy :  0.49594698669680803
Total reward :  1.3318971255684553
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02662135]
Trial 350: Controller loss : 143.561752

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'linear', 0, 'sigmoid']
2018-08-31 01:14:00.655675: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:14:00.656286: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:14:00.656879: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:14:00.657304: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:14:00.657831: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69422 train_f1_mic= 0.35511 train_f1_mac= 0.23370 val_loss= 0.65635 val_f1_mic= 0.37026 val_f1_mac= 0.09716 time= 0.84692
Iter: 0005 train_loss= 0.57192 train_f1_mic= 0.39909 train_f1_mac= 0.10303 val_loss= 0.65635 val_f1_mic= 0.37026 val_f1_mac= 0.09716 time= 0.17538
Iter: 0010 train_loss= 0.54025 train_f1_mic= 0.37622 train_f1_mac= 0.08783 val_loss= 0.65635 val_f1_mic= 0.37026 val_f1_mac= 0.09716 time= 0.11460
Iter: 0015 train_loss= 0.55464 train_f1_mic= 0.38071 train_f1_mac= 0.09572 val_loss= 0.65635 val_f1_mic= 0.37026 val_f1_mac= 0.09716 time= 0.09207
Epoch: 0002
Iter: 0001 train_loss= 0.54023 train_f1_mic= 0.40372 train_f1_mac= 0.10504 val_loss= 0.57711 val_f1_mic= 0.38726 val_f1_mac= 0.10991 time= 0.08150
Iter: 0006 train_loss= 0.53103 train_f1_mic= 0.39442 train_f1_mac= 0.10066 val_loss= 0.57711 val_f1_mic= 0.38726 val_f1_mac= 0.10991 time= 0.07407
Iter: 0011 train_loss= 0.54155 train_f1_mic= 0.38704 train_f1_mac= 0.10385 val_loss= 0.57711 val_f1_mic= 0.38726 val_f1_mac= 0.10991 time= 0.06885
Iter: 0016 train_loss= 0.53292 train_f1_mic= 0.43468 train_f1_mac= 0.13615 val_loss= 0.57711 val_f1_mic= 0.38726 val_f1_mac= 0.10991 time= 0.06500
Epoch: 0003
Iter: 0002 train_loss= 0.52385 train_f1_mic= 0.41242 train_f1_mac= 0.12659 val_loss= 0.54100 val_f1_mic= 0.42256 val_f1_mac= 0.13882 time= 0.06334
Iter: 0007 train_loss= 0.53069 train_f1_mic= 0.42215 train_f1_mac= 0.13208 val_loss= 0.54100 val_f1_mic= 0.42256 val_f1_mac= 0.13882 time= 0.06090
Iter: 0012 train_loss= 0.52959 train_f1_mic= 0.41098 train_f1_mac= 0.12703 val_loss= 0.54100 val_f1_mic= 0.42256 val_f1_mac= 0.13882 time= 0.05898
Iter: 0017 train_loss= 0.53394 train_f1_mic= 0.41283 train_f1_mac= 0.13478 val_loss= 0.54100 val_f1_mic= 0.42256 val_f1_mac= 0.13882 time= 0.05737
Epoch: 0004
Iter: 0003 train_loss= 0.52164 train_f1_mic= 0.43204 train_f1_mac= 0.14108 val_loss= 0.55120 val_f1_mic= 0.42420 val_f1_mac= 0.14574 time= 0.05680
Iter: 0008 train_loss= 0.52926 train_f1_mic= 0.43755 train_f1_mac= 0.14587 val_loss= 0.55120 val_f1_mic= 0.42420 val_f1_mac= 0.14574 time= 0.05561
Iter: 0013 train_loss= 0.52348 train_f1_mic= 0.41844 train_f1_mac= 0.13679 val_loss= 0.55120 val_f1_mic= 0.42420 val_f1_mac= 0.14574 time= 0.05463
Iter: 0018 train_loss= 0.52166 train_f1_mic= 0.45618 train_f1_mac= 0.16395 val_loss= 0.55120 val_f1_mic= 0.42420 val_f1_mac= 0.14574 time= 0.05367
Epoch: 0005
Iter: 0004 train_loss= 0.52886 train_f1_mic= 0.42504 train_f1_mac= 0.14170 val_loss= 0.55831 val_f1_mic= 0.42423 val_f1_mac= 0.15367 time= 0.05320
Iter: 0009 train_loss= 0.52293 train_f1_mic= 0.43909 train_f1_mac= 0.15615 val_loss= 0.55831 val_f1_mic= 0.42423 val_f1_mac= 0.15367 time= 0.05258
Iter: 0014 train_loss= 0.52715 train_f1_mic= 0.44015 train_f1_mac= 0.16277 val_loss= 0.55831 val_f1_mic= 0.42423 val_f1_mac= 0.15367 time= 0.05218
Epoch: 0006
Iter: 0000 train_loss= 0.49913 train_f1_mic= 0.44349 train_f1_mac= 0.16046 val_loss= 0.56123 val_f1_mic= 0.40273 val_f1_mac= 0.14917 time= 0.05232
Iter: 0005 train_loss= 0.51412 train_f1_mic= 0.46549 train_f1_mac= 0.18196 val_loss= 0.56123 val_f1_mic= 0.40273 val_f1_mac= 0.14917 time= 0.05188
Iter: 0010 train_loss= 0.51363 train_f1_mic= 0.45986 train_f1_mac= 0.18718 val_loss= 0.56123 val_f1_mic= 0.40273 val_f1_mac= 0.14917 time= 0.05142
Iter: 0015 train_loss= 0.50701 train_f1_mic= 0.45724 train_f1_mac= 0.18055 val_loss= 0.56123 val_f1_mic= 0.40273 val_f1_mac= 0.14917 time= 0.05105
Epoch: 0007
Iter: 0001 train_loss= 0.51039 train_f1_mic= 0.46808 train_f1_mac= 0.18675 val_loss= 0.52404 val_f1_mic= 0.44883 val_f1_mac= 0.18007 time= 0.05098
Iter: 0006 train_loss= 0.50603 train_f1_mic= 0.44322 train_f1_mac= 0.16937 val_loss= 0.52404 val_f1_mic= 0.44883 val_f1_mac= 0.18007 time= 0.05071
Iter: 0011 train_loss= 0.52208 train_f1_mic= 0.46053 train_f1_mac= 0.19154 val_loss= 0.52404 val_f1_mic= 0.44883 val_f1_mac= 0.18007 time= 0.05046
Iter: 0016 train_loss= 0.51914 train_f1_mic= 0.48738 train_f1_mac= 0.22000 val_loss= 0.52404 val_f1_mic= 0.44883 val_f1_mac= 0.18007 time= 0.05014
Epoch: 0008
Iter: 0002 train_loss= 0.51449 train_f1_mic= 0.47616 train_f1_mac= 0.19579 val_loss= 0.52391 val_f1_mic= 0.47088 val_f1_mac= 0.20603 time= 0.04998
Iter: 0007 train_loss= 0.51639 train_f1_mic= 0.46182 train_f1_mac= 0.19240 val_loss= 0.52391 val_f1_mic= 0.47088 val_f1_mac= 0.20603 time= 0.04974
Iter: 0012 train_loss= 0.51845 train_f1_mic= 0.42023 train_f1_mac= 0.16688 val_loss= 0.52391 val_f1_mic= 0.47088 val_f1_mac= 0.20603 time= 0.04948
Iter: 0017 train_loss= 0.53072 train_f1_mic= 0.44207 train_f1_mac= 0.18172 val_loss= 0.52391 val_f1_mic= 0.47088 val_f1_mac= 0.20603 time= 0.04926
Epoch: 0009
Iter: 0003 train_loss= 0.50965 train_f1_mic= 0.45362 train_f1_mac= 0.19679 val_loss= 0.53611 val_f1_mic= 0.45603 val_f1_mac= 0.20414 time= 0.04921
Iter: 0008 train_loss= 0.52046 train_f1_mic= 0.48098 train_f1_mac= 0.21163 val_loss= 0.53611 val_f1_mic= 0.45603 val_f1_mac= 0.20414 time= 0.04896
Iter: 0013 train_loss= 0.50751 train_f1_mic= 0.47253 train_f1_mac= 0.21688 val_loss= 0.53611 val_f1_mic= 0.45603 val_f1_mac= 0.20414 time= 0.04880
Iter: 0018 train_loss= 0.50416 train_f1_mic= 0.45177 train_f1_mac= 0.19712 val_loss= 0.53611 val_f1_mic= 0.45603 val_f1_mac= 0.20414 time= 0.04861
Epoch: 0010
Iter: 0004 train_loss= 0.50523 train_f1_mic= 0.47592 train_f1_mac= 0.21966 val_loss= 0.51770 val_f1_mic= 0.50854 val_f1_mac= 0.25853 time= 0.04875
Iter: 0009 train_loss= 0.50932 train_f1_mic= 0.47527 train_f1_mac= 0.21273 val_loss= 0.51770 val_f1_mic= 0.50854 val_f1_mac= 0.25853 time= 0.04855
Iter: 0014 train_loss= 0.50467 train_f1_mic= 0.49012 train_f1_mac= 0.23235 val_loss= 0.51770 val_f1_mic= 0.50854 val_f1_mac= 0.25853 time= 0.04835
Optimization Finished!
Full validation stats: loss= 0.52350 f1_micro= 0.49199 f1_macro= 0.24638 time= 0.13664
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47848054427683295
Rewards :  0.019153202860106966 Accuracy :  0.4938031065649185
Total reward :  1.3510503284285622
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'linear', 0, 'sigmoid']
Training RNN (Reward ip) :  [0.0191532]
Trial 351: Controller loss : 9307.645508

Prediction action from Controller
State input to Controller for Action :  [0. 0. 3. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:14:15.894542: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:14:15.895282: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:14:15.896010: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:14:15.896536: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:14:15.897207: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69475 train_f1_mic= 0.38278 train_f1_mac= 0.30018 val_loss= 0.66614 val_f1_mic= 0.39737 val_f1_mac= 0.12558 time= 0.77746
Iter: 0005 train_loss= 0.59470 train_f1_mic= 0.36903 train_f1_mac= 0.09018 val_loss= 0.66614 val_f1_mic= 0.39737 val_f1_mac= 0.12558 time= 0.14221
Iter: 0010 train_loss= 0.54620 train_f1_mic= 0.36992 train_f1_mac= 0.08935 val_loss= 0.66614 val_f1_mic= 0.39737 val_f1_mac= 0.12558 time= 0.08463
Iter: 0015 train_loss= 0.54091 train_f1_mic= 0.42029 train_f1_mac= 0.11296 val_loss= 0.66614 val_f1_mic= 0.39737 val_f1_mac= 0.12558 time= 0.06279
Epoch: 0002
Iter: 0001 train_loss= 0.54226 train_f1_mic= 0.39275 train_f1_mac= 0.10292 val_loss= 0.54280 val_f1_mic= 0.38705 val_f1_mac= 0.09986 time= 0.05259
Iter: 0006 train_loss= 0.52973 train_f1_mic= 0.37332 train_f1_mac= 0.08767 val_loss= 0.54280 val_f1_mic= 0.38705 val_f1_mac= 0.09986 time= 0.04531
Iter: 0011 train_loss= 0.53767 train_f1_mic= 0.37811 train_f1_mac= 0.09675 val_loss= 0.54280 val_f1_mic= 0.38705 val_f1_mac= 0.09986 time= 0.04042
Iter: 0016 train_loss= 0.52637 train_f1_mic= 0.41009 train_f1_mac= 0.10776 val_loss= 0.54280 val_f1_mic= 0.38705 val_f1_mac= 0.09986 time= 0.03688
Epoch: 0003
Iter: 0002 train_loss= 0.54508 train_f1_mic= 0.41394 train_f1_mac= 0.12167 val_loss= 0.54554 val_f1_mic= 0.40015 val_f1_mac= 0.11638 time= 0.03510
Iter: 0007 train_loss= 0.52293 train_f1_mic= 0.41545 train_f1_mac= 0.12312 val_loss= 0.54554 val_f1_mic= 0.40015 val_f1_mac= 0.11638 time= 0.03305
Iter: 0012 train_loss= 0.53210 train_f1_mic= 0.38780 train_f1_mac= 0.11357 val_loss= 0.54554 val_f1_mic= 0.40015 val_f1_mac= 0.11638 time= 0.03131
Iter: 0017 train_loss= 0.52713 train_f1_mic= 0.41782 train_f1_mac= 0.12990 val_loss= 0.54554 val_f1_mic= 0.40015 val_f1_mac= 0.11638 time= 0.02996
Epoch: 0004
Iter: 0003 train_loss= 0.52041 train_f1_mic= 0.40637 train_f1_mac= 0.12490 val_loss= 0.54407 val_f1_mic= 0.41805 val_f1_mac= 0.13351 time= 0.02943
Iter: 0008 train_loss= 0.52561 train_f1_mic= 0.42085 train_f1_mac= 0.13462 val_loss= 0.54407 val_f1_mic= 0.41805 val_f1_mac= 0.13351 time= 0.02832
Iter: 0013 train_loss= 0.53491 train_f1_mic= 0.41498 train_f1_mac= 0.13918 val_loss= 0.54407 val_f1_mic= 0.41805 val_f1_mac= 0.13351 time= 0.02741
Iter: 0018 train_loss= 0.51906 train_f1_mic= 0.42758 train_f1_mac= 0.14584 val_loss= 0.54407 val_f1_mic= 0.41805 val_f1_mac= 0.13351 time= 0.02659
Epoch: 0005
Iter: 0004 train_loss= 0.52640 train_f1_mic= 0.43188 train_f1_mac= 0.14896 val_loss= 0.55211 val_f1_mic= 0.40098 val_f1_mac= 0.14045 time= 0.02602
Iter: 0009 train_loss= 0.51308 train_f1_mic= 0.43020 train_f1_mac= 0.15098 val_loss= 0.55211 val_f1_mic= 0.40098 val_f1_mac= 0.14045 time= 0.02535
Iter: 0014 train_loss= 0.52083 train_f1_mic= 0.43587 train_f1_mac= 0.16416 val_loss= 0.55211 val_f1_mic= 0.40098 val_f1_mac= 0.14045 time= 0.02477
Epoch: 0006
Iter: 0000 train_loss= 0.51215 train_f1_mic= 0.45252 train_f1_mac= 0.17099 val_loss= 0.55109 val_f1_mic= 0.43423 val_f1_mac= 0.16927 time= 0.02442
Iter: 0005 train_loss= 0.52628 train_f1_mic= 0.44993 train_f1_mac= 0.17691 val_loss= 0.55109 val_f1_mic= 0.43423 val_f1_mac= 0.16927 time= 0.02397
Iter: 0010 train_loss= 0.51265 train_f1_mic= 0.43565 train_f1_mac= 0.16519 val_loss= 0.55109 val_f1_mic= 0.43423 val_f1_mac= 0.16927 time= 0.02354
Iter: 0015 train_loss= 0.52241 train_f1_mic= 0.44588 train_f1_mac= 0.17878 val_loss= 0.55109 val_f1_mic= 0.43423 val_f1_mac= 0.16927 time= 0.02316
Epoch: 0007
Iter: 0001 train_loss= 0.50786 train_f1_mic= 0.43923 train_f1_mac= 0.17067 val_loss= 0.52519 val_f1_mic= 0.44420 val_f1_mac= 0.19061 time= 0.02289
Iter: 0006 train_loss= 0.51398 train_f1_mic= 0.44631 train_f1_mac= 0.18911 val_loss= 0.52519 val_f1_mic= 0.44420 val_f1_mac= 0.19061 time= 0.02251
Iter: 0011 train_loss= 0.52581 train_f1_mic= 0.44264 train_f1_mac= 0.18157 val_loss= 0.52519 val_f1_mic= 0.44420 val_f1_mac= 0.19061 time= 0.02218
Iter: 0016 train_loss= 0.52348 train_f1_mic= 0.43556 train_f1_mac= 0.17729 val_loss= 0.52519 val_f1_mic= 0.44420 val_f1_mac= 0.19061 time= 0.02186
Epoch: 0008
Iter: 0002 train_loss= 0.51431 train_f1_mic= 0.44957 train_f1_mac= 0.19093 val_loss= 0.54489 val_f1_mic= 0.46569 val_f1_mac= 0.21289 time= 0.02182
Iter: 0007 train_loss= 0.51494 train_f1_mic= 0.47903 train_f1_mac= 0.22326 val_loss= 0.54489 val_f1_mic= 0.46569 val_f1_mac= 0.21289 time= 0.02153
Iter: 0012 train_loss= 0.51491 train_f1_mic= 0.47669 train_f1_mac= 0.22720 val_loss= 0.54489 val_f1_mic= 0.46569 val_f1_mac= 0.21289 time= 0.02127
Iter: 0017 train_loss= 0.50404 train_f1_mic= 0.46840 train_f1_mac= 0.21561 val_loss= 0.54489 val_f1_mic= 0.46569 val_f1_mac= 0.21289 time= 0.02106
Epoch: 0009
Iter: 0003 train_loss= 0.50719 train_f1_mic= 0.45614 train_f1_mac= 0.20389 val_loss= 0.52500 val_f1_mic= 0.46479 val_f1_mac= 0.22021 time= 0.02109
Iter: 0008 train_loss= 0.50553 train_f1_mic= 0.47113 train_f1_mac= 0.21832 val_loss= 0.52500 val_f1_mic= 0.46479 val_f1_mac= 0.22021 time= 0.02089
Iter: 0013 train_loss= 0.51089 train_f1_mic= 0.50689 train_f1_mac= 0.25584 val_loss= 0.52500 val_f1_mic= 0.46479 val_f1_mac= 0.22021 time= 0.02076
Iter: 0018 train_loss= 0.50238 train_f1_mic= 0.47314 train_f1_mac= 0.22989 val_loss= 0.52500 val_f1_mic= 0.46479 val_f1_mac= 0.22021 time= 0.02063
Epoch: 0010
Iter: 0004 train_loss= 0.51145 train_f1_mic= 0.48708 train_f1_mac= 0.24376 val_loss= 0.52172 val_f1_mic= 0.50920 val_f1_mac= 0.28546 time= 0.02060
Iter: 0009 train_loss= 0.50311 train_f1_mic= 0.49618 train_f1_mac= 0.26504 val_loss= 0.52172 val_f1_mic= 0.50920 val_f1_mac= 0.28546 time= 0.02044
Iter: 0014 train_loss= 0.49458 train_f1_mic= 0.48168 train_f1_mac= 0.25695 val_loss= 0.52172 val_f1_mic= 0.50920 val_f1_mac= 0.28546 time= 0.02033
Optimization Finished!
Full validation stats: loss= 0.51628 f1_micro= 0.50401 f1_macro= 0.27140 time= 0.11669
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4829320113901737
Rewards :  0.022257335566703618 Accuracy :  0.5007378798435366
Total reward :  1.373307663995266
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02225734]
Trial 352: Controller loss : 143.317505

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [4, 'linear', 0, 'tanh']
2018-08-31 01:14:25.130156: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:14:25.131050: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:14:25.131910: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:14:25.133228: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:14:25.133988: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69378 train_f1_mic= 0.38056 train_f1_mac= 0.35894 val_loss= 0.68480 val_f1_mic= 0.41669 val_f1_mac= 0.36125 time= 0.72878
Iter: 0005 train_loss= 0.62732 train_f1_mic= 0.39984 train_f1_mac= 0.25393 val_loss= 0.68480 val_f1_mic= 0.41669 val_f1_mac= 0.36125 time= 0.13059
Iter: 0010 train_loss= 0.57945 train_f1_mic= 0.39892 train_f1_mac= 0.17337 val_loss= 0.68480 val_f1_mic= 0.41669 val_f1_mac= 0.36125 time= 0.07621
Iter: 0015 train_loss= 0.56584 train_f1_mic= 0.40676 train_f1_mac= 0.18746 val_loss= 0.68480 val_f1_mic= 0.41669 val_f1_mac= 0.36125 time= 0.05663
Epoch: 0002
Iter: 0001 train_loss= 0.56022 train_f1_mic= 0.39529 train_f1_mac= 0.18873 val_loss= 0.58792 val_f1_mic= 0.39817 val_f1_mac= 0.20270 time= 0.04652
Iter: 0006 train_loss= 0.57497 train_f1_mic= 0.42133 train_f1_mac= 0.24682 val_loss= 0.58792 val_f1_mic= 0.39817 val_f1_mac= 0.20270 time= 0.04006
Iter: 0011 train_loss= 0.55495 train_f1_mic= 0.44134 train_f1_mac= 0.24164 val_loss= 0.58792 val_f1_mic= 0.39817 val_f1_mac= 0.20270 time= 0.03544
Iter: 0016 train_loss= 0.56297 train_f1_mic= 0.40830 train_f1_mac= 0.20129 val_loss= 0.58792 val_f1_mic= 0.39817 val_f1_mac= 0.20270 time= 0.03206
Epoch: 0003
Iter: 0002 train_loss= 0.55717 train_f1_mic= 0.41716 train_f1_mac= 0.20013 val_loss= 0.56524 val_f1_mic= 0.41499 val_f1_mac= 0.20791 time= 0.02988
Iter: 0007 train_loss= 0.55877 train_f1_mic= 0.42091 train_f1_mac= 0.20359 val_loss= 0.56524 val_f1_mic= 0.41499 val_f1_mac= 0.20791 time= 0.02780
Iter: 0012 train_loss= 0.56241 train_f1_mic= 0.42697 train_f1_mac= 0.20831 val_loss= 0.56524 val_f1_mic= 0.41499 val_f1_mac= 0.20791 time= 0.02621
Iter: 0017 train_loss= 0.54736 train_f1_mic= 0.42750 train_f1_mac= 0.20973 val_loss= 0.56524 val_f1_mic= 0.41499 val_f1_mac= 0.20791 time= 0.02497
Epoch: 0004
Iter: 0003 train_loss= 0.55300 train_f1_mic= 0.42012 train_f1_mac= 0.18608 val_loss= 0.55683 val_f1_mic= 0.41368 val_f1_mac= 0.16630 time= 0.02438
Iter: 0008 train_loss= 0.53402 train_f1_mic= 0.43701 train_f1_mac= 0.18792 val_loss= 0.55683 val_f1_mic= 0.41368 val_f1_mac= 0.16630 time= 0.02350
Iter: 0013 train_loss= 0.52874 train_f1_mic= 0.44930 train_f1_mac= 0.20301 val_loss= 0.55683 val_f1_mic= 0.41368 val_f1_mac= 0.16630 time= 0.02273
Iter: 0018 train_loss= 0.53347 train_f1_mic= 0.43076 train_f1_mac= 0.18379 val_loss= 0.55683 val_f1_mic= 0.41368 val_f1_mac= 0.16630 time= 0.02202
Epoch: 0005
Iter: 0004 train_loss= 0.52895 train_f1_mic= 0.42595 train_f1_mac= 0.16754 val_loss= 0.55129 val_f1_mic= 0.43803 val_f1_mac= 0.19686 time= 0.02159
Iter: 0009 train_loss= 0.53085 train_f1_mic= 0.42937 train_f1_mac= 0.16690 val_loss= 0.55129 val_f1_mic= 0.43803 val_f1_mac= 0.19686 time= 0.02102
Iter: 0014 train_loss= 0.53178 train_f1_mic= 0.45699 train_f1_mac= 0.19203 val_loss= 0.55129 val_f1_mic= 0.43803 val_f1_mac= 0.19686 time= 0.02050
Epoch: 0006
Iter: 0000 train_loss= 0.53030 train_f1_mic= 0.45048 train_f1_mac= 0.18340 val_loss= 0.53746 val_f1_mic= 0.44579 val_f1_mac= 0.18781 time= 0.02025
Iter: 0005 train_loss= 0.53009 train_f1_mic= 0.44063 train_f1_mac= 0.17344 val_loss= 0.53746 val_f1_mic= 0.44579 val_f1_mac= 0.18781 time= 0.01982
Iter: 0010 train_loss= 0.51769 train_f1_mic= 0.45615 train_f1_mac= 0.18723 val_loss= 0.53746 val_f1_mic= 0.44579 val_f1_mac= 0.18781 time= 0.01953
Iter: 0015 train_loss= 0.52495 train_f1_mic= 0.43767 train_f1_mac= 0.17263 val_loss= 0.53746 val_f1_mic= 0.44579 val_f1_mac= 0.18781 time= 0.01925
Epoch: 0007
Iter: 0001 train_loss= 0.52429 train_f1_mic= 0.43725 train_f1_mac= 0.17711 val_loss= 0.54802 val_f1_mic= 0.44301 val_f1_mac= 0.18856 time= 0.01919
Iter: 0006 train_loss= 0.53312 train_f1_mic= 0.44056 train_f1_mac= 0.18424 val_loss= 0.54802 val_f1_mic= 0.44301 val_f1_mac= 0.18856 time= 0.01894
Iter: 0011 train_loss= 0.51808 train_f1_mic= 0.46229 train_f1_mac= 0.19908 val_loss= 0.54802 val_f1_mic= 0.44301 val_f1_mac= 0.18856 time= 0.01868
Iter: 0016 train_loss= 0.51123 train_f1_mic= 0.44949 train_f1_mac= 0.18959 val_loss= 0.54802 val_f1_mic= 0.44301 val_f1_mac= 0.18856 time= 0.01840
Epoch: 0008
Iter: 0002 train_loss= 0.50925 train_f1_mic= 0.43828 train_f1_mac= 0.17954 val_loss= 0.54249 val_f1_mic= 0.43742 val_f1_mac= 0.19011 time= 0.01839
Iter: 0007 train_loss= 0.51421 train_f1_mic= 0.46510 train_f1_mac= 0.20505 val_loss= 0.54249 val_f1_mic= 0.43742 val_f1_mac= 0.19011 time= 0.01823
Iter: 0012 train_loss= 0.51578 train_f1_mic= 0.46051 train_f1_mac= 0.19618 val_loss= 0.54249 val_f1_mic= 0.43742 val_f1_mac= 0.19011 time= 0.01804
Iter: 0017 train_loss= 0.51986 train_f1_mic= 0.43736 train_f1_mac= 0.18091 val_loss= 0.54249 val_f1_mic= 0.43742 val_f1_mac= 0.19011 time= 0.01780
Epoch: 0009
Iter: 0003 train_loss= 0.51979 train_f1_mic= 0.44429 train_f1_mac= 0.17636 val_loss= 0.53478 val_f1_mic= 0.45715 val_f1_mac= 0.20424 time= 0.01769
Iter: 0008 train_loss= 0.51653 train_f1_mic= 0.43188 train_f1_mac= 0.17237 val_loss= 0.53478 val_f1_mic= 0.45715 val_f1_mac= 0.20424 time= 0.01752
Iter: 0013 train_loss= 0.51953 train_f1_mic= 0.46693 train_f1_mac= 0.21746 val_loss= 0.53478 val_f1_mic= 0.45715 val_f1_mac= 0.20424 time= 0.01740
Iter: 0018 train_loss= 0.52097 train_f1_mic= 0.44846 train_f1_mac= 0.19492 val_loss= 0.53478 val_f1_mic= 0.45715 val_f1_mac= 0.20424 time= 0.01721
Epoch: 0010
Iter: 0004 train_loss= 0.51072 train_f1_mic= 0.44867 train_f1_mac= 0.18800 val_loss= 0.54239 val_f1_mic= 0.45809 val_f1_mac= 0.20243 time= 0.01723
Iter: 0009 train_loss= 0.52146 train_f1_mic= 0.43882 train_f1_mac= 0.19356 val_loss= 0.54239 val_f1_mic= 0.45809 val_f1_mac= 0.20243 time= 0.01712
Iter: 0014 train_loss= 0.50957 train_f1_mic= 0.45750 train_f1_mac= 0.19850 val_loss= 0.54239 val_f1_mic= 0.45809 val_f1_mac= 0.20243 time= 0.01702
Optimization Finished!
Full validation stats: loss= 0.53460 f1_micro= 0.45398 f1_macro= 0.20892 time= 0.09276
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4766016538136118
Rewards :  -0.0316517878828097 Accuracy :  0.451280223507364
Total reward :  1.3416558761124562
State input to Controller for training :  [0 0 0 0 5]
Training RNN (States ip) :  [4, 'linear', 0, 'tanh']
Training RNN (Reward ip) :  [-0.03165179]
Trial 353: Controller loss : 12092.366211

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 3.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'relu', 1, 'tanh']
2018-08-31 01:14:33.635908: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:14:33.636372: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:14:33.636817: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:14:33.637149: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:14:33.637553: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69322 train_f1_mic= 0.35178 train_f1_mac= 0.30410 val_loss= 0.66228 val_f1_mic= 0.37222 val_f1_mac= 0.10583 time= 1.57681
Iter: 0005 train_loss= 0.57551 train_f1_mic= 0.37753 train_f1_mac= 0.09197 val_loss= 0.66228 val_f1_mic= 0.37222 val_f1_mac= 0.10583 time= 0.38031
Iter: 0010 train_loss= 0.54848 train_f1_mic= 0.39222 train_f1_mac= 0.09882 val_loss= 0.66228 val_f1_mic= 0.37222 val_f1_mac= 0.10583 time= 0.26936
Iter: 0015 train_loss= 0.54307 train_f1_mic= 0.37788 train_f1_mac= 0.09158 val_loss= 0.66228 val_f1_mic= 0.37222 val_f1_mac= 0.10583 time= 0.22739
Epoch: 0002
Iter: 0001 train_loss= 0.55566 train_f1_mic= 0.36223 train_f1_mac= 0.08806 val_loss= 0.56760 val_f1_mic= 0.36138 val_f1_mac= 0.08991 time= 0.20773
Iter: 0006 train_loss= 0.54715 train_f1_mic= 0.39957 train_f1_mac= 0.10417 val_loss= 0.56760 val_f1_mic= 0.36138 val_f1_mac= 0.08991 time= 0.19367
Iter: 0011 train_loss= 0.53310 train_f1_mic= 0.40264 train_f1_mac= 0.10591 val_loss= 0.56760 val_f1_mic= 0.36138 val_f1_mac= 0.08991 time= 0.18393
Iter: 0016 train_loss= 0.53470 train_f1_mic= 0.40665 train_f1_mac= 0.10703 val_loss= 0.56760 val_f1_mic= 0.36138 val_f1_mac= 0.08991 time= 0.17678
Epoch: 0003
Iter: 0002 train_loss= 0.53609 train_f1_mic= 0.36888 train_f1_mac= 0.09334 val_loss= 0.55400 val_f1_mic= 0.37107 val_f1_mac= 0.09636 time= 0.17264
Iter: 0007 train_loss= 0.54034 train_f1_mic= 0.40478 train_f1_mac= 0.11557 val_loss= 0.55400 val_f1_mic= 0.37107 val_f1_mac= 0.09636 time= 0.16840
Iter: 0012 train_loss= 0.53697 train_f1_mic= 0.42800 train_f1_mac= 0.13276 val_loss= 0.55400 val_f1_mic= 0.37107 val_f1_mac= 0.09636 time= 0.16484
Iter: 0017 train_loss= 0.53648 train_f1_mic= 0.38761 train_f1_mac= 0.10586 val_loss= 0.55400 val_f1_mic= 0.37107 val_f1_mac= 0.09636 time= 0.16216
Epoch: 0004
Iter: 0003 train_loss= 0.54146 train_f1_mic= 0.39631 train_f1_mac= 0.10588 val_loss= 0.55992 val_f1_mic= 0.38945 val_f1_mac= 0.10975 time= 0.16073
Iter: 0008 train_loss= 0.52777 train_f1_mic= 0.39415 train_f1_mac= 0.10368 val_loss= 0.55992 val_f1_mic= 0.38945 val_f1_mac= 0.10975 time= 0.15859
Iter: 0013 train_loss= 0.53328 train_f1_mic= 0.37874 train_f1_mac= 0.10075 val_loss= 0.55992 val_f1_mic= 0.38945 val_f1_mac= 0.10975 time= 0.15693
Iter: 0018 train_loss= 0.53230 train_f1_mic= 0.41707 train_f1_mac= 0.12368 val_loss= 0.55992 val_f1_mic= 0.38945 val_f1_mac= 0.10975 time= 0.15527
Epoch: 0005
Iter: 0004 train_loss= 0.53554 train_f1_mic= 0.43056 train_f1_mac= 0.13494 val_loss= 0.56263 val_f1_mic= 0.41566 val_f1_mac= 0.13097 time= 0.15465
Iter: 0009 train_loss= 0.53329 train_f1_mic= 0.41298 train_f1_mac= 0.12807 val_loss= 0.56263 val_f1_mic= 0.41566 val_f1_mac= 0.13097 time= 0.15351
Iter: 0014 train_loss= 0.53396 train_f1_mic= 0.41033 train_f1_mac= 0.12883 val_loss= 0.56263 val_f1_mic= 0.41566 val_f1_mac= 0.13097 time= 0.15249
Epoch: 0006
Iter: 0000 train_loss= 0.53463 train_f1_mic= 0.40999 train_f1_mac= 0.12708 val_loss= 0.54784 val_f1_mic= 0.41332 val_f1_mac= 0.13293 time= 0.15193
Iter: 0005 train_loss= 0.53394 train_f1_mic= 0.40378 train_f1_mac= 0.12587 val_loss= 0.54784 val_f1_mic= 0.41332 val_f1_mac= 0.13293 time= 0.15109
Iter: 0010 train_loss= 0.52117 train_f1_mic= 0.40303 train_f1_mac= 0.12248 val_loss= 0.54784 val_f1_mic= 0.41332 val_f1_mac= 0.13293 time= 0.15026
Iter: 0015 train_loss= 0.52913 train_f1_mic= 0.45452 train_f1_mac= 0.16680 val_loss= 0.54784 val_f1_mic= 0.41332 val_f1_mac= 0.13293 time= 0.14953
Epoch: 0007
Iter: 0001 train_loss= 0.53074 train_f1_mic= 0.43812 train_f1_mac= 0.15734 val_loss= 0.53159 val_f1_mic= 0.44231 val_f1_mac= 0.15940 time= 0.14922
Iter: 0006 train_loss= 0.52043 train_f1_mic= 0.43795 train_f1_mac= 0.16206 val_loss= 0.53159 val_f1_mic= 0.44231 val_f1_mac= 0.15940 time= 0.14866
Iter: 0011 train_loss= 0.52224 train_f1_mic= 0.44583 train_f1_mac= 0.17577 val_loss= 0.53159 val_f1_mic= 0.44231 val_f1_mac= 0.15940 time= 0.14818
Iter: 0016 train_loss= 0.51923 train_f1_mic= 0.42471 train_f1_mac= 0.15146 val_loss= 0.53159 val_f1_mic= 0.44231 val_f1_mac= 0.15940 time= 0.14756
Epoch: 0008
Iter: 0002 train_loss= 0.50782 train_f1_mic= 0.43666 train_f1_mac= 0.16479 val_loss= 0.54950 val_f1_mic= 0.44462 val_f1_mac= 0.17730 time= 0.14747
Iter: 0007 train_loss= 0.51120 train_f1_mic= 0.45559 train_f1_mac= 0.19151 val_loss= 0.54950 val_f1_mic= 0.44462 val_f1_mac= 0.17730 time= 0.14697
Iter: 0012 train_loss= 0.52417 train_f1_mic= 0.47290 train_f1_mac= 0.19305 val_loss= 0.54950 val_f1_mic= 0.44462 val_f1_mac= 0.17730 time= 0.14654
Iter: 0017 train_loss= 0.53815 train_f1_mic= 0.43936 train_f1_mac= 0.18116 val_loss= 0.54950 val_f1_mic= 0.44462 val_f1_mac= 0.17730 time= 0.14606
Epoch: 0009
Iter: 0003 train_loss= 0.51904 train_f1_mic= 0.44397 train_f1_mac= 0.18196 val_loss= 0.53842 val_f1_mic= 0.47709 val_f1_mac= 0.22075 time= 0.14597
Iter: 0008 train_loss= 0.51171 train_f1_mic= 0.43874 train_f1_mac= 0.18019 val_loss= 0.53842 val_f1_mic= 0.47709 val_f1_mac= 0.22075 time= 0.14553
Iter: 0013 train_loss= 0.51339 train_f1_mic= 0.49071 train_f1_mac= 0.23672 val_loss= 0.53842 val_f1_mic= 0.47709 val_f1_mac= 0.22075 time= 0.14530
Iter: 0018 train_loss= 0.50851 train_f1_mic= 0.45437 train_f1_mac= 0.19065 val_loss= 0.53842 val_f1_mic= 0.47709 val_f1_mac= 0.22075 time= 0.14499
Epoch: 0010
Iter: 0004 train_loss= 0.50195 train_f1_mic= 0.47620 train_f1_mac= 0.23071 val_loss= 0.53532 val_f1_mic= 0.50297 val_f1_mac= 0.25345 time= 0.14498
Iter: 0009 train_loss= 0.50400 train_f1_mic= 0.47724 train_f1_mac= 0.21992 val_loss= 0.53532 val_f1_mic= 0.50297 val_f1_mac= 0.25345 time= 0.14475
Iter: 0014 train_loss= 0.50570 train_f1_mic= 0.48820 train_f1_mac= 0.24240 val_loss= 0.53532 val_f1_mic= 0.50297 val_f1_mac= 0.25345 time= 0.14445
Optimization Finished!
Full validation stats: loss= 0.52418 f1_micro= 0.48116 f1_macro= 0.24633 time= 0.33710
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.476427595857937
Rewards :  -0.000870289778374056 Accuracy :  0.47573136403523775
Total reward :  1.340785586334082
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'relu', 1, 'tanh']
Training RNN (Reward ip) :  [-0.00087029]
Trial 354: Controller loss : 5902.758789

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 2.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [1, 'sigmoid', 2, 'tanh']
2018-08-31 01:15:08.962786: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:15:08.963262: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:15:08.964375: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:15:08.964715: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:15:08.965142: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69138 train_f1_mic= 0.35902 train_f1_mac= 0.22599 val_loss= 0.66689 val_f1_mic= 0.37441 val_f1_mac= 0.10896 time= 1.35535
Iter: 0005 train_loss= 0.58149 train_f1_mic= 0.37830 train_f1_mac= 0.09192 val_loss= 0.66689 val_f1_mic= 0.37441 val_f1_mac= 0.10896 time= 0.32876
Iter: 0010 train_loss= 0.53149 train_f1_mic= 0.38729 train_f1_mac= 0.09098 val_loss= 0.66689 val_f1_mic= 0.37441 val_f1_mac= 0.10896 time= 0.23518
Iter: 0015 train_loss= 0.53705 train_f1_mic= 0.40006 train_f1_mac= 0.09813 val_loss= 0.66689 val_f1_mic= 0.37441 val_f1_mac= 0.10896 time= 0.20033
Epoch: 0002
Iter: 0001 train_loss= 0.55312 train_f1_mic= 0.36234 train_f1_mac= 0.08660 val_loss= 0.56207 val_f1_mic= 0.36347 val_f1_mac= 0.08822 time= 0.18389
Iter: 0006 train_loss= 0.54520 train_f1_mic= 0.36864 train_f1_mac= 0.08710 val_loss= 0.56207 val_f1_mic= 0.36347 val_f1_mac= 0.08822 time= 0.17216
Iter: 0011 train_loss= 0.55985 train_f1_mic= 0.38601 train_f1_mac= 0.09975 val_loss= 0.56207 val_f1_mic= 0.36347 val_f1_mac= 0.08822 time= 0.16417
Iter: 0016 train_loss= 0.54485 train_f1_mic= 0.38033 train_f1_mac= 0.09308 val_loss= 0.56207 val_f1_mic= 0.36347 val_f1_mac= 0.08822 time= 0.15902
Epoch: 0003
Iter: 0002 train_loss= 0.54638 train_f1_mic= 0.37516 train_f1_mac= 0.09204 val_loss= 0.56458 val_f1_mic= 0.38258 val_f1_mac= 0.09706 time= 0.15587
Iter: 0007 train_loss= 0.54585 train_f1_mic= 0.38011 train_f1_mac= 0.09269 val_loss= 0.56458 val_f1_mic= 0.38258 val_f1_mac= 0.09706 time= 0.15257
Iter: 0012 train_loss= 0.53895 train_f1_mic= 0.39930 train_f1_mac= 0.09889 val_loss= 0.56458 val_f1_mic= 0.38258 val_f1_mac= 0.09706 time= 0.15024
Iter: 0017 train_loss= 0.54043 train_f1_mic= 0.36658 train_f1_mac= 0.08644 val_loss= 0.56458 val_f1_mic= 0.38258 val_f1_mac= 0.09706 time= 0.14807
Epoch: 0004
Iter: 0003 train_loss= 0.53888 train_f1_mic= 0.38461 train_f1_mac= 0.09267 val_loss= 0.58528 val_f1_mic= 0.36361 val_f1_mac= 0.09332 time= 0.14683
Iter: 0008 train_loss= 0.54848 train_f1_mic= 0.39427 train_f1_mac= 0.09928 val_loss= 0.58528 val_f1_mic= 0.36361 val_f1_mac= 0.09332 time= 0.14515
Iter: 0013 train_loss= 0.53918 train_f1_mic= 0.36823 train_f1_mac= 0.08653 val_loss= 0.58528 val_f1_mic= 0.36361 val_f1_mac= 0.09332 time= 0.14371
Iter: 0018 train_loss= 0.54369 train_f1_mic= 0.37784 train_f1_mac= 0.09255 val_loss= 0.58528 val_f1_mic= 0.36361 val_f1_mac= 0.09332 time= 0.14250
Epoch: 0005
Iter: 0004 train_loss= 0.53220 train_f1_mic= 0.38201 train_f1_mac= 0.09081 val_loss= 0.56460 val_f1_mic= 0.36906 val_f1_mac= 0.09421 time= 0.14232
Iter: 0009 train_loss= 0.54046 train_f1_mic= 0.37060 train_f1_mac= 0.08718 val_loss= 0.56460 val_f1_mic= 0.36906 val_f1_mac= 0.09421 time= 0.14135
Iter: 0014 train_loss= 0.54592 train_f1_mic= 0.38149 train_f1_mac= 0.09335 val_loss= 0.56460 val_f1_mic= 0.36906 val_f1_mac= 0.09421 time= 0.14058
Epoch: 0006
Iter: 0000 train_loss= 0.54567 train_f1_mic= 0.37702 train_f1_mac= 0.09237 val_loss= 0.57123 val_f1_mic= 0.36325 val_f1_mac= 0.09447 time= 0.14030
Iter: 0005 train_loss= 0.53775 train_f1_mic= 0.38336 train_f1_mac= 0.09379 val_loss= 0.57123 val_f1_mic= 0.36325 val_f1_mac= 0.09447 time= 0.13973
Iter: 0010 train_loss= 0.54476 train_f1_mic= 0.36871 train_f1_mac= 0.08763 val_loss= 0.57123 val_f1_mic= 0.36325 val_f1_mac= 0.09447 time= 0.13913
Iter: 0015 train_loss= 0.55241 train_f1_mic= 0.38415 train_f1_mac= 0.09783 val_loss= 0.57123 val_f1_mic= 0.36325 val_f1_mac= 0.09447 time= 0.13854
Epoch: 0007
Iter: 0001 train_loss= 0.55019 train_f1_mic= 0.39153 train_f1_mac= 0.10163 val_loss= 0.56248 val_f1_mic= 0.39511 val_f1_mac= 0.10610 time= 0.13842
Iter: 0006 train_loss= 0.55056 train_f1_mic= 0.37268 train_f1_mac= 0.09245 val_loss= 0.56248 val_f1_mic= 0.39511 val_f1_mac= 0.10610 time= 0.13806
Iter: 0011 train_loss= 0.52871 train_f1_mic= 0.39505 train_f1_mac= 0.09607 val_loss= 0.56248 val_f1_mic= 0.39511 val_f1_mac= 0.10610 time= 0.13763
Iter: 0016 train_loss= 0.54681 train_f1_mic= 0.36328 train_f1_mac= 0.08703 val_loss= 0.56248 val_f1_mic= 0.39511 val_f1_mac= 0.10610 time= 0.13722
Epoch: 0008
Iter: 0002 train_loss= 0.53932 train_f1_mic= 0.37216 train_f1_mac= 0.08761 val_loss= 0.57536 val_f1_mic= 0.35590 val_f1_mac= 0.09041 time= 0.13724
Iter: 0007 train_loss= 0.53468 train_f1_mic= 0.40740 train_f1_mac= 0.10285 val_loss= 0.57536 val_f1_mic= 0.35590 val_f1_mac= 0.09041 time= 0.13688
Iter: 0012 train_loss= 0.55314 train_f1_mic= 0.38472 train_f1_mac= 0.09855 val_loss= 0.57536 val_f1_mic= 0.35590 val_f1_mac= 0.09041 time= 0.13655
Iter: 0017 train_loss= 0.53456 train_f1_mic= 0.37773 train_f1_mac= 0.09204 val_loss= 0.57536 val_f1_mic= 0.35590 val_f1_mac= 0.09041 time= 0.13620
Epoch: 0009
Iter: 0003 train_loss= 0.53676 train_f1_mic= 0.38435 train_f1_mac= 0.09499 val_loss= 0.57797 val_f1_mic= 0.37936 val_f1_mac= 0.10047 time= 0.13625
Iter: 0008 train_loss= 0.53282 train_f1_mic= 0.39426 train_f1_mac= 0.09692 val_loss= 0.57797 val_f1_mic= 0.37936 val_f1_mac= 0.10047 time= 0.13604
Iter: 0013 train_loss= 0.54281 train_f1_mic= 0.37414 train_f1_mac= 0.09413 val_loss= 0.57797 val_f1_mic= 0.37936 val_f1_mac= 0.10047 time= 0.13581
Iter: 0018 train_loss= 0.54118 train_f1_mic= 0.37721 train_f1_mac= 0.09498 val_loss= 0.57797 val_f1_mic= 0.37936 val_f1_mac= 0.10047 time= 0.13553
Epoch: 0010
Iter: 0004 train_loss= 0.54473 train_f1_mic= 0.37634 train_f1_mac= 0.09643 val_loss= 0.55267 val_f1_mic= 0.37599 val_f1_mac= 0.09688 time= 0.13551
Iter: 0009 train_loss= 0.54447 train_f1_mic= 0.40162 train_f1_mac= 0.11132 val_loss= 0.55267 val_f1_mic= 0.37599 val_f1_mac= 0.09688 time= 0.13528
Iter: 0014 train_loss= 0.54352 train_f1_mic= 0.38440 train_f1_mac= 0.10074 val_loss= 0.55267 val_f1_mic= 0.37599 val_f1_mac= 0.09688 time= 0.13502
Optimization Finished!
Full validation stats: loss= 0.56029 f1_micro= 0.39082 f1_macro= 0.11222 time= 0.24833
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4606701491818247
Rewards :  -0.07878723338056143 Accuracy :  0.39764036247737555
Total reward :  1.2619983529535206
State input to Controller for training :  [0 2 0 0 0]
Training RNN (States ip) :  [1, 'sigmoid', 2, 'tanh']
Training RNN (Reward ip) :  [-0.07878723]
Trial 355: Controller loss : 8163.040039

Prediction action from Controller
State input to Controller for Action :  [0. 2. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:15:41.870056: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:15:41.870550: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:15:41.871020: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:15:41.871369: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:15:41.871847: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69190 train_f1_mic= 0.39008 train_f1_mac= 0.30618 val_loss= 0.66169 val_f1_mic= 0.33246 val_f1_mac= 0.10207 time= 0.82822
Iter: 0005 train_loss= 0.59145 train_f1_mic= 0.36269 train_f1_mac= 0.08605 val_loss= 0.66169 val_f1_mic= 0.33246 val_f1_mac= 0.10207 time= 0.15100
Iter: 0010 train_loss= 0.54321 train_f1_mic= 0.38444 train_f1_mac= 0.09233 val_loss= 0.66169 val_f1_mic= 0.33246 val_f1_mac= 0.10207 time= 0.08962
Iter: 0015 train_loss= 0.55174 train_f1_mic= 0.41107 train_f1_mac= 0.11292 val_loss= 0.66169 val_f1_mic= 0.33246 val_f1_mac= 0.10207 time= 0.06622
Epoch: 0002
Iter: 0001 train_loss= 0.53323 train_f1_mic= 0.40915 train_f1_mac= 0.10755 val_loss= 0.57258 val_f1_mic= 0.39462 val_f1_mac= 0.11286 time= 0.05473
Iter: 0006 train_loss= 0.54629 train_f1_mic= 0.37627 train_f1_mac= 0.09371 val_loss= 0.57258 val_f1_mic= 0.39462 val_f1_mac= 0.11286 time= 0.04697
Iter: 0011 train_loss= 0.54355 train_f1_mic= 0.37404 train_f1_mac= 0.09385 val_loss= 0.57258 val_f1_mic= 0.39462 val_f1_mac= 0.11286 time= 0.04165
Iter: 0016 train_loss= 0.54117 train_f1_mic= 0.39466 train_f1_mac= 0.10573 val_loss= 0.57258 val_f1_mic= 0.39462 val_f1_mac= 0.11286 time= 0.03802
Epoch: 0003
Iter: 0002 train_loss= 0.52952 train_f1_mic= 0.37952 train_f1_mac= 0.10006 val_loss= 0.55398 val_f1_mic= 0.37712 val_f1_mac= 0.10285 time= 0.03638
Iter: 0007 train_loss= 0.52765 train_f1_mic= 0.38856 train_f1_mac= 0.10880 val_loss= 0.55398 val_f1_mic= 0.37712 val_f1_mac= 0.10285 time= 0.03416
Iter: 0012 train_loss= 0.54264 train_f1_mic= 0.41433 train_f1_mac= 0.12928 val_loss= 0.55398 val_f1_mic= 0.37712 val_f1_mac= 0.10285 time= 0.03229
Iter: 0017 train_loss= 0.53765 train_f1_mic= 0.40038 train_f1_mac= 0.12350 val_loss= 0.55398 val_f1_mic= 0.37712 val_f1_mac= 0.10285 time= 0.03082
Epoch: 0004
Iter: 0003 train_loss= 0.52279 train_f1_mic= 0.43507 train_f1_mac= 0.13800 val_loss= 0.54099 val_f1_mic= 0.41468 val_f1_mac= 0.13179 time= 0.02993
Iter: 0008 train_loss= 0.52286 train_f1_mic= 0.42068 train_f1_mac= 0.13545 val_loss= 0.54099 val_f1_mic= 0.41468 val_f1_mac= 0.13179 time= 0.02876
Iter: 0013 train_loss= 0.51404 train_f1_mic= 0.43151 train_f1_mac= 0.14145 val_loss= 0.54099 val_f1_mic= 0.41468 val_f1_mac= 0.13179 time= 0.02775
Iter: 0018 train_loss= 0.52068 train_f1_mic= 0.42349 train_f1_mac= 0.13963 val_loss= 0.54099 val_f1_mic= 0.41468 val_f1_mac= 0.13179 time= 0.02696
Epoch: 0005
Iter: 0004 train_loss= 0.52574 train_f1_mic= 0.42363 train_f1_mac= 0.14048 val_loss= 0.54776 val_f1_mic= 0.42690 val_f1_mac= 0.15344 time= 0.02655
Iter: 0009 train_loss= 0.51562 train_f1_mic= 0.41936 train_f1_mac= 0.13715 val_loss= 0.54776 val_f1_mic= 0.42690 val_f1_mac= 0.15344 time= 0.02591
Iter: 0014 train_loss= 0.51526 train_f1_mic= 0.43321 train_f1_mac= 0.15277 val_loss= 0.54776 val_f1_mic= 0.42690 val_f1_mac= 0.15344 time= 0.02537
Epoch: 0006
Iter: 0000 train_loss= 0.53405 train_f1_mic= 0.47189 train_f1_mac= 0.20375 val_loss= 0.53365 val_f1_mic= 0.50242 val_f1_mac= 0.22495 time= 0.02508
Iter: 0005 train_loss= 0.51310 train_f1_mic= 0.42204 train_f1_mac= 0.15729 val_loss= 0.53365 val_f1_mic= 0.50242 val_f1_mac= 0.22495 time= 0.02456
Iter: 0010 train_loss= 0.52423 train_f1_mic= 0.44772 train_f1_mac= 0.18437 val_loss= 0.53365 val_f1_mic= 0.50242 val_f1_mac= 0.22495 time= 0.02414
Iter: 0015 train_loss= 0.52511 train_f1_mic= 0.44202 train_f1_mac= 0.17503 val_loss= 0.53365 val_f1_mic= 0.50242 val_f1_mac= 0.22495 time= 0.02377
Epoch: 0007
Iter: 0001 train_loss= 0.50791 train_f1_mic= 0.45323 train_f1_mac= 0.18321 val_loss= 0.52782 val_f1_mic= 0.45940 val_f1_mac= 0.19235 time= 0.02363
Iter: 0006 train_loss= 0.51358 train_f1_mic= 0.48482 train_f1_mac= 0.22184 val_loss= 0.52782 val_f1_mic= 0.45940 val_f1_mac= 0.19235 time= 0.02334
Iter: 0011 train_loss= 0.51244 train_f1_mic= 0.44864 train_f1_mac= 0.18937 val_loss= 0.52782 val_f1_mic= 0.45940 val_f1_mac= 0.19235 time= 0.02300
Iter: 0016 train_loss= 0.50901 train_f1_mic= 0.47199 train_f1_mac= 0.21360 val_loss= 0.52782 val_f1_mic= 0.45940 val_f1_mac= 0.19235 time= 0.02270
Epoch: 0008
Iter: 0002 train_loss= 0.50486 train_f1_mic= 0.47417 train_f1_mac= 0.21179 val_loss= 0.52388 val_f1_mic= 0.46047 val_f1_mac= 0.21743 time= 0.02255
Iter: 0007 train_loss= 0.50439 train_f1_mic= 0.46628 train_f1_mac= 0.21322 val_loss= 0.52388 val_f1_mic= 0.46047 val_f1_mac= 0.21743 time= 0.02229
Iter: 0012 train_loss= 0.50613 train_f1_mic= 0.48619 train_f1_mac= 0.23259 val_loss= 0.52388 val_f1_mic= 0.46047 val_f1_mac= 0.21743 time= 0.02203
Iter: 0017 train_loss= 0.49800 train_f1_mic= 0.48849 train_f1_mac= 0.24515 val_loss= 0.52388 val_f1_mic= 0.46047 val_f1_mac= 0.21743 time= 0.02177
Epoch: 0009
Iter: 0003 train_loss= 0.49768 train_f1_mic= 0.47852 train_f1_mac= 0.22853 val_loss= 0.53140 val_f1_mic= 0.47409 val_f1_mac= 0.22686 time= 0.02174
Iter: 0008 train_loss= 0.49458 train_f1_mic= 0.47815 train_f1_mac= 0.22116 val_loss= 0.53140 val_f1_mic= 0.47409 val_f1_mac= 0.22686 time= 0.02156
Iter: 0013 train_loss= 0.49574 train_f1_mic= 0.47169 train_f1_mac= 0.23280 val_loss= 0.53140 val_f1_mic= 0.47409 val_f1_mac= 0.22686 time= 0.02137
Iter: 0018 train_loss= 0.50829 train_f1_mic= 0.51479 train_f1_mac= 0.27262 val_loss= 0.53140 val_f1_mic= 0.47409 val_f1_mac= 0.22686 time= 0.02117
Epoch: 0010
Iter: 0004 train_loss= 0.50127 train_f1_mic= 0.47602 train_f1_mac= 0.23435 val_loss= 0.51958 val_f1_mic= 0.47523 val_f1_mac= 0.24420 time= 0.02113
Iter: 0009 train_loss= 0.49881 train_f1_mic= 0.45293 train_f1_mac= 0.21958 val_loss= 0.51958 val_f1_mic= 0.47523 val_f1_mac= 0.24420 time= 0.02097
Iter: 0014 train_loss= 0.50590 train_f1_mic= 0.52110 train_f1_mac= 0.27795 val_loss= 0.51958 val_f1_mic= 0.47523 val_f1_mac= 0.24420 time= 0.02080
Optimization Finished!
Full validation stats: loss= 0.51247 f1_micro= 0.50552 f1_macro= 0.27780 time= 0.11470
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46839121726413896
Rewards :  0.038605340411571376 Accuracy :  0.49927548959339607
Total reward :  1.300603693365092
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03860534]
Trial 356: Controller loss : 146.560425

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:15:51.436966: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:15:51.437405: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:15:51.437832: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:15:51.438146: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:15:51.438559: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69317 train_f1_mic= 0.38642 train_f1_mac= 0.30599 val_loss= 0.66474 val_f1_mic= 0.31075 val_f1_mac= 0.08151 time= 0.76995
Iter: 0005 train_loss= 0.59153 train_f1_mic= 0.39556 train_f1_mac= 0.10084 val_loss= 0.66474 val_f1_mic= 0.31075 val_f1_mac= 0.08151 time= 0.14095
Iter: 0010 train_loss= 0.53748 train_f1_mic= 0.38514 train_f1_mac= 0.09200 val_loss= 0.66474 val_f1_mic= 0.31075 val_f1_mac= 0.08151 time= 0.08450
Iter: 0015 train_loss= 0.54922 train_f1_mic= 0.40472 train_f1_mac= 0.10820 val_loss= 0.66474 val_f1_mic= 0.31075 val_f1_mac= 0.08151 time= 0.06282
Epoch: 0002
Iter: 0001 train_loss= 0.54368 train_f1_mic= 0.36842 train_f1_mac= 0.08937 val_loss= 0.55788 val_f1_mic= 0.36528 val_f1_mac= 0.09123 time= 0.05257
Iter: 0006 train_loss= 0.54570 train_f1_mic= 0.36705 train_f1_mac= 0.08902 val_loss= 0.55788 val_f1_mic= 0.36528 val_f1_mac= 0.09123 time= 0.04522
Iter: 0011 train_loss= 0.53555 train_f1_mic= 0.37705 train_f1_mac= 0.09631 val_loss= 0.55788 val_f1_mic= 0.36528 val_f1_mac= 0.09123 time= 0.04041
Iter: 0016 train_loss= 0.53275 train_f1_mic= 0.38103 train_f1_mac= 0.09800 val_loss= 0.55788 val_f1_mic= 0.36528 val_f1_mac= 0.09123 time= 0.03701
Epoch: 0003
Iter: 0002 train_loss= 0.52642 train_f1_mic= 0.39190 train_f1_mac= 0.10731 val_loss= 0.54760 val_f1_mic= 0.38182 val_f1_mac= 0.10932 time= 0.03485
Iter: 0007 train_loss= 0.53707 train_f1_mic= 0.40779 train_f1_mac= 0.12379 val_loss= 0.54760 val_f1_mic= 0.38182 val_f1_mac= 0.10932 time= 0.03263
Iter: 0012 train_loss= 0.53746 train_f1_mic= 0.41611 train_f1_mac= 0.12968 val_loss= 0.54760 val_f1_mic= 0.38182 val_f1_mac= 0.10932 time= 0.03093
Iter: 0017 train_loss= 0.53649 train_f1_mic= 0.39872 train_f1_mac= 0.12171 val_loss= 0.54760 val_f1_mic= 0.38182 val_f1_mac= 0.10932 time= 0.02969
Epoch: 0004
Iter: 0003 train_loss= 0.53362 train_f1_mic= 0.39117 train_f1_mac= 0.11973 val_loss= 0.56773 val_f1_mic= 0.41098 val_f1_mac= 0.13476 time= 0.02895
Iter: 0008 train_loss= 0.52223 train_f1_mic= 0.43183 train_f1_mac= 0.14257 val_loss= 0.56773 val_f1_mic= 0.41098 val_f1_mac= 0.13476 time= 0.02824
Iter: 0013 train_loss= 0.51726 train_f1_mic= 0.44755 train_f1_mac= 0.15423 val_loss= 0.56773 val_f1_mic= 0.41098 val_f1_mac= 0.13476 time= 0.02723
Iter: 0018 train_loss= 0.52283 train_f1_mic= 0.42001 train_f1_mac= 0.14119 val_loss= 0.56773 val_f1_mic= 0.41098 val_f1_mac= 0.13476 time= 0.02653
Epoch: 0005
Iter: 0004 train_loss= 0.52360 train_f1_mic= 0.44125 train_f1_mac= 0.16424 val_loss= 0.53775 val_f1_mic= 0.46056 val_f1_mac= 0.17507 time= 0.02615
Iter: 0009 train_loss= 0.52551 train_f1_mic= 0.41970 train_f1_mac= 0.15298 val_loss= 0.53775 val_f1_mic= 0.46056 val_f1_mac= 0.17507 time= 0.02560
Iter: 0014 train_loss= 0.51760 train_f1_mic= 0.44279 train_f1_mac= 0.16955 val_loss= 0.53775 val_f1_mic= 0.46056 val_f1_mac= 0.17507 time= 0.02507
Epoch: 0006
Iter: 0000 train_loss= 0.52442 train_f1_mic= 0.44749 train_f1_mac= 0.17202 val_loss= 0.53772 val_f1_mic= 0.46756 val_f1_mac= 0.19542 time= 0.02483
Iter: 0005 train_loss= 0.51748 train_f1_mic= 0.42536 train_f1_mac= 0.16002 val_loss= 0.53772 val_f1_mic= 0.46756 val_f1_mac= 0.19542 time= 0.02433
Iter: 0010 train_loss= 0.51605 train_f1_mic= 0.44557 train_f1_mac= 0.17061 val_loss= 0.53772 val_f1_mic= 0.46756 val_f1_mac= 0.19542 time= 0.02385
Iter: 0015 train_loss= 0.50479 train_f1_mic= 0.45620 train_f1_mac= 0.18063 val_loss= 0.53772 val_f1_mic= 0.46756 val_f1_mac= 0.19542 time= 0.02349
Epoch: 0007
Iter: 0001 train_loss= 0.50472 train_f1_mic= 0.47185 train_f1_mac= 0.20085 val_loss= 0.51901 val_f1_mic= 0.46049 val_f1_mac= 0.20437 time= 0.02336
Iter: 0006 train_loss= 0.52202 train_f1_mic= 0.46607 train_f1_mac= 0.21549 val_loss= 0.51901 val_f1_mic= 0.46049 val_f1_mac= 0.20437 time= 0.02299
Iter: 0011 train_loss= 0.51026 train_f1_mic= 0.46271 train_f1_mac= 0.21092 val_loss= 0.51901 val_f1_mic= 0.46049 val_f1_mac= 0.20437 time= 0.02274
Iter: 0016 train_loss= 0.51069 train_f1_mic= 0.47958 train_f1_mac= 0.21827 val_loss= 0.51901 val_f1_mic= 0.46049 val_f1_mac= 0.20437 time= 0.02250
Epoch: 0008
Iter: 0002 train_loss= 0.50609 train_f1_mic= 0.49001 train_f1_mac= 0.22648 val_loss= 0.52433 val_f1_mic= 0.46763 val_f1_mac= 0.21799 time= 0.02243
Iter: 0007 train_loss= 0.51224 train_f1_mic= 0.43422 train_f1_mac= 0.19010 val_loss= 0.52433 val_f1_mic= 0.46763 val_f1_mac= 0.21799 time= 0.02216
Iter: 0012 train_loss= 0.51527 train_f1_mic= 0.45997 train_f1_mac= 0.20353 val_loss= 0.52433 val_f1_mic= 0.46763 val_f1_mac= 0.21799 time= 0.02192
Iter: 0017 train_loss= 0.50265 train_f1_mic= 0.48874 train_f1_mac= 0.24334 val_loss= 0.52433 val_f1_mic= 0.46763 val_f1_mac= 0.21799 time= 0.02170
Epoch: 0009
Iter: 0003 train_loss= 0.51038 train_f1_mic= 0.46862 train_f1_mac= 0.21317 val_loss= 0.53179 val_f1_mic= 0.45342 val_f1_mac= 0.19866 time= 0.02162
Iter: 0008 train_loss= 0.50945 train_f1_mic= 0.44756 train_f1_mac= 0.20770 val_loss= 0.53179 val_f1_mic= 0.45342 val_f1_mac= 0.19866 time= 0.02145
Iter: 0013 train_loss= 0.49565 train_f1_mic= 0.48755 train_f1_mac= 0.23885 val_loss= 0.53179 val_f1_mic= 0.45342 val_f1_mac= 0.19866 time= 0.02125
Iter: 0018 train_loss= 0.50662 train_f1_mic= 0.53156 train_f1_mac= 0.28490 val_loss= 0.53179 val_f1_mic= 0.45342 val_f1_mac= 0.19866 time= 0.02112
Epoch: 0010
Iter: 0004 train_loss= 0.50245 train_f1_mic= 0.45980 train_f1_mac= 0.21843 val_loss= 0.51378 val_f1_mic= 0.52374 val_f1_mac= 0.29560 time= 0.02113
Iter: 0009 train_loss= 0.50177 train_f1_mic= 0.48964 train_f1_mac= 0.24796 val_loss= 0.51378 val_f1_mic= 0.52374 val_f1_mac= 0.29560 time= 0.02096
Iter: 0014 train_loss= 0.50760 train_f1_mic= 0.50823 train_f1_mac= 0.26119 val_loss= 0.51378 val_f1_mic= 0.52374 val_f1_mac= 0.29560 time= 0.02086
Optimization Finished!
Full validation stats: loss= 0.51557 f1_micro= 0.51587 f1_macro= 0.28560 time= 0.07882
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47599438125351823
Rewards :  0.038015819946896345 Accuracy :  0.5064070372110353
Total reward :  1.3386195133119883
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.03801582]
Trial 357: Controller loss : 146.861938
2018-08-31 01:16:01.175996: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:16:01.176469: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:16:01.176916: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:16:01.177245: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:16:01.177657: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'sigmoid', 2, 'tanh']
Epoch: 0001
Iter: 0000 train_loss= 0.69531 train_f1_mic= 0.37512 train_f1_mac= 0.26465 val_loss= 0.67174 val_f1_mic= 0.34225 val_f1_mac= 0.09839 time= 0.88162
Iter: 0005 train_loss= 0.59016 train_f1_mic= 0.38467 train_f1_mac= 0.09800 val_loss= 0.67174 val_f1_mic= 0.34225 val_f1_mac= 0.09839 time= 0.19928
Iter: 0010 train_loss= 0.53657 train_f1_mic= 0.37721 train_f1_mac= 0.08740 val_loss= 0.67174 val_f1_mic= 0.34225 val_f1_mac= 0.09839 time= 0.13717
Iter: 0015 train_loss= 0.53425 train_f1_mic= 0.38665 train_f1_mac= 0.09189 val_loss= 0.67174 val_f1_mic= 0.34225 val_f1_mac= 0.09839 time= 0.11400
Epoch: 0002
Iter: 0001 train_loss= 0.54388 train_f1_mic= 0.39511 train_f1_mac= 0.09801 val_loss= 0.59180 val_f1_mic= 0.37403 val_f1_mac= 0.10072 time= 0.10348
Iter: 0006 train_loss= 0.55135 train_f1_mic= 0.36883 train_f1_mac= 0.08821 val_loss= 0.59180 val_f1_mic= 0.37403 val_f1_mac= 0.10072 time= 0.09563
Iter: 0011 train_loss= 0.53750 train_f1_mic= 0.39773 train_f1_mac= 0.09776 val_loss= 0.59180 val_f1_mic= 0.37403 val_f1_mac= 0.10072 time= 0.09034
Iter: 0016 train_loss= 0.55179 train_f1_mic= 0.37866 train_f1_mac= 0.09358 val_loss= 0.59180 val_f1_mic= 0.37403 val_f1_mac= 0.10072 time= 0.08663
Epoch: 0003
Iter: 0002 train_loss= 0.54213 train_f1_mic= 0.39136 train_f1_mac= 0.09813 val_loss= 0.57020 val_f1_mic= 0.38378 val_f1_mac= 0.10167 time= 0.08426
Iter: 0007 train_loss= 0.54618 train_f1_mic= 0.39256 train_f1_mac= 0.09856 val_loss= 0.57020 val_f1_mic= 0.38378 val_f1_mac= 0.10167 time= 0.08198
Iter: 0012 train_loss= 0.54684 train_f1_mic= 0.37751 train_f1_mac= 0.09289 val_loss= 0.57020 val_f1_mic= 0.38378 val_f1_mac= 0.10167 time= 0.08008
Iter: 0017 train_loss= 0.54327 train_f1_mic= 0.37976 train_f1_mac= 0.09244 val_loss= 0.57020 val_f1_mic= 0.38378 val_f1_mac= 0.10167 time= 0.07852
Epoch: 0004
Iter: 0003 train_loss= 0.54135 train_f1_mic= 0.40098 train_f1_mac= 0.10242 val_loss= 0.56226 val_f1_mic= 0.36045 val_f1_mac= 0.08995 time= 0.07756
Iter: 0008 train_loss= 0.54119 train_f1_mic= 0.37247 train_f1_mac= 0.08880 val_loss= 0.56226 val_f1_mic= 0.36045 val_f1_mac= 0.08995 time= 0.07645
Iter: 0013 train_loss= 0.54355 train_f1_mic= 0.37018 train_f1_mac= 0.08837 val_loss= 0.56226 val_f1_mic= 0.36045 val_f1_mac= 0.08995 time= 0.07553
Iter: 0018 train_loss= 0.54791 train_f1_mic= 0.36738 train_f1_mac= 0.08834 val_loss= 0.56226 val_f1_mic= 0.36045 val_f1_mac= 0.08995 time= 0.07464
Epoch: 0005
Iter: 0004 train_loss= 0.55160 train_f1_mic= 0.40165 train_f1_mac= 0.10481 val_loss= 0.56504 val_f1_mic= 0.38697 val_f1_mac= 0.10204 time= 0.07413
Iter: 0009 train_loss= 0.54003 train_f1_mic= 0.38138 train_f1_mac= 0.09247 val_loss= 0.56504 val_f1_mic= 0.38697 val_f1_mac= 0.10204 time= 0.07348
Iter: 0014 train_loss= 0.53510 train_f1_mic= 0.38481 train_f1_mac= 0.09289 val_loss= 0.56504 val_f1_mic= 0.38697 val_f1_mac= 0.10204 time= 0.07286
Epoch: 0006
Iter: 0000 train_loss= 0.54396 train_f1_mic= 0.36500 train_f1_mac= 0.08692 val_loss= 0.57201 val_f1_mic= 0.36738 val_f1_mac= 0.09225 time= 0.07263
Iter: 0005 train_loss= 0.54604 train_f1_mic= 0.36972 train_f1_mac= 0.09103 val_loss= 0.57201 val_f1_mic= 0.36738 val_f1_mac= 0.09225 time= 0.07221
Iter: 0010 train_loss= 0.54025 train_f1_mic= 0.39511 train_f1_mac= 0.10134 val_loss= 0.57201 val_f1_mic= 0.36738 val_f1_mac= 0.09225 time= 0.07178
Iter: 0015 train_loss= 0.55283 train_f1_mic= 0.36873 train_f1_mac= 0.09479 val_loss= 0.57201 val_f1_mic= 0.36738 val_f1_mac= 0.09225 time= 0.07141
Epoch: 0007
Iter: 0001 train_loss= 0.53853 train_f1_mic= 0.37964 train_f1_mac= 0.09589 val_loss= 0.57892 val_f1_mic= 0.36638 val_f1_mac= 0.10077 time= 0.07124
Iter: 0006 train_loss= 0.54483 train_f1_mic= 0.37625 train_f1_mac= 0.09678 val_loss= 0.57892 val_f1_mic= 0.36638 val_f1_mac= 0.10077 time= 0.07088
Iter: 0011 train_loss= 0.53813 train_f1_mic= 0.39914 train_f1_mac= 0.10894 val_loss= 0.57892 val_f1_mic= 0.36638 val_f1_mac= 0.10077 time= 0.07054
Iter: 0016 train_loss= 0.53385 train_f1_mic= 0.37782 train_f1_mac= 0.09321 val_loss= 0.57892 val_f1_mic= 0.36638 val_f1_mac= 0.10077 time= 0.07026
Epoch: 0008
Iter: 0002 train_loss= 0.51718 train_f1_mic= 0.38707 train_f1_mac= 0.09598 val_loss= 0.56840 val_f1_mic= 0.37382 val_f1_mac= 0.10408 time= 0.07017
Iter: 0007 train_loss= 0.52783 train_f1_mic= 0.40540 train_f1_mac= 0.11428 val_loss= 0.56840 val_f1_mic= 0.37382 val_f1_mac= 0.10408 time= 0.06991
Iter: 0012 train_loss= 0.51719 train_f1_mic= 0.44571 train_f1_mac= 0.13510 val_loss= 0.56840 val_f1_mic= 0.37382 val_f1_mac= 0.10408 time= 0.06974
Iter: 0017 train_loss= 0.53792 train_f1_mic= 0.41670 train_f1_mac= 0.12934 val_loss= 0.56840 val_f1_mic= 0.37382 val_f1_mac= 0.10408 time= 0.06957
Epoch: 0009
Iter: 0003 train_loss= 0.52547 train_f1_mic= 0.41846 train_f1_mac= 0.12380 val_loss= 0.56210 val_f1_mic= 0.42227 val_f1_mac= 0.13532 time= 0.06949
Iter: 0008 train_loss= 0.52901 train_f1_mic= 0.42777 train_f1_mac= 0.13361 val_loss= 0.56210 val_f1_mic= 0.42227 val_f1_mac= 0.13532 time= 0.06929
Iter: 0013 train_loss= 0.53275 train_f1_mic= 0.38606 train_f1_mac= 0.10966 val_loss= 0.56210 val_f1_mic= 0.42227 val_f1_mac= 0.13532 time= 0.06910
Iter: 0018 train_loss= 0.52207 train_f1_mic= 0.42835 train_f1_mac= 0.13039 val_loss= 0.56210 val_f1_mic= 0.42227 val_f1_mac= 0.13532 time= 0.06892
Epoch: 0010
Iter: 0004 train_loss= 0.52923 train_f1_mic= 0.43554 train_f1_mac= 0.13770 val_loss= 0.57550 val_f1_mic= 0.40506 val_f1_mac= 0.13402 time= 0.06889
Iter: 0009 train_loss= 0.53883 train_f1_mic= 0.40170 train_f1_mac= 0.12210 val_loss= 0.57550 val_f1_mic= 0.40506 val_f1_mac= 0.13402 time= 0.06873
Iter: 0014 train_loss= 0.54248 train_f1_mic= 0.41644 train_f1_mac= 0.13111 val_loss= 0.57550 val_f1_mic= 0.40506 val_f1_mac= 0.13402 time= 0.06858
Optimization Finished!
Full validation stats: loss= 0.55252 f1_micro= 0.39344 f1_macro= 0.12531 time= 0.12866
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46110993371899966
Rewards :  -0.07442223767259276 Accuracy :  0.40157214358092547
Total reward :  1.2641972756393955
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'sigmoid', 2, 'tanh']
Training RNN (Reward ip) :  [-0.07442224]
Trial 358: Controller loss : 9660.695312

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 1.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [3, 'linear', 3, 'sigmoid']
2018-08-31 01:16:19.854050: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:16:19.854781: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:16:19.855475: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:16:19.855977: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:16:19.857358: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69280 train_f1_mic= 0.36106 train_f1_mac= 0.23613 val_loss= 0.65345 val_f1_mic= 0.36369 val_f1_mac= 0.08906 time= 0.87566
Iter: 0005 train_loss= 0.57344 train_f1_mic= 0.39615 train_f1_mac= 0.09798 val_loss= 0.65345 val_f1_mic= 0.36369 val_f1_mac= 0.08906 time= 0.19880
Iter: 0010 train_loss= 0.54237 train_f1_mic= 0.39560 train_f1_mac= 0.09767 val_loss= 0.65345 val_f1_mic= 0.36369 val_f1_mac= 0.08906 time= 0.13709
Iter: 0015 train_loss= 0.54470 train_f1_mic= 0.38481 train_f1_mac= 0.09342 val_loss= 0.65345 val_f1_mic= 0.36369 val_f1_mac= 0.08906 time= 0.11395
Epoch: 0002
Iter: 0001 train_loss= 0.55013 train_f1_mic= 0.38005 train_f1_mac= 0.09502 val_loss= 0.58646 val_f1_mic= 0.38270 val_f1_mac= 0.10180 time= 0.10282
Iter: 0006 train_loss= 0.54919 train_f1_mic= 0.36518 train_f1_mac= 0.08701 val_loss= 0.58646 val_f1_mic= 0.38270 val_f1_mac= 0.10180 time= 0.09528
Iter: 0011 train_loss= 0.54979 train_f1_mic= 0.37177 train_f1_mac= 0.09107 val_loss= 0.58646 val_f1_mic= 0.38270 val_f1_mac= 0.10180 time= 0.09011
Iter: 0016 train_loss= 0.52891 train_f1_mic= 0.40268 train_f1_mac= 0.10097 val_loss= 0.58646 val_f1_mic= 0.38270 val_f1_mac= 0.10180 time= 0.08635
Epoch: 0003
Iter: 0002 train_loss= 0.53203 train_f1_mic= 0.40066 train_f1_mac= 0.10072 val_loss= 0.57392 val_f1_mic= 0.38688 val_f1_mac= 0.10643 time= 0.08404
Iter: 0007 train_loss= 0.54392 train_f1_mic= 0.36785 train_f1_mac= 0.09106 val_loss= 0.57392 val_f1_mic= 0.38688 val_f1_mac= 0.10643 time= 0.08176
Iter: 0012 train_loss= 0.53222 train_f1_mic= 0.39280 train_f1_mac= 0.09710 val_loss= 0.57392 val_f1_mic= 0.38688 val_f1_mac= 0.10643 time= 0.08004
Iter: 0017 train_loss= 0.54446 train_f1_mic= 0.40117 train_f1_mac= 0.10766 val_loss= 0.57392 val_f1_mic= 0.38688 val_f1_mac= 0.10643 time= 0.07852
Epoch: 0004
Iter: 0003 train_loss= 0.55070 train_f1_mic= 0.39663 train_f1_mac= 0.10945 val_loss= 0.56827 val_f1_mic= 0.40379 val_f1_mac= 0.11669 time= 0.07759
Iter: 0008 train_loss= 0.52435 train_f1_mic= 0.40597 train_f1_mac= 0.11137 val_loss= 0.56827 val_f1_mic= 0.40379 val_f1_mac= 0.11669 time= 0.07653
Iter: 0013 train_loss= 0.53895 train_f1_mic= 0.40117 train_f1_mac= 0.10989 val_loss= 0.56827 val_f1_mic= 0.40379 val_f1_mac= 0.11669 time= 0.07561
Iter: 0018 train_loss= 0.53852 train_f1_mic= 0.40072 train_f1_mac= 0.11088 val_loss= 0.56827 val_f1_mic= 0.40379 val_f1_mac= 0.11669 time= 0.07480
Epoch: 0005
Iter: 0004 train_loss= 0.54378 train_f1_mic= 0.41047 train_f1_mac= 0.11689 val_loss= 0.55304 val_f1_mic= 0.41234 val_f1_mac= 0.11744 time= 0.07436
Iter: 0009 train_loss= 0.52314 train_f1_mic= 0.40998 train_f1_mac= 0.11506 val_loss= 0.55304 val_f1_mic= 0.41234 val_f1_mac= 0.11744 time= 0.07374
Iter: 0014 train_loss= 0.53221 train_f1_mic= 0.39853 train_f1_mac= 0.11080 val_loss= 0.55304 val_f1_mic= 0.41234 val_f1_mac= 0.11744 time= 0.07322
Epoch: 0006
Iter: 0000 train_loss= 0.52698 train_f1_mic= 0.42816 train_f1_mac= 0.12833 val_loss= 0.55273 val_f1_mic= 0.41068 val_f1_mac= 0.12390 time= 0.07298
Iter: 0005 train_loss= 0.52772 train_f1_mic= 0.39400 train_f1_mac= 0.11045 val_loss= 0.55273 val_f1_mic= 0.41068 val_f1_mac= 0.12390 time= 0.07262
Iter: 0010 train_loss= 0.53576 train_f1_mic= 0.42412 train_f1_mac= 0.13269 val_loss= 0.55273 val_f1_mic= 0.41068 val_f1_mac= 0.12390 time= 0.07228
Iter: 0015 train_loss= 0.52811 train_f1_mic= 0.38870 train_f1_mac= 0.10638 val_loss= 0.55273 val_f1_mic= 0.41068 val_f1_mac= 0.12390 time= 0.07190
Epoch: 0007
Iter: 0001 train_loss= 0.53106 train_f1_mic= 0.41016 train_f1_mac= 0.11352 val_loss= 0.55102 val_f1_mic= 0.39366 val_f1_mac= 0.11451 time= 0.07176
Iter: 0006 train_loss= 0.52610 train_f1_mic= 0.40159 train_f1_mac= 0.11375 val_loss= 0.55102 val_f1_mic= 0.39366 val_f1_mac= 0.11451 time= 0.07146
Iter: 0011 train_loss= 0.53918 train_f1_mic= 0.42503 train_f1_mac= 0.13311 val_loss= 0.55102 val_f1_mic= 0.39366 val_f1_mac= 0.11451 time= 0.07119
Iter: 0016 train_loss= 0.53408 train_f1_mic= 0.39574 train_f1_mac= 0.11212 val_loss= 0.55102 val_f1_mic= 0.39366 val_f1_mac= 0.11451 time= 0.07093
Epoch: 0008
Iter: 0002 train_loss= 0.51968 train_f1_mic= 0.42699 train_f1_mac= 0.13512 val_loss= 0.55724 val_f1_mic= 0.41769 val_f1_mac= 0.13484 time= 0.07083
Iter: 0007 train_loss= 0.53124 train_f1_mic= 0.43177 train_f1_mac= 0.13350 val_loss= 0.55724 val_f1_mic= 0.41769 val_f1_mac= 0.13484 time= 0.07060
Iter: 0012 train_loss= 0.53574 train_f1_mic= 0.42215 train_f1_mac= 0.13481 val_loss= 0.55724 val_f1_mic= 0.41769 val_f1_mac= 0.13484 time= 0.07038
Iter: 0017 train_loss= 0.53164 train_f1_mic= 0.43871 train_f1_mac= 0.14348 val_loss= 0.55724 val_f1_mic= 0.41769 val_f1_mac= 0.13484 time= 0.07017
Epoch: 0009
Iter: 0003 train_loss= 0.52115 train_f1_mic= 0.40404 train_f1_mac= 0.11657 val_loss= 0.53994 val_f1_mic= 0.38269 val_f1_mac= 0.11518 time= 0.07009
Iter: 0008 train_loss= 0.52947 train_f1_mic= 0.42376 train_f1_mac= 0.13610 val_loss= 0.53994 val_f1_mic= 0.38269 val_f1_mac= 0.11518 time= 0.06993
Iter: 0013 train_loss= 0.52314 train_f1_mic= 0.42332 train_f1_mac= 0.13352 val_loss= 0.53994 val_f1_mic= 0.38269 val_f1_mac= 0.11518 time= 0.06975
Iter: 0018 train_loss= 0.52960 train_f1_mic= 0.43671 train_f1_mac= 0.14360 val_loss= 0.53994 val_f1_mic= 0.38269 val_f1_mac= 0.11518 time= 0.06958
Epoch: 0010
Iter: 0004 train_loss= 0.52413 train_f1_mic= 0.41418 train_f1_mac= 0.13763 val_loss= 0.55927 val_f1_mic= 0.44642 val_f1_mac= 0.15613 time= 0.06955
Iter: 0009 train_loss= 0.53209 train_f1_mic= 0.44186 train_f1_mac= 0.14668 val_loss= 0.55927 val_f1_mic= 0.44642 val_f1_mac= 0.15613 time= 0.06939
Iter: 0014 train_loss= 0.50872 train_f1_mic= 0.41565 train_f1_mac= 0.12914 val_loss= 0.55927 val_f1_mic= 0.44642 val_f1_mac= 0.15613 time= 0.06927
Optimization Finished!
Full validation stats: loss= 0.54615 f1_micro= 0.41280 f1_macro= 0.14172 time= 0.11771
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.45282823549304985
Rewards :  -0.0414084911297492 Accuracy :  0.41970144258925046
Total reward :  1.2227887845096463
State input to Controller for training :  [0 0 0 4 0]
Training RNN (States ip) :  [3, 'linear', 3, 'sigmoid']
Training RNN (Reward ip) :  [-0.04140849]
Trial 359: Controller loss : 9184.547852

Prediction action from Controller
State input to Controller for Action :  [0. 0. 0. 4. 0.]
2018-08-31 01:16:38.493447: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:16:38.494022: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:16:38.495079: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:16:38.495720: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:16:38.496372: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69370 train_f1_mic= 0.40177 train_f1_mac= 0.31896 val_loss= 0.66464 val_f1_mic= 0.37213 val_f1_mac= 0.11197 time= 0.77471
Iter: 0005 train_loss= 0.59690 train_f1_mic= 0.37168 train_f1_mac= 0.09213 val_loss= 0.66464 val_f1_mic= 0.37213 val_f1_mac= 0.11197 time= 0.14258
Iter: 0010 train_loss= 0.54838 train_f1_mic= 0.36259 train_f1_mac= 0.08337 val_loss= 0.66464 val_f1_mic= 0.37213 val_f1_mac= 0.11197 time= 0.08530
Iter: 0015 train_loss= 0.54451 train_f1_mic= 0.40958 train_f1_mac= 0.10861 val_loss= 0.66464 val_f1_mic= 0.37213 val_f1_mac= 0.11197 time= 0.06375
Epoch: 0002
Iter: 0001 train_loss= 0.54345 train_f1_mic= 0.39029 train_f1_mac= 0.10354 val_loss= 0.56042 val_f1_mic= 0.39471 val_f1_mac= 0.10892 time= 0.05346
Iter: 0006 train_loss= 0.54855 train_f1_mic= 0.37248 train_f1_mac= 0.09323 val_loss= 0.56042 val_f1_mic= 0.39471 val_f1_mac= 0.10892 time= 0.04636
Iter: 0011 train_loss= 0.52573 train_f1_mic= 0.38345 train_f1_mac= 0.09443 val_loss= 0.56042 val_f1_mic= 0.39471 val_f1_mac= 0.10892 time= 0.04140
Iter: 0016 train_loss= 0.55068 train_f1_mic= 0.37988 train_f1_mac= 0.10805 val_loss= 0.56042 val_f1_mic= 0.39471 val_f1_mac= 0.10892 time= 0.03789
Epoch: 0003
Iter: 0002 train_loss= 0.53329 train_f1_mic= 0.40936 train_f1_mac= 0.12404 val_loss= 0.57077 val_f1_mic= 0.40404 val_f1_mac= 0.12926 time= 0.03597
Iter: 0007 train_loss= 0.52879 train_f1_mic= 0.40913 train_f1_mac= 0.12528 val_loss= 0.57077 val_f1_mic= 0.40404 val_f1_mac= 0.12926 time= 0.03382
Iter: 0012 train_loss= 0.53940 train_f1_mic= 0.43508 train_f1_mac= 0.14091 val_loss= 0.57077 val_f1_mic= 0.40404 val_f1_mac= 0.12926 time= 0.03199
Iter: 0017 train_loss= 0.52948 train_f1_mic= 0.40385 train_f1_mac= 0.12457 val_loss= 0.57077 val_f1_mic= 0.40404 val_f1_mac= 0.12926 time= 0.03050
Epoch: 0004
Iter: 0003 train_loss= 0.53610 train_f1_mic= 0.40974 train_f1_mac= 0.12925 val_loss= 0.54799 val_f1_mic= 0.41488 val_f1_mac= 0.13314 time= 0.02949
Iter: 0008 train_loss= 0.52732 train_f1_mic= 0.41613 train_f1_mac= 0.13653 val_loss= 0.54799 val_f1_mic= 0.41488 val_f1_mac= 0.13314 time= 0.02843
Iter: 0013 train_loss= 0.52630 train_f1_mic= 0.42382 train_f1_mac= 0.14323 val_loss= 0.54799 val_f1_mic= 0.41488 val_f1_mac= 0.13314 time= 0.02761
Iter: 0018 train_loss= 0.51784 train_f1_mic= 0.44699 train_f1_mac= 0.16244 val_loss= 0.54799 val_f1_mic= 0.41488 val_f1_mac= 0.13314 time= 0.02684
Epoch: 0005
Iter: 0004 train_loss= 0.53321 train_f1_mic= 0.43970 train_f1_mac= 0.16107 val_loss= 0.54954 val_f1_mic= 0.40357 val_f1_mac= 0.13470 time= 0.02637
Iter: 0009 train_loss= 0.52108 train_f1_mic= 0.40202 train_f1_mac= 0.14014 val_loss= 0.54954 val_f1_mic= 0.40357 val_f1_mac= 0.13470 time= 0.02580
Iter: 0014 train_loss= 0.51875 train_f1_mic= 0.43948 train_f1_mac= 0.16945 val_loss= 0.54954 val_f1_mic= 0.40357 val_f1_mac= 0.13470 time= 0.02541
Epoch: 0006
Iter: 0000 train_loss= 0.51855 train_f1_mic= 0.45546 train_f1_mac= 0.18549 val_loss= 0.54107 val_f1_mic= 0.47873 val_f1_mac= 0.21431 time= 0.02519
Iter: 0005 train_loss= 0.51429 train_f1_mic= 0.44931 train_f1_mac= 0.18204 val_loss= 0.54107 val_f1_mic= 0.47873 val_f1_mac= 0.21431 time= 0.02477
Iter: 0010 train_loss= 0.51252 train_f1_mic= 0.45824 train_f1_mac= 0.18867 val_loss= 0.54107 val_f1_mic= 0.47873 val_f1_mac= 0.21431 time= 0.02435
Iter: 0015 train_loss= 0.49542 train_f1_mic= 0.46884 train_f1_mac= 0.19649 val_loss= 0.54107 val_f1_mic= 0.47873 val_f1_mac= 0.21431 time= 0.02393
Epoch: 0007
Iter: 0001 train_loss= 0.50800 train_f1_mic= 0.46491 train_f1_mac= 0.20545 val_loss= 0.51863 val_f1_mic= 0.48756 val_f1_mac= 0.23819 time= 0.02377
Iter: 0006 train_loss= 0.50779 train_f1_mic= 0.47323 train_f1_mac= 0.21233 val_loss= 0.51863 val_f1_mic= 0.48756 val_f1_mac= 0.23819 time= 0.02344
Iter: 0011 train_loss= 0.50673 train_f1_mic= 0.50855 train_f1_mac= 0.25203 val_loss= 0.51863 val_f1_mic= 0.48756 val_f1_mac= 0.23819 time= 0.02311
Iter: 0016 train_loss= 0.50195 train_f1_mic= 0.47491 train_f1_mac= 0.21343 val_loss= 0.51863 val_f1_mic= 0.48756 val_f1_mac= 0.23819 time= 0.02283
Epoch: 0008
Iter: 0002 train_loss= 0.50670 train_f1_mic= 0.44936 train_f1_mac= 0.20104 val_loss= 0.51498 val_f1_mic= 0.46388 val_f1_mac= 0.21138 time= 0.02281
Iter: 0007 train_loss= 0.49979 train_f1_mic= 0.47259 train_f1_mac= 0.21428 val_loss= 0.51498 val_f1_mic= 0.46388 val_f1_mac= 0.21138 time= 0.02266
Iter: 0012 train_loss= 0.50539 train_f1_mic= 0.50357 train_f1_mac= 0.25546 val_loss= 0.51498 val_f1_mic= 0.46388 val_f1_mac= 0.21138 time= 0.02242
Iter: 0017 train_loss= 0.49682 train_f1_mic= 0.45745 train_f1_mac= 0.20935 val_loss= 0.51498 val_f1_mic= 0.46388 val_f1_mac= 0.21138 time= 0.02225
Epoch: 0009
Iter: 0003 train_loss= 0.50581 train_f1_mic= 0.48564 train_f1_mac= 0.24027 val_loss= 0.52001 val_f1_mic= 0.51680 val_f1_mac= 0.28306 time= 0.02209
Iter: 0008 train_loss= 0.50651 train_f1_mic= 0.50108 train_f1_mac= 0.25837 val_loss= 0.52001 val_f1_mic= 0.51680 val_f1_mac= 0.28306 time= 0.02186
Iter: 0013 train_loss= 0.49055 train_f1_mic= 0.48206 train_f1_mac= 0.23166 val_loss= 0.52001 val_f1_mic= 0.51680 val_f1_mac= 0.28306 time= 0.02170
Iter: 0018 train_loss= 0.50401 train_f1_mic= 0.46149 train_f1_mac= 0.22435 val_loss= 0.52001 val_f1_mic= 0.51680 val_f1_mac= 0.28306 time= 0.02152
Epoch: 0010
Iter: 0004 train_loss= 0.49707 train_f1_mic= 0.48691 train_f1_mac= 0.24694 val_loss= 0.54202 val_f1_mic= 0.50950 val_f1_mac= 0.27802 time= 0.02144
Iter: 0009 train_loss= 0.50592 train_f1_mic= 0.53420 train_f1_mac= 0.30108 val_loss= 0.54202 val_f1_mic= 0.50950 val_f1_mac= 0.27802 time= 0.02133
Iter: 0014 train_loss= 0.48048 train_f1_mic= 0.47100 train_f1_mac= 0.23610 val_loss= 0.54202 val_f1_mic= 0.50950 val_f1_mac= 0.27802 time= 0.02114
Optimization Finished!
Full validation stats: loss= 0.51317 f1_micro= 0.52637 f1_macro= 0.30193 time= 0.11470
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.46596902200505375
Rewards :  0.0657039325600195 Accuracy :  0.5185321680530693
Total reward :  1.2884927170696658
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.06570394]
Trial 360: Controller loss : 149.730606
2018-08-31 01:16:48.334770: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:16:48.335203: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\
Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'tanh', 2, 'linear']
common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:16:48.335825: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:16:48.336092: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:16:48.336445: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69297 train_f1_mic= 0.37665 train_f1_mac= 0.32966 val_loss= 0.66707 val_f1_mic= 0.39746 val_f1_mac= 0.13411 time= 0.87617
Iter: 0005 train_loss= 0.57911 train_f1_mic= 0.38243 train_f1_mac= 0.09326 val_loss= 0.66707 val_f1_mic= 0.39746 val_f1_mac= 0.13411 time= 0.18375
Iter: 0010 train_loss= 0.54944 train_f1_mic= 0.39137 train_f1_mac= 0.09827 val_loss= 0.66707 val_f1_mic= 0.39746 val_f1_mac= 0.13411 time= 0.12044
Iter: 0015 train_loss= 0.52419 train_f1_mic= 0.38754 train_f1_mac= 0.09294 val_loss= 0.66707 val_f1_mic= 0.39746 val_f1_mac= 0.13411 time= 0.09701
Epoch: 0002
Iter: 0001 train_loss= 0.53080 train_f1_mic= 0.37607 train_f1_mac= 0.08632 val_loss= 0.57723 val_f1_mic= 0.34738 val_f1_mac= 0.08844 time= 0.08636
Iter: 0006 train_loss= 0.53954 train_f1_mic= 0.39406 train_f1_mac= 0.10077 val_loss= 0.57723 val_f1_mic= 0.34738 val_f1_mac= 0.08844 time= 0.07838
Iter: 0011 train_loss= 0.54565 train_f1_mic= 0.40193 train_f1_mac= 0.10847 val_loss= 0.57723 val_f1_mic= 0.34738 val_f1_mac= 0.08844 time= 0.07298
Iter: 0016 train_loss= 0.54165 train_f1_mic= 0.39009 train_f1_mac= 0.10847 val_loss= 0.57723 val_f1_mic= 0.34738 val_f1_mac= 0.08844 time= 0.06910
Epoch: 0003
Iter: 0002 train_loss= 0.54004 train_f1_mic= 0.38250 train_f1_mac= 0.10538 val_loss= 0.55696 val_f1_mic= 0.37570 val_f1_mac= 0.10835 time= 0.06659
Iter: 0007 train_loss= 0.54582 train_f1_mic= 0.39121 train_f1_mac= 0.11482 val_loss= 0.55696 val_f1_mic= 0.37570 val_f1_mac= 0.10835 time= 0.06449
Iter: 0012 train_loss= 0.53340 train_f1_mic= 0.40834 train_f1_mac= 0.12138 val_loss= 0.55696 val_f1_mic= 0.37570 val_f1_mac= 0.10835 time= 0.06268
Iter: 0017 train_loss= 0.53591 train_f1_mic= 0.41674 train_f1_mac= 0.12950 val_loss= 0.55696 val_f1_mic= 0.37570 val_f1_mac= 0.10835 time= 0.06097
Epoch: 0004
Iter: 0003 train_loss= 0.51675 train_f1_mic= 0.40516 train_f1_mac= 0.11718 val_loss= 0.55790 val_f1_mic= 0.41006 val_f1_mac= 0.13237 time= 0.05988
Iter: 0008 train_loss= 0.53826 train_f1_mic= 0.41503 train_f1_mac= 0.13062 val_loss= 0.55790 val_f1_mic= 0.41006 val_f1_mac= 0.13237 time= 0.05866
Iter: 0013 train_loss= 0.52781 train_f1_mic= 0.39304 train_f1_mac= 0.11960 val_loss= 0.55790 val_f1_mic= 0.41006 val_f1_mac= 0.13237 time= 0.05758
Iter: 0018 train_loss= 0.54817 train_f1_mic= 0.43652 train_f1_mac= 0.14733 val_loss= 0.55790 val_f1_mic= 0.41006 val_f1_mac= 0.13237 time= 0.05663
Epoch: 0005
Iter: 0004 train_loss= 0.52806 train_f1_mic= 0.40030 train_f1_mac= 0.12999 val_loss= 0.53925 val_f1_mic= 0.45467 val_f1_mac= 0.16584 time= 0.05617
Iter: 0009 train_loss= 0.53286 train_f1_mic= 0.40980 train_f1_mac= 0.13315 val_loss= 0.53925 val_f1_mic= 0.45467 val_f1_mac= 0.16584 time= 0.05543
Iter: 0014 train_loss= 0.52982 train_f1_mic= 0.42625 train_f1_mac= 0.15097 val_loss= 0.53925 val_f1_mic= 0.45467 val_f1_mac= 0.16584 time= 0.05483
Epoch: 0006
Iter: 0000 train_loss= 0.51617 train_f1_mic= 0.44301 train_f1_mac= 0.15184 val_loss= 0.53336 val_f1_mic= 0.43228 val_f1_mac= 0.15372 time= 0.05450
Iter: 0005 train_loss= 0.53854 train_f1_mic= 0.42777 train_f1_mac= 0.15641 val_loss= 0.53336 val_f1_mic= 0.43228 val_f1_mac= 0.15372 time= 0.05395
Iter: 0010 train_loss= 0.52541 train_f1_mic= 0.41930 train_f1_mac= 0.15376 val_loss= 0.53336 val_f1_mic= 0.43228 val_f1_mac= 0.15372 time= 0.05356
Iter: 0015 train_loss= 0.52221 train_f1_mic= 0.43249 train_f1_mac= 0.16656 val_loss= 0.53336 val_f1_mic= 0.43228 val_f1_mac= 0.15372 time= 0.05313
Epoch: 0007
Iter: 0001 train_loss= 0.51820 train_f1_mic= 0.45335 train_f1_mac= 0.18113 val_loss= 0.53498 val_f1_mic= 0.44965 val_f1_mac= 0.19173 time= 0.05312
Iter: 0006 train_loss= 0.51978 train_f1_mic= 0.46490 train_f1_mac= 0.19265 val_loss= 0.53498 val_f1_mic= 0.44965 val_f1_mac= 0.19173 time= 0.05281
Iter: 0011 train_loss= 0.52431 train_f1_mic= 0.46823 train_f1_mac= 0.19750 val_loss= 0.53498 val_f1_mic= 0.44965 val_f1_mac= 0.19173 time= 0.05248
Iter: 0016 train_loss= 0.53806 train_f1_mic= 0.42549 train_f1_mac= 0.16459 val_loss= 0.53498 val_f1_mic= 0.44965 val_f1_mac= 0.19173 time= 0.05219
Epoch: 0008
Iter: 0002 train_loss= 0.52378 train_f1_mic= 0.43410 train_f1_mac= 0.19478 val_loss= 0.53801 val_f1_mic= 0.46224 val_f1_mac= 0.19813 time= 0.05229
Iter: 0007 train_loss= 0.51658 train_f1_mic= 0.48507 train_f1_mac= 0.21790 val_loss= 0.53801 val_f1_mic= 0.46224 val_f1_mac= 0.19813 time= 0.05201
Iter: 0012 train_loss= 0.51315 train_f1_mic= 0.47156 train_f1_mac= 0.21460 val_loss= 0.53801 val_f1_mic= 0.46224 val_f1_mac= 0.19813 time= 0.05173
Iter: 0017 train_loss= 0.51155 train_f1_mic= 0.46380 train_f1_mac= 0.21310 val_loss= 0.53801 val_f1_mic= 0.46224 val_f1_mac= 0.19813 time= 0.05149
Epoch: 0009
Iter: 0003 train_loss= 0.51694 train_f1_mic= 0.46860 train_f1_mac= 0.24520 val_loss= 0.50934 val_f1_mic= 0.51194 val_f1_mac= 0.27496 time= 0.05139
Iter: 0008 train_loss= 0.50453 train_f1_mic= 0.44286 train_f1_mac= 0.20515 val_loss= 0.50934 val_f1_mic= 0.51194 val_f1_mac= 0.27496 time= 0.05116
Iter: 0013 train_loss= 0.51279 train_f1_mic= 0.44559 train_f1_mac= 0.20076 val_loss= 0.50934 val_f1_mic= 0.51194 val_f1_mac= 0.27496 time= 0.05094
Iter: 0018 train_loss= 0.51767 train_f1_mic= 0.45251 train_f1_mac= 0.20894 val_loss= 0.50934 val_f1_mic= 0.51194 val_f1_mac= 0.27496 time= 0.05074
Epoch: 0010
Iter: 0004 train_loss= 0.50744 train_f1_mic= 0.48842 train_f1_mac= 0.24157 val_loss= 0.52619 val_f1_mic= 0.45223 val_f1_mac= 0.21848 time= 0.05066
Iter: 0009 train_loss= 0.50063 train_f1_mic= 0.50506 train_f1_mac= 0.26531 val_loss= 0.52619 val_f1_mic= 0.45223 val_f1_mac= 0.21848 time= 0.05046
Iter: 0014 train_loss= 0.51483 train_f1_mic= 0.50799 train_f1_mac= 0.27691 val_loss= 0.52619 val_f1_mic= 0.45223 val_f1_mac= 0.21848 time= 0.05035
Optimization Finished!
Full validation stats: loss= 0.52020 f1_micro= 0.52450 f1_macro= 0.30626 time= 0.11965
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47558124563825954
Rewards :  0.04806111816602887 Accuracy :  0.5140301401710826
Total reward :  1.3365538352356947
Saved buffers to file `buffers.txt` !
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'tanh', 2, 'linear']
Training RNN (Reward ip) :  [0.04806112]
Trial 361: Controller loss : 10998.695312

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 5.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]

Predicted actions :  [2, 'linear', 4, 'tanh']
2018-08-31 01:17:03.813770: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:17:03.814136: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:17:03.814469: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:17:03.814715: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:17:03.815036: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69398 train_f1_mic= 0.37111 train_f1_mac= 0.32609 val_loss= 0.67413 val_f1_mic= 0.43080 val_f1_mac= 0.18742 time= 0.82679
Iter: 0005 train_loss= 0.58571 train_f1_mic= 0.38442 train_f1_mac= 0.09389 val_loss= 0.67413 val_f1_mic= 0.43080 val_f1_mac= 0.18742 time= 0.17337
Iter: 0010 train_loss= 0.55140 train_f1_mic= 0.39211 train_f1_mac= 0.10106 val_loss= 0.67413 val_f1_mic= 0.43080 val_f1_mac= 0.18742 time= 0.11325
Iter: 0015 train_loss= 0.54040 train_f1_mic= 0.37079 train_f1_mac= 0.08713 val_loss= 0.67413 val_f1_mic= 0.43080 val_f1_mac= 0.18742 time= 0.09126
Epoch: 0002
Iter: 0001 train_loss= 0.54829 train_f1_mic= 0.37664 train_f1_mac= 0.09227 val_loss= 0.57447 val_f1_mic= 0.37014 val_f1_mac= 0.09512 time= 0.08136
Iter: 0006 train_loss= 0.55450 train_f1_mic= 0.38681 train_f1_mac= 0.09932 val_loss= 0.57447 val_f1_mic= 0.37014 val_f1_mac= 0.09512 time= 0.07404
Iter: 0011 train_loss= 0.54089 train_f1_mic= 0.37892 train_f1_mac= 0.09386 val_loss= 0.57447 val_f1_mic= 0.37014 val_f1_mac= 0.09512 time= 0.06885
Iter: 0016 train_loss= 0.53361 train_f1_mic= 0.39004 train_f1_mac= 0.09622 val_loss= 0.57447 val_f1_mic= 0.37014 val_f1_mac= 0.09512 time= 0.06519
Epoch: 0003
Iter: 0002 train_loss= 0.54751 train_f1_mic= 0.38820 train_f1_mac= 0.10423 val_loss= 0.56305 val_f1_mic= 0.38301 val_f1_mac= 0.10483 time= 0.06340
Iter: 0007 train_loss= 0.53687 train_f1_mic= 0.40177 train_f1_mac= 0.11257 val_loss= 0.56305 val_f1_mic= 0.38301 val_f1_mac= 0.10483 time= 0.06108
Iter: 0012 train_loss= 0.54740 train_f1_mic= 0.38471 train_f1_mac= 0.10450 val_loss= 0.56305 val_f1_mic= 0.38301 val_f1_mac= 0.10483 time= 0.05928
Iter: 0017 train_loss= 0.53788 train_f1_mic= 0.40390 train_f1_mac= 0.11079 val_loss= 0.56305 val_f1_mic= 0.38301 val_f1_mac= 0.10483 time= 0.05765
Epoch: 0004
Iter: 0003 train_loss= 0.53491 train_f1_mic= 0.39879 train_f1_mac= 0.11650 val_loss= 0.54574 val_f1_mic= 0.40287 val_f1_mac= 0.11815 time= 0.05678
Iter: 0008 train_loss= 0.52889 train_f1_mic= 0.41368 train_f1_mac= 0.12630 val_loss= 0.54574 val_f1_mic= 0.40287 val_f1_mac= 0.11815 time= 0.05584
Iter: 0013 train_loss= 0.52226 train_f1_mic= 0.41858 train_f1_mac= 0.11949 val_loss= 0.54574 val_f1_mic= 0.40287 val_f1_mac= 0.11815 time= 0.05481
Iter: 0018 train_loss= 0.54199 train_f1_mic= 0.39610 train_f1_mac= 0.11026 val_loss= 0.54574 val_f1_mic= 0.40287 val_f1_mac= 0.11815 time= 0.05403
Epoch: 0005
Iter: 0004 train_loss= 0.52209 train_f1_mic= 0.41716 train_f1_mac= 0.12278 val_loss= 0.57058 val_f1_mic= 0.38871 val_f1_mac= 0.11555 time= 0.05362
Iter: 0009 train_loss= 0.53996 train_f1_mic= 0.40592 train_f1_mac= 0.12623 val_loss= 0.57058 val_f1_mic= 0.38871 val_f1_mac= 0.11555 time= 0.05298
Iter: 0014 train_loss= 0.53258 train_f1_mic= 0.41902 train_f1_mac= 0.12771 val_loss= 0.57058 val_f1_mic= 0.38871 val_f1_mac= 0.11555 time= 0.05245
Epoch: 0006
Iter: 0000 train_loss= 0.53545 train_f1_mic= 0.42383 train_f1_mac= 0.13401 val_loss= 0.55406 val_f1_mic= 0.41054 val_f1_mac= 0.13091 time= 0.05212
Iter: 0005 train_loss= 0.52194 train_f1_mic= 0.42475 train_f1_mac= 0.13165 val_loss= 0.55406 val_f1_mic= 0.41054 val_f1_mac= 0.13091 time= 0.05164
Iter: 0010 train_loss= 0.53330 train_f1_mic= 0.42030 train_f1_mac= 0.13366 val_loss= 0.55406 val_f1_mic= 0.41054 val_f1_mac= 0.13091 time= 0.05124
Iter: 0015 train_loss= 0.53183 train_f1_mic= 0.41606 train_f1_mac= 0.12628 val_loss= 0.55406 val_f1_mic= 0.41054 val_f1_mac= 0.13091 time= 0.05084
Epoch: 0007
Iter: 0001 train_loss= 0.52400 train_f1_mic= 0.42124 train_f1_mac= 0.13138 val_loss= 0.54088 val_f1_mic= 0.40958 val_f1_mac= 0.13127 time= 0.05075
Iter: 0006 train_loss= 0.53465 train_f1_mic= 0.40669 train_f1_mac= 0.12732 val_loss= 0.54088 val_f1_mic= 0.40958 val_f1_mac= 0.13127 time= 0.05048
Iter: 0011 train_loss= 0.52908 train_f1_mic= 0.42720 train_f1_mac= 0.13618 val_loss= 0.54088 val_f1_mic= 0.40958 val_f1_mac= 0.13127 time= 0.05018
Iter: 0016 train_loss= 0.53992 train_f1_mic= 0.40874 train_f1_mac= 0.12963 val_loss= 0.54088 val_f1_mic= 0.40958 val_f1_mac= 0.13127 time= 0.04988
Epoch: 0008
Iter: 0002 train_loss= 0.52789 train_f1_mic= 0.43886 train_f1_mac= 0.14755 val_loss= 0.54700 val_f1_mic= 0.42434 val_f1_mac= 0.14052 time= 0.04976
Iter: 0007 train_loss= 0.53461 train_f1_mic= 0.41593 train_f1_mac= 0.13675 val_loss= 0.54700 val_f1_mic= 0.42434 val_f1_mac= 0.14052 time= 0.04949
Iter: 0012 train_loss= 0.52197 train_f1_mic= 0.42310 train_f1_mac= 0.13421 val_loss= 0.54700 val_f1_mic= 0.42434 val_f1_mac= 0.14052 time= 0.04928
Iter: 0017 train_loss= 0.52881 train_f1_mic= 0.44471 train_f1_mac= 0.14977 val_loss= 0.54700 val_f1_mic= 0.42434 val_f1_mac= 0.14052 time= 0.04910
Epoch: 0009
Iter: 0003 train_loss= 0.53276 train_f1_mic= 0.43569 train_f1_mac= 0.14903 val_loss= 0.56186 val_f1_mic= 0.40130 val_f1_mac= 0.13561 time= 0.04919
Iter: 0008 train_loss= 0.53337 train_f1_mic= 0.40971 train_f1_mac= 0.12869 val_loss= 0.56186 val_f1_mic= 0.40130 val_f1_mac= 0.13561 time= 0.04893
Iter: 0013 train_loss= 0.51953 train_f1_mic= 0.43655 train_f1_mac= 0.14404 val_loss= 0.56186 val_f1_mic= 0.40130 val_f1_mac= 0.13561 time= 0.04873
Iter: 0018 train_loss= 0.51981 train_f1_mic= 0.40872 train_f1_mac= 0.13595 val_loss= 0.56186 val_f1_mic= 0.40130 val_f1_mac= 0.13561 time= 0.04861
Epoch: 0010
Iter: 0004 train_loss= 0.53231 train_f1_mic= 0.43839 train_f1_mac= 0.15727 val_loss= 0.55040 val_f1_mic= 0.41296 val_f1_mac= 0.14435 time= 0.04871
Iter: 0009 train_loss= 0.52638 train_f1_mic= 0.42056 train_f1_mac= 0.14174 val_loss= 0.55040 val_f1_mic= 0.41296 val_f1_mac= 0.14435 time= 0.04852
Iter: 0014 train_loss= 0.51639 train_f1_mic= 0.42796 train_f1_mac= 0.14418 val_loss= 0.55040 val_f1_mic= 0.41296 val_f1_mac= 0.14435 time= 0.04834
Optimization Finished!
Full validation stats: loss= 0.54128 f1_micro= 0.45314 f1_macro= 0.17227 time= 0.11569
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.47234638424056596
Rewards :  -0.016174306988468112 Accuracy :  0.45940693864979143
Total reward :  1.3203795282472266
State input to Controller for training :  [0 0 3 0 0]
Training RNN (States ip) :  [2, 'linear', 4, 'tanh']
Training RNN (Reward ip) :  [-0.01617431]
Trial 362: Controller loss : 16456.158203

Prediction action from Controller
State input to Controller for Action :  [0. 0. 3. 0. 0.]
Actions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
2018-08-31 01:17:18.811829: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:17:18.812272: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:17:18.812694: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:17:18.813011: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:17:18.813406: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69067 train_f1_mic= 0.34026 train_f1_mac= 0.26543 val_loss= 0.66382 val_f1_mic= 0.36247 val_f1_mac= 0.10429 time= 0.76617
Iter: 0005 train_loss= 0.59102 train_f1_mic= 0.38188 train_f1_mac= 0.09316 val_loss= 0.66382 val_f1_mic= 0.36247 val_f1_mac= 0.10429 time= 0.14149
Iter: 0010 train_loss= 0.55418 train_f1_mic= 0.38207 train_f1_mac= 0.09380 val_loss= 0.66382 val_f1_mic= 0.36247 val_f1_mac= 0.10429 time= 0.08398
Iter: 0015 train_loss= 0.53088 train_f1_mic= 0.41065 train_f1_mac= 0.10554 val_loss= 0.66382 val_f1_mic= 0.36247 val_f1_mac= 0.10429 time= 0.06234
Epoch: 0002
Iter: 0001 train_loss= 0.54055 train_f1_mic= 0.40357 train_f1_mac= 0.10445 val_loss= 0.54996 val_f1_mic= 0.39234 val_f1_mac= 0.10342 time= 0.05163
Iter: 0006 train_loss= 0.53034 train_f1_mic= 0.37949 train_f1_mac= 0.09380 val_loss= 0.54996 val_f1_mic= 0.39234 val_f1_mac= 0.10342 time= 0.04445
Iter: 0011 train_loss= 0.54170 train_f1_mic= 0.37756 train_f1_mac= 0.09758 val_loss= 0.54996 val_f1_mic= 0.39234 val_f1_mac= 0.10342 time= 0.03956
Iter: 0016 train_loss= 0.54374 train_f1_mic= 0.38213 train_f1_mac= 0.10308 val_loss= 0.54996 val_f1_mic= 0.39234 val_f1_mac= 0.10342 time= 0.03600
Epoch: 0003
Iter: 0002 train_loss= 0.54340 train_f1_mic= 0.38648 train_f1_mac= 0.10788 val_loss= 0.56255 val_f1_mic= 0.38389 val_f1_mac= 0.11106 time= 0.03426
Iter: 0007 train_loss= 0.53500 train_f1_mic= 0.38698 train_f1_mac= 0.11463 val_loss= 0.56255 val_f1_mic= 0.38389 val_f1_mac= 0.11106 time= 0.03214
Iter: 0012 train_loss= 0.53726 train_f1_mic= 0.41258 train_f1_mac= 0.12843 val_loss= 0.56255 val_f1_mic= 0.38389 val_f1_mac= 0.11106 time= 0.03055
Iter: 0017 train_loss= 0.53393 train_f1_mic= 0.41693 train_f1_mac= 0.12977 val_loss= 0.56255 val_f1_mic= 0.38389 val_f1_mac= 0.11106 time= 0.02909
Epoch: 0004
Iter: 0003 train_loss= 0.51846 train_f1_mic= 0.42688 train_f1_mac= 0.13308 val_loss= 0.54554 val_f1_mic= 0.43544 val_f1_mac= 0.14642 time= 0.02824
Iter: 0008 train_loss= 0.52739 train_f1_mic= 0.41960 train_f1_mac= 0.13281 val_loss= 0.54554 val_f1_mic= 0.43544 val_f1_mac= 0.14642 time= 0.02722
Iter: 0013 train_loss= 0.52012 train_f1_mic= 0.43670 train_f1_mac= 0.14819 val_loss= 0.54554 val_f1_mic= 0.43544 val_f1_mac= 0.14642 time= 0.02640
Iter: 0018 train_loss= 0.51899 train_f1_mic= 0.43030 train_f1_mac= 0.15005 val_loss= 0.54554 val_f1_mic= 0.43544 val_f1_mac= 0.14642 time= 0.02561
Epoch: 0005
Iter: 0004 train_loss= 0.51668 train_f1_mic= 0.42850 train_f1_mac= 0.15307 val_loss= 0.52797 val_f1_mic= 0.43279 val_f1_mac= 0.15927 time= 0.02521
Iter: 0009 train_loss= 0.52772 train_f1_mic= 0.44550 train_f1_mac= 0.16925 val_loss= 0.52797 val_f1_mic= 0.43279 val_f1_mac= 0.15927 time= 0.02473
Iter: 0014 train_loss= 0.51626 train_f1_mic= 0.42706 train_f1_mac= 0.14666 val_loss= 0.52797 val_f1_mic= 0.43279 val_f1_mac= 0.15927 time= 0.02419
Epoch: 0006
Iter: 0000 train_loss= 0.51494 train_f1_mic= 0.44201 train_f1_mac= 0.17018 val_loss= 0.52145 val_f1_mic= 0.45535 val_f1_mac= 0.18143 time= 0.02409
Iter: 0005 train_loss= 0.51756 train_f1_mic= 0.46360 train_f1_mac= 0.20030 val_loss= 0.52145 val_f1_mic= 0.45535 val_f1_mac= 0.18143 time= 0.02374
Iter: 0010 train_loss= 0.50259 train_f1_mic= 0.47039 train_f1_mac= 0.20028 val_loss= 0.52145 val_f1_mic= 0.45535 val_f1_mac= 0.18143 time= 0.02328
Iter: 0015 train_loss= 0.51763 train_f1_mic= 0.44921 train_f1_mac= 0.18127 val_loss= 0.52145 val_f1_mic= 0.45535 val_f1_mac= 0.18143 time= 0.02289
Epoch: 0007
Iter: 0001 train_loss= 0.51010 train_f1_mic= 0.44469 train_f1_mac= 0.17775 val_loss= 0.52419 val_f1_mic= 0.46042 val_f1_mac= 0.20197 time= 0.02263
Iter: 0006 train_loss= 0.51476 train_f1_mic= 0.45308 train_f1_mac= 0.18813 val_loss= 0.52419 val_f1_mic= 0.46042 val_f1_mac= 0.20197 time= 0.02227
Iter: 0011 train_loss= 0.51549 train_f1_mic= 0.44984 train_f1_mac= 0.19825 val_loss= 0.52419 val_f1_mic= 0.46042 val_f1_mac= 0.20197 time= 0.02196
Iter: 0016 train_loss= 0.52185 train_f1_mic= 0.48799 train_f1_mac= 0.23566 val_loss= 0.52419 val_f1_mic= 0.46042 val_f1_mac= 0.20197 time= 0.02171
Epoch: 0008
Iter: 0002 train_loss= 0.49900 train_f1_mic= 0.44347 train_f1_mac= 0.18764 val_loss= 0.54836 val_f1_mic= 0.46499 val_f1_mac= 0.22778 time= 0.02190
Iter: 0007 train_loss= 0.50435 train_f1_mic= 0.47100 train_f1_mac= 0.21895 val_loss= 0.54836 val_f1_mic= 0.46499 val_f1_mac= 0.22778 time= 0.02172
Iter: 0012 train_loss= 0.49912 train_f1_mic= 0.49202 train_f1_mac= 0.24525 val_loss= 0.54836 val_f1_mic= 0.46499 val_f1_mac= 0.22778 time= 0.02146
Iter: 0017 train_loss= 0.49591 train_f1_mic= 0.49066 train_f1_mac= 0.24584 val_loss= 0.54836 val_f1_mic= 0.46499 val_f1_mac= 0.22778 time= 0.02122
Epoch: 0009
Iter: 0003 train_loss= 0.49808 train_f1_mic= 0.48632 train_f1_mac= 0.23663 val_loss= 0.52470 val_f1_mic= 0.47571 val_f1_mac= 0.23737 time= 0.02127
Iter: 0008 train_loss= 0.51243 train_f1_mic= 0.50048 train_f1_mac= 0.26245 val_loss= 0.52470 val_f1_mic= 0.47571 val_f1_mac= 0.23737 time= 0.02109
Iter: 0013 train_loss= 0.49513 train_f1_mic= 0.48069 train_f1_mac= 0.23523 val_loss= 0.52470 val_f1_mic= 0.47571 val_f1_mac= 0.23737 time= 0.02091
Iter: 0018 train_loss= 0.49123 train_f1_mic= 0.50023 train_f1_mac= 0.25610 val_loss= 0.52470 val_f1_mic= 0.47571 val_f1_mac= 0.23737 time= 0.02073
Epoch: 0010
Iter: 0004 train_loss= 0.50098 train_f1_mic= 0.47765 train_f1_mac= 0.24350 val_loss= 0.51570 val_f1_mic= 0.51225 val_f1_mac= 0.28400 time= 0.02067
Iter: 0009 train_loss= 0.49589 train_f1_mic= 0.49858 train_f1_mac= 0.26806 val_loss= 0.51570 val_f1_mic= 0.51225 val_f1_mac= 0.28400 time= 0.02049
Iter: 0014 train_loss= 0.49477 train_f1_mic= 0.48850 train_f1_mac= 0.25552 val_loss= 0.51570 val_f1_mic= 0.51225 val_f1_mac= 0.28400 time= 0.02037
Optimization Finished!
Full validation stats: loss= 0.51299 f1_micro= 0.50178 f1_macro= 0.27189 time= 0.09378
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4780982819776818
Rewards :  0.028759488685579204 Accuracy :  0.5011058729261452
Total reward :  1.349139016932806
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02875949]
Trial 363: Controller loss : 149.637192

Prediction action from Controller
State input to Controller for Action :  [1. 0. 0. 0. 0.]
2018-08-31 01:17:28.233104: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:17:28.233604: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:17:28.234355: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:17:28.234683: I C:\users\nwani\_bazel_nwani\ujdkActions :
******************** Layer 1 ********************
aggType :  [(0, 1.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 1.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 1.0), ('linear', 0.0)]

Predicted actions :  [0, 'relu', 3, 'relu']
fsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:17:28.235283: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69448 train_f1_mic= 0.39090 train_f1_mac= 0.32218 val_loss= 0.66459 val_f1_mic= 0.38599 val_f1_mac= 0.11360 time= 0.78261
Iter: 0005 train_loss= 0.58994 train_f1_mic= 0.37578 train_f1_mac= 0.09066 val_loss= 0.66459 val_f1_mic= 0.38599 val_f1_mac= 0.11360 time= 0.14340
Iter: 0010 train_loss= 0.54069 train_f1_mic= 0.38227 train_f1_mac= 0.09127 val_loss= 0.66459 val_f1_mic= 0.38599 val_f1_mac= 0.11360 time= 0.08483
Iter: 0015 train_loss= 0.53188 train_f1_mic= 0.41148 train_f1_mac= 0.10478 val_loss= 0.66459 val_f1_mic= 0.38599 val_f1_mac= 0.11360 time= 0.06269
Epoch: 0002
Iter: 0001 train_loss= 0.53841 train_f1_mic= 0.40353 train_f1_mac= 0.10256 val_loss= 0.55161 val_f1_mic= 0.39736 val_f1_mac= 0.10416 time= 0.05184
Iter: 0006 train_loss= 0.53096 train_f1_mic= 0.38327 train_f1_mac= 0.09343 val_loss= 0.55161 val_f1_mic= 0.39736 val_f1_mac= 0.10416 time= 0.04483
Iter: 0011 train_loss= 0.54196 train_f1_mic= 0.36048 train_f1_mac= 0.08838 val_loss= 0.55161 val_f1_mic= 0.39736 val_f1_mac= 0.10416 time= 0.04001
Iter: 0016 train_loss= 0.53105 train_f1_mic= 0.38814 train_f1_mac= 0.10325 val_loss= 0.55161 val_f1_mic= 0.39736 val_f1_mac= 0.10416 time= 0.03647
Epoch: 0003
Iter: 0002 train_loss= 0.53843 train_f1_mic= 0.41170 train_f1_mac= 0.11957 val_loss= 0.56216 val_f1_mic= 0.39843 val_f1_mac= 0.11967 time= 0.03417
Iter: 0007 train_loss= 0.53431 train_f1_mic= 0.38829 train_f1_mac= 0.11344 val_loss= 0.56216 val_f1_mic= 0.39843 val_f1_mac= 0.11967 time= 0.03201
Iter: 0012 train_loss= 0.53014 train_f1_mic= 0.39080 train_f1_mac= 0.11845 val_loss= 0.56216 val_f1_mic= 0.39843 val_f1_mac= 0.11967 time= 0.03030
Iter: 0017 train_loss= 0.52500 train_f1_mic= 0.42575 train_f1_mac= 0.12809 val_loss= 0.56216 val_f1_mic= 0.39843 val_f1_mac= 0.11967 time= 0.02888
Epoch: 0004
Iter: 0003 train_loss= 0.52233 train_f1_mic= 0.41156 train_f1_mac= 0.12395 val_loss= 0.55760 val_f1_mic= 0.41458 val_f1_mac= 0.13367 time= 0.02797
Iter: 0008 train_loss= 0.53162 train_f1_mic= 0.41882 train_f1_mac= 0.13567 val_loss= 0.55760 val_f1_mic= 0.41458 val_f1_mac= 0.13367 time= 0.02692
Iter: 0013 train_loss= 0.51996 train_f1_mic= 0.39602 train_f1_mac= 0.12371 val_loss= 0.55760 val_f1_mic= 0.41458 val_f1_mac= 0.13367 time= 0.02602
Iter: 0018 train_loss= 0.51766 train_f1_mic= 0.42219 train_f1_mac= 0.13633 val_loss= 0.55760 val_f1_mic= 0.41458 val_f1_mac= 0.13367 time= 0.02523
Epoch: 0005
Iter: 0004 train_loss= 0.52953 train_f1_mic= 0.43323 train_f1_mac= 0.15298 val_loss= 0.53233 val_f1_mic= 0.43511 val_f1_mac= 0.15074 time= 0.02479
Iter: 0009 train_loss= 0.51340 train_f1_mic= 0.43352 train_f1_mac= 0.14990 val_loss= 0.53233 val_f1_mic= 0.43511 val_f1_mac= 0.15074 time= 0.02429
Iter: 0014 train_loss= 0.53033 train_f1_mic= 0.45383 train_f1_mac= 0.17634 val_loss= 0.53233 val_f1_mic= 0.43511 val_f1_mac= 0.15074 time= 0.02384
Epoch: 0006
Iter: 0000 train_loss= 0.50623 train_f1_mic= 0.43357 train_f1_mac= 0.16136 val_loss= 0.54846 val_f1_mic= 0.43427 val_f1_mac= 0.17381 time= 0.02363
Iter: 0005 train_loss= 0.52316 train_f1_mic= 0.42534 train_f1_mac= 0.15316 val_loss= 0.54846 val_f1_mic= 0.43427 val_f1_mac= 0.17381 time= 0.02330
Iter: 0010 train_loss= 0.52815 train_f1_mic= 0.44898 train_f1_mac= 0.18199 val_loss= 0.54846 val_f1_mic= 0.43427 val_f1_mac= 0.17381 time= 0.02287
Iter: 0015 train_loss= 0.52609 train_f1_mic= 0.44862 train_f1_mac= 0.17739 val_loss= 0.54846 val_f1_mic= 0.43427 val_f1_mac= 0.17381 time= 0.02251
Epoch: 0007
Iter: 0001 train_loss= 0.51997 train_f1_mic= 0.43163 train_f1_mac= 0.16484 val_loss= 0.53633 val_f1_mic= 0.45071 val_f1_mac= 0.19165 time= 0.02236
Iter: 0006 train_loss= 0.51329 train_f1_mic= 0.46199 train_f1_mac= 0.20267 val_loss= 0.53633 val_f1_mic= 0.45071 val_f1_mac= 0.19165 time= 0.02203
Iter: 0011 train_loss= 0.50981 train_f1_mic= 0.46561 train_f1_mac= 0.19926 val_loss= 0.53633 val_f1_mic= 0.45071 val_f1_mac= 0.19165 time= 0.02171
Iter: 0016 train_loss= 0.50932 train_f1_mic= 0.46327 train_f1_mac= 0.20448 val_loss= 0.53633 val_f1_mic= 0.45071 val_f1_mac= 0.19165 time= 0.02142
Epoch: 0008
Iter: 0002 train_loss= 0.50860 train_f1_mic= 0.47715 train_f1_mac= 0.22167 val_loss= 0.51910 val_f1_mic= 0.51560 val_f1_mac= 0.26289 time= 0.02130
Iter: 0007 train_loss= 0.50705 train_f1_mic= 0.51312 train_f1_mac= 0.26282 val_loss= 0.51910 val_f1_mic= 0.51560 val_f1_mac= 0.26289 time= 0.02108
Iter: 0012 train_loss= 0.50751 train_f1_mic= 0.42297 train_f1_mac= 0.16771 val_loss= 0.51910 val_f1_mic= 0.51560 val_f1_mac= 0.26289 time= 0.02086
Iter: 0017 train_loss= 0.49872 train_f1_mic= 0.45953 train_f1_mac= 0.20340 val_loss= 0.51910 val_f1_mic= 0.51560 val_f1_mac= 0.26289 time= 0.02069
Epoch: 0009
Iter: 0003 train_loss= 0.50433 train_f1_mic= 0.49990 train_f1_mac= 0.24944 val_loss= 0.54298 val_f1_mic= 0.44141 val_f1_mac= 0.19909 time= 0.02070
Iter: 0008 train_loss= 0.50176 train_f1_mic= 0.45492 train_f1_mac= 0.20975 val_loss= 0.54298 val_f1_mic= 0.44141 val_f1_mac= 0.19909 time= 0.02052
Iter: 0013 train_loss= 0.49688 train_f1_mic= 0.51395 train_f1_mac= 0.27154 val_loss= 0.54298 val_f1_mic= 0.44141 val_f1_mac= 0.19909 time= 0.02032
Iter: 0018 train_loss= 0.49911 train_f1_mic= 0.46441 train_f1_mac= 0.23003 val_loss= 0.54298 val_f1_mic= 0.44141 val_f1_mac= 0.19909 time= 0.02021
Epoch: 0010
Iter: 0004 train_loss= 0.48784 train_f1_mic= 0.49346 train_f1_mac= 0.24685 val_loss= 0.51156 val_f1_mic= 0.50507 val_f1_mac= 0.25779 time= 0.02017
Iter: 0009 train_loss= 0.49432 train_f1_mic= 0.48229 train_f1_mac= 0.24106 val_loss= 0.51156 val_f1_mic= 0.50507 val_f1_mac= 0.25779 time= 0.02003
Iter: 0014 train_loss= 0.50579 train_f1_mic= 0.47455 train_f1_mac= 0.24039 val_loss= 0.51156 val_f1_mic= 0.50507 val_f1_mac= 0.25779 time= 0.01990
Optimization Finished!
Full validation stats: loss= 0.51367 f1_micro= 0.50318 f1_macro= 0.27353 time= 0.08478
Writing test set stats to file (don't peak!)

Manager: EWA Accuracy =  0.4832499450468735
Rewards :  0.025758315345958627 Accuracy :  0.5038565973236404
Total reward :  1.3748973322787645
State input to Controller for training :  [1 0 0 0 0]
Training RNN (States ip) :  [0, 'relu', 3, 'relu']
Training RNN (Reward ip) :  [0.02575831]
Trial 364: Controller loss : 149.892639

Generating random action to explore
Actions :
******************** Layer 1 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 3.0), (3, 0.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 2.0), ('relu', 0.0), ('linear', 0.0)]
******************** Layer 2 ********************
aggType :  [(0, 0.0), (1, 0.0), (2, 0.0), (3, 4.0), (4, 0.0)]
aggType :  [('sigmoid', 0.0), ('tanh', 0.0), ('relu', 0.0), ('linear', 4.0)]

Predicted actions :  [2, 'tanh', 3, 'linear']
2018-08-31 01:17:37.132872: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-31 01:17:37.133431: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-31 01:17:37.134010: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:958]      0
2018-08-31 01:17:37.134442: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:971] 0:   N
2018-08-31 01:17:37.134953: I C:\users\nwani\_bazel_nwani\ujdkfsks\execroot\org_tensorflow\tensorflow\core\common_runtime\gpu\gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4726 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 0001
Iter: 0000 train_loss= 0.69412 train_f1_mic= 0.37585 train_f1_mac= 0.31973 val_loss= 0.67080 val_f1_mic= 0.38733 val_f1_mac= 0.12749 time= 0.88312
Iter: 0005 train_loss= 0.58009 train_f1_mic= 0.36571 train_f1_mac= 0.08626 val_loss= 0.67080 val_f1_mic= 0.38733 val_f1_mac= 0.12749 time= 0.18509
Iter: 0010 train_loss= 0.54670 train_f1_mic= 0.39222 train_f1_mac= 0.09811 val_loss= 0.67080 val_f1_mic= 0.38733 val_f1_mac= 0.12749 time= 0.12136
Iter: 0015 train_loss= 0.53972 train_f1_mic= 0.38451 train_f1_mac= 0.09584 val_loss= 0.67080 val_f1_mic= 0.38733 val_f1_mac= 0.12749 time= 0.09740
Epoch: 0002
Iter: 0001 train_loss= 0.53122 train_f1_mic= 0.38084 train_f1_mac= 0.09217 val_loss= 0.56205 val_f1_mic= 0.36858 val_f1_mac= 0.09623 time= 0.08636
Iter: 0006 train_loss= 0.55225 train_f1_mic= 0.37575 train_f1_mac= 0.09645 val_loss= 0.56205 val_f1_mic= 0.36858 val_f1_mac= 0.09623 time= 0.07839
Iter: 0011 train_loss= 0.54196 train_f1_mic= 0.36917 train_f1_mac= 0.09170 val_loss= 0.56205 val_f1_mic= 0.36858 val_f1_mac= 0.09623 time= 0.07330
Iter: 0016 train_loss= 0.53702 train_f1_mic= 0.40656 train_f1_mac= 0.11124 val_loss= 0.56205 val_f1_mic= 0.36858 val_f1_mac= 0.09623 time= 0.06930
Epoch: 0003
Iter: 0002 train_loss= 0.54395 train_f1_mic= 0.38252 train_f1_mac= 0.10753 val_loss= 0.55547 val_f1_mic= 0.39300 val_f1_mac= 0.11402 time= 0.06683
Iter: 0007 train_loss= 0.53377 train_f1_mic= 0.40301 train_f1_mac= 0.11603 val_loss= 0.55547 val_f1_mic= 0.39300 val_f1_mac= 0.11402 time= 0.06460
Iter: 0012 train_loss= 0.53254 train_f1_mic= 0.42847 train_f1_mac= 0.13195 val_loss= 0.55547 val_f1_mic= 0.39300 val_f1_mac= 0.11402 time= 0.06272
Iter: 0017 train_loss= 0.52131 train_f1_mic= 0.42745 train_f1_mac= 0.13139 val_loss= 0.55547 val_f1_mic= 0.39300 val_f1_mac= 0.11402 time= 0.06113
Epoch: 0004
Iter: 0003 train_loss= 0.51976 train_f1_mic= 0.43103 train_f1_mac= 0.13799 val_loss= 0.56410 val_f1_mic= 0.40234 val_f1_mac= 0.13257 time= 0.06051
Iter: 0008 train_loss= 0.51849 train_f1_mic= 0.42146 train_f1_mac= 0.13623 val_loss= 0.56410 val_f1_mic= 0.40234 val_f1_mac= 0.13257 time= 0.05925
Iter: 0013 train_loss= 0.51991 train_f1_mic= 0.42561 train_f1_mac= 0.13685 val_loss= 0.56410 val_f1_mic= 0.40234 val_f1_mac= 0.13257 time= 0.05834
Iter: 0018 train_loss= 0.52712 train_f1_mic= 0.43477 train_f1_mac= 0.15305 val_loss= 0.56410 val_f1_mic= 0.40234 val_f1_mac= 0.13257 time= 0.05743
Epoch: 0005
Iter: 0004 train_loss= 0.53697 train_f1_mic= 0.40924 train_f1_mac= 0.14058 val_loss= 0.53110 val_f1_mic= 0.44223 val_f1_mac= 0.16869 time= 0.05705
Iter: 0009 train_loss= 0.52151 train_f1_mic= 0.42141 train_f1_mac= 0.14809 val_loss= 0.53110 val_f1_mic= 0.44223 val_f1_mac= 0.16869 time= 0.05636
Iter: 0014 train_loss= 0.51796 train_f1_mic= 0.46048 train_f1_mac= 0.18286 val_loss= 0.53110 val_f1_mic= 0.44223 val_f1_mac= 0.16869 time= 0.05584
Epoch: 0006
Iter: 0000 train_loss= 0.51614 train_f1_mic= 0.41281 train_f1_mac= 0.14171 val_loss= 0.53348 val_f1_mic= 0.46278 val_f1_mac= 0.19612 time= 0.05553
Iter: 0005 train_loss= 0.52582 train_f1_mic= 0.44814 train_f1_mac= 0.17835 val_loss= 0.53348 val_f1_mic= 0.46278 val_f1_mac= 0.19612 time= 0.05505
Iter: 0010 train_loss= 0.53283 train_f1_mic= 0.43443 train_f1_mac= 0.17475 val_loss= 0.53348 val_f1_mic= 0.46278 val_f1_mac= 0.19612 time= 0.05454

Process finished with exit code -1
